let grid = GridStack.init({
  cellHeight: 10,
});

let a11_x = 0,
  a11_y = 0,
  a11_w = 4,
  a11_h = 16;
let a12_x = 4,
  a12_y = 0,
  a12_w = 4,
  a12_h = 16;
let a13_x = 8,
  a13_y = 0,
  a13_w = 4,
  a13_h = 16;
let a14_x = 0,
  a14_y = 16,
  a14_w = 4,
  a14_h = 16;
let a15_x = 4,
  a15_y = 16,
  a15_w = 4,
  a15_h = 16;
let a70_x = 8,
  a70_y = 16,
  a70_w = 4,
  a70_h = 16;
let a71_x = 0,
  a71_y = 607,
  a71_w = 4,
  a71_h = 16;
let a72_x = 4,
  a72_y = 607,
  a72_w = 4,
  a72_h = 16;
let a73_x = 8,
  a73_y = 607,
  a73_w = 4,
  a73_h = 16;
let a74_x = 0,
  a74_y = 547,
  a74_w = 12,
  a74_h = 60;
let a75_x = 0,
  a75_y = 437,
  a75_w = 12,
  a75_h = 50;
let a114_x = 0,
  a114_y = 2651,
  a114_w = 6,
  a114_h = 50;
let a115_x = 6,
  a115_y = 2651,
  a115_w = 6,
  a115_h = 50;
let a116_x = 0,
  a116_y = 1668,
  a116_w = 12,
  a116_h = 47;
let a117_x = 0,
  a117_y = 1715,
  a117_w = 12,
  a117_h = 57;
let a118_x = 0,
  a118_y = 1772,
  a118_w = 12,
  a118_h = 77;
let a119_x = 0,
  a119_y = 1849,
  a119_w = 12,
  a119_h = 76;
let a120_x = 0,
  a120_y = 2690,
  a120_w = 12,
  a120_h = 50;
let a76_x = 0,
  a76_y = 1344,
  a76_w = 6,
  a76_h = 20;
let a77_x = 6,
  a77_y = 1344,
  a77_w = 6,
  a77_h = 20;
let a78_x = 0,
  a78_y = 387,
  a78_w = 12,
  a78_h = 50;
let a79_x = 0,
  a79_y = 92,
  a79_w = 12,
  a79_h = 50;
let a16_x = 0,
  a16_y = 32,
  a16_w = 6,
  a16_h = 60;

let a69_x = 6,
  a69_y = 32,
  a69_w = 6,
  a69_h = 60;
// let a17_x = 6,
//   a17_y = 30,
//   a17_w = 6,
//   a17_h = 42;
let a18_x = 0,
  a18_y = 142,
  a18_w = 12,
  a18_h = 50;
let a19_x = 0,
  a19_y = 192,
  a19_w = 12,
  a19_h = 50;
let a39_x = 0,
  a39_y = 242,
  a39_w = 12,
  a39_h = 50;
let a40_x = 0,
  a40_y = 292,
  a40_w = 12,
  a40_h = 50;
let a20_x = 0,
  a20_y = 342,
  a20_w = 6,
  a20_h = 45;
let a21_x = 6,
  a21_y = 342,
  a21_w = 3,
  a21_h = 45;
let a22_x = 9,
  a22_y = 342,
  a22_w = 3,
  a22_h = 45;

// let a24_x = 6,
//   a24_y = 317,
//   a24_w = 6,
//   a24_h = 45;
let a50_x = 4,
  a50_y = 362,
  a50_w = 4,
  a50_h = 15;
let a51_x = 8,
  a51_y = 362,
  a51_w = 4,
  a51_h = 15;
// let a52_x = 0,
//   a52_y = 377,
//   a52_w = 4,
//   a52_h = 15;
// let a53_x = 4,
//   a53_y = 377,
//   a53_w = 4,
//   a53_h = 15;
// let a54_x = 8,
//   a54_y = 377,
//   a54_w = 4,
//   a54_h = 15;
let a55_x = 8,
  a55_y = 452,
  a55_w = 4,
  a55_h = 15;
let a56_x = 0,
  a56_y = 437,
  a56_w = 4,
  a56_h = 15;
let a57_x = 8,
  a57_y = 437,
  a57_w = 4,
  a57_h = 15;
let a58_x = 4,
  a58_y = 437,
  a58_w = 4,
  a58_h = 15;
let a59_x = 0,
  a59_y = 2250,
  a59_w = 4,
  a59_h = 15;
let a60_x = 4,
  a60_y = 2250,
  a60_w = 4,
  a60_h = 15;

let a47_x = 0,
  a47_y = 317,
  a47_w = 12,
  a47_h = 45;
let a48_x = 0,
  a48_y = 2265,
  a48_w = 6,
  a48_h = 45;
let a49_x = 6,
  a49_y = 2265,
  a49_w = 6,
  a49_h = 45;

let a25_x = 0,
  a25_y = 1066,
  a25_w = 12,
  a25_h = 130;

let a26_x = 0,
  a26_y = 1148,
  a26_w = 12,
  a26_h = 133;

let a27_x = 0,
  a27_y = 1361,
  a27_w = 6,
  a27_h = 20;

let a63_x = 0,
  a63_y = 1341,
  a63_w = 6,
  a63_h = 20;

let a29_x = 6,
  a29_y = 1361,
  a29_w = 6,
  a29_h = 20;

let a28_x = 6,
  a28_y = 1341,
  a28_w = 6,
  a28_h = 20;


let a30_x = 0,
  a30_y = 623,
  a30_w = 6,
  a30_h = 45;
let a31_x = 6,
  a31_y = 623,
  a31_w = 6,
  a31_h = 45;

let a33_x = 0,
  a33_y = 1281,
  a33_w = 12,
  a33_h = 60;
let a34_x = 0,
  a34_y = 668,
  a34_w = 4,
  a34_h = 20;
let a35_x = 4,
  a35_y = 668,
  a35_w = 4,
  a35_h = 20;
let a41_x = 8,
  a41_y = 668,
  a41_w = 4,
  a41_h = 20;
let a36_x = 6,
  a36_y = 688,
  a36_w = 6,
  a36_h = 20;
let a37_x = 0,
  a37_y = 688,
  a37_w = 6,
  a37_h = 20;

let a38_x = 0,
  a38_y = 708,
  a38_w = 12,
  a38_h = 60;
let a42_x = 0,
  a42_y = 1381,
  a42_w = 12,
  a42_h = 60;

let a68_x = 0,
  a68_y = 487,
  a68_w = 12,
  a68_h = 60;

let a44_x = 0,
  a44_y = 768,
  a44_w = 6,
  a44_h = 45;
// let a45_x = 6,
//   a45_y = 480,
//   a45_w = 6,
//   a45_h = 45;

let a46_x = 6,
  a46_y = 768,
  a46_w = 6,
  a46_h = 45;

let a64_x = 0,
  a64_y = 813,
  a64_w = 12,
  a64_h = 68;

let a23_x = 0,
  a23_y = 1021,
  a23_w = 6,
  a23_h = 45;

let a32_x = 6,
  a32_y = 1021,
  a32_w = 6,
  a32_h = 45;

let a67_x = 0,
  a67_y = 951,
  a67_w = 12,
  a67_h = 70;

let a61_x = 0,
  a61_y = 881,
  a61_w = 12,
  a61_h = 70;

let a80_x = 0,
  a80_y = 1441,
  a80_w = 6,
  a80_h = 16;

let a81_x = 6,
  a81_y = 1441,
  a81_w = 6,
  a81_h = 16;

let a82_x = 0,
  a82_y = 1457,
  a82_w = 6,
  a82_h = 45;

let a83_x = 6,
  a83_y = 1457,
  a83_w = 6,
  a83_h = 45;

let a84_x = 0,
  a84_y = 1502,
  a84_w = 12,
  a84_h = 53;

let a85_x = 0,
  a85_y = 1555,
  a85_w = 12,
  a85_h = 53;


// let a62_x = 0,
//   a62_y = 573,
//   a62_w = 12,
//   a62_h = 23;


let a100_x = 6,
  a100_y = 1945,
  a100_w = 6,
  a100_h = 45;

let a101_x = 0,
  a101_y = 1990,
  a101_w = 12,
  a101_h = 45;

let a102_x = 0,
  a102_y = 1945,
  a102_w = 6,
  a102_h = 45;

let a103_x = 0,
  a103_y = 1608,
  a103_w = 12,
  a103_h = 60;

let a104_x = 0,
  a104_y = 2089,
  a104_w = 12,
  a104_h = 60;


let a105_x = 0,
  a105_y = 2228,
  a105_w = 4,
  a105_h = 22;

let a106_x = 4,
  a106_y = 2228,
  a106_w = 4,
  a106_h = 22;


let a107_x = 8,
  a107_y = 2228,
  a107_w = 4,
  a107_h = 22;


let a108_x = 0,
  a108_y = 2210,
  a108_w = 4,
  a108_h = 18;

let a109_x = 4,
  a109_y = 2210,
  a109_w = 4,
  a109_h = 18;


let a110_x = 8,
  a110_y = 2210,
  a110_w = 4,
  a110_h = 18;


let a111_x = 0,
  a111_y = 2310,
  a111_w = 4,
  a111_h = 18;

let a112_x = 4,
  a112_y = 2310,
  a112_w = 4,
  a112_h = 18;

let a113_x = 8,
  a113_y = 2310,
  a113_w = 4,
  a113_h = 18;

let b70_x = 0,
  b70_y = 2328,
  b70_w = 4,
  b70_h = 20;

let b71_x = 4,
  b71_y = 2328,
  b71_w = 4,
  b71_h = 20;

let b72_x = 8,
  b72_y = 2328,
  b72_w = 4,
  b72_h = 20;

let b73_x = 0,
  b73_y = 2348,
  b73_w = 6,
  b73_h = 20;

let b74_x = 6,
  b74_y = 2348,
  b74_w = 6,
  b74_h = 20;

// let b75_x = 0,
//   b75_y = 2368,
//   b75_w = 12,
//   b75_h = 60;

let b76_x = 0,
  b76_y = 2551,
  b76_w = 12,
  b76_h = 60;

let b77_x = 0,
  b77_y = 2420,
  b77_w = 12,
  b77_h = 40;


let b78_x = 0,
  b78_y = 2491,
  b78_w = 12,
  b78_h = 60;

let b61_x = 0,
  b61_y = 2611,
  b61_w = 12,
  b61_h = 40;

let b34_x = 0,
  b34_y = 2470,
  b34_w = 4,
  b34_h = 21;
let b35_x = 4,
  b35_y = 2470,
  b35_w = 4,
  b35_h = 21;
let b36_x = 8,
  b36_y = 2470,
  b36_w = 4,
  b36_h = 21;


let c21_x = 6,
  c21_y = 2090,
  c21_w = 6,
  c21_h = 60;

let c19_x = 0,
  c19_y = 2090,
  c19_w = 6,
  c19_h = 60;

let c14_x = 0,
  c14_y = 2035,
  c14_w = 6,
  c14_h = 55;

let c15_x = 6,
  c15_y = 2035,
  c15_w = 6,
  c15_h = 55;

let c11_x = 0,
  c11_y = 1925,
  c11_w = 12,
  c11_h = 20;


  let d11_x = 0,
  d11_y = 3000,
  d11_w = 12,
  d11_h = 50;

let d12_x = 0,
  d12_y = 3050,
  d12_w = 12,
  d12_h = 50;
let d13_x = 0,
  d13_y = 4000,
  d13_w = 12,
  d13_h = 50;
let d14_x = 0,
  d14_y = 4050,
  d14_w = 12,
  d14_h = 50;
let d15_x = 0,
  d15_y = 5000,
  d15_w = 12,
  d15_h = 50;
let d16_x = 0,
  d16_y = 5050,
  d16_w = 12,
  d16_h = 50;


// Global Variable Declare for refreshWidgets and LoadData
let globalType, globalDateFirst, globalDateSecond;

let globalSiteName, globalSiteId, globalSocietyId;

let downloadTrendsMonthsLink = "";
let downloadTrendsSitesLink = "";

let downloadTotalVisitorIILink = '';
let downloadGoodInLink = '';
let downloadGoodOutLink = '';

// Links Declare Sidebar

let checkTotalAssetsAvailable = document.getElementById(
  "checkTotalAssetsAvailable"
);
let checkAssetsInUse = document.getElementById("checkAssetsInUse");
let checkAssetInBreakdown = document.getElementById("checkAssetInBreakdown");
let checkLTIR = document.getElementById("checkLTIR");
let checkZeroIncidentDays = document.getElementById("checkZeroIncidentDays");
let checkIncidentPerSqFt = document.getElementById("checkIncidentPerSqFt");
let checkIncidentNearMissGoodCatch = document.getElementById(
  "checkIncidentNearMissGoodCatch"
);
let checkCriticalAssetsInBreakdown = document.getElementById(
  "checkCriticalAssetsInBreakdown"
);
let checkPPMConductedAssets = document.getElementById(
  "checkPPMConductedAssets"
);
let checkTickets = document.getElementById("checkTickets");
let checkActivityFeed = document.getElementById("checkActivityFeed");
let checkCategoryWiseTickets = document.getElementById(
  "checkCategoryWiseTickets"
);
let checkCustomerSentiments = document.getElementById(
  "checkCustomerSentiments"
);
let checkExecutiveEscalation = document.getElementById(
  "checkExecutiveEscalation"
);
let checkCategoryWiseProactiveTickets = document.getElementById(
  "checkCategoryWiseProactiveTickets"
);
let checkCACategoryWiseTickets = document.getElementById(
  "checkCACategoryWiseTickets"
);


let checkCACategoryWiseProactiveTickets = document.getElementById(
  "checkCACategoryWiseProactiveTickets"
);
let checkTicketsAgeingMatrix = document.getElementById(
  "checkTicketsAgeingMatrix"
);
let checkResolutionTAT = document.getElementById("checkResolutionTAT");
let checkResponseTAT = document.getElementById("checkResponseTAT");
let checkVisitors = document.getElementById("checkVisitors");
let checkPermits = document.getElementById("checkPermits");
let checkPermitSite = document.getElementById("checkPermitSite");
let checkPowerConsumption = document.getElementById("checkPowerConsumption");
let checkPowerConsumptionTop = document.getElementById("checkPowerConsumptionTop");
let checkWaterConsumption = document.getElementById("checkWaterConsumption");
let checkWaterConsumptionTop = document.getElementById("checkWaterConsumptionTop");
let checkCarbonEmission = document.getElementById("checkCarbonEmission");
let checkTopChecklist = document.getElementById("checkTopChecklist");
let checkFuelConsumption = document.getElementById("checkFuelConsumption");
let checkFitoutRequest = document.getElementById("checkFitoutRequest");
let checkIncidents = document.getElementById("checkIncidents");
let checkOpenEscalation = document.getElementById("checkOpenEscalation");
let checkCloseEscalation = document.getElementById("checkCloseEscalation");
let checkAvgEscalation = document.getElementById("checkAvgEscalation");
let checkCategoryWiseIncidents = document.getElementById(
  "checkCategoryWiseIncidents"
);
let checkManPowerAttendance = document.getElementById(
  "checkManPowerAttendance"
);
let checkEventsFootfallAnalysis = document.getElementById(
  "checkEventsFootfallAnalysis"
);
let checkRAC = document.getElementById("checkRAC");
let checkFitout = document.getElementById("checkFitout");
let checkSafeManHours = document.getElementById("checkSafeManHours");
let checkAssetsBreakdown = document.getElementById("checkAssetsBreakdown");
let checkAssetsBreakdownGraph = document.getElementById("checkAssetsBreakdownGraph");
let checkWaste = document.getElementById("checkWaste");
let checkPyramid = document.getElementById("checkPyramid");
let checkIncidentII = document.getElementById("checkIncidentII");
let checkRootCause = document.getElementById("checkRootCause");
let checkBodyInjuryChart = document.getElementById("checkBodyInjuryChart");
let checkReactiveProactiveTickets = document.getElementById("checkReactiveProactiveTickets");
let checkOccupancy = document.getElementById("checkOccupancy");

let checkTechnicalChecklist = document.getElementById("checkTechnicalChecklist");
let checkNonTechnicalChecklist = document.getElementById("checkNonTechnicalChecklist");

let checkTotalVisitors = document.getElementById("checkTotalVisitors");
let checkTotalVisitorsII = document.getElementById("checkTotalVisitorsII");
let checkExpectedVisitors = document.getElementById("checkExpectedVisitors");
let checkUnExpectedVisitors = document.getElementById("checkUnExpectedVisitors");
let checkGoodsIn = document.getElementById("checkGoodsIn");
let checkGoodsOut = document.getElementById("checkGoodsOut");
let checkGoodsInwards = document.getElementById("checkGoodsInwards");
let checkGoodsOutwards = document.getElementById("checkGoodsOutwards");
let checkCustomAvg = document.getElementById("checkCustomAvg");
let checkRegisterdUser = document.getElementById("checkRegisterdUser");
let checkOpenAndCloseEscalation = document.getElementById("checkOpenAndCloseEscalation");
let checkZoneWiseEscalation = document.getElementById("checkZoneWiseEscalation");
let checkTotalStaff = document.getElementById("checkTotalStaff");
let checkStaffIn = document.getElementById("checkStaffIn");
let checkStaffOut = document.getElementById("checkStaffOut");
let checkTotalGatePass = document.getElementById("checkTotalGatePass");
let checkReturnablePass = document.getElementById("checkReturnablePass");
let checkNonReturnablePass = document.getElementById("checkNonReturnablePass");
let checkTotalAmount = document.getElementById("checkTotalAmount");
let checkTotalReceived = document.getElementById("checkTotalReceived");
let checkTotalOutstanding = document.getElementById("checkTotalOutstanding");
let checkTotalOutstandingAmount = document.getElementById("checkTotalOutstandingAmount");
let checkCategoryWiseEscalation = document.getElementById("checkCategoryWiseEscalation");
let checkOpenCloseEscalation = document.getElementById("checkOpenCloseEscalation");

let checkServicePartnerEvaluation = document.getElementById("checkServicePartnerEvaluation");

let checkTotalDownloads = document.getElementById("checkTotalDownloads");
let checkFunctionWise = document.getElementById("checkFunctionWise");
let checkClusterStats = document.getElementById("checkClusterStats");
let checkGenderParticipation = document.getElementById("checkGenderParticipation");

let checkTrendsOverMonthSites = document.getElementById("checkTrendsOverMonthSites");

let checkTotalParking = document.getElementById("checkTotalParking");
let checkFreeParking = document.getElementById("checkFreeParking");
let checkPaidParking = document.getElementById("checkPaidParking");
let checkOccupiedParking = document.getElementById("checkOccupiedParking");
let checkVacantParking = document.getElementById("checkVacantParking");
let checkIncident = document.getElementById("checkIncident");
let checkInventory = document.getElementById("checkInventory");

let checkEmpParticipationStats = document.getElementById("checkEmpParticipationStats");
let checkDeliveryVisitors = document.getElementById("checkDeliveryVisitors");
let checkCheckList = document.getElementById("checkCheckList");
let checkFacilityInfo = document.getElementById("checkFacilityInfo");
let checkDailyStepStats = document.getElementById("checkDailyStepStats");
let checkCommLeaderboard = document.getElementById("checkCommLeaderboard");
let checkDailyStepCount = document.getElementById("checkDailyStepCount");
let checkDepartmentStats = document.getElementById("checkDepartmentStats");
let checkCommLeaderboardFemale = document.getElementById("checkCommLeaderboardFemale");


let toggleDaily = document.getElementById("toggleDaily");
let toggleCustom = document.getElementById("toggleCustom");
let toggleInventory = document.getElementById("toggleInventory");

// let ticketDrillDownLevel = 1;
// let ReactiveProactivedrillDownLevel = 1;
// let CategoryTicketdrillDownLevel =1;
// let CategoryProactivedrillDownLevel = 1;
// let CategoryCommomTicketdrillDownLevel = 1;
// let CategoryCommonProactivedrillDownLevel = 1;
// let visitorsDeliverydrillDownLevel = 1;
// let IncidentdrillDownLevel = 1;
// let IncidentWisedrillDownLevel = 1;
// let FootfalldrillDownLevel = 1;
// let OccupancydrillDownLevel = 1;

let ZoneWiseEscalationdrillDownLevel = 1;
// let OpenCloseEscalationdrillDownLevel = 1;
let CategoryWiseExecutiveEscalationdrillDownLevel = 1;



let showDaily = document.getElementById("showDaily");
let showCustom = document.getElementById("showCustom");
let showInventory = document.getElementById("showInventory");

let inventDate = document.getElementById("inventDate");
let currentDate = document.getElementById("currentDate");
let startDate = document.getElementById("startDate");
let endDate = document.getElementById("endDate");

let showSites = document.getElementById("showSites");
let firstSite = document.getElementById("firstSite");
let selectedCompanyLogo = document.getElementById("selectedCompanyLogo");

let resfunInventDate;
let resfunCardTotalAsset;
let resfunCardTotalAssetInUseAndBreakDown;
let resfunPpmConducted;
let resfunCardOpenCloseEscalation;
let resfunCardAvgEscalation;
let resfunCardDieselNot;
let resfunCardWaterNot;
let resfunCardTotalCriticalAssetInBreakdown;
let resfunCardCustomerAverage;
let resfunChartTicket;
let resfunReactiveTicket;
let resfunChecklist;
let resfunCategoryTicket;
let resfunCategoryProactiveTicket;
let resfunChartCustomerSentiments;
let resfunCACategoryTicket;
let resfunCACategoryProactiveTicket;
let resfunAgeingMatrix;
let resfunTATResolution;
let resfunTATResponse;
let resfunVisitors;
let resfunVisitorsCards;
let resfunStaff;
let resfunStaffIn;
let resfunStaffOut;
let resfunGoodsInwards;
let resfunOutwards;
let resfunPowerConsumptionObject1;
let resfunPowerConsumptionObject2;
let resfunPowerConsumptionObject3;
let resfunPowerConsumptionObject4;
let resfunPowerConsumptionObject5;
let resfunPowerConsumptionObjectMonth;
let resfunPowerConsumptionObject6;
let resfunPowerConsumptionObject7;
let resfunPowerConsumptionObject8;
let resfunWaterConsumptionObject1;
let resfunWaterConsumptionObject2;
let resfunWaterConsumptionObject5;
let resfunWaterConsumptionObject6;

let resFunoccupency1;
let resfunFtFitout2;

let resfunWaterConsumptionObjectLPCD;


let resfunFootfall;
let resfunCarbonEmissionScope1;
let resfunFuelConsumption;
let resfunFitOutRequest;
let resgetEnergyIntensity;
let resfunIncidents;
let resfunIncidentsCategory;
let resfunGetLTIR;
let resfunGetZeroIncidentDays;
let resfunGetIncidentPerSqFt;
let resfunpurchaseOrder;
let resfuntotalValue;
let resfunEmpParticipationStats;
// let resfunGetTotalFlats;
let resfunGetIncidentNearMissGoodCatch;
let resfunRCA;
let resfunManPower;
let resfunAssetsBreakdown;
let resfunExecutiveEscalation;
let resfunFacilityInfo;
let resfunGetSafeManHours;
let resfunPyramid;
// let resfunIncidentII;
let resfunRootCause;
let resBodyInjuryChart;
let resfunTotalVisitors;
let resfunTotalVisitorsII;
let resfunTotalVisitorsIIDrill;
let resfunTotalVisitorsIIDrillSecond;
let resfunTotalVisitorsDropdown;
let resfunGoodsIn;
let resfunGoodsInDrill;
let resfunGoodVisitorsDropdown;
let resfunGoodsOut;
let resfunGoodsOutDrill;
let resfunOutVisitorsDropdown;
let resfunOccupancy;
let resfunDeliveryVisitor;
let resfunFitout;
let resTowerDrill;
let resTicketDrill;
let resTicketDrillSec;
let resResponseTATDrill;
let resPowerDrill;
let resWaterDrill;
let resResolutionTATDrill;
let resIncidentDrill;
let resIncidentDrillIncident;
let resIncidentCategoryDrill;
let resIncidentLevelDrill;
let resTicketCategoryDrill;
let resTicketCategoryProactiveDrill;
let resTicketCategoryCommonDrill;
let resTicketCategoryCommonProactiveDrill;
let resTicketReactiveDrill;
let resFootFallDrill;
let resVisitorsDrill;
let resfunSiteWiseEscalation;
let resfunOpenCloseEscalation;
let resfunOpenCloseDrill;
let resfunCategoryWiseEscalation;
let resfunAuditScore;
let resfungenderParticipation;
let resfunDailyStepStats;
let resfunClusterStats;
let resfuntrendsOverSites;
let resTrendsOverSitesDrill;
let resfuntrendsOverMonths;
let resTrendsOverMonthsDrill;

let resfunCardParking;
let resfunCardParkingPaidFree;
let resfunCardParkingOccpied;
let resfunCardParkingVacant;
let resfunIncidentSummary;
let resfungetTotalAmount;
let resfuntotalInventory;
let resfunOverUnderStock;
let resfunPermitStatus;
let resfunOutstanding;
let resfunSitePermit;

let resfunCommLeaderboard;
let resfunCommLeaderboardFemale;
let resfunClusterEmployeeParticiption;
let resfunDailyStepCount;
let resfunFunctionEmployeeParticiption;

let resfunTechnicalChecklist;
let resfunNonTechnicalChecklist;
let resfunChecklistTop ;
let resfunAssetBreakDown;
let resfunDryWasteSegregation;

let resfunInventoryConsumption;
let resfunInventoryReport;
let resfunCurrentStock;
let resfunInventoryConsumptionGreen;
let resfunInventoryReportGreen;
let resfunCurrentStockGreen;

let
  activeTotalAssetsAvailable = 1,
  activeAssetsInUse = 1,
  activeAssetInBreakdown = 1,
  activeCriticalAssetsInBreakdown = 1,
  activePPMConductedAssets = 1,
  activeTickets = 1,
  activeExecutiveEscalation = 1,

  activeOccupancy = 1,
  activeTotalStaff = 1,
  activeStaffIn = 1,
  activeStaffOut = 1,

  activeActivityFeed = 1,
  activeCategoryWiseTickets = 1,
  activeCustomerSentiments = 1,
  activeFootfall = 1,
  activeCategoryWiseProactiveTickets = 1,
  activeCACategoryWiseTickets = 1,
  activeCACategoryWiseProactiveTickets = 1,
  activeTicketsAgeingMatrix = 1,
  activeResolutionTAT = 1,
  activeResponseTAT = 1,
  activeVisitors = 1,
  activePermits = 1,
  activePermitSite = 1,
  activePowerConsumption = 1,
  activePowerConsumptionTop = 1,
  activeWaterConsumption = 1,
  activeWaterConsumptionTop = 1,
  activeCarbonEmission = 1,
  activeTopChecklist = 1,
  activeFuelConsumption = 1,
  activeFitoutRequest = 1,
  activeEnergyIntensity = 1,
  activeConductedAssets = 1,
  activeCustomerAverage = 1,
  activeOpenEscalation = 1,
  activeCloseEscalation = 1,
  activeAvgEscalation = 1,
  activeIncidents = 1,
  activeCategoryWiseIncidents = 1,
  activeManPowerAttendance = 1,
  activeEventsFootfallAnalysis = 1,
  activeLTIR = 1,
  activeZeroIncidentDays = 1,
  activeIncidentPerSqFt = 1,
  activeIncidentNearMissGoodCatch = 1,
  activeRAC = 1,
  activeFitout = 1,
  activeFitoutOccupancy = 1,

  activeSafeManHours = 1,
  activeAssetsBreakdown = 1,
  activeAssetsBreakdownGraph = 1,
  activeWaste = 1,
  activePyramid = 1,
  activeIncidentII = 1,
  activeRootCause = 1,
  activeBodyInjuryChart = 1,
  activeTotalVisitors = 1,
  activeTotalVisitorsII = 1,
  activeExpectedVisitors = 1,
  activeUnExpectedVisitors = 1,
  activeGoodsIn = 1,
  activeGoodsOut = 1,
  activeGoodsInwards = 1,
  activeGoodsOutwards = 1,
  activeSiteWiseEscalation = 1,
  activeOpenCloseEscalation = 1,
  activeCategoryWiseEscalation = 1,

  activeCustomAvg = 1,
  activeReactiveProactiveTickets = 1,
  activeTotalDownloads = 1,
  activeRegisterdUser = 1,
  activeOpenAndCloseEscalation = 1,
  activeZoneWiseEscalation = 1,
  activeServicePartnerEvaluation = 1,

  activeFunctionWise = 1,
  activeClusterStats = 1,
  activeGenderParticipation = 1,
  activeTrendsOverMonthSites = 1,
  activeTotalParking = 1,
  activeFreeParking = 1,
  activePaidParking = 1,
  activeOccupiedParking = 1,
  activeVacantParking = 1,
  activeTotalGatePass = 1,
  activeReturnablePass = 1,
  activeNonReturnablePass = 1,
  activeTotalAmount = 1,
  activeTotalReceived = 1,
  activeTotalOutStanding = 1,
  activeTotalOutStandingAmount = 1,
  activeIncident = 1,
  activeInventory = 1,


  activeDailyStepStats = 1,
  activeDailyStepCount = 1,
  activeDepartmentStats = 1,
  activeEmpParticipationStats = 1,
  activeDeliveryVisitors = 1,
  activeCheckList = 1,
  activeFacilityInfo = 1,
  activeCommLeaderboard = 1,
  activeCommLeaderboardFemale = 1,
  activeTechnicalChecklist = 1,
  activeNonTechnicalChecklist = 1;


toggleDaily.className = "l px-4 l-active";
toggleCustom.className = "l px-4";
// toggleInventory.className = "l px-4";

showDaily.style.display = "block";
showCustom.style.display = "none";
// showInventory.style.display = "none";

// Describe Link for Daily or Custom Date
function callLinks(type) {
  if (type == "daily") {
    // getTotalAssetCard = ip + "charts-daily/get-total-asset-card-daily/";
    getTotalAssetCard = ip + "charts-monthly/get-total-asset-card-monthly/";
    getDryWasteSegregation = ip + "supervisor-monthly/get-site-wise-dry-waste-segregation/";
    // getTotalAssetInUseAndBreakDownCard =
    //   ip + "charts-daily/get-total-asset-in-use-and-breakdown-card-daily/";
    getTotalAssetInUseAndBreakDownCard =
    ip + "charts-monthly/get-total-asset-in-use-and-breakdown-card-monthly/";
 
    // getTotalCriticalAssetInBreakdownCard =
    //   ip + "charts-daily/get-total-critical-asset-in-breakdown-card-daily/";
    getTotalCriticalAssetInBreakdownCard =
      ip + "charts-monthly/get-total-critical-asset-in-breakdown-card-monthly/";

    getLTIR = ip + "charts-daily/get-LTIR/";
    // getCustomerAverage = ip + "charts-daily/get-average-sentiment-daily/";
    getCustomerAverage = ip + "charts-monthly/get-average-sentiment-monthly/";
    getOpenCloseEscalation = ip + "charts-daily/get-executive-escalation-pie-chart-daily/";
    getOpenCloseDrill = ip + "ceo-drill-down/get-drill-down-open-closed-escalation-ceo/";
    getAvgEscalation = ip + "charts-daily/get-executive-escalation-average-ageing-daily/";
    getcardDieselNot = ip + "charts-daily/get-card-total-diesel-non-consumed-daily/";
    getcardWaterNot = ip + "charts-daily/get-card-total-water-non-consumed-daily/";
    getZeroIncidentDays = ip + "charts-daily/get-zero-incident-days/";
    getIncidentPerSqFt = ip + "charts-daily/get-incident-per-million-sqft/";

    // getTotalFlats = ip + "charts-monthly/get-total-flats/";
    getIncidentNearMissGoodCatch =
      ip + "charts-daily/get-incident-near-miss-good-catch/";

    getTicketsChart = ip + "charts-daily/get-ticktes-chart-daily/";
    getReactiveTicket = ip + "charts-daily/get-proactive-reactive-incident/";
    getChecklist = ip + "charts-monthly/get-chart-checklist-monthly/";
    getOccupancyChart = ip + "charts-monthly/get-tower-occupancy-summary/";
    getTowerDrill = ip + "charts-monthly/get-tower-no/";
    getTowerDrillSec = ip + "get-drill-down-for-occupancy-summary/";
    getTicketDrill = ip + "charts-monthly/get-tickets-drill-down/";
    getSecondLevelDrillDownTickets = ip + "fm-drill-down/get-tickets-drill-down-second-level/";
    getSecondLevelDrillDownIncident = ip + "fm-drill-down/get-drill-down-for-incident/";
    getResponseTATDrill = ip + "charts-monthly/get-drill-down-for-response-tat/";
    getResolutionTATDrill = ip + "charts-monthly/get-drill-down-for-resolution-tat/";
    getPowerDrill = ip + "charts-monthly/get-drill-down-for-power-consumptiont/";
    getWaterDrill = ip + "charts-monthly/get-drill-down-for-water-consumptiont/";
    getIncidentDrill = ip + "charts-monthly/get-drill-down-for-incidents/";
    getIncidentCategoryDrill = ip + "charts-monthly/get-drill-down-for-incident-category/";
    getIncidentLevelDrill = ip + "charts-monthly/get-drill-down-for-level-wise-incident/";
    getIncidentLevelDrillSecond = ip + "fm-drill-down/get-drill-down-for-level-wise-incident/";
    getTicketCategoryDrill = ip + "charts-monthly/get-drill-down-for-unit-category-wise-tickets/";
    getTicketCategoryDrillSecond = ip + "fm-drill-down/get-drill-down-for-unit-category-wise-tickets/";
    getTicketCategoryProactiveDrill = ip + "charts-monthly/get-drill-down-for-unit-category-proactive-tickets/";
    getTicketCategoryProactiveDrillSecond = ip + "fm-drill-down/get-drill-down-for-unit-category-proactive-tickets/";
    getTicketCategoryCommonDrill = ip + "charts-monthly/get-drill-down-for-common-area-category-wise-tickets/";
    getTicketCategoryCommonDrillSecond = ip + "fm-drill-down/get-drill-down-for-common-area-category-wise-tickets/";
    getTicketCategoryCommonProactiveDrill = ip + "charts-monthly/get-drill-down-for-common-area-category-proactive-tickets/";
    getTicketCategoryCommonProactiveDrillSecond = ip + "fm-drill-down/get-drill-down-for-common-area-category-proactive-tickets/";
    getTicketReactiveDrill = ip + "charts-monthly/get-drill-down-for-proactive-reactive-tickets/";
    getTicketReactiveDrillSecond = ip + "fm-drill-down/get-drill-down-for-reactive-proactive-tickets/";
    getFootFallDrill = ip + "charts-monthly/get-drill-down-for-footfall-analysis/";
    getFootFallDrillSecond = ip + "fm-drill-down/get-drill-down-for-footfall-analysis/";
    getVisitorsDrill = ip + "charts-monthly/get-drill-down-for-visitors/";
    getVisitorsDrillSecond = ip + "fm-drill-down/get-drill-down-for-visitors/";
    getDeliveryVisitor = ip + "charts-daily/get-delivery-visitor-daily/";
    getUnitCategoryWiseTicketsChart =
      ip + "charts-daily/get-unit-category-wise-ticktes-chart-daily/";
    getUnitCategoryWiseProactiveTicketsChart =
      ip + "charts-daily/get-unit-category-wise-proactive-ticktes-chart-daily/";
    getCommonAreaCategoryWiseTicketsChart =
      ip + "charts-daily/get-commonArea-category-wise-ticktes-chart-daily/";
    getCommonAreaCategoryWiseProactiveTicketsChart =
      ip +
      "charts-daily/get-commonArea-category-wise-proactive-ticktes-chart-daily/";
    getAgeingMatrixChart = ip + "charts-daily/get-ageing-matrix-chart-daily/";
    getTATResolutionResponseChart =
      ip + "charts-daily/get-response-tat-chart-daily/";
    getVisitors = ip + "charts-daily/get-visitor-card-daily/";
    getVisitorsCards = ip + "quick-gate-monthly/get-visitor-card/";

    getStaff = ip + "quick-gate-daily/get-total-staff/";
    getStaffIn = ip + "quick-gate-daily/get-staff-in/";
    getStaffOut = ip + "quick-gate-daily/get-staff-out/";
    getGoodsInwards = ip + "charts-daily/get-goods-inward/";
    getOutwards = ip + "charts-daily/get-goods-outward/";
    getCustomerSentimentsChart = ip + "charts-daily/get-sentiment-daily/";

    getTotalVisitorsDorpdown = ip + "charts-daily/get-building/";
    getTotalVisitors = ip + "charts-daily/get-building-wise-visitors/";

    getGoodVisitorsDorpdown = ip + "charts-daily/get-building/";

    getOutVisitorsDorpdown = ip + "charts-daily/get-building/";

    // getTotalVisitorsII = ip + "fm-drill-down/get-site-Wise-Visitors-drill-down/";
    getGoodsIn = ip + "quick-gate-monthly/get-site-wise-goods-inward/";
    getGoodsOut = ip + "quick-gate-monthly/get-site-wise-goods-outward/";

    getTotalVisitorsIIDrillDown = ip + "fm-drill-down/get-site-Wise-Visitors-drill-down/";

    getMainMeterTotalConsumption = ip + "charts-daily/get-main-meter-total-consumption/";

    getFitoutOccupiedUnoccupied = ip + "charts-daily/get-flat-occupancy/";
    getFtFitoutFlat = ip + "charts-daily/get-fitout-flat/";
    getFitout = ip + "charts-monthly/get-active-fitout-requests/";

    getTransformerTotal = ip + "charts-daily/get-transformer-total/";
    getDGTotal = ip + "charts-daily/get-dg-total/";
    getDieselConsumption = ip + "charts-daily/get-diesel-consumption/";
    getDieselConsumptionPieChart =
      ip + "charts-daily/get-diesel-consumption-pie-chart/";
    getPowerConsumptionBarChart =
      ip + "charts-daily/get-power-consumption-bar-chart/";

    // getPowerConsumptionTimeSeries =
    //   ip + "charts-monthly/get-power-consumption-time-series/";

    // getTotalWaterConsumption = ip + "charts-daily/get-total-water-consumption/";
    getTotalWaterConsumption = ip + "charts-monthly/get-total-water-consumption-monthly/";

    getTotalSTP = ip + "charts-daily/get-total-stp-water-consumption/";
    // getWaterConsumption = ip + "charts-daily/get-water-consumption/";
    getWaterConsumption = ip + "charts-monthly/get-water-consumption-cards-monthly/";
    getWaterSourcePieChart = ip + "charts-daily/get-water-source-pie-chart/";
    getWaterConsumptionStackedBarChart = ip + "charts-daily/get-water-consumption-stacked-bar-chart/";


    getWaterSourceLPCDChart = ip + "charts-daily/get-chart-lpcd/"

    getCarbonEmissionScope1 = ip + "charts-daily/get-carbon-emission-scope1/";

    getCarbonEmissionScope2 = ip + "charts-daily/get-carbon-emission-scope2/";

    getEnergyIntensity = ip + "charts-daily/get-energy-intensity/";



    getIncidents = ip + "charts-daily/get-incidents/";
    getIncidentsCategory = ip + "charts-daily/get-incidents-category/";

    getIncidentsRCATable = ip + "charts-daily/get-incidents-rca-table/";
    getIncidentManPower = ip + "charts-monthly/get-pms-attendance/";


    getAssetsBreakdown = ip + "charts-daily/get-asset-breakdown/";
    getExecutiveEscalation = ip + "charts-daily/get-executive-escalation-table-daily/"
    getSafeManHours = ip + "charts-daily/get-safe-man-hours/";
    getFacilityInfo = ip + "charts-daily/get-club-facilities-daily/";

    getIncidentPerMillionSqFt =
      ip + "charts-daily/get-incident-per-million-sqft/";

      getPyramid = ip + "charts-monthly/get-level-wise-incidents-monthly/";




    getIncidents = ip + "charts-daily/get-incidents/";
    getIncidentsCategory = ip + "charts-daily/get-incidents-category/";

    getIncidentsRCATable = ip + "charts-daily/get-incidents-rca-table/";


    getCumulativeConsumptionPieChart =
      ip + "charts-daily/get-card-total-consumption-with-cumulative/";


    getFitoutCount = ip + "charts-daily/get-fitout-count/";

    getAssetsBreakdown = ip + "charts-daily/get-asset-breakdown/";
    getExecutiveEscalation = ip + "charts-daily/get-executive-escalation-table-daily/"
    getSafeManHours = ip + "charts-daily/get-safe-man-hours/";
    getConducted = ip + "charts-monthly/get-ppm-conducted-monthly/";


    getBodyInjuryChart =
      ip + "charts-daily/get-injuries/";

    getIncidentPerMillionSqFt =
      ip + "charts-daily/get-incident-per-million-sqft/";

      getPyramid = ip + "charts-monthly/get-level-wise-incidents-monthly/";
    // getIncidentII = ip + "charts-daily/get-injury-illness-incidents/";
    getRootCause = ip + "charts-monthly/get-cause-wise-incidents-monthly/";

    getTotalusers = ip + "charts-daily/get-total-registered-users/";
    getTotalDownloads =
      ip + "charts-daily/get-total-downloads/";

    getGender = ip + "stepathon/get-gender-participation/";
    getDailyStepStats = ip + "stepathon/get-function-wise-step-count/";
    getClusterStats = ip + "stepathon/get-cluster-wise-total-steps_taken/";
    getAuditScore = ip + "charts-monthly/get-auditscore-tablee-monthly/";


    getSiteWiseEscalation = ip + "charts-monthly/get-executive-escalation-zone-wise-chart-monthly/";
    getGenderParticipationDrill = ip + "stepathon/get-gender-participation-drill-down/";
    getCusterStatsDrill = ip + "stepathon/get-cluster-wise-total-steps-taken-drill-down/";
    getDailyStepStatsDrill = ip + "stepathon/get-function-wise-step-count-drill-down/";

    gettrendsOverMonths = ip + "supervisor-monthly/get-card-inventory-cost-over-month/";
    gettrendsOverSites = ip + "charts-monthly/get-inventory-consumption-over-site/";
    getInventoryOverMonthDrill = ip + "supervisor-monthly/get-inventory-cost-over-month-drill-down/";
    getInventoryOverMonthDrillSecond = ip + "supervisor-monthly/get-inventory-cost-over-month-drill-down/";
    getTrendsOverSitesDrill = ip + "supervisor-monthly/get-inventory-consumption-over-site-drill-down/";
    getTrendsOverSitesDrillSecond = ip + "supervisor-monthly/get-inventory-consumption-over-site-drill-down/";

    getPowerConsumptionBarChartMonthWise = ip + "supervisor-monthly/get-power-consumption-bar-chart-monthly/";
    getPowerMonthDrill = ip + "charts-monthly/get-month-wise-power-consumption-drill-down/";
    getCategoryEscalation = ip + "charts-monthly/get-category-wise-executive-escalation-monthly/";

    getSitePowerConsumption = ip + "charts-monthly/get-card-site-wise-power-consumption/";
    getPowerDrill = ip + "charts-monthly/get-card-site-wise-power-consumption-drill-down/";

    getSitePermit = ip + "supervisor-monthly/get-site-wise-permits-data/";
    getPermitStatus = ip + "supervisor-monthly/get-permits-status-data/";
    gettotalInventory = ip + "supervisor-monthly/get-card-total-value-of-inventory-and-capital-block/";
    getOverUnderStock = ip + "supervisor-monthly/get-card-over-stock-and-under-stock-items/";
    getPurchaseOrder = ip + "supervisor-monthly/get-card-po-and-wo/";
    getTotalValues = ip + "supervisor-monthly/get-card-total-value-of-consumable-and-spares/";
    getTotalAmount = ip + "supervisor-monthly/get-top-management-total-amount/";
    getIncidentsSummary = ip + "charts-daily/get-incidents-rca-table/";
    getOutstandingTable = ip + "charts-daily/get-total-outstanding-amount-client-wise-daily/";
    getParking = ip + "supervisor-monthly/get-total-parking/";
    getVacantParking = ip + "supervisor-monthly/get-vacant-parking-data/";
    getOccupiedParking = ip + "supervisor-monthly/get-two-four-wheeler-parking-data/";
    getPaidFreeParking = ip + "supervisor-monthly/get-free-and-paid-parking/";

    getCommLeaderboard = ip + "stepathon/get-cumulative-leaderboard-male/";
    getCommLeaderboardFemale = ip + "stepathon/get-cumulative-leaderboard-female/";
    getFunctionEmployeeParticipation = ip + "stepathon/get-function-employee-participation/";
    getDailyStepCount = ip + "stepathon/get-organisation-daily-step-count/";
    getClusterEmployeeParticipation = ip + "stepathon/get-cluster-employee-participation/";

    getTechnicalChecklist = ip + "charts-monthly/get-chart-technical-checklist-monthly/";
    getNonTechnicalChecklist = ip + "charts-monthly/get-chart-non-technical-checklist-monthly/";
    getChecklistTop = ip + "charts-monthly/get-top-ten-checklist/";
    getAssetBreakDown = ip + "supervisor-monthly/get-breakdown-history-chart-monthly/";
    getInventoryConsumption = ip + "inventory/get_inventory_consumption_non_green/";
    getInventoryReport =
  ip + "inventory/get_inventory_consumption_report_non_green/";
getCurrentStock =
  ip + "inventory/get_inventory_current_and_minimum_stock_non_green/";

getInventoryConsumptionGreen =
  ip + "inventory/get_inventory_consumption_green/";
getInventoryReportGreen =
  ip + "inventory/get_inventory_consumption_report_green/";
getCurrentStockGreen =
  ip + "inventory/get_inventory_current_and_minimum_stock_green/";

  getTotalVisitorsII = ip + "quick-gate-monthly/get-site-wise-visitors/";

  } else {
    getTechnicalChecklist = ip + "charts-monthly/get-chart-technical-checklist-monthly/";
    getNonTechnicalChecklist = ip + "charts-monthly/get-chart-non-technical-checklist-monthly/";
    getChecklistTop = ip + "charts-monthly/get-top-ten-checklist/";
    getAssetBreakDown = ip + "supervisor-monthly/get-breakdown-history-chart-monthly/";

    getInventoryConsumption = ip + "inventory/get_inventory_consumption_non_green/";
    getInventoryReport =
  ip + "inventory/get_inventory_consumption_report_non_green/";
getCurrentStock =
  ip + "inventory/get_inventory_current_and_minimum_stock_non_green/";

getInventoryConsumptionGreen =
  ip + "inventory/get_inventory_consumption_green/";
getInventoryReportGreen =
  ip + "inventory/get_inventory_consumption_report_green/";
getCurrentStockGreen =
  ip + "inventory/get_inventory_current_and_minimum_stock_green/";


    getCommLeaderboard = ip + "stepathon/get-cumulative-leaderboard-male/";
    getCommLeaderboardFemale = ip + "stepathon/get-cumulative-leaderboard-female/";
    getFunctionEmployeeParticipation = ip + "stepathon/get-function-employee-participation/";
    getDailyStepCount = ip + "stepathon/get-organisation-daily-step-count/";
    getClusterEmployeeParticipation = ip + "stepathon/get-cluster-employee-participation/";

    getSitePermit = ip + "supervisor-monthly/get-site-wise-permits-data/";
    getPermitStatus = ip + "supervisor-monthly/get-permits-status-data/";
    gettotalInventory = ip + "supervisor-monthly/get-card-total-value-of-inventory-and-capital-block/";
    getOverUnderStock = ip + "supervisor-monthly/get-card-over-stock-and-under-stock-items/";
    getPurchaseOrder = ip + "supervisor-monthly/get-card-po-and-wo/";
    getTotalValues = ip + "supervisor-monthly/get-card-total-value-of-consumable-and-spares/";
    getTotalAmount = ip + "supervisor-monthly/get-top-management-total-amount/";
    getIncidentsSummary = ip + "charts-monthly/get-rca-table-monthly/";
    getParking = ip + "supervisor-monthly/get-total-parking/";
    getVacantParking = ip + "supervisor-monthly/get-vacant-parking-data/";
    getOccupiedParking = ip + "supervisor-monthly/get-two-four-wheeler-parking-data/";
    getPaidFreeParking = ip + "supervisor-monthly/get-free-and-paid-parking/";


    getInventoryOverMonthDrill = ip + "supervisor-monthly/get-inventory-cost-over-month-drill-down/";
    getInventoryOverMonthDrillSecond = ip + "supervisor-monthly/get-inventory-cost-over-month-drill-down/";

    getTrendsOverSitesDrill = ip + "supervisor-monthly/get-inventory-consumption-over-site-drill-down/";
    getTrendsOverSitesDrillSecond = ip + "supervisor-monthly/get-inventory-consumption-over-site-drill-down/";

    gettrendsOverMonths = ip + "supervisor-monthly/get-card-inventory-cost-over-month/";
    gettrendsOverSites = ip + "charts-monthly/get-inventory-consumption-over-site/";

    getPowerConsumptionBarChartMonthWise = ip + "supervisor-monthly/get-power-consumption-bar-chart-monthly/";
    getPowerMonthDrill = ip + "charts-monthly/get-month-wise-power-consumption-drill-down/";

    getSitePowerConsumption = ip + "charts-monthly/get-card-site-wise-power-consumption/";
    getPowerDrill = ip + "charts-monthly/get-card-site-wise-power-consumption-drill-down/";

    getTotalVisitorsII = ip + "quick-gate-monthly/get-site-wise-visitors/";

    getAuditScore = ip + "charts-monthly/get-auditscore-tablee-monthly/";

    getCategoryEscalation = ip + "charts-monthly/get-category-wise-executive-escalation-monthly/";
    getOpenCloseEscalation = ip + "charts-monthly/get-executive-escalation-pie-chart-monthly/";
    getOpenCloseDrill = ip + "ceo-drill-down/get-drill-down-open-closed-escalation-ceo/";
    // getOpenCloseDrill = "https://reports.lockated.com:8000/ceo-drill-down/get-drill-down-open-closed-escalation-ceo/?site_id=1010&society_id=3632,2189,2192,2193,2194,2195,2404,2635,2687,2191,2196,2190&from_date=2022-11-01&to_date=2023-11-29&status=Closed&first_drilldown_by=Category&sec_drilldown_by=Priority&sec_drill_down_on=Carpentry";

    getSiteWiseEscalation = ip + "charts-monthly/get-executive-escalation-zone-wise-chart-monthly/";

    getTotalusers = ip + "charts-daily/get-total-registered-users/";
    getTotalDownloads =
      ip + "charts-daily/get-total-downloads/";

    // ?&site_id=2630&society_id=3719
    getInventDate = "https://reports.lockated.com:8000/charts-daily/get-project-start-date/";
    getTotalAssetCard = ip + "charts-monthly/get-total-asset-card-monthly/";
    getTotalAssetInUseAndBreakDownCard =
      ip + "charts-monthly/get-total-asset-in-use-and-breakdown-card-monthly/";
    getDryWasteSegregation = ip + "supervisor-monthly/get-site-wise-dry-waste-segregation/";
    getTotalCriticalAssetInBreakdownCard =
      ip + "charts-monthly/get-total-critical-asset-in-breakdown-card-monthly/";
    getConducted = ip + "charts-monthly/get-ppm-conducted-monthly/";
    getFootfall = ip + "charts-monthly/get-footfall-monthly/";
    getOpenCloseEscalation = ip + "charts-monthly/get-executive-escalation-pie-chart-monthly/";
    getAvgEscalation = ip + "charts-monthly/get-executive-escalation-average-ageing-monthly/";
    getcardDieselNot = ip + "charts-monthly/get-card-total-diesel-non-consumed/";
    getcardWaterNot = ip + "charts-monthly/get-card-total-water-non-consumed/";

    getLTIR = ip + "charts-monthly/get-LTIR/";
    getCustomerAverage = ip + "charts-monthly/get-average-sentiment-monthly/";
    getZeroIncidentDays = ip + "charts-monthly/get-zero-incident-days/";
    getIncidentPerSqFt = ip + "charts-monthly/get-incident-per-sqft/";

    // getTotalFlats = ip + "charts-monthly/get-total-flats/";
    // getIncidentPerSqFt = ip + " charts-monthly/get-incident-per-million-sqft/";


    getCarbonEmissionScope1 = ip + "charts-monthly/get-carbon-emission-scope1-monthly/";

    getCarbonEmissionScope2 = ip + "charts-monthly/get-carbon-emission-scope2-monthly/";

    getEnergyIntensity = ip + "charts-monthly/get-energy-intensity/";


    getIncidentNearMissGoodCatch =
      ip + "charts-monthly/get-incident-near-miss-good-catch/";

    getTicketsChart = ip + "charts-monthly/get-ticktes-chart-monthly/";
    getReactiveTicket = ip + "charts-monthly/get-chart-ReactiveProactiveTicket-monthly/";

    getChecklist = ip + "charts-monthly/get-chart-checklist-monthly/";
    getOccupancyChart = ip + "charts-monthly/get-tower-occupancy-summary/";
    getTowerDrill = ip + "charts-monthly/get-tower-no/";
    getTowerDrillSec = ip + "fm-drill-down/get-drill-down-for-occupancy-summary/";
    getTicketDrill = ip + "charts-monthly/get-tickets-drill-down/";
    getSecondLevelDrillDownTickets = ip + "fm-drill-down/get-tickets-drill-down-second-level/";
    getSecondLevelDrillDownIncident = ip + "fm-drill-down/get-drill-down-for-incident/";
    getResponseTATDrill = ip + "charts-monthly/get-drill-down-for-response-tat/";
    getPowerDrill = ip + "charts-monthly/get-drill-down-for-power-consumptiont/";
    getWaterDrill = ip + "charts-monthly/get-drill-down-for-water-consumptiont/";
    getResolutionTATDrill = ip + "charts-monthly/get-drill-down-for-resolution-tat/";
    getIncidentDrill = ip + "charts-monthly/get-drill-down-for-incidents/";
    getIncidentCategoryDrill = ip + "charts-monthly/get-drill-down-for-incident-category/";
    getIncidentLevelDrill = ip + "charts-monthly/get-drill-down-for-level-wise-incident/";
    getIncidentLevelDrillSecond = ip + "fm-drill-down/get-drill-down-for-level-wise-incident/";
    getTicketCategoryDrill = ip + "charts-monthly/get-drill-down-for-unit-category-wise-tickets/";
    getTicketCategoryDrillSecond = ip + "fm-drill-down/get-drill-down-for-unit-category-wise-tickets/";
    getTicketCategoryProactiveDrill = ip + "charts-monthly/get-drill-down-for-unit-category-proactive-tickets/";
    getTicketCategoryProactiveDrillSecond = ip + "fm-drill-down/get-drill-down-for-unit-category-proactive-tickets/";
    getTicketCategoryCommonDrill = ip + "charts-monthly/get-drill-down-for-common-area-category-wise-tickets/";
    getTicketCategoryCommonDrillSecond = ip + "fm-drill-down/get-drill-down-for-common-area-category-wise-tickets/";
    getTicketCategoryCommonProactiveDrill = ip + "charts-monthly/get-drill-down-for-common-area-category-proactive-tickets/";
    getTicketCategoryCommonProactiveDrillSecond = ip + "fm-drill-down/get-drill-down-for-common-area-category-proactive-tickets/";
    getTicketReactiveDrill = ip + "charts-monthly/get-drill-down-for-proactive-reactive-tickets/";
    getTicketReactiveDrillSecond = ip + "fm-drill-down/get-drill-down-for-reactive-proactive-tickets/";
    getFootFallDrill = ip + "charts-monthly/get-drill-down-for-footfall-analysis/";
    getFootFallDrillSecond = ip + "fm-drill-down/get-drill-down-for-footfall-analysis/";
    getVisitorsDrill = ip + "charts-monthly/get-drill-down-for-visitors/";
    getVisitorsDrillSecond = ip + "fm-drill-down/get-drill-down-for-visitors/";
    getDeliveryVisitor = ip + "charts-monthly/get-delivery-visitor-data/";
    getUnitCategoryWiseTicketsChart =
      ip + "charts-monthly/get-unit-category-wise-ticktes-chart-monthly/";
    getUnitCategoryWiseProactiveTicketsChart =
      ip +
      "charts-monthly/get-unit-category-wise-proactive-ticktes-chart-monthly/";
    getCommonAreaCategoryWiseTicketsChart =
      ip +
      "charts-monthly/get-common-area-category-wise-ticktes-chart-monthly/";
    getCommonAreaCategoryWiseProactiveTicketsChart =
      ip +
      "charts-monthly/get-common-area-category-wise-proactive-ticktes-chart-monthly/";
    getAgeingMatrixChart =
      ip + "charts-monthly/get-ageing-matrix-chart-monthly/";
    getTATResolutionResponseChart =
      ip + "charts-monthly/get-response-tat-chart-monthly/";
    getVisitors = ip + "charts-monthly/get-visitor-card-monthly/";
    getVisitorsCards = ip + "quick-gate-monthly/get-visitor-card/";

    getStaff = ip + "quick-gate-monthly/get-total-staff/";
    getStaffIn = ip + "quick-gate-monthly/get-staff-in/";
    getStaffOut = ip + "quick-gate-monthly/get-staff-out/";

    getTotalVisitorsIIDrillDown = ip + "fm-drill-down/get-site-Wise-Visitors-drill-down/";
    getGoodsIn = ip + "quick-gate-monthly/get-site-wise-goods-inward/";
    getGoodsOut = ip + "quick-gate-monthly/get-site-wise-goods-outward/";


    getMainMeterTotalConsumption = ip + "charts-monthly/get-main-meter-total-consumption-monthly/";
    getFitoutOccupiedUnoccupied = ip + "charts-monthly/get-flat-occupancy/";
    getFtFitoutFlat = ip + "charts-monthly/get-fitout-flat/";

    getTransformerTotal = ip + "charts-monthly/get-transformer-total-monthly/";
    getDGTotal = ip + "charts-monthly/get-dg-total-monthly/";
    getDieselConsumption =
      ip + "charts-monthly/get-diesel-consumption-monthly/";
    getDieselConsumptionPieChart =
      ip + "charts-monthly/get-diesel-consumption-pie-chart-monthly/";
    getPowerConsumptionBarChart =
      ip + "charts-monthly/get-power-consumption-bar-chart-monthly/";
    // getPowerConsumptionTimeSeries =
    //   ip + "charts-monthly/get-power-consumption-time-series/";

    getTotalWaterConsumption =
      ip + "charts-monthly/get-total-water-consumption-monthly/";
    getWaterConsumption = ip + "charts-monthly/get-water-consumption-monthly/";
    getTotalSTP = ip + "charts-monthly/get-total-stp-water-consumption-monthly/";
    getWaterSourcePieChart =
      ip + "charts-monthly/get-water-source-pie-chart-monthly/";
    getWaterConsumptionStackedBarChart =
      ip + "charts-monthly/get-water-consumption-stacked-bar-chart-monthly/";


    getWaterSourceLPCDChart = ip + "charts-monthly/get-chart-lpcdt-monthly/";
    getCumulativeConsumptionPieChart =
      ip + "charts-monthly/get-card-total-consumption-with-cumulative-monthly/";

    getCarbonEmissionScope1 =
      ip + "charts-monthly/get-carbon-emission-scope1-monthly/";
    getFuelConsumption = ip + "charts-monthly/get-fuel-consumption-monthly/";

    getIncidents = ip + "charts-monthly/get-incidents-monthly/";
    getIncidentsCategory =
      ip + "charts-monthly/get-incidents-category-monthly/";


    getBodyInjuryChart =
      ip + "charts-monthly/get-injuries/";

    getIncidentsRCATable = ip + "charts-monthly/get-rca-table-monthly/";

    getIncidentManPower = ip + "charts-monthly/get-pms-attendance/";
    getFitout = ip + "charts-monthly/get-active-fitout-requests/";

    getFitoutCount = ip + "charts-monthly/get-fitout-count-monthly/";

    getAssetsBreakdown = ip + "charts-monthly/get-asset-breakdown-monthly/";
    getExecutiveEscalation = ip + "charts-monthly/get-executive-escalation-table-monthly/"
    getSafeManHours = ip + "charts-monthly/get-safe-man-hours/";
    getFacilityInfo = ip + "charts-monthly/get-club-facilities-monthly/";

    getIncidentPerMillionSqFt =
      ip + "charts-monthly/get-incident-per-million-sqft/";

    getPyramid = ip + "charts-monthly/get-level-wise-incidents-monthly/";
    // getIncidentII = ip + "charts-monthly/get-injury-illness-incidents-monthly/";
    getRootCause = ip + "charts-monthly/get-cause-wise-incidents-monthly/";
    getCustomerSentimentsChart = ip + "charts-monthly/get-sentiment-daily/";

    getTotalVisitors = ip + "charts-monthly/get-buinding-wise-visitors/";
    getTotalVisitorsDorpdown = ip + "charts-daily/get-building/";
    getGoodVisitorsDorpdown = ip + "charts-daily/get-building/";

    getGoodsIn = ip + "quick-gate-monthly/get-site-wise-goods-inward/";
    getGoodsOut = ip + "quick-gate-monthly/get-site-wise-goods-outward/";

    getOutVisitorsDorpdown = ip + "charts-daily/get-building/";

    getGender = ip + "stepathon/get-gender-participation/";
    getDailyStepStats = ip + "stepathon/get-function-wise-step-count/";
    getClusterStats = ip + "stepathon/get-cluster-wise-total-steps_taken/";


    getGenderParticipationDrill = ip + "stepathon/get-gender-participation-drill-down/";
    getCusterStatsDrill = ip + "stepathon/get-cluster-wise-total-steps-taken-drill-down/";
    getDailyStepStatsDrill = ip + "stepathon/get-function-wise-step-count-drill-down/";


  }
}


// changes
let a11 = {
  id: "a11",
  x: a11_x,
  y: a11_y,
  w: a11_w,
  h: a11_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                  <div class="orange-shade"> 
                      <span style="text-align:left"><span id="cardTotalAsset" class="count">0</span><br/>
                      <span class="text">Total Assets Available</span></span>
                      <div id="loader_a11" class="mt-4 spinner-icon" role="status" style="display: none;">
                          <span>
                              <img height="65" width="65" src="assets/img/spinner.svg"/>
                          </span>
                      </div>
                      <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                      <a1 style="cursor: pointer;" onclick="downloadAsset()" data-toggle="popover"  title="Download Underlying Data" >
                        <i class="bi bi-download"></i></a1>
                        <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a11()" title="Refresh Content" >
                   <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                  </div>
              </div>`,
};


function Refresh_a11() {
  let cardTotalAsset = document.getElementById("cardTotalAsset");
  let loader = document.getElementById("loader_a11");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardTotalAsset.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getTotalAssetCard + idLink, true);

    xhr_object.onload = function () {
      resfunCardTotalAsset = JSON.parse(this.responseText);
      console.log("Asset Total - ");
      console.log(resfunCardTotalAsset);

      if (resfunCardTotalAsset.response === 0) {
        cardTotalAsset.innerHTML = "No data available"; // Show "No data available" message
      } else {
        cardTotalAsset.innerHTML = resfunCardTotalAsset.response + ""; // Show data count
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}

let a12 = {
  id: "a12",
  x: a12_x,
  y: a12_y,
  w: a12_w,
  h: a12_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="green-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardUseAsset" class="count">0</span><br/>
                    <span class=" text">Asset In Use</span>
                  </span>
                  <div id="loader_a12" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadAssetInUse()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a12()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

  function Refresh_a12() {
    let cardUseAsset = document.getElementById("cardUseAsset");
    let loader = document.getElementById("loader_a12");
  
    // Function to fetch data
    function fetchData() {
      loader.style.display = "block"; // Show loader
      cardUseAsset.innerHTML = ""; // Clear the content while loading
  
      let xhr_object = new XMLHttpRequest();
      xhr_object.open("GET", getTotalAssetInUseAndBreakDownCard + idLink, true);
  
      xhr_object.onload = function () {
        resfunCardTotalAssetInUseAndBreakDown = JSON.parse(this.responseText);
        console.log("Asset In Use/Breakdown - ");
        console.log(resfunCardTotalAssetInUseAndBreakDown);
      
        // Check if response exists and if it's greater than 0 hours
        if (resfunCardTotalAssetInUseAndBreakDown.response && parseFloat(resfunCardTotalAssetInUseAndBreakDown.response.InUse) > 0) {
          cardUseAsset.innerHTML = resfunCardTotalAssetInUseAndBreakDown.response.InUse;
        } else {
          cardUseAsset.innerHTML = "No data available"; // Show "No data available" message if no data or data is 0 or less than 0 hours
        }
      
        loader.style.display = "none"; // Hide loader
      };
      
      
      xhr_object.send();
    }
  
    // Initial data fetch
    fetchData();
  
    // Function to handle refresh button click
    function handleRefresh() {
      fetchData(); // Refresh the data
    }
  
  }

  let a13 = {
    id: "a13",
    x: a13_x,
    y: a13_y,
    w: a13_w,
    h: a13_h,
    content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                <div class="pink-shade"> 
                    <span style="font-size:100%; text-align:left">
                      <span id="cardBreakdownAsset" class="count">0</span><br/>
                      <span class=" text">Asset In Breakdown</span>
                    </span>
                    <div id="loader_a13" class="mt-4 spinner-icon" role="status" style="display: none;">
                       <span>
                         <img height="65" width="65" src="assets/img/spinner.svg"/>
                       </span>
                    </div>
                    <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                    <a1 style="cursor: pointer;" onclick="downloadAssetIB()" data-toggle="popover"  title="Download Underlying Data" >
                      <i class="bi bi-download"></i></a1>
                    <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a13()" title="Refresh Content" >
                      <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                </div>
            </div>`
  };
  
  function Refresh_a13() {
    let cardBreakdownAsset = document.getElementById("cardBreakdownAsset");
    let loader = document.getElementById("loader_a13");
  
    // Function to fetch data
    function fetchData() {
      loader.style.display = "block"; // Show loader
      cardBreakdownAsset.innerHTML = ""; // Clear the content while loading
  
      let xhr_object = new XMLHttpRequest();
      xhr_object.open("GET", getTotalAssetInUseAndBreakDownCard + idLink, true);
  
      xhr_object.onload = function () {
        resfunCardTotalAssetInUseAndBreakDown = JSON.parse(this.responseText);
        console.log("Asset In Use/Breakdown - ");
        console.log(resfunCardTotalAssetInUseAndBreakDown);
      
        // Check if response exists and if it's greater than 0 hours
        if (resfunCardTotalAssetInUseAndBreakDown.response && parseFloat(resfunCardTotalAssetInUseAndBreakDown.response.InBreakdown) > 0) {
          cardBreakdownAsset.innerHTML = resfunCardTotalAssetInUseAndBreakDown.response.InBreakdown;
        } else {
          cardBreakdownAsset.innerHTML = "No data available"; // Show "No data available" message if no data or data is 0 or less than 0 hours
        }
      
        loader.style.display = "none"; // Hide loader
      };
      xhr_object.send();
    }
  
    // Initial data fetch
    fetchData();
  
    // Function to handle refresh button click
    function handleRefresh() {
      fetchData(); // Refresh the data
    }
  
  }  

  let a14 = {
    id: "a14",
    x: a14_x,
    y: a14_y,
    w: a14_w,
    h: a14_h,
    content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                <div class="red-shade"> 
                    <span style="font-size:100%; text-align:left">
                      <span id="cardCriticalAsset" class="count">0</span><br/>
                      <span class=" text">Critical Assets In Breakdown</span>
                    </span>
                    <div id="loader_a14" class="mt-4 spinner-icon" role="status" style="display: none;">
                       <span>
                         <img height="65" width="65" src="assets/img/spinner.svg"/>
                       </span>
                    </div>
                    <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                    <a1 style="cursor: pointer;" onclick="downloadCAIB()" data-toggle="popover"  title="Download Underlying Data" >
                      <i class="bi bi-download"></i></a1>
                    <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a14()" title="Refresh Content" >
                      <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                </div>
            </div>`
  };
  
  function Refresh_a14() {
    let cardCriticalAsset = document.getElementById("cardCriticalAsset");
    let loader = document.getElementById("loader_a14");
  
    // Function to fetch data
    function fetchData() {
      loader.style.display = "block"; // Show loader
      cardCriticalAsset.innerHTML = ""; // Clear the content while loading
  
      let xhr_object = new XMLHttpRequest();
      xhr_object.open("GET", getTotalCriticalAssetInBreakdownCard + idLink, true);
  
      xhr_object.onload = function () {
        resfunCardTotalCriticalAssetInBreakdown = JSON.parse(this.responseText);
        console.log("Critical Asset In Breakdown - ");
        console.log(resfunCardTotalCriticalAssetInBreakdown);
  
        if (resfunCardTotalCriticalAssetInBreakdown.response === 0) {
          cardCriticalAsset.innerHTML = "No data available"; // Show "No data available" message
        } else {
          cardCriticalAsset.innerHTML = resfunCardTotalCriticalAssetInBreakdown.response + ""; // Show data count
        }
  
        loader.style.display = "none"; // Hide loader
      };
      xhr_object.send();
    }
  
    // Initial data fetch
    fetchData();
  
    // Function to handle refresh button click
    function handleRefresh() {
      fetchData(); // Refresh the data
    }
  }

// Refresh_a15
let a15 = {
  id: "a15",
  x: a15_x,
  y: a15_y,
  w: a15_w,
  h: a15_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="red-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardConductedAssets" class="count">0</span><br/>
                    <span class=" text">PPM Overdue Assets</span>
                  </span>
                  <div id="loader_a15" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadAssetPPM()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a15()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

function Refresh_a15() {
  let cardTotalAsset = document.getElementById("cardConductedAssets"); // Update variable name
  let loader = document.getElementById("loader_a15");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardTotalAsset.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getConducted + idLink, true); // Update URL for fetching data

    xhr_object.onload = function () {
      resfunCardTotalAsset = JSON.parse(this.responseText); // Update variable name
      console.log("Asset Total - ");
      console.log(resfunCardTotalAsset);

      if (resfunCardTotalAsset.response === 0) {
        cardTotalAsset.innerHTML = "No data available"; // Show "No data available" message
      } else {
        cardTotalAsset.innerHTML = resfunCardTotalAsset.response + ""; // Show data count
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}

let a70 = {
  id: "a70",
  x: a70_x,
  y: a70_y,
  w: a70_w,
  h: a70_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="green-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardCustomerAvg" class="count">0</span><br/>
                    <span class=" text">Customer Average Rating</span>
                  </span>
                  <div id="loader_a70" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadcardCustomerAvg()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a70()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

// Refresh_a70
function Refresh_a70() {
  let cardCustomerAvg = document.getElementById("cardCustomerAvg");
  let loader = document.getElementById("loader_a70");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardCustomerAvg.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getCustomerAverage + idLink, true);

    
  if (globalType == "daily") {
    xhr_object.open("GET", getCustomerAverage + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getCustomerAverage + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

    xhr_object.onload = function () {
      resfunCardCustomerAverage = JSON.parse(this.responseText);
      console.log("Customer Average Rating - ");
      console.log(resfunCardCustomerAverage);
      cardCustomerAvg.innerHTML =
      resfunCardCustomerAverage.response + "";
      
      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}


let a71 = {
  id: "a71",
  x: a71_x,
  y: a71_y,
  w: a71_w,
  h: a71_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="pink-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardOpenEscalation" class="count">0</span><br/>
                    <span class=" text">Open Escalation</span>
                  </span>
                  <div id="loader_a71" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadOpenEscalation()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a71()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

function Refresh_a71() {
  let cardOpenEscalation = document.getElementById("cardOpenEscalation");
  let loader = document.getElementById("loader_a71");
  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardOpenEscalation.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getOpenCloseEscalation + idLink, true);

    if (globalType == "daily") {
      xhr_object.open("GET", getOpenCloseEscalation + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getOpenCloseEscalation + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond, true);
    }

    xhr_object.onload = function () {
      let resfunCardOpenCloseEscalation = JSON.parse(this.responseText);
      console.log("Open Escalation - ");
      console.log(resfunCardOpenCloseEscalation);
      
      // Check if response exists and if it's not equal to 0
      if (resfunCardOpenCloseEscalation.response && resfunCardOpenCloseEscalation.response.Open !== 0) {
        cardOpenEscalation.innerHTML = resfunCardOpenCloseEscalation.response.Open + "";
      } else {
        cardOpenEscalation.innerHTML = "No data available"; // Show "No data available" message if no data or data count is 0
      }
    
      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}
// cardOpenEscalation,cardCloseEscalation,cardAvgEscalation

let a72 = {
  id: "a72",
  x: a72_x,
  y: a72_y,
  w: a72_w,
  h: a72_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="green-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardCloseEscalation" class="count">0</span><br/>
                    <span class=" text">Close Escalation</span>
                  </span>
                  <div id="loader_a72" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadCloseEscalation()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a72()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a72() {
  let cardCloseEscalation = document.getElementById("cardCloseEscalation");
  let loader = document.getElementById("loader_a72");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardCloseEscalation.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getOpenCloseEscalation + idLink, true);

    if (globalType == "daily") {
      xhr_object.open("GET", getOpenCloseEscalation + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getOpenCloseEscalation + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond, true);
    }

    xhr_object.onload = function () {
      let resfunCardOpenCloseEscalation = JSON.parse(this.responseText);
      console.log("Close Escalation - ");
      console.log(resfunCardOpenCloseEscalation);
      
      // Check if response exists and if it's not equal to 0
      if (resfunCardOpenCloseEscalation.response && resfunCardOpenCloseEscalation.response.Closed !== 0) {
        cardCloseEscalation.innerHTML = resfunCardOpenCloseEscalation.response.Closed + "";
      } else {
        cardCloseEscalation.innerHTML = "No data available"; // Show "No data available" message if no data or data count is 0
      }
    
      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}

let a73 = {
  id: "a73",
  x: a73_x,
  y: a73_y,
  w: a73_w,
  h: a73_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="green-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardAvgEscalation" class="count">0</span><br/>
                    <span class=" text">Average Escalation</span>
                  </span>
                  <div id="loader_a73" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <div id="fetcher_a72" class="mt-4 fetcher-icon" role="status" style="display: none;">
                          <span>
                              <img height="65" width="65" src="assets/img/fetcher.svg"/>
                          </span>
                      </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadAvgEscalation()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a73()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a73() {
  let cardAvgEscalation = document.getElementById("cardAvgEscalation");
  let loader = document.getElementById("loader_a73");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardAvgEscalation.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    if (globalType == "daily") {
      xhr_object.open("GET", getAvgEscalation + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getAvgEscalation + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond, true);
    }

    xhr_object.onload = function () {
      let resfunCardAvgEscalation = JSON.parse(this.responseText);
      console.log("Avg Escalation - ");
      console.log(resfunCardAvgEscalation);
      
      if (resfunCardAvgEscalation.response !== null && resfunCardAvgEscalation.response !== "" && parseFloat(resfunCardAvgEscalation.response) > 0) {
        cardAvgEscalation.innerHTML = resfunCardAvgEscalation.response + " Hours";
      } else {
        cardAvgEscalation.innerHTML = "No data available";
      }
    
      loader.style.display = "none"; // Hide loader
    };
    
    

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}


let a76 = {
  id: "a76",
  x: a76_x,
  y: a76_y,
  w: a76_w,
  h: a76_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="green-shade">
                        <span style="text-align:left"><span id="cardDieselNot" class="count" style="font-size:30px">0</span><br/>
                        <span class="text">Total Diesel Non Cosumption</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                        <a1 style="cursor: pointer;" onclick="downloadDieselNot()" data-toggle="popover"  title="Download Underlying Data" >
                          <i class="fa fa-download"></i></a1> 
                    </div>
                </div>`,
};

let a77 = {
  id: "a77",
  x: a77_x,
  y: a77_y,
  w: a77_w,
  h: a77_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="yellow-shade">
                        <span style="text-align:left"><span id="cardWaterNot" class="count" style="font-size:30px">0</span><br/>
                        <span class="text">Total Water Non Cosumption</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                        <a1 style="cursor: pointer;" onclick="downloadWaterNot()" data-toggle="popover"  title="Download Underlying Data" >
                          <i class="fa fa-download"></i></a1> 
                    </div>
                </div>`,
};



let a78 = {
  id: "a78",
  x: a78_x,
  y: a78_y,
  w: a78_w,
  h: a78_h,
  content: `<div style="height: 100%; width: 100%;">
                      <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Delivery Visitors</b></span>
                          <div class="parent col-md-2">
                          <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_visitors" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" onclick="downloadDeliveryVisitor()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <img height="15" width="15"  onclick="showDeliveryVisitors()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                      </div>
                    </div>
                    <hr class="mt-0"/><br><br><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_visitors" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelVisitors">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>                 
                    <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>
                   <a  style="cursor:pointer;" class="dropdown-item" id="Purpose" >Purpose </a>
              
                 
             </div>
             </div>
                    <center id="loaderDelivery" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="DeliveryNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="deliveryVisitor"></canvas>
                    </div></center>
                </div>`,
};

let a79 = {
  id: "a79",
  x: a79_x,
  y: a79_y,
  w: a79_w,
  h: a79_h,
  content: `<div style="height: 100%; width: 100%;">
                      <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Reactive Proactive Ticket </b></span>
                          <div class="parent col-md-2">
                              <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_reactive" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" onclick="downloadTickets()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <img height="15" width="15"  onclick="showTickets()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                      </div>
                    </div>
                    <hr class="mt-0"/><br><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_reactive" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelReactive">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>                        
                     <a  style="cursor:pointer;"class="dropdown-item" id="Tower"  >Tower </a>                        <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Number">Ticket Number</a>
                        
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Created_Date">Created Date To</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Rating">Rating</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Service_Type">Service Type</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                    </div>
             </div>
                    <center id="loaderReactiveTicket" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="ReactiveTicketNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="reactiveTicket"></canvas>
                    </div></center>
                </div>`,
};
// loaderReactiveTicket ,ReactiveTicketNoData , reactiveTicket



let a16 = {
  id: "a16",
  x: a16_x,
  y: a16_y,
  w: a16_w,
  h: a16_h,
  content: `<div style="height: 100%; width: 100%;">
                      <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                          <span id="dt1" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Tickets</b></span>
                          <div class="parent col-md-3">
                          <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_ticket" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" onclick="downloadTickets()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <img height="15" width="15"  onclick="showTickets()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                      </div>
                    </div> 
                    <hr class="mt-0"/><br><br><br>

                    <div id="dataDropdown_ticket" class="dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelTicket" style="pointer-events: none;">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>
                        
                        <a style="cursor:pointer;" class="dropdown-item" id="Tower">Tower </a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Status">Status</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Created_By">Created By</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Proactive/Reactive">Proactive/Reactive</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Category">Category</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Sub_Category">Sub Category</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Assign_To">Assign To</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Priority">Priority</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                        <a style="cursor:pointer;" class="dropdown-item" id="Related_To">Related To</a>
                        
                    </div>

                
                    <center id="loaderTicketB1Chart" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="dt1NoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="ticket-b1"></canvas>
                    </div></center>
                </div>`,

};



let a61 = {
  id: "a61",
  x: a61_x,
  y: a61_y,
  w: a61_w,
  h: a61_h,
  content: `<div style="height: 100%; width: 100%;">
                <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="fitout" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Fitout</span>
                        <div class="parent col-md-2">
                            
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showFitout()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                </div>
              
                    <hr class="mt-0"/><br>

                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12 row">
                        <div class=" d-flex flex-wrap power-counts justify-content-center">
                              <div class="text-center mt-auto">
                                <span id="fitoutOccupiedFlats" class="fs-3 fw-bold">0</span>
                                <br><span>Occupied Units</span>
                              </div>
                   <div id="loader_a61" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                              <div class="text-center  m-1 ">
                                 <a style="cursor: pointer;margin-left: 69%;" id="refreshIconElement_totalAmount" onclick="Refresh_a61()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                                <a style="cursor: pointer;"><i style="font-size:20px; font-weight:bold;" class="bi bi-info-circle"  id="infoOccupiedUnitsIcon"></i></a>
                                <a style="cursor: pointer;width:10px;float: right;" onclick="downloadfitoutUnoccupied()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                                <br><span id="fitoutUnoccupiedFlats"  class="fs-3 fw-bold">0</span><br>
                                <span>Unoccupied Units</span>
                              </div>    
                           </div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12 row">
                            <div class="col-6" style="width:125%">
                                <div class=" text-center  m-1">
                                 <a style="cursor: pointer;margin-left: 69%;" id="refreshIconElement_totalAmount" onclick="Refresh_a61FitOut()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                                  <a style="cursor: pointer;"><i style="font-size:20px; font-weight:bold;" class="bi bi-info-circle" id="infoFitoutUnitsIcon"></i></a>
                                   <a style="cursor: pointer;padding-left:5px;width:10px" onclick="downloadftFitoutFlats()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                                    <br><span id="ftFitoutFlats" class="fs-3 fw-bold">0</span><br>
                                    <div id="loader_a61FitOut" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                                    <span>Fitout Units</span>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="custom-dropdown" >
                    <div id="FitoutUnitsDiv" class=" dropdown-menu" style="height: 160px;
                    overflow-y: scroll;
                    inset: 0px;
                    position: absolute;
                       width: 27%;
                       margin: 6% 25px 25px 57%;
                    display: none;
                    padding: 10px;">
                    <span > <img  id="closeFitoutUnits" height="15" width="15" style="margin-left:90%" src="assets/img/xmark-solid.svg"/></span>
                    <p style="margin-bottom:0px;font-size: 14px;" id="FitoutUnitsInfo"></p>
                    <p style="margin-bottom:0px;font-size: 14px;" id="FitoutUnitsInfo2"></p>
                    </div>
                  </div>

                  <div class="custom-dropdown" >
                    <div id="OccupiedUnitsDiv" class=" dropdown-menu" style="height: 160px;
                    overflow-y: scroll;
                    inset: 0px;
                    position: absolute;
                       width: 27%;
                       margin: 6% 25px 25px 16%;
                    display: none;
                    padding: 10px;">
                    <span > <img  id="closeOccupiedUnits" height="15" width="15" style="margin-left:90%" src="assets/img/xmark-solid.svg"/></span>
                    <p style="margin-bottom:0px;font-size: 14px;" id="OccupiedUnitsInfo"></p>
                    <p style="margin-bottom:0px;font-size: 14px;" id="OccupiedUnitsInfo2"></p>
                    </div>
                  </div>
                    <br>
                    <hr class="mt-0"/>
                    <div>
                    <span id="fitout" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Active Fitout Requests</span>
                    
                        <a style="cursor: pointer; float:right; padding-right:30px;" onclick="downloadFitoutTableData()" data-toggle="popover" title="Download Underlying Data" >
                        <img height="15" width="15" src="assets/img/download.png"/></a>
                         <a style="cursor: pointer;" id="infoFitOutTableIcon"><i style="font-size:20px; font-weight:bold ; float: right; padding-right: 20px;" class="bi bi-info-circle"></i></a>
                          <a style="cursor: pointer;" id="refreshIconElementActiveFitout" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold;float: right;padding-right: 12px;" class="bi bi-arrow-clockwise bold-icon"></i></a>
                    </div>

                    <br><br>

                     <div class="custom-dropdown" >
                    <div id="FitOutTableDiv" class=" dropdown-menu" style="height: 160px;
                    overflow-y: scroll;
                    inset: 0px;
                    position: absolute;
                    width: 76%;
                    margin: 30% 25px 25px 10%;
                    display: none;
                    padding: 10px;">
                    <span > <img  id="closeFitOutTable" height="15" width="15" style="margin-left:90%" src="assets/img/xmark-solid.svg"/></span>
                    <p style="margin-bottom:0px;" id="FitOutTableInfo"></p>
                    <p style="margin-bottom:0px;" id="FitOutTableInfo2"></p>
                    </div>
                  </div>
                    <div class="tbl-container overflow-scroll" >
              
                        <table id="tblFitout" class="table table-bordered" overflow-y:scroll" >
                        
                            <thead style="font-size:15px">
                                <th>User Name</th>
                                <th>Category</th>
                                <th>Description</th>
                                <th>Tower</th>
                                <th>Unit</th>
                                <th>Master Status</th>
                            </thead>
                            <tbody id= "tablebodyFitout">
                                  
                            </tbody>
                            
                        </table>
                        <center id="loaderFitout" class="mt-4"><br><br><br>
                        
                        <div class="mt-4" role="status">
                        <span>
                        <img height="100" width="100" src="assets/img/loader.svg"/></span>
                    </div>
                        </center>  
                        <center><span class="fw-bold my-4" id="FitoutNoData"><br><br><br>No Data Available</span></center>
                        <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body"></div></center>
                    </div>
                </div>`,
};


let a67 = {
  id: "a67",
  x: a67_x,
  y: a67_y,
  w: a67_w,
  h: a67_h,
  content: `<div style="height: 100%; width: 100%;">
                <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="occupancy" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Occupancy Summary</span>
                        <div class="parent col-md-2">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadOccupancy()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showOccupancy()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                </div>
                    <hr class="mt-0"/><br><br><br>
                    <center id="loaderOccupancy" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="occupancyNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-0" style="height: 400px;" style="background-color:#fff; class="card-body">
                        <canvas id="Occupancy_sum"></canvas>
                    </div></center>

                    <div class="custom-dropdown" id="custom-dropdown">
                    
                    <div id="dataDropdown" class="dropdown-menu" style="height:300px;inset:0 ; position:absolute; width:fit-content;margin:80px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabel">Tower: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                </div>                       
                       <a  style="cursor:pointer;"class="dropdown-item" id="Flat">Flat </a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="Flat_Type" >Flat Type </a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Status">Status</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Possession">Possession</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Sold">Sold</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Date_Of_Possession">Date of Possession</a>
                        
                    </div>
                  
                </div>
                </div>
            
                
                `,
};

let a69 = {
  id: "a69",
  x: a69_x,
  y: a69_y,
  w: a69_w,
  h: a69_h,
  content: `<div style="height: 100%; width: 100%;">
  <div style="width:100%; background-color:#fff; padding: 10px;">
  <div class="row">
      <span id="sentiments" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Customer Sentiments</b></span>
      <div class="parent col-md-3">
       <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_sentiments" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
          <div class="col-sm-1 child mx-2">
              <a style="cursor: pointer;" onclick="downloadcustomerSentiment()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
          </div>
          <div class="col-sm-1 child mx-2">
              <img height="15" width="15"  onclick="showCustomerSentiments()" src="assets/img/xmark-solid.svg"/>
          </div>
      </div>
  </div>
</div>
                    <hr class="mt-0"/><br><br><br>
                    <center id="loaderCustomerSentiments" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id=CustomerSentimentsNoData"></span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="customerSentiment"></canvas>
                    </div></center>
                </div>`,


};


let a75 = {
  id: "a75",
  x: a75_x,
  y: a75_y,
  w: a75_w,
  h: a75_h,
  content: `<div style="height: 100%; width: 100%;">
               <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Checklist</b></span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_checklist" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadChecklist()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showCheckList()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                   <hr class="mt-0"/><br><br><br>
                    <center id="loaderChecklist" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id=ChecklistNoData"></span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="Checklist"></canvas>
                    </div></center>
                </div>`,


};
// Checklist,loaderChecklist,ChecklistNoData

let a114 = {
  id: "a114",
  x: a114_x,
  y: a114_y,
  w: a114_w,
  h: a114_h,
  content: `<div style="height: 100%; width: 100%;">
               <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Technical Checklist</b></span>
                        <div class="parent col-md-2">
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadTechnicalChecklist()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showTechnicalChecklist()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                   <hr class="mt-0"/><br><br><br>
                    <center id="loaderTechnicalChecklist" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id=TechnicalChecklistNoData"></span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="TechnicalChecklist"></canvas>
                    </div></center>
                </div>`,


};
// loaderTechnicalChecklist,TechnicalChecklistNoData, TechnicalChecklist, downloadTechnicalChecklist

let a115 = {
  id: "a115",
  x: a115_x,
  y: a115_y,
  w: a115_w,
  h: a115_h,
  content: `<div style="height: 100%; width: 100%;">
               <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Non Technical Checklist</b></span>
                        <div class="parent col-md-2">
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadNonTechnicalChecklist()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showNonTechnicalChecklist()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                   <hr class="mt-0"/><br><br><br>
                    <center id="loaderNonTechnicalChecklist" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id=NonTechnicalChecklistNoData"></span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="NonTechnicalChecklist"></canvas>
                    </div></center>
                </div>`,


};


let a116 = {
  id: "a116",
  x: a116_x,
  y: a116_y,
  w: a116_w,
  h: a116_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Asset BreakDown</b></span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_AssetBreakDown" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadAssetBreakdown()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showAssetsBreakdownGraph()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <center id="loaderAssetBreakDown" class="mt-4"><br><br><br>
                    
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="AssetBreakDownNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="AssetBreakDown"></canvas>
                    </div></center>
                </div>`,
  // <span id="dt2" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Unit Category-wise Tickets</span>
};

let a117 = {
  id: "a117",
  x: a117_x,
  y: a117_y,
  w: a117_w,
  h: a117_h,
  content: `<div style="height: 100%; width: 100%;">
  <div style="width:100%; background-color:#fff; padding: 10px;">
      <div class="row">
          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></i></b>Site Wise Dry Waste Segregation Data</span>
          <div class="parent col-md-3">
          <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_waste" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
              <div class="col-sm-1 child mx-2">
                  <a style="cursor: pointer;" onclick="download()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
              </div>
              <div class="col-sm-1 child mx-2">
                  <img height="15" width="15"  onclick="showWaste()" src="assets/img/xmark-solid.svg"/>
              </div>
          </div>
      </div>
  </div>
      <hr class="mt-0"/><br>
      <center id="loaderDryWaste" class="mt-4"><br><br><br>
      
      <div class="mt-4" role="status">
      <span>
      <img height="100" width="100" src="assets/img/loader.svg"/></span>
  </div>
      </center>
      <center><span class="fw-bold my-4" id="dryWasteNoData"><br><br><br>No Data Available</span></center>
      <center><div class="m-4" style="height: 400px;" style="background-color:#fff; class="card-body">
          <canvas id="dryWasteSegregation"></canvas>
      </div></center>
  </div>`,
  // <span id="dt2" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Unit Category-wise Tickets</span>
};
// loaderNonTechnicalChecklist, NonTechnicalChecklistNoData, NonTechnicalChecklist
// downloadNonTechnicalChecklist

// let a17 = {
//   id: "a17",
//   x: a17_x,
//   y: a17_y,
//   w: a17_w,
//   h: a17_h,
//   content: `<div>
//                     <div style="background-color:#fff;" class="card-header row">
//                         <div class="row" style="display:flex;position:relative">
//                             <span align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Activity Feed</span>
//                             <div style=" padding-left:490px;position:absolute;display: inline-block;">
//                                  <a style="cursor: pointer;padding-right:20px" onclick="downloadActivityFeed()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
//                             <img class="col-md-1 my-2" height="15" width="15" onclick="showActivityFeed()" src="assets/img/xmark-solid.svg" />
//                             </div>
//                         </div>
//                     </div>
//                     <hr class="mt-0" />
//                 </div>`,
// };



let a118 = {
  id: "a118",
  x: a118_x,
  y: a118_y,
  w: a118_w,
  h: a118_h,
  content: `<div >
                    <div style="background-color:#fff;" class="card-header row">
                        <div class="row">
                            <span id="titlePowerConsumation" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Power Consumption Top Management</span>
                            <img class="col-md-1 my-2" height="15" width="15" onclick="showPowerConsumptionTop()" src="assets/img/xmark-solid.svg" />
                        </div>
                    </div>
                    <hr class="mt-0" /><br>
                <div class="row">
                <div class="col-lg-6 col-md-6 col-sm-12 ">
                <div class=" d-flex flex-wrap power-counts justify-content-center">
                    <div class="text-center go-shadow m-2 total-consumption"><span id="pcTotalHtMeterTop" class="fs-3 fw-bold">0 EBKVAH</span><br><span>Total Consumption (Mains)</span>
                          <a style="cursor: pointer; float:right; width:10px" onclick="downloadTotalConsumption()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

                    <div class="text-center go-shadow m-2 total-transform"><span id="pcTotalTransformerTop" class="fs-3 fw-bold">0 kwh</span><br><span> Total Renewable</span>
                            <a style="cursor: pointer; float:right;width:10px" onclick="downloadTransformaerTotal()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

                    <div class="text-center go-shadow m-2 total-dg"><span id="pcTotalDgTop" class="fs-3 fw-bold">0 DGKVAH</span><br><span>DG Total</span>
                            <a style="cursor: pointer; float:right; width:10px" onclick="downloadDgtotal()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

                   
                </div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12 " style="color:#5e2750;"><b>Renewable Sources & Consumption</b>
                        <div class=" d-flex flex-wrap power-counts justify-content-center"> 
                    <div class="col-3">
                    <center id="loaderPowerConsumPie" class="">
                        <div class="mt-4 spinner-borde" role="status">
                            <span class="sr-only"></span>
                        </div>
                    </center>
                    <center><a style="cursor: pointer;padding-left:600px;width:10px" onclick="downloadDConsumPie()" 
                    data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
              <span class="fw-bold my-4" id="powerConsumPieNoData">No Data Available</span></center>
                
                    <center><div style=" margin-top:-30px ">
                        <canvas id="power-consume-pie"></canvas>
                    </div></center>
                </div>
                        
                        <div class="col-3 mt-5">
                            <div>
                                <span class="fw-bold" style="font-size:14px">Renewable Resources </span> <br />
                                <span id="psPie1"  style=" font-size: 12px ; margin-left:20px;"> <i style="color:#F2C06C ;font-size: 13px; margin-left:10px; font-style:normal;"></i></span><br/>
                                <span  id="psPie2" style=" font-size: 12px ; margin-left:20px;"> <i style="color:#01C875 ;font-size: 13px; margin-left:10px; font-style:normal;"></i></span><br/>
                                <span  id="psPie3" style=" font-size: 12px ; margin-left:-30px;"><i style="color:#E95420 ;font-size: 13px; margin-left:10px; font-style:normal;"></i></span><br/>
                                <span  id="psPie4" style=" font-size: 12px ; margin-left:-30px;">  <i style="color:#FDAB3D ;font-size: 13px; margin-left:10px; font-style:normal;"></i></span><br/>
                            </div>

                           
                        </div>
                        </div>

                       

                    </div>

                        <div class="col-12 mt-2">
                            <hr class="mb-4" />
                            <span class="fw-bold">Site Wise Power Consumption</span> <br />
                              <center id="loaderSitePower" class="mt-4"><br><br><br>
                               <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                              </center>
                              <center>
                              <div class="row">
                              
                                    <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
                                  <div class="parent col-md-2">
                                  <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" id="refreshIconElement_powerSite" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                                    <a style="cursor: pointer;" onclick="downloadSiteWise()"  data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                                 
                                   <span class="fw-bold my-4" id="SitePowerNoData"><br><br><br>No Data Available</span>
                              </center>
                         
                              <center> 
                            
                                <div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                                  <canvas id="SitePowerConsumption"></canvas>
                                  <div class="custom-dropdown" id="custom-dropdown">
                                  <div id="dataDropdown_powersite" class=" dropdown-menu" style="height:150px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px; margin-top:60%;">
                                  <div style="display:flex;">
                                  <span class="dropdown-item" id="listItemLabelpowerTop">Power Consumption: </span>
                                  <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                                  </div>                                      
                                  <a  style="cursor:pointer;"class="dropdown-item" id="Asset_Name">Asset Name </a>
                               
                           </div>
                         
                       </div>
                                </div>
                               
                              </center>

                              </div> 

                           
                              
                        </div>

                        <div class="col-12 mt-2">
                        <hr class="mb-4" />
                        <span class="fw-bold">Month Wise Power Consumption</span> <br />
                          <center>
                          <div class="row">
                          
                                <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
                              <div class="parent col-md-2">
                              <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_monthpower" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                                <a style="cursor: pointer;" onclick="downloadPowerConsum()"  data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                               <span class="fw-bold my-4" id="powerConsumMonthNoData"><br><br><br></span>
                          </center>
                     
                          <center> 
                            <div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                              <canvas id="power_consumption_month"></canvas>
                            </div>
                          </center>
                          <div class="custom-dropdown" id="custom-dropdown">
                          <div id="dataDropdown_monthpower_wise" class=" dropdown-menu" style="height:150px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px; margin-top:122%">
                          <div style="display:flex;">
                            <span class="dropdown-item" id="listItemLabelmonthpower">Power Consumption: </span>
                            <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                            </div>                             
                           <a  style="cursor:pointer;"class="dropdown-item" id="Asset_Name">Asset Name </a>
                       
                   </div>
                 
               </div>
                          </div>    
                    </div>

               
            </div>
        </div>
            </div>`,

};



let a119 = {
  id: "a119",
  x: a119_x,
  y: a119_y,
  w: a119_w,
  h: a119_h,
  content: `<div >
                    <div style="background-color:#fff;" class="card-header row">
                        <div class="row">
                            <span id="titleWaterConsumption" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Water Consumption Top Management</span>
                            <img class="col-md-1 my-2" height="15" width="15" onclick="showWaterConsumptionTop()" src="assets/img/xmark-solid.svg" />
                        </div>
                    </div>
                    <hr class="mt-0" /><br>
                    <div class="row">
                        <div class="col-12 water-counts" style="margin-bottom:70px;">
                            <div class="text-center go-shadow m-2 total-consumption"><span id="wcTotalConsumptionTop" class="fs-3 fw-bold">0
                                    KL</span><br><span style="padding-left:40px">Total Consumption </span><a style="cursor: pointer;padding-left:25px;width:10px" onclick="downloadwcTotalConsumption()" 
                                      data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                            <div class="text-center go-shadow m-2 total-transform"><span id="wcTotalDomesticTop" class="fs-3 fw-bold">0
                                    KL</span><br><span style="padding-left:50px">Domestic Total</span><a style="cursor: pointer;padding-left:40px;width:10px" onclick="downloadDomesticTotal()" 
                                      data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                            <div class="text-center go-shadow m-2 total-dg"><span id="wcFlushingTotalTop" class="fs-3 fw-bold">0
                                    KL</span><br><span style="padding-left:50px">Flushing Total</span><a style="cursor: pointer;padding-left:40px;width:10px" onclick="downloadFlushingTotal()" 
                                      data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                            <div class="text-center go-shadow m-2 tatal-diesel-consume"><span id="wcTotalIrrigationTop" class="fs-3 fw-bold">0
                                    KL</span><br><span style="padding-left:50px">Irrigation Total</span>
                                    <a style="cursor: pointer;padding-left:40px;width:10px" onclick="downloadIrrigation()" 
                                      data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                        </div>



                        <div class="col-md-12 row">
                            <div class="col-md-6 d-flex border-end row">
                                <div>
                                <span id="fitout" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Water Source Consumption</span>
                                <a style="cursor: pointer; float:right;" onclick="downloadWaterConsumPie()" data-toggle="popover" title="Download Underlying Data">
                                <img height="15" width="15" src="assets/img/download.png"/></a>
                                </div>

                               
                                <center><br>
                                      <span class="fw-bold my-4" id="waterConsumPieNoData"></span>
                                </center>
                                <center><div style="background-color:#fff; class="card-body col-8 mt-4">
                                    <canvas id="water_consume_pieTop" style="display: block; box-sizing: border-box; height: 300px; width: 597.6px;"></canvas>
                                </div></center>
                                <span class="col-4 ml-2">
                                    <div>
                                        <p align="left" id="wsPie1"></p>
                                    </div>
                                </span>
                            </div>

                            <div class="col-md-6 d-flex row ">
                                <div>
                                <span id="domesticMonth" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Site Wise Domestic Water Consumption</span>
                                <a style="cursor: pointer; float:right;" onclick="downloadWaterDomesticMonth()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                                </div>

                                <center id="loaderWaterDomesticMonth" class="mt-4">
                               <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                            </center>
                                    
                                <center><br>
                                    <span class="fw-bold my-4" id="WaterDomesticMonthNoData"></span>
                                </center>

                                <center>
                                    <div style="background-color:#fff; class="card-body col-8 mt-4">
                                      <canvas id="WaterDomesticMonth" style="display: block; box-sizing: border-box; height: 300px; width: 597.6px;"></canvas>
                                    </div>
                                </center>
                            </div>
                        </div>

                         <div class="col-12">
                            <hr class="mb-4" />
                                <span class="fw-bold">Sector Wise Water Consumption</span> <br />
                                <center id="loaderCustomerWiseWater" class="mt-4"><br><br><br>
                                <div class="mt-4" role="status">
                                <span>
                                <img height="100" width="100" src="assets/img/loader.svg"/></span>
                                </div>
                                </center>

                                <center>
                            <div class="row">
                                <span  align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b></span>
                                <div class="parent col-md-3">
                                <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;width:10px;" id="refreshIconElement_CustomerWise" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                                </div>
                                <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadWaterConsumBar()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              <span class="fw-bold my-4"  id="CustomerWiseWaterNoData""><br><br><br>No Data Available</span></center>
                                <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                                    <canvas id="CustomerWiseWater"></canvas>
                                </div></center>
                            </div>
                        </div> 

                        <div class="col-12">
                            <hr class="mb-4" />
                            <span class="fw-bold">Site Wise Water Consumption</span> <br />
                            <center id="loaderSiteWiseWater" class="mt-4"><br><br><br>
                               <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                            </center>

                            <center>
                        <div class="row">
                        <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
                        <div class="parent col-md-2">
                         <div class="col-sm-1 child mx-2">
                         <a style="cursor: pointer;" onclick="downloadWaterConsumBar()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                       <span class="fw-bold my-4"  id="SiteWiseWaterNoData""><br><br><br>No Data Available</span></center>
                        <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                            <canvas id="SiteWiseWater"></canvas>
                        </div></center>
                        </div>
                    </div> 
                   

                    <div class="col-12">
                    <hr class="mb-4" />
                    <span class="fw-bold">Month Wise Water Consumption</span> <br />

                    <center>
                <div class="row">
                <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
                <div class="parent col-md-2">
                 <div class="col-sm-1 child mx-2">
                 <a style="cursor: pointer;" onclick="downloadWaterConsumBar()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
               <span class="fw-bold my-4"  id="waterConsumNoData""><br><br><br></span></center>
                <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                    <canvas id="water_consumption_top"></canvas>
                </div></center>
                </div>
            </div> 


            <div class="col-12">
            <hr class="mb-4" />
            <span class="fw-bold">Site Wise STP Efficiency</span> <br />
            <center id="loaderMonthWiseSTP" class="mt-4"><br><br><br>
                <div class="mt-4 spinner-border" role="status">
                    <span class="sr-only"></span>
                </div>
            </center>

            <center>
        <div class="row">
        <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
        <div class="parent col-md-2">
         <div class="col-sm-1 child mx-2">
         <a style="cursor: pointer;" onclick="downloadMonthWiseSTP()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
       <span class="fw-bold my-4"  id="MonthWiseSTPNoData""><br><br><br>No Data Available</span></center>
        <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
            <canvas id="MonthWiseSTP"></canvas>
        </div></center>
        </div>
    </div> 

    </div>
                </div>`,
};

let a120 = {
  id: "a120",
  x: a120_x,
  y: a120_y,
  w: a120_w,
  h: a120_h,
  content: `<div style="height: 100%; width: 100%;">
               <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Top 10 Checklist</b></span>
                        <div class="parent col-md-3">
                          <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_Top10Checklist" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadChecklistTop()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="show()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                   <hr class="mt-0"/><br><br><br>
                    <center id="loaderTopChecklist" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id=ChecklistTopNoData"></span></center>
                    <center><div class="m-4"  style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="ChecklistTop"></canvas>
                    </div></center>
                </div>`,


};

let d11 = {
  id: "d11",
  x: d11_x,
  y: d11_y,
  w: d11_w,
  h: d11_h,
  content: `<div style="height: 100%; width: 100%;">
                     

                      <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Inventory Consumption</b></span>
                          <div class="parent col-md-3">
                           <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_inventoryConsumption" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" onclick="downloadInventoryConsumption()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <img height="15" width="15"  onclick="showInventoryConsumption()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                      </div>
                    </div> 
                      <hr class="mt-0" />
                      <center id="loaderInventoryConsumption" class="mt-4"><br><br><br>
                      <div class="mt-4" role="status">
                      <span>
                      <img height="100" width="100" src="assets/img/loader.svg"/></span>
                  </div>
                          </center>  
                      <center><span class="fw-bold my-4" id="inventoryConsumptionNoData"><br><br><br>No Data Available</span></center>
  
                      <div class="tbl-container overflow-scroll">
                          <table id="tblInventoryConsumptioninfo" class="table table-bordered" overflow-y:scroll" style="padding-left:20px;">    
                              <tbody id = "tablebodyInventoryConsumption">
                              <thead>
                                  <th>Date</th>
                                  <th>Product</th>
                                  <th>Unit</th>
                                  <th>Opening</th>
                                  <th>Addition</th>
                                  <th>Consumed</th>
                                  <th>Closing</th>
                                  <th>Cost Per Unit</th>
                                  <th>Consumption Cost</th>
                              </thead>
                              </tbody>  
                          </table>
                      </div>
                  </div>`,
};


let d12 = {
  id: "d12",
  x: d12_x,
  y: d12_y,
  w: d12_w,
  h: d12_h,
  content: `<div style="height: 100%; width: 100%;">
                   

                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Inventory Consumption Report</b></span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_inventoryConsumptionReport" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadInventoryConsumptionReport()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showInventoryConsumptionReport()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div> 

                    <hr class="mt-0" />
                    </br>
                    </br>
                    <center id="loaderInventoryReport" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="inventoryReportNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; height:300px;" class="card-body">
                        <canvas id="inventory_report"></canvas>
                    </div></center>
                </div>`,
};
// bar chart  showCurrentStock(),loaderCurrentStock,CurrentStockNoData,current-Stock
let d13 = {
  id: "d13",
  x: d13_x,
  y: d13_y,
  w: d13_w,
  h: d13_h,
  content: `<div style="height: 100%; width: 100%;">
                      
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Current Stock </b></span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_CurrentStock" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadCurrentStock()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showCurrentStock()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div> 

                     <hr class="mt-0" />
                      <center id="loaderCurrentStock" class="mt-4"><br><br><br>
                          <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                      </center>
                      
                     
                     <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                          <canvas id="current-Stock"></canvas>
                      </div></center>
                  </div>`,
  // <center><span class="fw-bold my-4" id="CurrentStockNoData"><br><br><br>No Data Available</span></center>
};
// loaderInventoryConsumptionGreen,inventoryConsumptionGreenNoData,tblInventoryConsumptionGreeninfo,tablebodyInventoryConsumptionGreen
let d14 = {
  id: "d14",
  x: d14_x,
  y: d14_y,
  w: d14_w,
  h: d14_h,
  content: `<div style="height: 100%; width: 100%;">
                      
                      <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Inventory Consumption Green </b></span>
                          <div class="parent col-md-3">
                           <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_inventoryConsumptionGreen" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" onclick="downloadInventoryConsumptionGreen()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <img height="15" width="15"  onclick="showInventoryConsumptionGreen()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                      </div>
                    </div> 
                      <hr class="mt-0" />
                      <center id="loaderInventoryConsumptionGreen" class="mt-4"><br><br><br>
                      <div class="mt-4" role="status">
                      <span>
                      <img height="100" width="100" src="assets/img/loader.svg"/></span>
                  </div>
                          </center>  
                      <center><span class="fw-bold my-4" id="inventoryConsumptionGreenNoData"><br><br><br>No Data Available</span></center>
  
                      <div class="tbl-container overflow-scroll">
                          <table id="tblInventoryConsumptionGreeninfo" class="table table-bordered" overflow-y:scroll">    
                              <tbody id = "tablebodyInventoryConsumptionGreen">
                              <thead>
                                  <th>Date</th>
                                  <th>Product</th>
                                  <th>Unit</th>
                                  <th>Opening</th>
                                  <th>Addition</th>
                                  <th>Consumed</th>
                                  <th>Closing</th>
                                  <th>Cost Per Unit</th>
                                  <th>Consumption Cost</th>
                              </thead>
                              </tbody>  
                          </table>
                      </div>
                  </div>`,
};
// pie chart // loaderInventoryReportGreen,inventoryReportGreenNoData,inventory_report_green
let d15 = {
  id: "d15",
  x: d15_x,
  y: d15_y,
  w: d15_w,
  h: d15_h,
  content: `<div style="height: 100%; width: 100%;">
                    
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Inventory Report Green </b></span>
                          <div class="parent col-md-3">
                          <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_inventoryReportGreen" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" onclick="downloadInventoryConsumptionReportGreen()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <img height="15" width="15"  onclick="showInventoryConsumptionReportGreen()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                      </div>
                    </div> 
                    <hr class="mt-0" />
                    <center id="loaderInventoryReportGreen" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="inventoryReportGreenNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; class="card-body">
                        <canvas id="inventory_report_green"></canvas>
                    </div></center>
                </div>`,
};
// bar chart  // loaderCurrentStockGreen,CurrentStockGreenNoData,current-Stock-Green
let d16 = {
  id: "d16",
  x: d16_x,
  y: d16_y,
  w: d16_w,
  h: d16_h,
  content: `<div style="height: 100%; width: 100%;">
                    
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Current Stock Green </b></span>
                          <div class="parent col-md-3">
                           <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_currentStockGreen" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;" onclick="downloadCurrentStockGreen()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <img height="15" width="15"  onclick="showCurrentStockGreen()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                      </div>
                    </div> 
                     <hr class="mt-0" />
                      <center id="loaderCurrentStockGreen" class="mt-4"><br><br><br>
                      <div class="mt-4" role="status">
                      <span>
                      <img height="100" width="100" src="assets/img/loader.svg"/></span>
                  </div>
                      </center>
                       <center><span class="fw-bold my-4" id="CurrentStockGreenNoData"><br><br><br>No Data Available</span></center> 
                     <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                          <canvas id="current-Stock-Green"></canvas>
                      </div></center>
                  </div>`,
  // <center><span class="fw-bold my-4" id="CurrentStockGreenNoData"><br><br><br>No Data Available</span></center>
};



let a18 = {
  id: "a18",
  x: a18_x,
  y: a18_y,
  w: a18_w,
  h: a18_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="dt2" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Unit Category-wise Tickets</b></span>
                        <div class="parent col-md-2">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_category" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadCategoryWiseTickets()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showCategoryWiseTickets()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>

                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_category" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelCategory">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>
                 <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>
                 <a  style="cursor:pointer;" class="dropdown-item" id="Flat_Type" >Flat </a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Status">Status</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Proactive/Reactive">Proactive/Reactive</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Priority">Priority</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                 
             </div>
             </div>
                    <center id="loaderCategoryTicketChart" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="categoryTicketNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="catagory-ticket"></canvas>
                    </div></center>
                </div>`,
  // <span id="dt2" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Unit Category-wise Tickets</span>
};

let a19 = {
  id: "a19",
  x: a19_x,
  y: a19_y,
  w: a19_w,
  h: a19_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Unit Category-wise Proactive Tickets</b></span>
                        <div class="parent col-md-2">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_proactive" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadCategoryWiseProactiveTickets()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showCategoryWiseProactiveTickets()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_proactive" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelProactive">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                       </div>                 
                       <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>

                 <a  style="cursor:pointer;"  class="dropdown-item" id="Status">Status</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Proactive/Reactive">Proactive/Reactive</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Priority">Priority</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                 
             </div>
             </div>
                    <center id="loaderCategoryProactiveTicketChart" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="categoryProactiveTicketNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="proactive-ticket"></canvas>
                    </div></center>
                </div>`,
};

let a39 = {
  id: "a39",
  x: a39_x,
  y: a39_y,
  w: a39_w,
  h: a39_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="dt2_ca"  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Common Area Category-wise Tickets</b></span>
                        <div class="parent col-md-2">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_common" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadCACategoryWiseTickets()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showCACategoryWiseTickets()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_common" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelCommon">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                          </div>                  
                          <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>
                 <a  style="cursor:pointer;" class="dropdown-item" id="Flat_Type" >Flat </a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Status">Status</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Priority">Priority</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                 
             </div>
             </div>
                    <center id="loaderCACategoryTicketChart" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="categoryCATicketNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="catagory-ticket-ca"></canvas>
                    </div></center>
                </div>`,
};

let a40 = {
  id: "a40",
  x: a40_x,
  y: a40_y,
  w: a40_w,
  h: a40_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="dt3_ca"  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Common Area Category-wise Proactive Tickets</b></span>
                        <div class="parent col-md-2">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_commonproactive" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadCACategoryWiseProactiveTickets()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showCACategoryWiseProactiveTickets()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>

                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_commonproactive" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelCommonProactive">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                             </div>                  
                             <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>

                 <a  style="cursor:pointer;"  class="dropdown-item" id="Status">Status</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Proactive">Proactive</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Priority">Priority</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                 
             </div>
             </div>
                    <center id="loaderCACategoryProactiveTicketChart" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="categoryCAProactiveTicketNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="proactive-ticket-ca"></canvas>
                    </div></center>
                </div>`,
};

let a20 = {
  id: "a20",
  x: a20_x,
  y: a20_y,
  w: a20_w,
  h: a20_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span  align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b> Tickets Ageing Matrix</span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_TicketsAgeingMatrix" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadTicketsAgeingMatrix()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showTicketsAgeingMatrix()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="tbl-container overflow-hidden h-auto p-0" id="tbl1info">
                        <table style="width: 100%;">
                            <thead>
                                <tr>
                                    <th rowspan="2">Priority</th>
                                    <th colspan="5">No. Of Days</th>
                                </tr>
                                <tr>
                                    <th>0-10</th>
                                    <th>11-20</th>
                                    <th>21-30</th>
                                    <th>31-40</th>
                                    <th>40+</th>
                                </tr>
                            </thead>
                            <tbody id="tablebodyTicketAgeing">

                            </tbody>
                        </table>
                    </div>
                    <center id="loaderAgeingMatrix" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="ageingMatrixNoData"><br><br><br>No Data Available</span></center>
                    <div class="go-shadow mx-0 my-auto text-center green-count " style="margin-top: 15px !important;">
                        <span id="daysTicketAgeing" class="fw-bold fs-3">0</span><span class="fs-6 fw-normal">
                            days</span>
                        <br>
                        Average Time Taken To Resolve A Ticket
                    </div>
                </div>`,
};

let a21 = {
  id: "a21",
  x: a21_x,
  y: a21_y,
  w: a21_w,
  h: a21_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span  align="left" style="color:#5e2750;" class="fw-bold col-md-7 mt-1"><b></b>Resolution TAT</span>
                        <div class="parent col-md-5">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_resolutionTAT" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadResolutionTAT()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showResolutionTAT()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" />
                    <div class="custom-dropdown" id="custom-dropdown">
                      <div id="dataDropdown_resolutionTAT" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                      <div style="display:flex;">
                      <span class="dropdown-item" id="listItemLabelresolutionTAT">Ticket: </span>
                      <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                      </div>                        
                      <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>

                        <a  style="cursor:pointer;"  class="dropdown-item" id="Status">Status</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Proactive/Reactive">Proactive/Reactive</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Priority">Priority</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                  
                      </div>
           
                    </div>
                    <span class="d-flex justify-content-between py-1 mx-2" id="ri1">
                        <span style="margin:30px;"> Achieved <br>&emsp; <span
                                style="color:#01C875;" id="tatResolutionAchieved"></span> </span>
                        <span style="margin:30px;">Breached <br>&emsp; <span
                                style="color:#FDAB3D ;" id="tatResolutionBreached"></span> </span>
                    </span>
                    <center id="loaderTATResolution" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="tatResolutionNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="background-color:#fff; class="card-body">
                        <canvas id="resolution-b1"></canvas>
                    </div></center>
                </div>`,
};

let a22 = {
  id: "a22",
  x: a22_x,
  y: a22_y,
  w: a22_w,
  h: a22_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span  align="left" style="color:#5e2750;" class="fw-bold col-md-7 mt-1"><b></b>Response TAT</span>
                        <div class="parent col-md-5">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_responseTAT" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadResponseTAT()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showResponseTAT()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" />
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_responseTAT" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelresponseTAT">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>                      
                     <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>

                      <a  style="cursor:pointer;"  class="dropdown-item" id="Status">Status</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Proactive/Reactive">Proactive/Reactive</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Priority">Priority</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                      <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                 
             </div>
           
         </div>
                    <span class="d-flex justify-content-between py-1 mx-2" id="ri2">
                        <span style="margin:30px;">Achieved <br>&emsp; <span
                                style="color:#01C875;" id="tatResponseAchieved"></span> </span>
                        <span style="margin:30px;"> Breached <br>&emsp; <span
                                style="color:#FDAB3D;" id="tatResponseBreached"></span> </span>
                    </span>
                    <center id="loaderTATResponse" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="tatResponseNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="background-color:#fff; class="card-body">
                        <canvas id="response-b1"></canvas>
                    </div></center>
                </div>`,
};

let a23 = {
  id: "a23",
  x: a23_x,
  y: a23_y,
  w: a23_w,
  h: a23_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Visitors</span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_Visitors" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadVisitors()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showVisitors()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0 mb-0" /><br>
                    <div class="row text-center m-2" id="spaceoccupancydata">
                        <div class="col-lg-4 col-md-2 col-sm-12">
                            <span id="visTotalVisitors" class="fs-3 fw-bold text-violet">0</span><br>Total Visitors
                        </div>
                        <div class="col-lg-4 col-md-2 col-sm-12 border-start border-end">
                            <span id="visExpectedVisitors" class="fs-3 fw-bold text-darkorange ">0</span><br>Expected
                            Visitors
                        </div>
                        <div class="col-lg-4 col-md-2 col-sm-12">
                            <span id="visUnExpectedVisitors" class="fs-3 fw-bold text-sandel">0</span><br>Unexpected
                            Visitors
                        </div>
                        <div class="col-lg-4 col-md-2 col-sm-12 border-top border-end">
                            <span id="visTotalStaff"class="fs-3 fw-bold text-sandel">0</span><br>Total Staff
                        </div>
                        <div class="col-lg-4 col-md-3 col-sm-12 border-end border-top">
                            <span id="visStaffIn"  class="fs-3 fw-bold text-sandel">0</span><br>Staff In
                        </div>
                        <div class="col-lg-4 col-md-3 col-sm-12  border-top">
                            <span id="visStaffOut"  class="fs-3 fw-bold text-sandel">0</span><br>Staff Out
                        </div>

                    </div>
                    <div class="go-shadow mx-0 my-auto text-center green-count" style="margin-top: 15px !important;width: 602px">
                        <span id="visTotalVehicles" class="fw-bold fs-3">0</span>
                        <br>Total Vehicles
                    </div>

                </div>`,
};

{/* <div class="col-lg-4 col-md-2 col-sm-12 border-top border-end">
<span id="visTotalGatePass"class="fs-3 fw-bold text-sandel">0</span><br>Total Gate Pass
</div>
<div class="col-lg-4 col-md-3 col-sm-12 border-end border-top">
<span id="visReturnGatePass"  class="fs-3 fw-bold text-sandel">0</span><br>Returnable
Gate Pass Issued
</div>
<div class="col-lg-4 col-md-3 col-sm-12  border-top">
<span id="visNonReturnGatePass"  class="fs-3 fw-bold text-sandel">0</span><br>Non-Returnable Gate Pass Issued
</div> */}
// let a23 = {
//   id: "a23",
//   x: a23_x,
//   y: a23_y,
//   w: a23_w,
//   h: a23_h,
//   content: `<div style="height: 100%; width: 100%;">
//                     <div style="background-color:#fff;" class="card-header row">
//                         <div class="row">
//                             <span align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Visitors</span>
//                             <img class="col-md-1 my-2" height="15" width="15" onclick="showVisitors()" src="assets/img/xmark-solid.svg" />
//                         </div>
//                     </div>
//                     <hr class="mt-0 mb-4" /><br>
//                     <div class="row text-center m-2" id="spaceoccupancydata">
//                         <div class="col-lg-2 col-md-2 col-sm-12">
//                             <span id="visTotalVisitors" class="fs-3 fw-bold text-violet">0</span><br>Total Visitors
//                         </div>
//                         <div class="col-lg-2 col-md-2 col-sm-12 border-start border-end">
//                             <span id="visExpectedVisitors" class="fs-3 fw-bold text-darkorange ">0</span><br>Expected
//                             Visitors
//                         </div>
//                         <div class="col-lg-2 col-md-2 col-sm-12">
//                             <span id="visUnExpectedVisitors" class="fs-3 fw-bold text-sandel">0</span><br>Unexpected
//                             Visitors
//                         </div>
//                         <div class="col-lg-2 col-md-2 col-sm-12 border-end border-start">
//                             <span id="visTotalStaff" class="fs-3 fw-bold text-sandel">0</span><br>Total Staff
//                         </div>
//                         <div class="col-lg-2 col-md-2 col-sm-12 border-end border-start">
//                             <span id="visStaffIn" class="fs-3 fw-bold text-sandel">0</span><br>Staff In
//                         </div>
//                         <div class="col-lg-2 col-md-2 col-sm-12 border-end border-start">
//                             <span id="visStaffOut" class="fs-3 fw-bold text-sandel">0</span><br>Staff Out
//                         </div>

//                         <div class="row-lg-2 col-md-2 col-sm-12 border-top">
//                             <span id="visTotalGatePass" class="fs-3 fw-bold text-violet">0</span><br>Total Gate Pass
//                         </div>
//                         <div class="col-lg-2 col-md-2 col-sm-12 border-end border-start border-top">
//                             <span id="visReturnGatePass" class="fs-3 fw-bold text-darkorange ">0</span><br>Returnable
//                             Gate Pass Issued
//                         </div>
//                         <div class="col-lg-2 col-md-2 col-sm-12 border-top border-end">
//                             <span id="visNonReturnGatePass" class="fs-3 fw-bold text-sandel">0</span><br>Non-Returnable
//                             Gate Pass Issued
//                         </div>
//                         <div class="col-lg-3 col-md-3 col-sm-12 border-end border-top">
//                             <span id="visGoodsInwards" class="fs-3 fw-bold text-sandel">0</span><br>Goods Inwards
//                         </div>
//                         <div class="col-lg-3 col-md-3 col-sm-12 border-end border-top">
//                             <span id="visOutwards" class="fs-3 fw-bold text-sandel">0</span><br>Outwards
//                         </div>

//                     </div>
//                     <div class="go-shadow mx-0 my-auto text-center green-count" style="margin-top: 15px !important;width: 602px">
//                         <span id="visTotalVehicles" class="fw-bold fs-3">0</span>
//                         <br>Total Vehicles
//                     </div>

//                 </div>`,
// };

// ---------
// let a23 = {
//   id: "a23",
//   x: a23_x,
//   y: a23_y,
//   w: a23_w,
//   h: a23_h,
//   content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
//                     <div class="orange-shade">
//                         <span style="text-align:left; padding-right:100px;"><span id="visTotalVisitors" class="count">0</span><br/>
//                         <span class="text">Total Visitors</span></span>
//                         <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
//                       <a1 style="cursor: pointer;" onclick="downloadTotalVisitors()" data-toggle="popover"  title="Download Underlying Data" >
//                         <i class="bi bi-download"></i></a1>
//                     </div>
//                 </div>`,
// };
let a50 = {
  id: "a50",
  x: a50_x,
  y: a50_y,
  w: a50_w,
  h: a50_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="green-shade"> 
                        <span style="text-align:left;padding-right:90px;"><span id="visExpectedVisitors" class="count">0</span><br/>
                        <span class="text">Expected Visitors</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                        <a1 style="cursor: pointer;" onclick="downloadExpectedVisitors()" data-toggle="popover"  title="Download Underlying Data" >
                        <i class="bi bi-download"></i></a1>
                    </div>
                </div>`,
};
let a51 = {
  id: "a51",
  x: a51_x,
  y: a51_y,
  w: a51_w,
  h: a51_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="pink-shade"> 
                        <span style="text-align:left;padding-right:50px;"><span id="visUnExpectedVisitors" class="count">0</span><br/>
                        <span class="text">UnExpected Visitors</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                         <a1 style="cursor: pointer;" onclick="downloadUnExpectedVisitors()" data-toggle="popover"  title="Download Underlying Data" >
                        <i class="bi bi-download"></i></a1>
                    </div>
                </div>`,
};

// let a52 = {
//   id: "a52",
//   x: a52_x,
//   y: a52_y,
//   w: a52_w,
//   h: a52_h,
//   content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
//                     <div class="yellow-shade"> 
//                         <span style="text-align:left;padding-right:80px;"><span id="visTotalGatePass" class="count">0</span><br/>
//                         <span class="text">Total Gate Pass</span></span>
//                         <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
//                          <a1 style="cursor: pointer;" onclick="downloadTotalGatePass()" data-toggle="popover"  title="Download Underlying Data" >
//                         <i class="bi bi-download"></i></a1>
//                     </div>
//                 </div>`,
// };
// let a53 = {
//   id: "a53",
//   x: a53_x,
//   y: a53_y,
//   w: a53_w,
//   h: a53_h,
//   content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
//                     <div class="red-shade"> 
//                         <span style="text-align:left"><span id="visReturnGatePass" class="count">0</span><br/>
//                         <span class="text">Returnable Gate Pass Issued</span></span>
//                         <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
//                          <a1 style="cursor: pointer;" onclick="downloadReturnGatePass()" data-toggle="popover"  title="Download Underlying Data" >
//                         <i class="bi bi-download"></i></a1>
//                     </div>
//                 </div>`,
// };
// let a54 = {
//   id: "a54",
//   x: a54_x,
//   y: a54_y,
//   w: a54_w,
//   h: a54_h,
//   content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
//                     <div class="orange-shade"> 
//                         <span style="text-align:left"><span id="visNonReturnGatePass" class="count">0</span><br/>
//                         <span class="text">Non-Returnable Gate Pass Issued</span></span>
//                         <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
//                          <a1 style="cursor: pointer;" onclick="downloadNonReturnGatePass()" data-toggle="popover"  title="Download Underlying Data" >
//                         <i class="bi bi-download"></i></a1>
//                     </div>
//                 </div>`,
// };

let a55 = {
  id: "a55",
  x: a55_x,
  y: a55_y,
  w: a55_w,
  h: a55_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="green-shade"> 
                        <span style="text-align:left;padding-right:90px;"><span id="visTotalVehicles" class="count">0</span><br/>
                        <span class="text">Total Vehicles</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                         <a1 style="cursor: pointer;" onclick="downloadTotalVehicles()" data-toggle="popover"  title="Download Underlying Data" >
                        <i class="bi bi-download"></i></a1>
                    </div>
                </div>`,
};
let a56 = {
  id: "a56",
  x: a56_x,
  y: a56_y,
  w: a56_w,
  h: a56_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="pink-shade"> 
                        <span style="text-align:left;padding-right:100px;"><span id="visTotalStaff" class="count">0</span><br/>
                        <span class="text">Total Staff</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                         <a1 style="cursor: pointer;" onclick="downloadTotalStaff()" data-toggle="popover"  title="Download Underlying Data" >
                        <i class="bi bi-download"></i></a1>
                    </div>
                </div>`,
};
let a57 = {
  id: "a57",
  x: a57_x,
  y: a57_y,
  w: a57_w,
  h: a57_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="yellow-shade"> 
                        <span style="text-align:left;padding-right:120px;"><span id="visStaffIn" class="count">0</span><br/>
                        <span class="text">Staff In</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                         <a1 style="cursor: pointer;" onclick="downloadStaffIn()" data-toggle="popover"  title="Download Underlying Data" >
                        <i class="bi bi-download"></i></a1>
                    </div>
                </div>`,
};
let a58 = {
  id: "a58",
  x: a58_x,
  y: a58_y,
  w: a58_w,
  h: a58_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="red-shade"> 
                        <span style="text-align:left;padding-right:120px;"><span id="visStaffOut" class="count">0</span><br/>
                        <span class="text">Staff Out</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                         <a1 style="cursor: pointer;" onclick="downloadStaffOut()" data-toggle="popover"  title="Download Underlying Data" >
                        <i class="bi bi-download"></i></a1>
                    </div>
                </div>`,
};

let a59 = {
  id: "a59",
  x: a59_x,
  y: a59_y,
  w: a59_w,
  h: a59_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visGoodsInwards" class="count">0</span><br/>
                    <span class=" text">Goods Inwards</span>
                  </span>
                  <div id="loader_a59" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadGoodsInwards()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a59()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

// Refresh_a59
function Refresh_a59() {
  let visGoodsInwards = document.getElementById("visGoodsInwards");
  let loader = document.getElementById("loader_a59");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visGoodsInwards.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getGoodsInwards + idLink, true);

    if (globalType == "daily") {
      xhr_object.open("GET", getGoodsInwards + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getGoodsInwards + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond, true);
    }

    xhr_object.onload = function () {
      resfunGoodsInwards = JSON.parse(this.responseText);
      console.log("GoodsInwards - ");
      console.log(resfunGoodsInwards);

      if (resfunGoodsInwards.response) {
        visGoodsInwards.innerHTML = resfunGoodsInwards.response + "";
      } else {
        visGoodsInwards.innerHTML = "No data available"; // Show "No data available" message if no data or API can't be recalled
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}

let a60 = {
  id: "a60",
  x: a60_x,
  y: a60_y,
  w: a60_w,
  h: a60_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visOutwards" class="count">0</span><br/>
                    <span class=" text">Goods Outwards</span>
                  </span>
                  <div id="loader_a60" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <div id="fetcher_a60" class="mt-4 fetcher-icon" role="status" style="display: none;">
                          <span>
                              <img height="65" width="65" src="assets/img/fetcher.svg"/>
                          </span>
                      </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadOutwards()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a60()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a60() {
  let visOutwards = document.getElementById("visOutwards");
  let loader = document.getElementById("loader_a60");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visOutwards.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    if (globalType == "daily") {
      xhr_object.open("GET", getOutwards + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getOutwards + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateSecond, true);
    }

    xhr_object.onload = function () {
      resfunOutwards = JSON.parse(this.responseText);
      console.log("Outwards - ");
      console.log(resfunOutwards);

      if (resfunOutwards && resfunOutwards.response) {
        visOutwards.innerHTML = resfunOutwards.response + "";
      } else {
        visOutwards.innerHTML = "No data available"; // Show "No data available" message if no data or API can't be recalled
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}
// showTotalVisitors(),loaderTotalVisitors,totalVisitorsNoData,total-visitors
let a47 = {
  id: "a47",
  x: a47_x,
  y: a47_y,
  w: a47_w,
  h: a47_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row">
                        <div class="row">
                            <span id="dt2_tv" align="left" style="color:#5e2750;width:1000px" class="fw-bold col-md-11 mt-1">Total Visitors </span>
                             <a style="cursor: pointer;padding-right:40px;width:10px" onclick="downloadVisitors()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>     
                            <img class="col-md-1 my-2" height="15" width="15" onclick="showTotalVisitors()" src="assets/img/xmark-solid.svg" />
                        </div>
                    </div>
                    <hr class="mt-0" /><br>
                    <select class="border-1 d-flex dashboard-cal my-0 mx-2" style="margin-left: 5px;" id="drop" name="drop"  >
                        
                    </select>
                    <center id="loaderTotalVisitors" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="totalVisitorsNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="total-visitors"></canvas>
                    </div></center>
                </div>`,
};
let a48 = {
  id: "a48",
  x: a48_x,
  y: a48_y,
  w: a48_w,
  h: a48_h,
  content: `<div style="height: 100%; width: 100%;">

                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="dt1" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Goods In</b></span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_goodsIn" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadGoodsInwards()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showGoodsIn()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>

                    <hr class="mt-0" /><br>
                      <div class="custom-dropdown" id="custom-dropdown">
                        <div id="dataDropdown_goodsIn" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                        <div style="display:flex;">
                        <span class="dropdown-item" id="listItemLabelGoodsIn">Ticket: </span>
                        <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                        </div>                       
                          <a  style="cursor:pointer;"class="dropdown-item" id="item">Item </a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="mode_of_transport" >Mode of transport </a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="type" >Type </a>


                        </div>
                      </div>
                    
                    <center id="loaderGoodsIn" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id=goodsInNoData"></span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="goods_in"></canvas>
                    </div></center>
                </div>`,
};

let a49 = {
  id: "a49",
  x: a49_x,
  y: a49_y,
  w: a49_w,
  h: a49_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="dt1" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Goods Out</b></span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_goodsOut" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadOutwards()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showGoodsOut()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>

                    <hr class="mt-0" /><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                        <div id="dataDropdown_goodsOut" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                        <div style="display:flex;">
                        <span class="dropdown-item" id="listItemLabelGoodsOut">Ticket: </span>
                        <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                        </div>                         
                        <a  style="cursor:pointer;"class="dropdown-item" id="item">Item </a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="mode_of_transport" >Mode of transport </a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="type" >Type </a>


                        </div>
                      </div>
                    <center id="loaderGoodsOut" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="goodsOutNoData">No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="goods_out"></canvas>
                    </div></center>
                </div>`,
};
// let a24 = {
//   id: "a24",
//   x: a24_x,
//   y: a24_y,
//   w: a24_w,
//   h: a24_h,
//   content: `<div style="height: 100%; width: 100%;">
//                     <div style="background-color:#fff;" class="card-header row">
//                         <div class="row">
//                             <span align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Permits</span>
//                             <img class="col-md-1 my-2" height="15" width="15" onclick="showPermits()" src="assets/img/xmark-solid.svg" />
//                         </div>
//                     </div>
//                     <hr class="mt-0" /><br>
//                     <div class="row text-center mx-3 divider-bg" id="spaceoccupancydata">
//                         <div class="col-lg-6 col-md-6 col-sm-12">
//                             <span class="fs-3 fw-bold text-violet">0</span><br>Total Permits
//                         </div>
//                         <div class="col-lg-6 col-md-6 col-sm-12">
//                             <span class="fs-3 fw-bold text-lightorange">0</span><br>Hot Permits
//                         </div>
//                         <div class="col-lg-6 col-md-6 col-sm-12">
//                             <span class="fs-3 fw-bold text-green">0</span><br>Cold Permits
//                         </div>
//                         <div class="col-lg-6 col-md-6 col-sm-12">
//                             <span class="fs-3 fw-bold text-pink">0</span><br>Height Permits
//                         </div>
//                     </div>
//                 </div>`,
// };

let a25 = {
  id: "a25",
  x: a25_x,
  y: a25_y,
  w: a25_w,
  h: a25_h,
  content: `<div style="height: 100%; width: 100%;">
  <div style="background-color:#fff;" class="card-header row">
      <div class="row">
          <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Power Consumption</span>
          <img class="col-md-1 my-2" height="15" width="15" onclick="showPowerConsumption()" src="assets/img/xmark-solid.svg" />
                      
          </div>
  </div>
  <hr class="mt-0" /><br>
   <div class="row">
      <div class="col-lg-6 col-md-6 col-sm-12 ">
          <div class=" d-flex flex-wrap power-counts justify-content-center">
              <div class="text-center go-shadow m-2 total-consumption"><span id="pcTotalHtMeter" class="fs-3 fw-bold">0 kwh</span><br><span>Total Consumption (Mains)</span>
                    <a style="cursor: pointer; float:right; width:10px" onclick="downloadTotalConsumption()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

              <div class="text-center go-shadow m-2 total-transform"><span id="pcTotalTransformer" class="fs-3 fw-bold">0 kwh</span><br><span>Solar Total</span>
                      <a style="cursor: pointer; float:right;width:10px" onclick="downloadTransformaerTotal()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

              <div class="text-center go-shadow m-2 total-dg"><span id="pcTotalDg" class="fs-3 fw-bold">0kwh</span><br><span>DG Total</span>
                      <a style="cursor: pointer; float:right; width:10px" onclick="downloadDgtotal()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

              <div class="text-center go-shadow m-2 tatal-diesel-consume"><span id="pcTotalDieselConsumed"class="fs-3 fw-bold">0 liter</span><br><span>Total Diesel Consumed</span>
                      <a style="cursor: pointer; float:right;width:10px" onclick="downloadTotalDieselConsumed()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
          </div>
      </div>
      <div class="col-lg-6 col-md-6 col-sm-12 row">
          <div class="col-6">
              <div class=" text-center go-shadow m-2 cumulative-area w-100">
                  <span id="pcTotalDieselConsumedPie" class="fs-3 fw-bold">0 liters</span><br><span>Cumulative Power Consumed</span>
                      
              </div>
              <div align="left" class="m-3">
                  <span class="fw-bold">Sub Meter Sources</span> <br />
                  <span id="psPie1"></span>
                  <span id="psPie2"></span>
                  <span id="psPie3"></span>
                  <span id="psPie4"></span>
                  <span id="psPie5"></span>
              </div>
          </div>
          <div class="col-6">
              <center id="loaderPowerConsumPie" class="mt-4">
                  <div class="mt-4 spinner-border" role="status">
                      <span class="sr-only"></span>
                  </div>
              </center>
              <center><a style="cursor: pointer;padding-left:120px;width:10px" onclick="downloadDConsumPie()" 
                    data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
              <span class="fw-bold my-4" id="powerConsumPieNoData">No Data Available</span></center>
              <center><div style="background-color:#fff; class="card-body">
                  <canvas id="power-consume-pie"></canvas>
              </div></center>
          </div>
      </div>

      <div class="col-12 mt-2">
          <hr class="mb-4" />
          <span class="fw-bold">Power Consumption - Time Series</span> <br />
            <center id="loaderPowerConsum" class="mt-4"><br><br><br>
              <div class="mt-4 spinner-border" role="status">
                  <span class="sr-only"></span>
              </div>
            </center>
            <center>
            <div class="row">
            
                  <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
                <div class="parent col-md-2">
                <div class="col-sm-1 child mx-2">
          <a style="cursor: pointer;" id="refreshIconElement_power" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
         </div>
                <div class="col-sm-1 child mx-2">
                  <a style="cursor: pointer;" onclick="downloadPowerConsum()"  data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                 <span class="fw-bold my-4" id="powerConsumNoData"><br><br><br>No Data Available</span>
            </center>
       
            <center> 
              <div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                <canvas id="power-consumption"></canvas>
              </div>
            </center>
            <div class="custom-dropdown" id="custom-dropdown">
            <div id="dataDropdown_power" class=" dropdown-menu" style="height:150px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px; margin-top:37%">
            <div style="display:flex;">
            <span class="dropdown-item" id="listItemLabelpower">Power Consumption: </span>
            <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
            </div>              
             <a  style="cursor:pointer;"class="dropdown-item" id="Asset_Name">Asset Name </a>
         
      </div>
   
</div>


      </div> 
      

        
      
      </div> 


    </div>

    
        
</div>`,
  // <center id="loaderPowerConsumAssetWiseTimeSeries" class="mt-4"><br><br><br>
  //                 <div class="mt-4 spinner-border" role="status">
  //                     <span class="sr-only"></span>
  //                 </div>
  //             </center>
  // <div class="col-12 mt-2">
  //   <hr class="mb-4" />
  //     <center>
  //       <div class="row">
  //         <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
  //       <div class="parent col-md-2">
  //       <div class="col-sm-1 child mx-2">
  //         <span class="fw-bold my-4" id="powerConsumAssetWiseTimeSeriesNoData"><br><br><br>No Data Available</span>
  //       </div>
  //       </div>
  //    </center>
  //     <center>
  //       <div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
  //         <canvas id="power-consumption-assetwise"></canvas>
  //       </div>
  //     </center>
  // </div>
};

let a26 = {
  id: "a26",
  x: a26_x,
  y: a26_y,
  w: a26_w,
  h: a26_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row">
                        <div class="row">
                            <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Water Consumption</span>
                            <img class="col-md-1 my-2" height="15" width="15" onclick="showWaterConsumption()" src="assets/img/xmark-solid.svg" />
                        </div>
                    </div>
                    <hr class="mt-0" /><br>
                    <div class="row">
                        <div class=" col-md-12 " style="margin-bottom:70px; display:flex;flex-wrap:wrap;">
                        <div style="width:47% " class="  text-center go-shadow m-3 total-consumption"><span id="wcTotalConsumption" class="fs-3 fw-bold">0
                                KL</span><br><span style="padding-left:40px">Total Consumption </span><a style="cursor: pointer;padding-left:25px;width:10px" onclick="downloadwcTotalConsumption()" 
                                  data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                        <div style="width:47%" class="text-center go-shadow m-3 total-transform"><span id="wcTotalDomestic" class="fs-3 fw-bold">0
                                KL</span><br><span style="padding-left:50px">Domestic Total</span><a style="cursor: pointer;padding-left:40px;width:10px" onclick="downloadDomesticTotal()" 
                                  data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                        <div  style="width:31.5%" class="text-center go-shadow m-2 total-dg"><span id="wcFlushingTotal" class="fs-3 fw-bold">0
                                KL</span><br><span style="padding-left:50px">Flushing Total</span><a style="cursor: pointer;padding-left:40px;width:10px" onclick="downloadFlushingTotal()" 
                                  data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                        <div style="width:31.5%" class="text-center go-shadow m-2 tatal-diesel-consume"><span id="wcTotalIrrigation" class="fs-3 fw-bold">0
                                KL</span><br><span style="padding-left:50px">Irrigation Total</span>
                                <a style="cursor: pointer;padding-left:40px;width:10px" onclick="downloadIrrigation()" 
                                  data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                       <div style="width:31.5%" class="text-center go-shadow m-2 total-consumption"><span id="wcTotalSTP" class="fs-3 fw-bold">0
                                  KL</span><br><span style="padding-left:50px">STP Total</span>
                                  <a style="cursor: pointer;padding-left:40px;width:10px" onclick="downloadwcTotalSTP()" 
                                    data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>          
                                  
                    </div>



                        <div class="col-md-12 row">
                            <div class="col-md-6 d-flex border-end row">
                                <center id="loaderWaterConsumPie" class="mt-4">
                                   <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                                </center>
                                <br>
                                <div>
                                <span id="fitout" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Water Resources</span>
                                <a style="cursor: pointer; float:right;" onclick="downloadWaterConsumPie()" data-toggle="popover" title="Download Underlying Data">
                                <img height="15" width="15" src="assets/img/download.png"/></a>
                                </div>
                               
                                <center><br>
                                      <span class="fw-bold my-4" id="waterConsumPieNoData">No Data Available</span>
                                </center>
                                <center><div style="background-color:#fff; class="card-body col-8 mt-4">
                                    <canvas id="water-consume-pie" style="display: block; box-sizing: border-box; height: 300px; width: 597.6px;"></canvas>
                                </div></center>
                                <span class="col-4 ml-2">
                                    <div>
                                        <p align="left" id="wsPie1"></p>
                                    </div>
                                </span>
                            </div>

                            <div class="col-md-6 d-flex row ">
                                <center id="loaderWaterConsumLPCD" class="mt-4">
                                   <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                                </center>
                                <div>
                                <span id="fitout" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>LPCD</span>
                                <a style="cursor: pointer; float:right;" onclick="downloadWaterConsumLPCD()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                                </div>
                                    
                                <center><br>
                                    <span class="fw-bold my-4" id="waterConsumLPCDNoData">No Data Available</span>
                                </center>

                                <center>
                                    <div style="background-color:#fff; class="card-body col-8 mt-4">
                                      <canvas id="water-consume-lpcd" style="display: block; box-sizing: border-box; height: 300px; width: 597.6px;"></canvas>
                                    </div>
                                </center>

                                <span class="col-4 ml-2">
                                    <div>
                                        <p align="left" id="wsLPCD"></p>
                                    </div>
                                </span>
                            </div>
                        </div>

                        <div class="col-12">
                            <hr class="mb-4" />
                            <span class="fw-bold">Water Consumption - Time Series</span> <br />
                            <center id="loaderWaterConsum" class="mt-4"><br><br><br>
                               <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                            </center>

                            <center>
                        <div class="row">
                        <span  align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b></span>
                        <div class="parent col-md-2">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_water" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                         <div class="col-sm-1 child mx-2">
                         <a style="cursor: pointer;" onclick="downloadWaterConsumBar()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                       <span class="fw-bold my-4"  id="waterConsumNoData""><br><br><br>No Data Available</span></center>
                        <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                            <canvas id="water-consumption"></canvas>
                        </div></center>
                        <div class="custom-dropdown" id="custom-dropdown">
                        <div id="dataDropdown_water" class=" dropdown-menu" style="height:150px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px; margin-top:80%">
                        <div style="display:flex;">
                        <span class="dropdown-item" id="listItemLabelwater">Water Consumption: </span>
                        <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                        </div>                          
                        <a  style="cursor:pointer;"class="dropdown-item" id="Asset_Name">Asset Name </a>
                     
                 </div>
               
             </div>
                        </div>
                    </div>
                </div>`,
};

let a27 = {
  id: "a27",
  x: a27_x,
  y: a27_y,
  w: a27_w,
  h: a27_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row">
                        <div class="row">
                            <span align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Carbon Emission</span>
                            
                        </div>
                    </div>
                    <hr class="mt-0" />
                    <div class="d-flex text-center justify-content-around">
                        <p><span id="cEScope1" class="text-violet fw-bold fs-3">0</span><br> Scope 1</p>
                        <a style="cursor: pointer;padding-left:10px;width:10px" onclick="downloadCarbonEmissionScope1()" 
                                      data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>

                        <p><span id="cEScope2" class="text-darkorange fw-bold fs-3">0</span><br> Scope 2</p>
                        <a style="cursor: pointer;padding-left:10px;width:10px" onclick="downloadCarbonEmissionScope2()" 
                                      data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                    </div>
                </div>`,
};

let a63 = {
  id: "a63",
  x: a63_x,
  y: a63_y,
  w: a63_w,
  h: a63_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row">
                      <div class="row">
                            <span align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Energy Intensity</span>

                            <a style="cursor: pointer;padding-left:10px; padding-bottom:20px;width:10px" onclick="downloadEnergyIntensity()" 
                                      data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            
                        </div>
                        <hr class="mt-0" />
                        <span align="left" id='energyIntensity' style="color:#5e2750;" class="text-violet fw-bold fs-3 col-md-11 mt-1">0</span></div>
                   
                </div>`,
};

let a28 = {
  id: "a28",
  x: a28_x,
  y: a28_y,
  w: a28_w,
  h: a28_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row mb-4"><a style="cursor: pointer;padding-left:540px; width:10px" onclick="downloadFuelConsumption()" 
                        data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                    <div class="d-flex text-center justify-content-around">
                        <p><span id="fuelConsmVal" class="text-violet fw-bold fs-3">0</span><br>Fuel Consumption</p>
                    </div>
                </div>`,
};

let a29 = {
  id: "a29",
  x: a29_x,
  y: a29_y,
  w: a29_w,
  h: a29_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row mb-4"><a style="cursor: pointer;padding-left:400px;width:10px" onclick="downloadFitout()" 
                        data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                    <div class="d-flex text-center justify-content-around">
                        <p><span id="fitOutVal" class="text-violet fw-bold fs-3">0</span><br>Fitout Request</p>
                    </div>
                </div>`,
};

let a30 = {
  id: "a30",
  x: a30_x,
  y: a30_y,
  w: a30_w,
  h: a30_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Incidents</span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_incident" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadIncidents()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showIncidents()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_incident" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelIncident">Incident: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>                 
                     <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>
                 <a  style="cursor:pointer;" class="dropdown-item" id="Primary_Category" >Primary Category </a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Secondary_Category">Secondary Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Created_Date">Created Date</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Level_Wise">Level Wise</a>                
                  <a  style="cursor:pointer;"  class="dropdown-item" id="Reported_By">Reported By</a>

             </div>
           
         </div>
                    <center id="loaderIncident" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="incidentNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; height:300px;" class="card-body">
                        <canvas id="incident-dount"></canvas>
                    </div></center>
                </div>`,
  // <p class="fw-bold">Incident Status</p>
  // <span align="left" class="row mx-2">
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#77216f;"></i>
  //         Open &emsp; <span id="incidentsOpen" class="float-end" style="color:#77216f">0</span>
  //     </span>
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#f2c06c"></i> In
  //         Progress &emsp; <span id="incidentsInProgress" class="float-end"
  //             style="color:#f2c06c ;">0</span> </span>
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#E2445B;"></i>
  //         Pending &emsp; <span id="incidentsPending" class="float-end" style="color:#E2445B;">0</span>
  //     </span>
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#a1cd7a;"></i>
  //         Closed &emsp; <span id="incidentsClosed" class="float-end" style="color:#a1cd7a;">0</span>
  //     </span>
  // </span>
};

let a31 = {
  id: "a31",
  x: a31_x,
  y: a31_y,
  w: a31_w,
  h: a31_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Top 5  Category-wise Incidents</span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_categoryIncident" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadCategoryWiseIncidents()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showCategoryWiseIncidents()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_incidentcategory" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                 <span class="dropdown-item" id="listItemLabelIncidentCategory">Incident: </span>
                 <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>
                 <a  style="cursor:pointer;" class="dropdown-item" id="Primary_Category" >Primary Category </a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Secondary_Category">Secondary Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Created_Date">Created Date</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Level_Wise">Level Wise</a>                
                  <a  style="cursor:pointer;"  class="dropdown-item" id="Reported_By">Reported By</a>

             </div>
           
         </div>
                    <center id="loaderIncidentCategory" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="incidentCategoryNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; class="card-body">
                        <canvas id="incident-category-pie"></canvas>
                    </div></center>
                </div>`,
  // <p class="fw-bold">Incident Category</p>
  // <span align="left" class="row mx-2">
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#E2445B;"></i>
  //         Mechanical &emsp; <span id="incidentsCatMechanical" class="float-end"
  //             style="color:#E2445B;">0</span> </span>
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#f2c06c"></i>
  //         Health & Safety &emsp; <span id="incidentsCatHealthSafety" class="float-end"
  //             style="color:#f2c06c ;">0</span> </span>
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#f8ea94;"></i>
  //         Engineering &emsp; <span id="incidentsCatEngineering" class="float-end"
  //             style="color:#f2c06c">0</span> </span>
  //     <span class="col-6 p-1 "><i class="bi p-1  bi-circle-fill px-1" style="color:#a1cd7a;"></i>
  //         Other &emsp; <span id="incidentsCatOther" class="float-end" style="color:#a1cd7a;">0</span>
  //     </span>
  // </span>




  // <div class="col-sm-1 child mx-2">
  //                       <a style="cursor: pointer;" id="refreshIconElement_incidentcategory" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
  //                        </div>
};

{/* <div class="col-sm-1 child mx-2">
<a style="cursor: pointer;" id="refreshIconElement_incidentcategory" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
 </div> */}

 let a32 = {
  id: "a32",
  x: a32_x,
  y: a32_y,
  w: a32_w,
  h: a32_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Manpower Attendance</span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_manPower" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadManPowerAttendance()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showManPowerAttendance()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" />
                    <div class="tbl-container overflow-scroll" >
                        <table id="tblManPowerinfo" class="table table-bordered" overflow-y:scroll">
                            <thead style="font-size:15px;vertical-align: middle">
                                <th> Designation </th>
                                <th>Attendance</th>
                            </thead>
                            <tbody id= "tablebodyManPower">
                                  
                            </tbody>
                            
                        </table>
                        <center id="loaderManPower" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                        <span>
                        <img height="100" width="100" src="assets/img/loader.svg"/></span>
                    </div>
                        </center>  
                        <center><span class="fw-bold my-4" id="ManPowerNoData"><br><br><br>No Data Available</span></center>
                    </div>
                </div>`,
};

let a33 = {
  id: "a33",
  x: a33_x,
  y: a33_y,
  w: a33_w,
  h: a33_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b>Footfall Analysis</span>
                        <div class="parent col-md-2">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_footfall" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                         </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadEventsFootfallAnalysis()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showEventsFootfallAnalysis()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_footfall" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelFootFall">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>                 
                     <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>

                 <a  style="cursor:pointer;"  class="dropdown-item" id="Facility_Name">Facility Name</a>
                 
             </div>
             </div>
                    <center><span class="fw-bold my-4" id="footfallNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="footfall_bar"></canvas>
                    </div></center>
                </div>`,
};

// let a35 = {
//   id: "a35",
//   x: a35_x,
//   y: a35_y,
//   w: a35_w,
//   h: a35_h,
//   content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
//                     <div class="green-shade"> 
//                         <span style=" text-align:left"><span id="cardZeroIncidentDays" class="count">0</span><br/>
//                         <span class=" text">Zero Incident Days</span></span>
//                         <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
//                         <a1 style="cursor: pointer;" onclick="downloadZeroIncidentDays()" data-toggle="popover"  title="Download Underlying Data" >
//                           <i class="fa fa-download"></i></a1>
//                     </div>
//                 </div>`,
// };

// let a62 = {
//   id: "a62",
//   x: a62_x,
//   y: a62_y,
//   w: a62_w,
//   h: a62_h,
//   content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
//                     <div class="pink-shade"> 
//                         <span style="margin-left:500px; margin-top:30px"><span id="cardTotalFlats" style="font-size:30px;" class="count">0</span><br/>
//                         <span class="text" style=" font-size:30px;">Total Flats</span></span>

//                         <a1 style="cursor: pointer;" onclick="downloadTotalflats()" data-toggle="popover"  title="Download Underlying Data" >
//                           <i class="fa fa-download"></i></a1>
//                     </div>
//                 </div>`,
// };
//  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>


// changes
let a34 = {
  id: "a34",
  x: a34_x,
  y: a34_y,
  w: a34_w,
  h: a34_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardLTIR" class="count">0</span><br/>
                    <span class=" text">LTIR</span>
                  </span>
                  <div id="loader_a34" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadLTIR()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a34()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};
// changes Refresh_a34
function Refresh_a34() {
  let cardLTIR = document.getElementById("cardLTIR");
  let loader = document.getElementById("loader_a34");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardLTIR.innerHTML = " "; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    let url;

    // Construct the URL based on globalType
    if (globalType === "daily") {
      url = getLTIR + idLink + "&date=" + globalDateFirst;
    } else {
      url = getLTIR + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateSecond;
    }

    xhr_object.open("GET", url, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunGetLTIR = JSON.parse(xhr_object.responseText);
        console.log("LTIR - ");
        console.log(resfunGetLTIR);

        // Check if data is absent or count is zero
        if (!resfunGetLTIR.response || resfunGetLTIR.response === 0) {
          console.log("No data or zero count received.");
          cardLTIR.innerHTML = "No data available";
        } else {
          cardLTIR.innerHTML = resfunGetLTIR.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        cardLTIR.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardLTIR.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  // function handleRefresh() {
  //   fetchData(); // Refresh the data
  // }

}
let a35 = {
  id: "a35",
  x: a35_x,
  y: a35_y,
  w: a35_w,
  h: a35_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="green-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardZeroIncidentDays" class="count">0</span><br/>
                    <span class=" text">Zero Incident Days</span>
                  </span>
                  <div id="loader_a35" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadZeroIncidentDays()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a35()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

// changes Refresh_a35
function Refresh_a35() {
  let cardZeroIncidentDays = document.getElementById("cardZeroIncidentDays");
  let loader = document.getElementById("loader_a35");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardZeroIncidentDays.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getZeroIncidentDays + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunGetZeroIncidentDays = JSON.parse(this.responseText);
        console.log("Zero Incidents - ");
        console.log(resfunGetZeroIncidentDays);

        // Check if data is absent or count is zero
        if (!resfunGetZeroIncidentDays.response || resfunGetZeroIncidentDays.response === 0) {
          console.log("No data or zero count received.");
          cardZeroIncidentDays.innerHTML = "No data available";
        } else {
          cardZeroIncidentDays.innerHTML = resfunGetZeroIncidentDays.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        cardZeroIncidentDays.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardZeroIncidentDays.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}


let a36 = {
  id: "a36",
  x: a36_x,
  y: a36_y,
  w: a36_w,
  h: a36_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="pink-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardIncidentPerSqFt" class="count">0</span><br/>
                    <span class=" text">Incident Per Million Sq Ft Per Annum</span>
                  </span>
                  <div id="loader_a36" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadIncidentPerSqFt()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a36()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a36() {
  let cardIncidentPerSqFt = document.getElementById("cardIncidentPerSqFt");
  let loader = document.getElementById("loader_a36");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardIncidentPerSqFt.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getIncidentPerSqFt + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunGetIncidentPerSqFt = JSON.parse(this.responseText);
        console.log("Incidents Per Sq. Ft. - ");
        console.log(resfunGetIncidentPerSqFt);

        // Check if data is absent or count is zero
        if (!resfunGetIncidentPerSqFt.response || resfunGetIncidentPerSqFt.response === 0) {
          console.log("No data or zero count received.");
          cardIncidentPerSqFt.innerHTML = "No data available";
        } else {
          cardIncidentPerSqFt.innerHTML = resfunGetIncidentPerSqFt.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        cardIncidentPerSqFt.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardIncidentPerSqFt.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}

let a37 = {
  id: "a37",
  x: a37_x,
  y: a37_y,
  w: a37_w,
  h: a37_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="pink-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardIncidentNearMissGoodCatch" class="count">0</span><br/>
                    <span class=" text">Incident Near Miss / Good Catch Per Million Sq Ft Per Annum</span>
                  </span>
                  <div id="loader_a37" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadIncidentNearMissGoodCatch()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a37()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a37() {
  let cardIncidentNearMissGoodCatch = document.getElementById("cardIncidentNearMissGoodCatch");
  let loader = document.getElementById("loader_a37");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardIncidentNearMissGoodCatch.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getIncidentNearMissGoodCatch + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunGetIncidentNearMissGoodCatch = JSON.parse(this.responseText);
        console.log("Incidents Near Miss Good Catch - ");
        console.log(resfunGetIncidentNearMissGoodCatch);

        // Check if data is absent or count is zero
        if (!resfunGetIncidentNearMissGoodCatch.response || resfunGetIncidentNearMissGoodCatch.response === 0) {
          console.log("No data or zero count received.");
          cardIncidentNearMissGoodCatch.innerHTML = "No data available";
        } else {
          cardIncidentNearMissGoodCatch.innerHTML = resfunGetIncidentNearMissGoodCatch.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        cardIncidentNearMissGoodCatch.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardIncidentNearMissGoodCatch.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}

let a41 = {
  id: "a41",
  x: a41_x,
  y: a41_y,
  w: a41_w,
  h: a41_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="pink-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardSafeManHours" class="count">0</span><br/>
                    <span class=" text">Safe Man Hours</span>
                  </span>
                  <div id="loader_a41" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadSafeManHours()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a41()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a41() {
  let cardSafeManHours = document.getElementById("cardSafeManHours");
  let loader = document.getElementById("loader_a41");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardSafeManHours.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getSafeManHours + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfunGetSafeManHours = JSON.parse(this.responseText);
        console.log("Safe Man Hours - ");
        console.log(resfunGetSafeManHours);

        // Check if data is absent or count is zero
        if (!resfunGetSafeManHours.response || resfunGetSafeManHours.response === 0) {
          console.log("No data or zero count received.");
          cardSafeManHours.innerHTML = "No data available";
        } else {
          cardSafeManHours.innerHTML = resfunGetSafeManHours.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        cardSafeManHours.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardSafeManHours.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}

let a38 = {
  id: "a38",
  x: a38_x,
  y: a38_y,
  w: a38_w,
  h: a38_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Incident Summary</span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_incidentSummary" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadRAC()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showRAC()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="tbl-container overflow-hidden h-auto p-0" style="width: 100%;">
                        <center> <table id="tblRCAinfo" style="width: 100%;margin-right:20px;  overflow-y:scroll" class="table table-bordered mx-4">
                                <thead>
                                    <th>Sr. No.</th>
                                    <th>Name of the site</th>
                                    <th>Location</th>
                                    <th>Incident date</th>
                                    <th>Time of incidence</th>
                                    <th>Incident Category</th>
                                    <th>Incident Brief</th>
                                    <th>Loss/Damage Evalution</th>
                                    <th>RCA</th>
                                    <th>Level</th>
                                    <th>Primary RCA Category</th>
                                    <th>Corrective Actions</th>
                                    <th>Preventive Actions</th>
                                    <th>Incident Status</th>
                                    <th>Action Owner</th>
                                    <th>Reason for pending</th>
                                </thead>
                                <tbody id="tablebodyRCA">
                                    
                                </tbody>
                            </table>
                        </center> 
                        <center id="loaderRCA" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                        <span>
                        <img height="100" width="100" src="assets/img/loader.svg"/></span>
                    </div>
                        </center>  
                        <center><span class="fw-bold my-4" id="RCANoData"><br><br><br>No Data Available</span></center>
                    </div>
                </div>`,
};


let a42 = {
  id: "a42",
  x: a42_x,
  y: a42_y,
  w: a42_w,
  h: a42_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b>Asset Breakdown Table</span>
                        <div class="parent col-md-2">
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadAssetsBreakdown()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showAssetsBreakdown()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="tbl-container overflow-hidden h-auto p-0" style="width: 100%;marign-left:100px">
                        <center> <table id="tblAssetsBreakdowninfo" class="table table-bordered mx-6" style="width: 75%; marign-left:100px">
                                <thead>
                                    <th>Sr. No.</th>
                                    <th>Asset name</th>
                                    <th>Breakdown Date</th>
                                    <th>Asset Code</th>
                                     <th>In Use Date</th>
                                     <th> Duration</th>
                                     <th>Comments</th>
                                   
                                   
                                </thead>
                                <tbody id="tablebodyAssetsBreakdown">
                                    
                                </tbody>
                            </table>
                        </center> 
                        <center id="loaderAssetsBreakdown" class="mt-4"><br><br><br>
                            <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                        </center>  
                        <center><span class="fw-bold my-4" id="assetsBreakdownNoData"><br><br><br>No Data Available</span></center>
                    </div>
                </div>`,



};


let a74 = {
  id: "a74",
  x: a74_x,
  y: a74_y,
  w: a74_w,
  h: a74_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Facilities Info</span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_FacilitiesInfo" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadFacilityInfo()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showFacilityInfo()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="tbl-container p-0" style="width: 100%;marign-left:100px;height: 480px; overflow: scroll;">
                        <center> <table id="tblfacilityinfo" class="table table-bordered mx-6" style=" marign-left:100px">
                                <thead>
                                    <th>Sr. No.</th>
                                    <th>Facility Name</th>
                                 
                                    <th>Booked By</th>
                                    <th>Booking Status</th>
                                    <th>Tower</th>
                                  
                                    <th>Schedule Date</th>
                                    <th>Schedule Slot</th>
                                   
                                   
                                   
                                </thead>
                                <tbody id="tablebodyfacilityinfo">
                                    
                                </tbody>
                            </table>
                        </center> 
                        <center id="loaderfacilityinfo" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                        <span>
                        <img height="100" width="100" src="assets/img/loader.svg"/></span>
                    </div>
                        </center>  
                        <center><span class="fw-bold my-4" id="facilityinfoNoData"><br><br><br>No Data Available</span></center>
                    </div>
                </div>`,



};
// tblfacilityinfo,tablebodyfacilityinfo,loaderfacilityinfo,facilityinfoNoData


let a68 = {
  id: "a68",
  x: a68_x,
  y: a68_y,
  w: a68_w,
  h: a68_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Executive Escalation </span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_executive" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadExecutiveEscalation()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showExecutiveEscalation()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="tbl-container">
                        <center> <table id="tblExecutiveEscalationinfo" class="table table-bordered" >
                                <thead>
                                    
                                    <th>Ticket Number</th>
                                    <th>Description</th>
                                    <th>Community Head</th>
                                    <th>Category</th>
                                    <th> Sub Category</th>
                                    <th>Ticket Status</th>
                                    <th>Created On </th>
                                    <th>Flat </th>
                                  
                                   
                                </thead>
                                <tbody id="tablebodyExecutiveEscalation">
                                    
                                </tbody>
                            </table>
                        </center> 
                        <center id="loaderExecutiveEscalation" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                        <span>
                        <img height="100" width="100" src="assets/img/loader.svg"/></span>
                    </div>
                        </center>  
                        <center><span class="fw-bold my-4" id="executiveEscalationNoData"><br><br><br>No Data Available</span></center>
                    </div>
                </div>`,

  // tblExecutiveEscalationinfo , tablebodyExecutiveEscalation ,loaderExecutiveEscalation ,executiveEscalationNoData


};
let a44 = {
  id: "a44",
  x: a44_x,
  y: a44_y,
  w: a44_w,
  h: a44_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Level Wise Incidents</span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_levelIncidents" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadPyramid()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showPyramid()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_incidentlevel" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                 <span class="dropdown-item" id="listItemLabelIncidentLevel">Incident: </span>
                 <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>
                 <a  style="cursor:pointer;" class="dropdown-item" id="Primary_Category" >Primary Category </a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Secondary_Category">Secondary Category</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Created_Date">Created Date</a>
                 <a  style="cursor:pointer;"  class="dropdown-item" id="Level_Wise">Level Wise</a>                
                  <a  style="cursor:pointer;"  class="dropdown-item" id="Reported_By">Reported By</a>

             </div>
           
         </div>
                    <center id="loaderPyramid" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="chartPyramidNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; height:300px;" class="card-body">
                      <canvas id="chartPyramid"></canvas>
                    </div>

                    </center>
                </div>
            
         `,
};
{/* <div class="col-sm-1 child mx-2">
<a style="cursor: pointer;" id="refreshIconElement_incidentlevel" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
  </div> */}



// let a45 = {
//   id: "a45",
//   x: a45_x,
//   y: a45_y,
//   w: a45_w,
//   h: a45_h,
//   content: `<div style="height: 100%; width: 100%;">
//                     <div style="width:100%; background-color:#fff; padding: 10px;">
//                     <div class="row">
//                         <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Injury Chart</span>
//                         <div class="parent col-md-3">
//                             <div class="col-sm-1 child mx-2">
//                                 <a style="cursor: pointer;"  onclick="downloadInjuryIllness()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
//                             </div>
//                             <div class="col-sm-1 child mx-2">
//                                 <img height="15" width="15" onclick="showIncidentII()" src="assets/img/xmark-solid.svg"/>
//                             </div>
//                         </div>
//                     </div>
//                   </div>
//                     <hr class="mt-0" />
//                     <center id="loaderIncidentII" class="mt-4"><br><br><br>
//                         <div class="mt-4 spinner-border" role="status">
//                             <span class="sr-only"></span>
//                         </div>
//                     </center>
//                     <center><span class="fw-bold my-4" id="incidentIINoData"><br><br><br>No Data Available</span></center>
//                     <center>
//                     <div style="background-color:#fff; class="card-body"><canvas id="incident_II_pie"></canvas></div></center>
//                     <span class="col-4 ml-2">
//                       <div style="padding:10px;">
//                           <p align="left" id="incidentSpan"></p>
//                       </div>
//                      </span>


//                 </div>`,
// };

let a46 = {
  id: "a46",
  x: a46_x,
  y: a46_y,
  w: a46_w,
  h: a46_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Primary Root Cause Category</span>
                        <div class="parent col-md-3">
                         <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_primaryRoot" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadRootCause()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showRootCause()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" />
                    
                    <center id="loaderRootCause" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="rootCauseNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; class="card-body">
                    <canvas id="root_Cause_pie"></canvas>
                    </div></center>
                    <span class="col-4 ml-2">
                      <div style="padding:10px;">
                          <p align="left" id="incidentRoot"></p>
                      </div>
                     </span>
                   
          </div>`,
};


let a64 = {
  id: "a64",
  x: a64_x,
  y: a64_y,
  w: a64_w,
  h: a64_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Body Injury Chart</span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_bodyInjury" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadBodyInjuryChart()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showBodyInjuryChart()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" />
                    
                    <center id="loaderBodyInjuryChart" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>

                    <center><span class="fw-bold my-4" id="bodyInjuryChartNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; class="card-body">
                    <img  id="bodyInjuryChart" name="bodyInjuryChart"  width=600px height=600px  src="src="https://reports.lockated.com:8000/media/body_injury/8756975713423273.png"" alt="">
                    </div></center>
                    <span class="col-4 ml-2">
                      <div style="padding:10px;">
                          <p align="center" ></p>
                      </div>
                     </span>
            </div>`,
};

let a80 = {
  id: "a80",
  x: a80_x,
  y: a80_y,
  w: a80_w,
  h: a80_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardRegisterdUser" class="count">0</span><br/>
                    <span class=" text">Total Registered Users</span>
                  </span>
                  <div id="loader_a80" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadRegisteredUsers()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a80()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a80() {
  let cardRegisterdUser = document.getElementById("cardRegisterdUser");
  let loader = document.getElementById("loader_a80");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardRegisterdUser.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getTotalusers + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        totalUsrers = JSON.parse(this.responseText);
        console.log("Asset Total - ");
        console.log(totalUsrers);

        if (!totalUsrers.response || totalUsrers.response === 0) {
          console.log("No data or zero count received.");
          cardRegisterdUser.innerHTML = "No data available";
        } else {
          cardRegisterdUser.innerHTML = totalUsrers.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        cardRegisterdUser.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardRegisterdUser.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}


let a81 = {
  id: "a81",
  x: a81_x,
  y: a81_y,
  w: a81_w,
  h: a81_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardDownloads" class="count">0</span><br/>
                    <span class=" text">Total Downloads</span>
                  </span>
                  <div id="loader_a81" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadDownloads()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a81()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

function Refresh_a81() {
  let cardDownloads = document.getElementById("cardDownloads");
  let loader = document.getElementById("loader_a81");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardDownloads.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getTotalDownloads + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let totalDownloads = JSON.parse(this.responseText);
        console.log("Asset Download data - ");
        console.log(totalDownloads);

        // Check if data is absent or count is zero
        if (!totalDownloads.response || totalDownloads.response === 0) {
          console.log("No data or zero count received.");
          cardDownloads.innerHTML = "No data available";
        } else {
          cardDownloads.innerHTML = totalDownloads.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        cardDownloads.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardDownloads.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}
let a82 = {
  id: "a82",
  x: a82_x,
  y: a82_y,
  w: a82_w,
  h: a82_h,
  content: `<div style="height: 100%; width: 100%;">
                <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></i></b>Zone Wise Escalation</span>
                        <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_ZoneWise" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadExecutiveEscalation()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="show()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                </div>
                    <hr class="mt-0"/>
                    <center id="loaderSiteWiseEscalation" class="mt-4"><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="SiteWiseEscalationNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-5" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="SiteWiseEscalation"></canvas>
                    </div></center>
                </div>`,

  // SiteWiseEscalation,loaderSiteWiseEscalation,SiteWiseEscalationNoData
};

let a83 = {
  id: "a83",
  x: a83_x,
  y: a83_y,
  w: a83_w,
  h: a83_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                      <div class="row">
                     
                      
                     
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Open & Close Escalation</span>
                        <div class="parent col-md-3">
                            <div class="col-sm-1 child mx-2">
                            <a style="cursor: pointer;" id="refreshIconElement_openClose" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadExecutiveEscalation()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="show()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                      </div>
                    </div>
                    <hr class="mt-0" /><br><br><br>

                    
                    <div class="custom-dropdown" id="custom-dropdown">
                      <div id="dataDropdown_openClose" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                      <div style="display:flex;">
                      <span class="dropdown-item" id="listItemLabelOpenClose">Ticket: </span>
                      <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                      </div>                       
                       <a  style="cursor:pointer;"class="dropdown-item" id="Tower">Tower </a>

                        <a  style="cursor:pointer;"  class="dropdown-item" id="Created_By">Created By</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Number">Ticket Number</a>
                        
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Category">Category</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Sub_Category">Sub Category</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Assign_To">Assign To</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Created_Date">Created Date To</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Rating">Rating</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Ticket_Type">Ticket Type</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Service_Type">Service Type</a>
                        <a  style="cursor:pointer;"  class="dropdown-item" id="Related_To">Related To</a>
                      </div>
                    </div>
                   
                                        
                    <center id="loaderOpenCloseEscalation" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    
                    
                    <center><div style="background-color:#fff; height:300px;" class="card-body">
                    <canvas id="OpenCloseEscalation"></canvas>
                    </div></center>
                   
          </div>`,
  // loaderOpenCloseEscalation,OpenCloseEscalationNoData,OpenCloseEscalation
  // <center><span class="fw-bold my-4" id="OpenCloseEscalationNoData"><br><br><br>No Data Available</span></center>
};

let a84 = {
  id: "a84",
  x: a84_x,
  y: a84_y,
  w: a84_w,
  h: a84_h,
  content: `<div style="height: 100%; width: 100%;">
  <div style="width:100%; background-color:#fff; padding: 10px;">
  <div class="row">
      <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b>Category-Wise Executive Escalation</b></span>
      <div class="parent col-md-3">
        <div class="col-sm-1 child mx-2">
                          <a style="cursor: pointer;" id="refreshIconElement_categoryExecutive" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                           </div>
          <div class="col-sm-1 child mx-2">
              <a style="cursor: pointer;" onclick="downloadCategoryEscalation()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
          </div>
          <div class="col-sm-1 child mx-2">
              <img height="15" width="15"  onclick="showTickets()" src="assets/img/xmark-solid.svg"/>
          </div>
      </div>
  </div>
</div>
                    <hr class="mt-0"/>
                    <center id="loaderCategoryEscalation" class="mt-4"><br><br><br><br>
                    <div class="mt-4" role="status">
                    <span>
                    <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="NoDataCategoryEscalation"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="background-color:#fff; class="card-body">
                        <canvas id="CategoryEscalation"></canvas>
                    </div></center>
                </div>`,
}

let a85 = {
  id: "a85",
  x: a85_x,
  y: a85_y,
  w: a85_w,
  h: a85_h,
  content: `<div style="height: 100%; width: 100%;">
  <div style="width:100%; background-color:#fff; padding: 10px;">
  <div class="row">
      <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Service Partner Evaluation </span>
      <div class="parent col-md-3">
       <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_servicePartner" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
          <div class="col-sm-1 child mx-2">
              <a style="cursor: pointer;" onclick="downloadAuditScore()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
          </div>
          <div class="col-sm-1 child mx-2">
              <img height="15" width="15" onclick="showServicePartnerEvaluation()" src="assets/img/xmark-solid.svg"/>
          </div>
      </div>
  </div>
</div>
  <hr class="mt-0" /><br>
  <div class="tbl-container">
      <center> <table id="tblAuditScoreinfo" class="table table-bordered" >
              <thead>
                  
              <th>Sr No.</th>
              <th>Vendor Name</th>
              <th>Average Rating</th>
              <th>Date</th>
              <th>Site</th>
              <th>Percentage</th>
                
                 
              </thead>
              <tbody id="tablebodyAuditScore">
                  
              </tbody>
          </table>
      </center> 
      <center id="loaderAuditScore" class="mt-4"><br><br><br>
      <div class="mt-4" role="status">
      <span>
      <img height="100" width="100" src="assets/img/loader.svg"/></span>
  </div>
      </center>  
      <center><span class="fw-bold my-4" id="AuditScoreNoData"><br><br><br>No Data Available</span></center>
  </div>
</div>`,
};

// -------------------------------------------------------


let a100 = {
  id: "a100",
  x: a100_x,
  y: a100_y,
  w: a100_w,
  h: a100_h,
  content: `<div style="height: 100%; width: 100%;">
                      <div style="background-color:#fff;" class="card-header row">
                          <div class="row">
                          <span  id="dt3"  align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Cluster Wise Total Steps Taken</span>
                          <div class="parent col-md-3">
                              <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_custerStats" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;"  onclick="downloadClusterWiseTotal()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showClusterWise()" src="assets/img/xmark-solid.svg"/>
                              </div>
                          </div>
                        </div>
                      </div>
                      <div class="custom-dropdown" id="custom-dropdown">
                        <div id="dataDropdown_custerStats" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                        <div style="display:flex;">
                        <span class="dropdown-item" id="listItemLabelCusterStats">Ticket: </span>
                        <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                        </div>                           
                        <a  style="cursor:pointer;"class="dropdown-item" id="User_Name">User Name </a>
                          
                        </div>
           
                      </div>
                      
                      <center id="loaderClusterStats" class="mt-4"><br><br><br>
                          <div class="mt-4 spinner-border" role="status">
                              <span class="sr-only"></span>
                          </div>
                      </center>
                      <center><span class="fw-bold my-4" id="clusterStatsNoData"><br><br><br>No Data Available</span></center>
                     
                     <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                          <canvas id="cluster-stats"></canvas>
                      </div></center>
                  </div>`,
  // listItemLabelCusterStats     dataDropdown_custerStats
};

let a101 = {
  id: "a101",
  x: a101_x,
  y: a101_y,
  w: a101_w,
  h: a101_h,
  content: `<div style="height: 100%; width: 100%;">
                      <div style="background-color:#fff;" class="card-header row">
                    
                          <div class="row">
                          <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Function Wise Total Steps Taken</span>
                          <div class="parent col-md-3">
                              <div class="col-sm-1 child mx-2">
                              <a style="cursor: pointer;" id="refreshIconElement_dailyStepStats" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                                  <a style="cursor: pointer;"  onclick="downloadFunctionWiseTotal()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                              </div>
                              <div class="col-sm-1 child mx-2">
                              <img height="15" width="15" onclick="showFunctionWise()" src="assets/img/xmark-solid.svg"/>
                            </div>
                          </div>
                      </div>
                      </div>
                      <div class="custom-dropdown" id="custom-dropdown">
                        <div id="dataDropdown_dailyStepStats" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                        <div style="display:flex;">
                        <span class="dropdown-item" id="listItemLabelDailyStepStats">Ticket: </span>
                        <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                      </div>                          
                       <a  style="cursor:pointer;"class="dropdown-item" id="User_Name">User Name </a>
                          
                        </div>
           
                      </div>
                      
                      <center id="loaderDailyStep" class="mt-4"><br><br><br>
                          <div class="mt-4 spinner-border" role="status">
                              <span class="sr-only"></span>
                          </div>
                      </center>
                      <center><span class="fw-bold my-4" id="dailyStepNoData"><br><br><br>No Data Available</span></center>
                     
                      <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                          <canvas id="barChartDailyStep"></canvas>
                      </div></center>
                  </div>`,
  // refreshIconElement_dailyStepStats   listItemLabelDailyStepStats   dataDropdown_dailyStepStats

};

let a102 = {
  id: "a102",
  x: a102_x,
  y: a102_y,
  w: a102_w,
  h: a102_h,
  content: `<div style="height: 100%; width: 100%;">
           
              <div style="background-color:#fff;" class="card-header row">
                          <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Gender Participation</span>
                        <div class="parent col-md-3">
                            <div class="col-sm-1 child mx-2">
                            <a style="cursor: pointer;" id="refreshIconElement_genderParticipation" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadGenderParticipation()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                              <img height="15" width="15" onclick="showGenderParticipation()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                      </div>
                <div class="custom-dropdown" id="custom-dropdown">
                    <div id="dataDropdown_genderParticipation" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                    <div style="display:flex;">
                    <span class="dropdown-item" id="listItemLabelGenderParticipation">Ticket: </span>
                    <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                    </div>                      
                     <a  style="cursor:pointer;"class="dropdown-item" id="User_Name">User Name </a>
                   
             
                    </div>
               
             
                </div>
              
              <center id="loaderGender" class="mt-4"><br><br><br>
                  <div class="mt-4 spinner-border" role="status">
                      <span class="sr-only"></span>
                  </div>
              </center>
              <center><span class="fw-bold my-4" id="genderNoData"><br><br><br>No Data Available</span></center>
            
            <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                  <canvas id="genderParticipation"></canvas>
              </div></center>
            </div>`,
  // refreshIconElement_genderParticipation  dataDropdown_genderParticipation
  // listItemLabelGenderParticipation
};

let a103 = {
  id: "a103",
  x: a103_x,
  y: a103_y,
  w: a103_w,
  h: a103_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row">
                        <div class="row">
                            <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1"></span>
                            <img class="col-md-1 my-2" height="15" width="15" onclick="showTrendsOverMonthSites()" src="assets/img/xmark-solid.svg" />
                        </div>
                    </div>
                        <div class="col-md-12 row">
                            <div class="col-md-6 d-flex border-end row">
                                <div >
                                  <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Inventory Cost Trend Over The Months </span>
                                   <div style="float:right;">
                                        <a style="cursor: pointer;" id="refreshIconElement_trendOverMonth" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a> &nbsp;
                                      
                                        <a style="cursor: pointer; float:right;" onclick="downloadTrendsMonths()" data-toggle="popover" title="Download Underlying Data">
                                        <img height="15" width="15" src="assets/img/download.png"/></a>
                                    </div> 
                                </div>
                                
                                <div class="custom-dropdown" id="custom-dropdown">
                                  <div id="dataDropdown_trendOverMonth" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                                  <div style="display:flex;">
                                  <span class="dropdown-item" id="listItemLabelTrendOverMonth">Ticket: </span>
                                  <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                                  </div>                                       
                                   <a  style="cursor:pointer;"class="dropdown-item" id="Inventory_Name">Inventory Name </a>
                                      <a  style="cursor:pointer;" class="dropdown-item" id="Inventory_Type" >Inventory Type </a>
                                    
                                    
                                  </div>
                                </div>

                                <center id="loaderTrendsMonths" class="mt-4">
                               <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                                </center>
                               
                                <center><br>
                                      <span class="fw-bold my-4" id="TrendsMonthsNoData">No Data Available</span>
                                </center>
                                <center><div style="background-color:#fff; height:300px; class="card-body mt-4">
                                    <canvas id="trendsOverMonths" ></canvas>
                                </div></center>
                            </div>

                            <div class="col-md-6 d-flex row ">
                               
                                <div>
                                  <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Inventory Cost Trend Over All The Sites</span>
                                  <div style="float:right;">
                                    <a style="cursor: pointer;" id="refreshIconElement_trendsOverSites" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                                    &nbsp;
                                    <a style="cursor: pointer;" onclick="downloadTrendsSites()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" style="margin-bottom:10px;" src="assets/img/download.png"/></a>
                                  </div>

                                </div>
                                   <div class="custom-dropdown" id="custom-dropdown">
                                      <div id="dataDropdown_trendsOverSites" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:auto;">
                                      <div style="display:flex;">
                                      <span class="dropdown-item" id="listItemLabelTrendsOverSites">Ticket: </span>
                                      <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                                      </div>                                     
                                       <a  style="cursor:pointer;"class="dropdown-item" id="Inventory_Name">Inventory Name </a>
                                      <a  style="cursor:pointer;" class="dropdown-item" id="Inventory_Type" >Inventory Type </a>
                
                 
                                      </div>
                                   </div>
                                <center id="loaderTrendsSites" class="mt-4">
                               <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                                </center>
                                    
                                <center><br>
                                    <span class="fw-bold my-4" id="TrendsSitesNoData">No Data Available</span>
                                </center>

                                <center>
                                    <div style="background-color:#fff; height:300px;" class="card-body mt-4">
                                      <canvas id="trendsOverSites"></canvas>
                                    </div>
                                </center>

                                <span class="col-4 ml-2">
                                    <div>
                                        <p align="left" id="wsLPCD"></p>
                                    </div>
                                </span>
                            </div>
                        </div>      
    </div>
                </div>`,
  // refreshIconElement_trendOverMonth   dataDropdown_trendOverMonth  listItemLabelTrendOverMonth
  // dataDropdown_trendsOverSites , listItemLabelTrendsOverSites,refreshIconElement_trendsOverSites
  // <span class="dropdown-item" id="listItemLabelTrendsOverSites">Ticket: </span>
};

// showTotalVisitors2(),loaderTotalVisitorsII,totalVisitorsNoDataII,total-visitors-II  refreshIconElement_totalVisitorII  dataDropdown_totalVisitorII  listItemLabelTotalVisitorII
let a104 = {
  id: "a104",
  x: a104_x,
  y: a104_y,
  w: a104_w,
  h: a104_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="background-color:#fff;" class="card-header row">  
                    <div class="row">
                    <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Total Visitors II</span>
                    <div class="parent col-md-3">
                        <div class="col-sm-1 child mx-2">
                        <a style="cursor: pointer;" id="refreshIconElement_totalVisitorII" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                        </div>
                        <div class="col-sm-1 child mx-2">
                            <a style="cursor: pointer;"  onclick="downloadTotalVisitorsChartII()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                        </div>
                        <div class="col-sm-1 child mx-2">
                        <img height="15" width="15" onclick="showTotalVisitors2()" src="assets/img/xmark-solid.svg"/>
                      </div>
                    </div>
                </div>
                </div>
                    <div class="custom-dropdown" id="custom-dropdown">
                        <div id="dataDropdown_totalVisitorII" class=" dropdown-menu" style="height:300px;overflow-y:scroll;inset:0 ; position:absolute; width:fit-content;margin:60px;">
                        <div style="display:flex;">
                        <span class="dropdown-item" id="listItemLabelTotalVisitorII">Ticket: </span>
                        <span > <img  id="closeDropdown" height="15" width="15" src="assets/img/xmark-solid.svg"/></span>
                        </div>                         
                         <a  style="cursor:pointer;"class="dropdown-item" id="type_of_visitor">Type of visitor </a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="created_by" >Created By </a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="purpose" >Purpose</a>
                        <a  style="cursor:pointer;" class="dropdown-item" id="visiting_to" >Visiting To </a>


                        </div>
                    </div>
                    <center id="loaderTotalVisitorsII" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="totalVisitorsNoDataII"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="total-visitors-II"></canvas>
                    </div></center>
                </div>`,
};



let a105 = {
  id: "a105",
  x: a105_x,
  y: a105_y,
  w: a105_w,
  h: a105_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visTotalVisitorsCards" class="count">0</span><br/>
                    <span class=" text">Total Visitors</span>
                  </span>
                  <div id="loader_a105" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadVisitors()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a105()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

function Refresh_a105() {
  let visTotalVisitorsCards = document.getElementById("visTotalVisitorsCards");
  let loader = document.getElementById("loader_a105");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visTotalVisitorsCards.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    let url;
    if (globalType === "daily") {
      url = getVisitorsCards + idLink + "&date=" + globalDateFirst;
    } else {
      url = getVisitorsCards + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateSecond;
    }

    xhr_object.open("GET", url, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunVisitorsCards = JSON.parse(xhr_object.responseText);
        console.log("Visitors cards----------------- - ");
        console.log(resfunVisitorsCards);

        if (resfunVisitorsCards && resfunVisitorsCards.response && resfunVisitorsCards.response.totalVisitors) {
          visTotalVisitorsCards.innerHTML = resfunVisitorsCards.response.totalVisitors;
        } else {
          visTotalVisitorsCards.innerHTML = "No data available";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visTotalVisitorsCards.innerHTML = "No data available";
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}

let a106 = {
  id: "a106",
  x: a106_x,
  y: a106_y,
  w: a106_w,
  h: a106_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="green-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visExpectedVisitorsCards" class="count">0</span><br/>
                    <span class=" text">Expected Visitors</span>
                  </span>
                  <div id="loader_a106" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadExpectedVisitors()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a106()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

function Refresh_a106() {
  let visExpectedVisitorsCards = document.getElementById("visExpectedVisitorsCards");
  let loader = document.getElementById("loader_a106");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visExpectedVisitorsCards.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    let url;
    if (globalType === "daily") {
      url = getVisitorsCards + idLink + "&date=" + globalDateFirst;
    } else {
      url = getVisitorsCards + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateSecond;
    }

    xhr_object.open("GET", url, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunVisitorsCards = JSON.parse(xhr_object.responseText);
        console.log("Visitors cards----------------- - ");
        console.log(resfunVisitorsCards);

        if (resfunVisitorsCards && resfunVisitorsCards.response && resfunVisitorsCards.response.expectedVisitors) {
          visExpectedVisitorsCards.innerHTML = resfunVisitorsCards.response.expectedVisitors;
        } else {
          visExpectedVisitorsCards.innerHTML = "No data available";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visExpectedVisitorsCards.innerHTML = "No data available";
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}


let a107 = {
  id: "a107",
  x: a107_x,
  y: a107_y,
  w: a107_w,
  h: a107_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="pink-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visUnExpectedVisitorsCards" class="count">0</span><br/>
                    <span class=" text">UnExpected Visitors</span>
                  </span>
                  <div id="loader_a107" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadUnExpectedVisitors()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a107()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a107() {
  let visUnExpectedVisitorsCards = document.getElementById("visUnExpectedVisitorsCards");
  let loader = document.getElementById("loader_a107");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visUnExpectedVisitorsCards.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    
    let url;
    if (globalType === "daily") {
      url = getVisitorsCards + idLink + "&date=" + globalDateFirst;
    } else {
      url = getVisitorsCards + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateSecond;
    }

    xhr_object.open("GET", url, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunVisitorsCards = JSON.parse(xhr_object.responseText);
        console.log("Visitors cards----------------- - ");
        console.log(resfunVisitorsCards);

        if (resfunVisitorsCards && resfunVisitorsCards.response && resfunVisitorsCards.response.unexpectedVisitors) {
          visUnExpectedVisitorsCards.innerHTML = resfunVisitorsCards.response.unexpectedVisitors;
        } else {
          visUnExpectedVisitorsCards.innerHTML = "No data available";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visUnExpectedVisitorsCards.innerHTML = "No data available";
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}



let a108 = {
  id: "a108",
  x: a108_x,
  y: a108_y,
  w: a108_w,
  h: a108_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="yellow-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visTotalGatePass" class="count">0</span><br/>
                    <span class=" text">Total Gate Pass</span>
                  </span>
                  <div id="loader_a108" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadTotalGatePass()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a108()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

function Refresh_a108() {
  let visTotalGatePass = document.getElementById("visTotalGatePass");
  let loader = document.getElementById("loader_a108");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visTotalGatePass.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    
    if (globalType == "daily") {
      xhr_object.open("GET", getVisitorsCards + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getVisitorsCards + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond, true);
    }

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfunVisitors = JSON.parse(this.responseText);
        console.log("Visitors cards----------------- - ");
        console.log(resfunVisitors);
        
        // Check if response exists and if totalGatePass is not equal to 0
        if (resfunVisitors.response && resfunVisitors.response.totalGatePass !== 0) {
          visTotalGatePass.innerHTML = resfunVisitors.response.totalGatePass + "";
        } else {
          visTotalGatePass.innerHTML = "No data available"; // Show "No data available" message if no data or data count is 0
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visTotalGatePass.innerHTML = "No data available"; // Show "No data available" on error
      }
    
      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}
let a109 = {
  id: "a109",
  x: a109_x,
  y: a109_y,
  w: a109_w,
  h: a109_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="red-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visReturnGatePass" class="count">0</span><br/>
                    <span class=" text">Returnable Gate Pass Issued</span>
                  </span>
                  <div id="loader_a109" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadReturnGatePass()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a109()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a109() {
  let visReturnGatePass = document.getElementById("visReturnGatePass");
  let loader = document.getElementById("loader_a109");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visReturnGatePass.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getVisitorsCards + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunVisitorsCards = JSON.parse(this.responseText);
        console.log("Visitors cards----------------- - ");
        console.log(resfunVisitorsCards);

        if (resfunVisitorsCards && resfunVisitorsCards.response && resfunVisitorsCards.response.returnable_gatePass) {
          visReturnGatePass.innerHTML = resfunVisitorsCards.response.returnable_gatePass;
        } else {
          visReturnGatePass.innerHTML = "No data available";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visReturnGatePass.innerHTML = "No data available";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}


let a110 = {
  id: "a110",
  x: a110_x,
  y: a110_y,
  w: a110_w,
  h: a110_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visNonReturnGatePass" class="count">0</span><br/>
                    <span class=" text">Non-Returnable Gate Pass Issued</span>
                  </span>
                  <div id="loader_a110" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadNonReturnGatePass()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a110()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a110() {
  let visNonReturnGatePass = document.getElementById("visNonReturnGatePass");
  let loader = document.getElementById("loader_a110");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visNonReturnGatePass.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getVisitorsCards + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        resfunVisitorsCards = JSON.parse(this.responseText);
        console.log("Visitors cards----------------- - ");
        console.log(resfunVisitorsCards);

        if (resfunVisitorsCards && resfunVisitorsCards.response && resfunVisitorsCards.response.non_returnable_gatePass) {
          visNonReturnGatePass.innerHTML = resfunVisitorsCards.response.non_returnable_gatePass;
        } else {
          visNonReturnGatePass.innerHTML = "No data available";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visNonReturnGatePass.innerHTML = "No data available";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}

let a111 = {
  id: "a111",
  x: a111_x,
  y: a111_y,
  w: a111_w,
  h: a111_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="pink-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visTotalStaffCard" class="count">0</span><br/>
                    <span class=" text">Total Staff</span>
                  </span>
                  <div id="loader_a111" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadTotalStaff()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a111()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_a111() {
  let visTotalStaffCard = document.getElementById("visTotalStaffCard");
  let loader = document.getElementById("loader_a111");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visTotalStaffCard.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getStaff + idLink, true);

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfunStaff = JSON.parse(this.responseText);
        console.log("Staff - ");
        console.log(resfunStaff);

        if (!resfunStaff.response || resfunStaff.response === 0) {
          console.log("No data or zero count received.");
          visTotalStaffCard.innerHTML = "No data available";
        } else {
          visTotalStaffCard.innerHTML = resfunStaff.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visTotalStaffCard.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      visTotalStaffCard.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}


let a112 = {
  id: "a112",
  x: a112_x,
  y: a112_y,
  w: a112_w,
  h: a112_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="yellow-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visStaffInCard" class="count">0</span><br/>
                    <span class=" text">Staff In</span>
                  </span>
                  <div id="loader_a112" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadStaffIn()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a112()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

// changes Refresh_a112
function Refresh_a112() {
  let visStaffInCard = document.getElementById("visStaffInCard");
  let loader = document.getElementById("loader_a112");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visStaffInCard.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    // Condition based on globalType
    if (globalType == "daily") {
      xhr_object.open(
        "GET",
        getStaffIn + idLink + "&date=" + globalDateFirst,
        true
      );
      console.log(getStaffIn + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object.open(
        "GET",
        getStaffIn +
          idLink +
          "&from_date=" +
          globalDateFirst +
          "&to_date=" +
          globalDateSecond,
        true
      );
      console.log(
        getStaffIn +
          idLink +
          "&from_date=" +
          globalDateFirst +
          "&to_date=" +
          globalDateSecond
      );
    }

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfunStaffIn = JSON.parse(this.responseText);
        console.log("Staff In - ");
        console.log(resfunStaffIn);

        if (!resfunStaffIn.response || resfunStaffIn.response === 0) {
          console.log("No data or zero count received.");
          visStaffInCard.innerHTML = "No data available";
        } else {
          visStaffInCard.innerHTML = resfunStaffIn.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visStaffInCard.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      visStaffInCard.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}

let a113 = {
  id: "a113",
  x: a113_x,
  y: a113_y,
  w: a113_w,
  h: a113_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="red-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="visStaffOutCard" class="count">0</span><br/>
                    <span class=" text">Staff Out</span>
                  </span>
                  <div id="loader_a113" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadStaffOut()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_a113()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};

// Refresh_a113

function Refresh_a113() {
  let visStaffOutCard = document.getElementById("visStaffOutCard");
  let loader = document.getElementById("loader_a113");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    visStaffOutCard.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    // Condition based on globalType
    if (globalType == "daily") {
      xhr_object.open(
        "GET",
        getStaffOut + idLink + "&date=" + globalDateFirst,
        true
      );
      console.log(getStaffOut + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object.open(
        "GET",
        getStaffOut +
          idLink +
          "&from_date=" +
          globalDateFirst +
          "&to_date=" +
          globalDateSecond,
        true
      );
      console.log(
        getStaffOut +
          idLink +
          "&from_date=" +
          globalDateFirst +
          "&to_date=" +
          globalDateSecond
      );
    }

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfunStaffOut = JSON.parse(this.responseText);
        console.log("Staff Out - ");
        console.log(resfunStaffOut);

        if (!resfunStaffOut.response || resfunStaffOut.response === 0) {
          console.log("No data or zero count received.");
          visStaffOutCard.innerHTML = "No data available";
        } else {
          visStaffOutCard.innerHTML = resfunStaffOut.response + "";
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        visStaffOutCard.innerHTML = "No data available"; // Show error message
      }

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      visStaffOutCard.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}


let b70 = {
  id: "b70",
  x: b70_x,
  y: b70_y,
  w: b70_w,
  h: b70_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="orange-shade"> 
                        <span style="text-align:left"><span id="cardTotalParking" class="count">0</span><br/>
                        <span class="text">Total Parking</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                        <div id="loader_b70" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                        <a1 style="cursor: pointer;" onclick="downloadTotalParking()" data-toggle="popover"  title="Download Underlying Data" >
                          <i class="fa fa-download"></i></a1>
                          <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b70()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                    </div>
                </div>`,
};

function Refresh_b70() {
  let cardTotalParking = document.getElementById("cardTotalParking");
  let loader = document.getElementById("loader_b70");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardTotalParking.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getParking + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);

    xhr_object.onload = function () {
      let resfunCardParking = JSON.parse(this.responseText);
      console.log("Parking----------- - ");
      console.log(resfunCardParking);

      // Update HTML elements with values from the response
      cardTotalParking.innerHTML = resfunCardParking.total_parking + "";

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardTotalParking.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}


let b71 = {
  id: "b71",
  x: b71_x,
  y: b71_y,
  w: b71_w,
  h: b71_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="green-shade"> 
                        <span style="text-align:left"><span id="cardFreeParking" class="count">0</span><br/>
                        <span class="text">Free Parking</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                        <div id="loader_b71" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                        <a1 style="cursor: pointer;" onclick="downloadFreeParking()" data-toggle="popover"  title="Download Underlying Data" >
                          <i class="fa fa-download"></i></a1>
                          <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b71()" title="Refresh Content" >
                        <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                    </div>
                </div>`,
};

function Refresh_b71() {
  let cardFreeParking = document.getElementById("cardFreeParking");
  let loader = document.getElementById("loader_b71");

  // Function to fetch free parking data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardFreeParking.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getPaidFreeParking + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);

    xhr_object.onload = function () {
      let resfunCardParkingPaidFree = JSON.parse(this.responseText);
      console.log("Free Parking - ");
      console.log(resfunCardParkingPaidFree);

      // Update HTML element with free parking data
      cardFreeParking.innerHTML = resfunCardParkingPaidFree.response.free_parking + "";

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardFreeParking.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch for free parking
  fetchData();

  // Function to handle refresh button click for free parking
  function handleRefresh() {
    fetchData(); // Refresh the free parking data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}


let b72 = {
  id: "b72",
  x: b72_x,
  y: b72_y,
  w: b72_w,
  h: b72_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="pink-shade"> 
                        <span style="text-align:left"><span id="cardPaidParking" class="count">0</span><br/>
                        <span class="text">Paid Parking</span></span>
                        <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                        <div id="loader_b72" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                        <a1 style="cursor: pointer;" onclick="downloadPaidParking()" data-toggle="popover"  title="Download Underlying Data" >
                          <i class="fa fa-download"></i></a1>
                          <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b72()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                    </div>
                </div>`,
};

function Refresh_b72() {
  let cardPaidParking = document.getElementById("cardPaidParking");
  let loader = document.getElementById("loader_b72");

  // Function to fetch paid parking data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardPaidParking.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getPaidFreeParking + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);

    xhr_object.onload = function () {
      let resfunCardParkingPaidFree = JSON.parse(this.responseText);
      console.log("Paid Parking - ");
      console.log(resfunCardParkingPaidFree);

      // Update HTML element with paid parking data
      cardPaidParking.innerHTML = resfunCardParkingPaidFree.response.paid_parking + "";

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardPaidParking.innerHTML = "No data available"; // Show "No data available" message on error
    };

    xhr_object.send();
  }

  // Initial data fetch for paid parking
  fetchData();

  // Function to handle refresh button click for paid parking
  function handleRefresh() {
    fetchData(); // Refresh the paid parking data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}


let b73 = {
  id: "b73",
  x: b73_x,
  y: b73_y,
  w: b73_w,
  h: b73_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="yellow-shade"> 
                        <span style="text-align:left"><span id="CardOccupiedParking" class="count">0</span>
                        <span class="text">Allocated Parking</span><br/><br/>
                        <div id="loader_b73" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                        <span class="count" id="occupiedFour">0 </span> <span class="text"> 4Wheelers | </span> <span class="count" id="occupiedTwo">0 </span> <span class="text"> 2Wheelers </span>  </span>
                        <a1 style="cursor: pointer;" onclick="downloadOccupiedParking()" data-toggle="popover"  title="Download Underlying Data" >
                          <i class="fa fa-download"></i></a1><br/>
                          <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b73()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                    </div>
                </div>`,
};

function Refresh_b73() {
  let CardOccupiedParking = document.getElementById("CardOccupiedParking");
  let occupiedFour = document.getElementById("occupiedFour");
  let occupiedTwo = document.getElementById("occupiedTwo");
  let loader = document.getElementById("loader_b73");

  // Function to fetch occupied parking data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    CardOccupiedParking.innerHTML = ""; // Clear the content while loading
    occupiedFour.innerHTML = "";
    occupiedTwo.innerHTML = "";

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getOccupiedParking + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);

    xhr_object.onload = function () {
      let resfunCardParkingOccpied = JSON.parse(this.responseText);
      console.log("Occupied Parking - ");
      console.log(resfunCardParkingOccpied);

      // Update HTML elements with values from the response
      CardOccupiedParking.innerHTML = resfunCardParkingOccpied.response.occupied_parking + "";
      occupiedFour.innerHTML = resfunCardParkingOccpied.response["4_wheeler_parking"] + "";
      occupiedTwo.innerHTML = resfunCardParkingOccpied.response["2_wheeler_parking"] + "";

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      CardOccupiedParking.innerHTML = "No data available"; // Show "No data available" message on error
      occupiedFour.innerHTML = "";
      occupiedTwo.innerHTML = "";
    };

    xhr_object.send();
  }

  // Initial data fetch for occupied parking
  fetchData();

  // Function to handle refresh button click for occupied parking
  function handleRefresh() {
    fetchData(); // Refresh the occupied parking data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}


let b74 = {
  id: "b74",
  x: b74_x,
  y: b74_y,
  w: b74_w,
  h: b74_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
                    <div class="red-shade"> 
                        <span style="text-align:left"><span id="cardVacantParking" class="count">0</span>
                        <span class="text"> Available Parking</span><br/><br/>
                        <div id="loader_b74" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                        <span id="fourVacant" class="count">0 </span> <span class="text"> 4Wheelers | </span> <span class="count" id="twoVacant">0 </span> <span class="text"> 2Wheelers </span>  </span>
                        <a1 style="cursor: pointer;" onclick="downloadVacantParking()" data-toggle="popover"  title="Download Underlying Data" >
                          <i class="fa fa-download"></i></a1>
                          <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b74()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
                    </div>
                </div>`,
};

function Refresh_b74() {
  let cardVacantParking = document.getElementById("cardVacantParking");
  let fourVacant = document.getElementById("fourVacant");
  let twoVacant = document.getElementById("twoVacant");
  let loader = document.getElementById("loader_b74");

  // Function to fetch vacant parking data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    cardVacantParking.innerHTML = ""; // Clear the content while loading
    fourVacant.innerHTML = "";
    twoVacant.innerHTML = "";

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getVacantParking + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);

    xhr_object.onload = function () {
      let resfunCardParkingVacant = JSON.parse(this.responseText);
      console.log("Vacant Parking - ");
      console.log(resfunCardParkingVacant);

      // Update HTML elements with values from the response
      cardVacantParking.innerHTML = resfunCardParkingVacant.response + "";
      fourVacant.innerHTML = resfunCardParkingVacant.four_wheeler_count + "";
      twoVacant.innerHTML = resfunCardParkingVacant.two_wheeler_count + "";

      loader.style.display = "none"; // Hide loader
    };

    xhr_object.onerror = function () {
      console.error('Error fetching data');
      loader.style.display = 'none'; // Hide loader on error
      cardVacantParking.innerHTML = "No data available"; // Show "No data available" message on error
      fourVacant.innerHTML = "";
      twoVacant.innerHTML = "";
    };

    xhr_object.send();
  }

  // Initial data fetch for vacant parking
  fetchData();

  // Function to handle refresh button click for vacant parking
  function handleRefresh() {
    fetchData(); // Refresh the vacant parking data
  }

  document.getElementById("refreshButton").addEventListener("click", handleRefresh);
}

// loaderTrendsMonths,TrendsMonthsNoData,trendsOverMonths


// let b75 = {
//   id: "b75",
//   x: b75_x,
//   y: b75_y,
//   w: b75_w,
//   h: b75_h,
//   content: `<div style="height: 100%; width: 100%;">
//                     <div style="width:100%; background-color:#fff; padding: 10px;">
//                     <div class="row">
//                         <span   align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b>Incident Summary</span>
//                         <div class="parent col-md-2">
//                             <div class="col-sm-1 child mx-2">
//                                 <a style="cursor: pointer;"  onclick="downloadIncidentSummary()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
//                             </div>
//                             <div class="col-sm-1 child mx-2">
//                                 <img height="15" width="15" onclick="showIncidentSummary()" src="assets/img/xmark-solid.svg"/>
//                             </div>
//                         </div>
//                     </div>
//                   </div>
//                     <hr class="mt-0" /><br>
//                     <div class="tbl-container overflow-hidden h-auto p-0" style="width: 100%;">
//                         <center> <table id="tblIncidentSummaryinfo" style="width: 100%;margin-right:20px;  overflow-y:scroll" class="table table-bordered mx-4">
//                                 <thead>
//                                     <th>Sr. No.</th>
//                                     <th>Name of the site</th>
//                                     <th>Location</th>
//                                     <th>Incident date</th>
//                                     <th>Time of incidence</th>
//                                     <th>Incident Category</th>
//                                     <th>Incident Brief</th>
//                                     <th>Loss/Damage Evalution</th>
//                                     <th>RCA</th>
//                                     <th>Level</th>
//                                     <th>Primary RCA Category</th>
//                                     <th>Corrective Actions</th>
//                                     <th>Preventive Actions</th>
//                                     <th>Incident Status</th>
//                                     <th>Action Owner</th>
//                                     <th>Reason for pending</th>
//                                 </thead>
//                                 <tbody id="tablebodyIncidentSummary">

//                                 </tbody>
//                             </table>
//                         </center> 
//                         <center id="loaderIncidentSummary" class="mt-4"><br><br><br>
//                             <div class="mt-4 spinner-border" role="status">
//                                 <span class="sr-only"></span>
//                             </div>
//                         </center>  
//                         <center><span class="fw-bold my-4" id="IncidentSummaryNoData"><br><br><br>No Data Available</span></center>
//                     </div>
//                 </div>`,
// };

let b76 = {
  id: "b76",
  x: b76_x,
  y: b76_y,
  w: b76_w,
  h: b76_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b>Permit Per Site</b></span>
                        <div class="parent col-md-2">
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;" onclick="downloadPermitSite()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showCategoryWiseTickets()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" /><br>
                    <center id="loaderSitePermit" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="SitePermitNoData"><br><br><br>No Data Available</span></center>
                    <center><div class="m-4" style="height: 300px;" style="background-color:#fff; class="card-body">
                        <canvas id="sitePermit"></canvas>
                    </div></center>
                </div>`,
  // <span id="dt2" align="left" style="color:#5e2750;" class="fw-bold col-md-11 mt-1">Unit Category-wise Tickets</span>
};

let b77 = {
  id: "b77",
  x: b77_x,
  y: b77_y,
  w: b77_w,
  h: b77_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Permit Status</span>
                        <div class="parent col-md-3">
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadPermitStatus()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showIncidents()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" />
                    <center id="loaderPermitStatus" class="mt-4"><br><br><br>
                        <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                    </center>
                    <center><span class="fw-bold my-4" id="PermitStatusNoData"><br><br><br>No Data Available</span></center>
                    <center><div style="background-color:#fff; class="card-body">
                        <canvas id="permitStatus"></canvas>
                    </div></center>
                </div>`,

};


let b78 = {
  id: "b78",
  x: b78_x,
  y: b78_y,
  w: b78_w,
  h: b78_h,
  content: `<div style="height: 100%; width: 100%;">
                    <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></b>Client Wise Outstanding Amount</span>
                        <div class="parent col-md-2">
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadOutstandingClient()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15" onclick="showTotalOutstandingAmount()" src="assets/img/xmark-solid.svg"/>
                            </div>
                        </div>
                    </div>
                  </div>
                    <hr class="mt-0" />
                    <div class="tbl-container overflow-hidden h-auto p-0" style="width: 100%;">
                        <center> <table id="tblOutstandinginfo" style="width: 100%;margin-right:20px;overflow-y:scroll; display: inline-table "  class="table table-bordered ">
                                <thead>
                                  
                                    <th>Sites</th>
                                    <th>Outstanding Amount</th>
                                    <th>Percentage</th>
                                   
                                </thead>
                                <tbody id="tablebodyOutstanding">
                                    
                                </tbody>
                            </table>
                        </center> 
                        <center id="loaderOutstanding" class="mt-4"><br><br><br>
                            <div class="mt-4" role="status">
                  <span>
                     <img height="100" width="100" src="assets/img/loader.svg"/></span>
                </div>
                        </center>  
                        <center><span class="fw-bold my-4" id="OutstandingNoData"><br><br><br>No Data Available</span></center>
                    </div>
                </div>`,
};


let b61 = {
  id: "b61",
  x: b61_x,
  y: b61_y,
  w: b61_w,
  h: b61_h,
  content: `<div style="height: 100%; width: 100%;">
                <div style="width:100%; background-color:#fff; padding: 10px;">
                    <div class="row">
                        <span id="titleInventory" align="left" style="color:#5e2750;" class="fw-bold col-md-10 mt-1"><b></i></b>Inventory</span>
                        <div class="parent col-md-2">
                       
                            
                            <div class="col-sm-1 child mx-2">
                                <img height="15" width="15"  onclick="showTotalInventory()" src="assets/img/xmark-solid.svg"/>
                                
                            </div>
                        </div>
                    </div>
                </div>
              
                    <hr class="mt-0"/><br>

                    <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-12 ">
                        <div class=" d-flex flex-wrap power-counts justify-content-center">
                            <div class="text-center go-shadow m-2 total-consumption"><span id="overStock" class="fs-3 fw-bold"></span><br><span>Over Stock Items</span><br>
                            <div id="loader_OverStock" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                              <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_OverStock()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                            <a style="cursor: pointer;" id="infoOverStockItemsIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                            <a style="cursor: pointer; float:right;" onclick="downloadOverStock()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            
                            </div>

                                 

                            <div class="text-center go-shadow m-2 total-consumption"><span id="underStock" class="fs-3 fw-bold"></span><br><span>Under Stock Items</span><br>
                            <div id="loader_UnderStock" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                   <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_UnderStock()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                            <a style="cursor: pointer;" id="infoUnderStockItemsIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                            <a style="cursor: pointer; float:right;" onclick="downloadUnderStock()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>

                            <div class="text-center go-shadow m-2 total-consumption"><i class="bi bi-currency-rupee" style="font-size:20px"></i><span id="workOrder" class="fs-3 fw-bold"></span><br><span>Work Order </span><br>
                              <div id="loader_WorkOrder" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                   <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_WorkOrder()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                            <a style="cursor: pointer;" id="infoWorkOrderIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                            <a style="cursor: pointer; float:right;" onclick="downloadWorkOrder()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

                            <div class="text-center go-shadow m-2 total-consumption"><i class="bi bi-currency-rupee" style="font-size:20px"></i><span id="purchaseOrder"class="fs-3 fw-bold"></span><br><span>Purchase Order</span><br>
                             <div id="loader_purchaseOrder" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                   <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_purchaseOrder()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                            <a style="cursor: pointer;" id="infoPurchaseOrderIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                            <a style="cursor: pointer; float:right;" onclick="downloadPurchaseOrder()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-md-6 col-sm-12 ">
                    <div class=" d-flex flex-wrap power-counts justify-content-center">
                        <div class="text-center go-shadow m-2 total-consumption"><i class="bi bi-currency-rupee" style="font-size:20px"></i><span id="totalInventory" class="fs-3 fw-bold"></span><br><span> Total Value Of Inventory</span><br>
                        <div id="loader_TotalValue" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                   <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_TotalValue()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                        <a style="cursor: pointer;" id="infoTotalValueOfInventoryIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                        <a style="cursor: pointer; float:right;" onclick="downloadTotalValue()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

                        <div class="text-center go-shadow m-2 total-consumption"><i class="bi bi-currency-rupee" style="font-size:20px"></i><span id="capitalBlock" class="fs-3 fw-bold"></span><br><span>Capital Blocked in Over Stocking</span><br>
                         <div id="loader_capitalBlock" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                   <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_capitalBlock()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                        <a style="cursor: pointer;" id="infoCapitalBlockedIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                        <a style="cursor: pointer; float:right; width:10px" onclick="downloadInventory()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a></div>

                        <div class="text-center go-shadow m-2 total-consumption"><i class="bi bi-currency-rupee" style="font-size:20px"></i><span id="valueConsumable" class="fs-3 fw-bold"></span><br><span>Total Value of Consumables</span><br>
                        <div id="loader_valueConsumable" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                   <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_valueConsumable()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                        <a style="cursor: pointer;" id="infoValueofConsumablesIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                        <a style="cursor: pointer; float:right; width:10px" onclick="downloadTotalConsumables()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a> </div>

                        <div class="text-center go-shadow m-2 total-consumption"><i class="bi bi-currency-rupee" style="font-size:20px"></i><span id="valueSpares"class="fs-3 fw-bold"></span><br><span>Total Value of Spares</span><br>
                        <div id="loader_valueSpares" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                   <a style="cursor: pointer;width:10px;margin-left: 66%;" id="refreshIconElement_totalAmount" onclick="Refresh_valueSpares()" data-toggle="popover" title="Refresh Data"><i style="font-size:20px; font-weight:bold" class="bi bi-arrow-clockwise bold-icon"></i></a>
                        <a style="cursor: pointer;" id="infoValueofSparesIcon"><i style="font-size:17px; font-weight:bold" class="bi bi-info-circle"></i></a>
                        <a style="cursor: pointer; float:right; width:10px" onclick="downloadTotalSpares()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a> </div>
                    </div>
                </div>



                    
 </div>`,

};


let b34 = {
  id: "b34",
  x: b34_x,
  y: b34_y,
  w: b34_w,
  h: b34_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="totalAmount" class="count">0</span><br/>
                    <span class=" text">Total Amount</span>
                  </span>
                  <div id="loader_b34" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadTotalAmount()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b34()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_b34() {
  let totalAmount = document.getElementById("totalAmount");
  let loader = document.getElementById("loader_b34");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    totalAmount.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    if (globalType == "daily") {
      xhr_object.open("GET", getTotalAmount + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getTotalAmount + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond, true);
    }

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfungetTotalAmount = JSON.parse(this.responseText);
        console.log("Total Amount - ");
        console.log(resfungetTotalAmount);

        // Check if total_amount_response exists and is not 0
        if (resfungetTotalAmount.total_amount_response !== undefined && resfungetTotalAmount.total_amount_response !== 0) {
          totalAmount.innerHTML = resfungetTotalAmount.total_amount_response + "";
        } else {
          totalAmount.innerHTML = "No data available"; // Show "No data available" message if no data or total_amount_response is 0
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        totalAmount.innerHTML = "No data available"; // Show "No data available" on error
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}


let b35 = {
  id: "b35",
  x: b35_x,
  y: b35_y,
  w: b35_w,
  h: b35_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="green-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="totalReceived" class="count">0</span><br/>
                    <span class=" text">Total Received</span>
                  </span>
                  <div id="loader_b35" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadTotalReceived()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b35()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_b35() {
  let totalReceived = document.getElementById("totalReceived");
  let loader = document.getElementById("loader_b35");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    totalReceived.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();

    if (globalType == "daily") {
      xhr_object.open("GET", getTotalAmount + idLink + "&date=" + globalDateFirst, true);
    } else {
      xhr_object.open("GET", getTotalAmount + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond, true);
    }

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfungetTotalAmount = JSON.parse(this.responseText);
        console.log("Total Amount - ");
        console.log(resfungetTotalAmount);

        // Check if received_amount_response exists and is not 0
        if (resfungetTotalAmount.received_amount_response !== undefined && resfungetTotalAmount.total_amount_response !== 0) {
          totalReceived.innerHTML = resfungetTotalAmount.total_amount_response + "";
        } else {
          totalReceived.innerHTML = "No data available"; // Show "No data available" message if no data or total_amount_response is 0
        }
      } else {
        console.error('Error fetching data:', xhr_object.statusText);
        totalReceived.innerHTML = "No data available"; // Show "No data available" on error
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }
}

let b36 = {
  id: "b36",
  x: b36_x,
  y: b36_y,
  w: b36_w,
  h: b36_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="pink-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="totalOutstanding" class="count">0</span><br/>
                    <span class=" text">Total Outstanding</span>
                  </span>
                  <div id="loader_b36" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadTotalOutstanding()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_b36()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


// changes Refresh_b36
function Refresh_b36() {
  let totalOutstanding = document.getElementById("totalOutstanding");
  let loader = document.getElementById("loader_b36");

  // Function to fetch data
  function fetchData() {
    loader.style.display = "block"; // Show loader
    totalOutstanding.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open("GET", getTotalAmount + idLink, true);

    
  if (globalType == "daily") {
    xhr_object.open("GET", getTotalAmount + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getTotalAmount + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

    xhr_object.onload = function () {
      resfungetTotalAmount = JSON.parse(this.responseText);
      console.log("Total Amount - ");
      console.log(resfungetTotalAmount);
      totalOutstanding.innerHTML =
      resfungetTotalAmount.total_outstanding + "";
      
      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();
  }

  // Initial data fetch
  fetchData();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchData(); // Refresh the data
  }

}




let c15 = {
  id: "c15",
  x: c15_x,
  y: c15_y,
  w: c15_w,
  h: c15_h,
  content: `<div style="height: 100%; width: 100%;">
  <div style="background-color:#fff;" class="card-header row">
      <div class="row">
    <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Cluster Employee Particiption</span>
    <div class="parent col-md-3">
        <div class="col-sm-1 child mx-2">
            <a style="cursor: pointer;"  onclick="downloadClusterEmployeeParticiption()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
        </div>
    </div>
</div>
  </div>
  
  <center id="loaderClusterEmployeeParticiption" class="mt-4"><br><br><br>
          <div class="mt-4 spinner-border" role="status">
              <span class="sr-only"></span>
          </div>
      </center>  
  <center><span class="fw-bold my-4" id="ClusterEmployeeParticiptionNoData"><br><br><br>No Data Available</span></center>

  <div class="tbl-container">
      <table id="tblClusterEmployeeParticiptioninfo" class="table table-bordered table-reponsive" style="overflow-x:scroll">    
          <tbody id = "tablebodyClusterEmployeeParticiption">
          <thead>
              <th>Rank</th>
              <th>Cluster</th>
              <th>No.Of Participants</th>
              <th> Avg Step Count   </th>
          </thead>
          </tbody>  
      </table>
  </div>
</div>`,
};

let c21 = {
  id: "c21",
  x: c21_x,
  y: c21_y,
  w: c21_w,
  h: c21_h,
  content: `<div style="height: 100%; width: 100%;">
                     
              <div style="background-color:#fff;" class="card-header row">
              <div class="row">
            <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Cumulative Leaderboard : Top 10 Female</span>
            <div class="parent col-md-3">
                <div class="col-sm-1 child mx-2">
                    <a style="cursor: pointer;"  onclick="downloadCumulativeLeaderboardFemale()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                </div>
            </div>
        </div>
          </div>
                      
                      <center id="loaderCommulativeLeaderboardFemale" class="mt-4"><br><br><br>
                              <div class="mt-4 spinner-border" role="status">
                                  <span class="sr-only"></span>
                              </div>
                          </center>  
                      <center><span class="fw-bold my-4" id="commulativeLeaderboardNoDataFemale"><br><br><br>No Data Available</span></center>
  
                      <div class="tbl-container">
                          <table id="tblCommulativeLeaderboardinfoFemale" class="table table-bordered">    
                              <tbody id = "tablebodyCommulativeLeaderboardFemale">
                              <thead>
                                  <th>Rank</th>
                                  <th>Employee</th>
                                  <th>Cluster</th>
                                  <th>Steps Taken</th>
                              </thead>
                              </tbody>  
                          </table>
                      </div>
                  </div>`,
};


let c11 = {
  id: "c11",
  x: c11_x,
  y: c11_y,
  w: c11_w,
  h: c11_h,
  content: `<div style="height: 100%; width: 100%;" class="dashboard-movement">
              <div class="orange-shade"> 
                  <span style="font-size:100%; text-align:left">
                    <span id="cardDailyStep" class="count">0</span><br/>
                    <span class=" text">Organisation Daily Step Count</span>
                  </span>
                  <div id="loader_c11" class="mt-4 spinner-icon" role="status" style="display: none;">
                     <span>
                       <img height="65" width="65" src="assets/img/spinner.svg"/>
                     </span>
                  </div>
                  <img style="height: 20; width: 20;" src="assets/img/checked.png"/>
                  <a1 style="cursor: pointer;" onclick="downloadDailyStepCount()" data-toggle="popover"  title="Download Underlying Data" >
                    <i class="bi bi-download"></i></a1>
                  <a1 id="refreshButton" style="cursor: pointer;" onclick="Refresh_c11()" title="Refresh Content" >
                    <i class="bi bi-arrow-clockwise bold-icon"></i></a1>
              </div>
          </div>`
};


function Refresh_c11() {
  let cardDailyStep = document.getElementById("cardDailyStep");
  let loader = document.getElementById("loader_c11");

  // Function to fetch data with from date - to date condition
  function fetchDataWithDate() {
    loader.style.display = "block"; // Show loader
    cardDailyStep.innerHTML = ""; // Clear the content while loading

    let xhr_object = new XMLHttpRequest();
    xhr_object.open(
      "GET",
      getDailyStepCount +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
      true
    );

    xhr_object.onload = function () {
      if (xhr_object.status === 200) {
        let resfunDailyStepCount = JSON.parse(this.responseText);
        console.log("Daily Step Count - ");
        console.log(resfunDailyStepCount);

        // Check if data is available and greater than zero
        if (resfunDailyStepCount && resfunDailyStepCount.response && parseFloat(resfunDailyStepCount.response) > 0) {
          cardDailyStep.innerHTML = resfunDailyStepCount.response + "";
        } else {
          cardDailyStep.innerHTML = "No data available"; // Show "No data available" message if no data or data count is 0 or less than 0
        }

        loader.style.display = "none"; // Hide loader
      } else {
        console.error("Error fetching data:", xhr_object.statusText);
        cardDailyStep.innerHTML = "No data available"; // Show "No data available" message on error
        loader.style.display = "none"; // Hide loader
      }
    };

    xhr_object.send();
  }

  // Initial data fetch with from date - to date condition
  fetchDataWithDate();

  // Function to handle refresh button click
  function handleRefresh() {
    fetchDataWithDate(); // Refresh the data with from date - to date condition
  }
}

let c14 = {
  id: "c14",
  x: c14_x,
  y: c14_y,
  w: c14_w,
  h: c14_h,
  content: `
  <div style="height: 100%; width: 100%;">
  <div style="background-color:#fff;" class="card-header row">
      <div class="row">
    <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Function Employee Particiption</span>
    <div class="parent col-md-3">
        <div class="col-sm-1 child mx-2">
            <a style="cursor: pointer;"  onclick="downloadFunctionEmployee()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
        </div>
    </div>
</div>
  </div>
  
  <center id="loaderDepartmentStats" class="mt-4"><br><br><br>
          <div class="mt-4 spinner-border" role="status">
              <span class="sr-only"></span>
          </div>
      </center>  
  <center><span class="fw-bold my-4" id="DepartmentStatsNoData"><br><br><br>No Data Available</span></center>

  <div class="tbl-container">
      <table id="tblFunctionEmployeeParticiptioninfo" class="table table-bordered table-reponsive" style="overflow-x:scroll">    
          <tbody id = "tablebodyFunctionEmployeeParticiption">
          <thead>
              <th>Rank</th>
              <th>Function</th>
              <th>No.Of Participants</th>
              <th> Avg Step Count   </th>
          </thead>
          </tbody>  
      </table>
  </div>
</div>`,


};

let c19 = {
  id: "c19",
  x: c19_x,
  y: c19_y,
  w: c19_w,
  h: c19_h,
  content: `<div style="height: 100%; width: 100%;">
                      <div style="background-color:#fff;" class="card-header row">
                          <div class="row">
                        <span   align="left" style="color:#5e2750;" class="fw-bold col-md-9 mt-1"><b></b>Cumulative Leaderboard : Top 10 Male</span>
                        <div class="parent col-md-3">
                            <div class="col-sm-1 child mx-2">
                                <a style="cursor: pointer;"  onclick="downloadCumulativeLeaderboardMale()" data-toggle="popover" title="Download Underlying Data"><img height="15" width="15" src="assets/img/download.png"/></a>
                            </div>
                        </div>
                    </div>
                      </div>
                      
                      <center id="loaderCommulativeLeaderboard" class="mt-4"><br><br><br>
                              <div class="mt-4 spinner-border" role="status">
                                  <span class="sr-only"></span>
                              </div>
                          </center>  
                      <center><span class="fw-bold my-4" id="commulativeLeaderboardNoData"><br><br><br>No Data Available</span></center>
  
                      <div class="tbl-container">
                          <table id="tblCommulativeLeaderboardinfo" class="table table-bordered">    
                              <tbody id = "tablebodyCommulativeLeaderboard">
                              <thead>
                                  <th>Rank</th>
                                  <th>Employee</th>
                                  <th>Cluster</th>
                                  <th>Steps Taken </th>
                              </thead>
                              </tbody>  
                          </table>
                      </div>
                  </div>`,
};

let items = [
  a11,
  a12,
  a13,
  a14,
  a15,
  a16,
  a70,
  a71,
  a72,
  a73,
  a74,
  a75,
  // a76,
  // a77,
  a78,
  a79,


  // a17,
  a18,
  a19,
  a39,
  a40,
  a20,
  a21,
  a22,
  a23,
  // // a24,
  // a50,
  // a51,
  // a52,
  // a53,
  // a54,
  // a55,
  // a56,
  // a57,
  // a58,
  a59,
  a60,
  // a47,
  a48,
  a49,
  a25,
  a26,
  a27,
  a63,
  a28,
  a29,
  a30,
  a31,
  a32,
  a33,
  a34,
  a35,
  a36,
  a37,
  a41,
  a38,
  a42,
  a44,
  // a45,
  a46,
  a64,
  a61,
  // a62,
  a67,
  a68,
  a69,

  a80,
  a81,
  a82,
  a83,
  a84,
  a85,
  a100,
  a102,
  a101,
  a103,
  a104,
  a105,
  a106,
  a107,
  a108,
  a109,
  a110,
  a111,
  a112,
  a113,
  a114,
  a115,
  a116,
  a117,
  a118,
  a119,
  a120,
  b34,
  b35,
  b36,
  b61,
  b70,
  b71,
  b72,
  b73,
  b74,
  // b75,
  b76,
  b77,
  b78,
  c11,
  c14,
  c15,
  c19,
  c21,
  d11,
  d12,
  d13,
  d14,
  d15,
  d16

];

let itemsList = [
  'a11',
  'a12',
  'a13',
  'a14',
  'a15',
  'a16',
  'a70',
  'a71',
  'a72',
  'a73',
  'a18',
  'a19',
  'a39',
  'a40',
  'a20',
  'a21',
  'a22',
  'a23',
  'a25',
  'a26',
  'a27',
  'a63',
  'a28',
  'a29',
  'a30',
  'a31',
  'a32',
  'a33',
  'a34',
  'a35',
  'a36',
  'a37',
  'a41',
  'a38',
  'a42',
  'a44',
  'a46',
  'a64',
  'a61',
  'a67',
  'a68',
  'a69',
  'a79',
  'a80',
  'a81',
  'a82',
  'a83',
  'a84',
  'a85',
  'a100',
  'a102',
  'a101',
  'a103',
  'a48',
  'a49',
  'a104',
  'a106',
  'a107',
  'b34',
  'b35',
  'b36',
  'b61',
  'b70',
  'b71',
  'b72',
  'b73',
  'b74',
  // 'b75',
  'b76',
  'b77',
  'a59',
  'a60',
  "c11",
  "c14",
  "c15",
  "c19",
  "c21",
  "a108",
  "a109",
  "a110",
  "a105",
  "a114",
  "a115",
  "a118",
  "a119",
  "a112",
  "a111",
  "a113",
  'b78',
  "a78",
  "a75",
  "a74",
  "a116",
  "a117",
  "a120",
  "d11",
  "d12",
  "d13",
  "d14",
  "d15",
  "d16"

];

grid.on("added removed change", function (e, items) {
  let str = "";
  items.forEach(function (item) {
    str += " (x,y)=" + item.x + "," + item.y;

    if (item.id == "a11") {
      a11.x = item.x;
      a11.y = item.y;
      a11.h = item.h;
      a11.w = item.w;
    }

    if (item.id == "a12") {
      a12.x = item.x;
      a12.y = item.y;
      a12.h = item.h;
      a12.w = item.w;
    }

    if (item.id == "a13") {
      a13.x = item.x;
      a13.y = item.y;
      a13.h = item.h;
      a13.w = item.w;
    }

    if (item.id == "a14") {
      a14.x = item.x;
      a14.y = item.y;
      a14.h = item.h;
      a14.w = item.w;
    }

    if (item.id == "a15") {
      a15.x = item.x;
      a15.y = item.y;
      a15.h = item.h;
      a15.w = item.w;
    }

    if (item.id == "a70") {
      a70.x = item.x;
      a70.y = item.y;
      a70.h = item.h;
      a70.w = item.w;
    }

    if (item.id == "a71") {
      a71.x = item.x;
      a71.y = item.y;
      a71.h = item.h;
      a71.w = item.w;
    }

    if (item.id == "a72") {
      a72.x = item.x;
      a72.y = item.y;
      a72.h = item.h;
      a72.w = item.w;
    }

    if (item.id == "a73") {
      a73.x = item.x;
      a73.y = item.y;
      a73.h = item.h;
      a73.w = item.w;
    }

    if (item.id == "a16") {
      a16.x = item.x;
      a16.y = item.y;
      a16.h = item.h;
      a16.w = item.w;
    }

    // if (item.id == "a17") {
    //   a17.x = item.x;
    //   a17.y = item.y;
    //   a17.h = item.h;
    //   a17.w = item.w;
    // }

    if (item.id == "a18") {
      a18.x = item.x;
      a18.y = item.y;
      a18.h = item.h;
      a18.w = item.w;
    }

    if (item.id == "a19") {
      a19.x = item.x;
      a19.y = item.y;
      a19.h = item.h;
      a19.w = item.w;
    }

    if (item.id == "a20") {
      a20.x = item.x;
      a20.y = item.y;
      a20.h = item.h;
      a20.w = item.w;
    }

    if (item.id == "a21") {
      a21.x = item.x;
      a21.y = item.y;
      a21.h = item.h;
      a21.w = item.w;
    }

    if (item.id == "a22") {
      a22.x = item.x;
      a22.y = item.y;
      a22.h = item.h;
      a22.w = item.w;
    }

    if (item.id == "a79") {
      a79.x = item.x;
      a79.y = item.y;
      a79.h = item.h;
      a79.w = item.w;
    }

    if (item.id == "a23") {
      a23.x = item.x;
      a23.y = item.y;
      a23.h = item.h;
      a23.w = item.w;
    }

    if (item.id == "a50") {
      a50.x = item.x;
      a50.y = item.y;
      a50.h = item.h;
      a50.w = item.w;
    }

    if (item.id == "a51") {
      a51.x = item.x;
      a51.y = item.y;
      a51.h = item.h;
      a51.w = item.w;
    }

    // if (item.id == "a52") {
    //   a52.x = item.x;
    //   a52.y = item.y;
    //   a52.h = item.h;
    //   a52.w = item.w;
    // }

    // if (item.id == "a53") {
    //   a53.x = item.x;
    //   a53.y = item.y;
    //   a53.h = item.h;
    //   a53.w = item.w;
    // }

    // if (item.id == "a54") {
    //   a54.x = item.x;
    //   a54.y = item.y;
    //   a54.h = item.h;
    //   a54.w = item.w;
    // }

    if (item.id == "a55") {
      a55.x = item.x;
      a55.y = item.y;
      a55.h = item.h;
      a55.w = item.w;
    }

    if (item.id == "a56") {
      a56.x = item.x;
      a56.y = item.y;
      a56.h = item.h;
      a56.w = item.w;
    }

    if (item.id == "a57") {
      a57.x = item.x;
      a57.y = item.y;
      a57.h = item.h;
      a57.w = item.w;
    }

    if (item.id == "a58") {
      a58.x = item.x;
      a58.y = item.y;
      a58.h = item.h;
      a58.w = item.w;
    }

    if (item.id == "a59") {
      a59.x = item.x;
      a59.y = item.y;
      a59.h = item.h;
      a59.w = item.w;
    }

    if (item.id == "a60") {
      a60.x = item.x;
      a60.y = item.y;
      a60.h = item.h;
      a60.w = item.w;
    }
    if (item.id == "a61") {
      a61.x = item.x;
      a61.y = item.y;
      a61.h = item.h;
      a61.w = item.w;
    }
    if (item.id == "a67") {
      a67.x = item.x;
      a67.y = item.y;
      a67.h = item.h;
      a67.w = item.w;
    }

    // if (item.id == "a62") {
    //   a62.x = item.x;
    //   a62.y = item.y;
    //   a62.h = item.h;
    //   a62.w = item.w;
    // }


    // if (item.id == "a24") {
    //   a24.x = item.x;
    //   a24.y = item.y;
    //   a24.h = item.h;
    //   a24.w = item.w;
    // }

    // if (item.id == "a47") {
    //   a47.x = item.x;
    //   a47.y = item.y;
    //   a47.h = item.h;
    //   a47.w = item.w;
    // }

    if (item.id == "a48") {
      a48.x = item.x;
      a48.y = item.y;
      a48.h = item.h;
      a48.w = item.w;
    }

    if (item.id == "a49") {
      a49.x = item.x;
      a49.y = item.y;
      a49.h = item.h;
      a49.w = item.w;
    }

    if (item.id == "a25") {
      a25.x = item.x;
      a25.y = item.y;
      a25.h = item.h;
      a25.w = item.w;
    }

    if (item.id == "a26") {
      a26.x = item.x;
      a26.y = item.y;
      a26.h = item.h;
      a26.w = item.w;
    }

    if (item.id == "a27") {
      a27.x = item.x;
      a27.y = item.y;
      a27.h = item.h;
      a27.w = item.w;
    }
    if (item.id == "a63") {
      a63.x = item.x;
      a63.y = item.y;
      a63.h = item.h;
      a63.w = item.w;
    }

    if (item.id == "a28") {
      a28.x = item.x;
      a28.y = item.y;
      a28.h = item.h;
      a28.w = item.w;
    }

    if (item.id == "a29") {
      a29.x = item.x;
      a29.y = item.y;
      a29.h = item.h;
      a29.w = item.w;
    }

    if (item.id == "a30") {
      a30.x = item.x;
      a30.y = item.y;
      a30.h = item.h;
      a30.w = item.w;
    }

    if (item.id == "a31") {
      a31.x = item.x;
      a31.y = item.y;
      a31.h = item.h;
      a31.w = item.w;
    }

    if (item.id == "a32") {
      a32.x = item.x;
      a32.y = item.y;
      a32.h = item.h;
      a32.w = item.w;
    }

    if (item.id == "a33") {
      a33.x = item.x;
      a33.y = item.y;
      a33.h = item.h;
      a33.w = item.w;
    }

    if (item.id == "a34") {
      a34.x = item.x;
      a34.y = item.y;
      a34.h = item.h;
      a34.w = item.w;
    }

    if (item.id == "a35") {
      a35.x = item.x;
      a35.y = item.y;
      a35.h = item.h;
      a35.w = item.w;
    }

    if (item.id == "a36") {
      a36.x = item.x;
      a36.y = item.y;
      a36.h = item.h;
      a36.w = item.w;
    }

    if (item.id == "a37") {
      a37.x = item.x;
      a37.y = item.y;
      a37.h = item.h;
      a37.w = item.w;
    }

    if (item.id == "a38") {
      a38.x = item.x;
      a38.y = item.y;
      a38.h = item.h;
      a38.w = item.w;
    }

    if (item.id == "a39") {
      a39.x = item.x;
      a39.y = item.y;
      a39.h = item.h;
      a39.w = item.w;
    }

    if (item.id == "a40") {
      a40.x = item.x;
      a40.y = item.y;
      a40.h = item.h;
      a40.w = item.w;
    }

    if (item.id == "a41") {
      a41.x = item.x;
      a41.y = item.y;
      a41.h = item.h;
      a41.w = item.w;
    }

    if (item.id == "a42") {
      a42.x = item.x;
      a42.y = item.y;
      a42.h = item.h;
      a42.w = item.w;
    }

    if (item.id == "a44") {
      a44.x = item.x;
      a44.y = item.y;
      a44.h = item.h;
      a44.w = item.w;
    }

    // if (item.id == "a45") {
    //   a45.x = item.x;
    //   a45.y = item.y;
    //   a45.h = item.h;
    //   a45.w = item.w;
    // }

    if (item.id == "a46") {
      a46.x = item.x;
      a46.y = item.y;
      a46.h = item.h;
      a46.w = item.w;
    }

    if (item.id == "a64") {
      a64.x = item.x;
      a64.y = item.y;
      a64.h = item.h;
      a64.w = item.w;
    }

    if (item.id == "a68") {
      a68.x = item.x;
      a68.y = item.y;
      a68.h = item.h;
      a68.w = item.w;
    }

    if (item.id == "a69") {
      a69.x = item.x;
      a69.y = item.y;
      a69.h = item.h;
      a69.w = item.w;
    }

    if (item.id == "a80") {
      a80.x = item.x;
      a80.y = item.y;
      a80.h = item.h;
      a80.w = item.w;
    }

    if (item.id == "a81") {
      a81.x = item.x;
      a81.y = item.y;
      a81.h = item.h;
      a81.w = item.w;
    }

    if (item.id == "a82") {
      a82.x = item.x;
      a82.y = item.y;
      a82.h = item.h;
      a82.w = item.w;
    }

    if (item.id == "a83") {
      a83.x = item.x;
      a83.y = item.y;
      a83.h = item.h;
      a83.w = item.w;
    }

    if (item.id == "a84") {
      a84.x = item.x;
      a84.y = item.y;
      a84.h = item.h;
      a84.w = item.w;
    }

    if (item.id == "a85") {
      a85.x = item.x;
      a85.y = item.y;
      a85.h = item.h;
      a85.w = item.w;
    }

    if (item.id == "a100") {
      a100.x = item.x;
      a100.y = item.y;
      a100.h = item.h;
      a100.w = item.w;
    }

    if (item.id == "a101") {
      a101.x = item.x;
      a101.y = item.y;
      a101.h = item.h;
      a101.w = item.w;
    }

    if (item.id == "a102") {
      a102.x = item.x;
      a102.y = item.y;
      a102.h = item.h;
      a102.w = item.w;
    }

    if (item.id == "a103") {
      a103.x = item.x;
      a103.y = item.y;
      a103.h = item.h;
      a103.w = item.w;
    }

    if (item.id == "a104") {
      a104.x = item.x;
      a104.y = item.y;
      a104.h = item.h;
      a104.w = item.w;
    }

    if (item.id == "a105") {
      a105.x = item.x;
      a105.y = item.y;
      a105.h = item.h;
      a105.w = item.w;
    }

    if (item.id == "a106") {
      a106.x = item.x;
      a106.y = item.y;
      a106.h = item.h;
      a106.w = item.w;
    }


    if (item.id == "a107") {
      a107.x = item.x;
      a107.y = item.y;
      a107.h = item.h;
      a107.w = item.w;
    }
    if (item.id == "b34") {
      b34.x = item.x;
      b34.y = item.y;
      b34.h = item.h;
      b34.w = item.w;
    }

    if (item.id == "b35") {
      b35.x = item.x;
      b35.y = item.y;
      b35.h = item.h;
      b35.w = item.w;
    }

    if (item.id == "b36") {
      b36.x = item.x;
      b36.y = item.y;
      b36.h = item.h;
      b36.w = item.w;
    }

    if (item.id == "b61") {
      b61.x = item.x;
      b61.y = item.y;
      b61.h = item.h;
      b61.w = item.w;
    }

    if (item.id == "b70") {
      b70.x = item.x;
      b70.y = item.y;
      b70.h = item.h;
      b70.w = item.w;
    }

    if (item.id == "b71") {
      b71.x = item.x;
      b71.y = item.y;
      b71.h = item.h;
      b71.w = item.w;
    }

    if (item.id == "b72") {
      b72.x = item.x;
      b72.y = item.y;
      b72.h = item.h;
      b72.w = item.w;
    }

    if (item.id == "b73") {
      b73.x = item.x;
      b73.y = item.y;
      b73.h = item.h;
      b73.w = item.w;
    }

    if (item.id == "b74") {
      b74.x = item.x;
      b74.y = item.y;
      b74.h = item.h;
      b74.w = item.w;
    }

    // if (item.id == "b75") {
    //   b75.x = item.x;
    //   b75.y = item.y;
    //   b75.h = item.h;
    //   b75.w = item.w;
    // }

    if (item.id == "b76") {
      b76.x = item.x;
      b76.y = item.y;
      b76.h = item.h;
      b76.w = item.w;
    }

    if (item.id == "b77") {
      b77.x = item.x;
      b77.y = item.y;
      b77.h = item.h;
      b77.w = item.w;
    }

    if (item.id == "c11") {
      c11.x = item.x;
      c11.y = item.y;
      c11.h = item.h;
      c11.w = item.w;
    }

    if (item.id == "c14") {
      c14.x = item.x;
      c14.y = item.y;
      c14.h = item.h;
      c14.w = item.w;
    }

    if (item.id == "c15") {
      c15.x = item.x;
      c15.y = item.y;
      c15.h = item.h;
      c15.w = item.w;
    }
    if (item.id == "c19") {
      c19.x = item.x;
      c19.y = item.y;
      c19.h = item.h;
      c19.w = item.w;
    }
    if (item.id == "c21") {
      c21.x = item.x;
      c21.y = item.y;
      c21.h = item.h;
      c21.w = item.w;
    }
    if (item.id == "a108") {
      a108.x = item.x;
      a108.y = item.y;
      a108.h = item.h;
      a108.w = item.w;
    }
    if (item.id == "a109") {
      a109.x = item.x;
      a109.y = item.y;
      a109.h = item.h;
      a109.w = item.w;
    }
    if (item.id == "a110") {
      a110.x = item.x;
      a110.y = item.y;
      a110.h = item.h;
      a110.w = item.w;
    }

    if (item.id == "a114") {
      a114.x = item.x;
      a114.y = item.y;
      a114.h = item.h;
      a114.w = item.w;
    }
    if (item.id == "a115") {
      a115.x = item.x;
      a115.y = item.y;
      a115.h = item.h;
      a115.w = item.w;
    }
    if (item.id == "a118") {
      a118.x = item.x;
      a118.y = item.y;
      a118.h = item.h;
      a118.w = item.w;
    }
    if (item.id == "a119") {
      a119.x = item.x;
      a119.y = item.y;
      a119.h = item.h;
      a119.w = item.w;
    }

    if (item.id == "a120") {
      a120.x = item.x;
      a120.y = item.y;
      a120.h = item.h;
      a120.w = item.w;
    }
    if (item.id == "a112") {
      a112.x = item.x;
      a112.y = item.y;
      a112.h = item.h;
      a112.w = item.w;
    }
    if (item.id == "a111") {
      a111.x = item.x;
      a111.y = item.y;
      a111.h = item.h;
      a111.w = item.w;
    }
    if (item.id == "a113") {
      a113.x = item.x;
      a113.y = item.y;
      a113.h = item.h;
      a113.w = item.w;
    }
    if (item.id == "d11") {
      d11.x = item.x;
      d11.y = item.y;
      d11.h = item.h;
      d11.w = item.w;
    }
    if (item.id == "d12") {
      d12.x = item.x;
      d12.y = item.y;
      d12.h = item.h;
      d12.w = item.w;
    }
    if (item.id == "d13") {
      d13.x = item.x;
      d13.y = item.y;
      d13.h = item.h;
      d13.w = item.w;
    }
    if (item.id == "d14") {
      d14.x = item.x;
      d14.y = item.y;
      d14.h = item.h;
      d14.w = item.w;
    }

    if (item.id == "d15") {
      d15.x = item.x;
      d15.y = item.y;
      d15.h = item.h;
      d15.w = item.w;
    }


    if (item.id == "d16") {
      d16.x = item.x;
      d16.y = item.y;
      d16.h = item.h;
      d16.w = item.w;
    }

  });
});

function reloadPage() {
  window.location.reload();
}

function saveModifiedLayout() {
  const formData = new FormData();
  formData.append('grid_text', JSON.stringify(items));
  formData.append('token', token);
  formData.append('dashboard_name', 'fm_daily');

  fetch('https://oig-reports.lockated.com/api-fm/user-dashboard/save-dashboard/', {
    method: 'POST',
    body: formData,
  })
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log(data);
      console.log(JSON.stringify(items));
      console.log(token);
      alert('Please give 5 second to save Data');
      reloadPage();

    })
    .catch(error => {
      console.error('Error:', error);
      alert('Error saving data');
    });
}

function convertDateFormat(dateString) {
  var dateParts = dateString.split("-");
  var year = dateParts[0];
  var month = dateParts[1];
  var day = dateParts[2];

  return day + "/" + month + "/" + year;
}
const date = new Date();

let day = date.getDate();
let month = date.getMonth() + 1;
let year = date.getFullYear();

let todaysDate = `${year}-${month}-${day}`;

let thirtyDaysAgo = new Date(date.getTime() - 30 * 24 * 60 * 60 * 1000);
console.log(thirtyDaysAgo.toISOString().slice(0, 10));
let newDate = thirtyDaysAgo.toISOString().slice(0, 10);
callLinks("daily");
// --------------------------

let globalVisitorBuildingId = "";

let globalGoodsIn = "";
let globalGoodsOut = "";

let downloadTicketsLink = "";
let downloadEventsFootfallAnalysisLink = "";
let downloadCategoryTicketsLink = "";
let downloadCategoryWiseProactiveTicketsLink = "";
let downloadCACategoryWiseTicketsLink = "";
let downloadCACategoryWiseProactiveTicketsLink = "";
let downloadResolutionTATLink = "";
let downloadResponseTATLink = "";
let downloadIncidentsLink = "";
let downloadCategoryWiseIncidentsLink = "";
let downloadOccupancyLink = "";
let downloadPowerConsumLink = "";
let downloadWaterConsumBarLink = "";
let downloadDeliveryVisitorLink = "";

let downloadClusterWiseTotalLink = "";
let downloadFunctionWiseTotalLink = "";
let downloadGenderParticipationLink = "";
// ------------------------------------------------------------------------------------------------------------------------
const urlString = window.location.search;
const urlParams = new URLSearchParams(urlString);
const token = urlParams.get("token");
const link_project_name = urlParams.get("site_name");
const link_project_id = urlParams.get("pms_site_id");
const link_society_id = urlParams.get("society_id");
console.log("Token - " + token);

let countSiteDrop = document.getElementById("countSiteDrop");
let countSocietyDrop = document.getElementById("countSocietyDrop");
let nameSiteDrop = document.getElementById("nameSiteDrop");
let numberofRegion = 0;
let idLink ; 

let xhr_sites = new XMLHttpRequest();
xhr_sites.open("GET", getSites + "?token=" + token, true);
xhr_sites.onload = function () {
  resSites = JSON.parse(this.responseText);
  console.log(resSites);
  updateCompanyDropdown();
};
xhr_sites.send();

let companyDropdown;
function updateCompanyDropdown() {
  companyDropdown = document.getElementById("showCompanies");
  let companyDetails = ``;
  for (let i = 0; i < resSites.mapping.length; i += 1) {
    const companyId = resSites.mapping[i].company_id;
    const companyName = resSites.mapping[i].company_name;
    const checked = i === 0 ? "checked" : "";
    companyDetails +=
      `<li><input type="radio" name="radCompanyDrop" class="dropdown-check-list" value="${companyId}" onclick="updateRegionDropdown(${i})" ${checked}>${companyName}</li><li><hr class="dropdown-divider"></li>`;
  }
  companyDropdown.innerHTML = companyDetails;
  updateRegionDropdown(0);
}

let selectedCompany;

// Function to update the regions dropdown
// function updateRegionDropdown(selectedCompanyIndex) {
//   let regionDropdown = document.getElementById("showRegions");
//   let regionDetails = ``;

//   selectedCompany = resSites.mapping[selectedCompanyIndex];
//   console.log(selectedCompany);
//   selectedCompanyLogo.src = selectedCompany.logo;

//   for (const [regionName, sites] of Object.entries(selectedCompany.region)) {
//     const checked = regionName === Object.keys(selectedCompany.region)[0] ? "checked" : "";
//     regionDetails +=
//       `<li><input type="radio" name="radRegionDrop" class="dropdown-check-list" value="${regionName}" onclick="updateSiteDropdown('${regionName}', ${selectedCompanyIndex})" ${checked}>${regionName}</li><li><hr class="dropdown-divider"></li>`;
//   }

//   regionDropdown.innerHTML = regionDetails;
//   updateSiteDropdown(Object.keys(selectedCompany.region)[0], selectedCompanyIndex);
// }

function updateRegionDropdown(selectedCompanyIndex) {
  let regionDropdown = document.getElementById("showRegions");
  let regionDetails = ``;
  selectedCompany = resSites.mapping[selectedCompanyIndex];
  selectedCompanyLogo.src = selectedCompany.logo;
  console.log(selectedCompany);

  regionDetails = `<form id="regionForm">`;

  for (let i = 0; i < Object.keys(selectedCompany.region).length; i++) {
    const regionName = Object.keys(selectedCompany.region)[i];
    const checked = i === 0 ? "checked" : ""; // Check the first region by default
    regionDetails +=
      `<label><input type="checkbox" name="selectedRegions" value="${regionName}" onchange="updateSiteDropdown(${selectedCompanyIndex})" ${checked}> ${regionName}</label><hr class="dropdown-divider">`;
  }

  regionDetails += `</form>`;
  regionDropdown.innerHTML = regionDetails;
  updateSiteDropdown(selectedCompanyIndex);
}

let selectesSites = []
let selectedRegion = [];
// function updateSiteDropdown(selectedRegionName, selectedCompanyIndex) {
//   let siteDropdown = document.getElementById("showSites");
//   let siteDetails = ``;

//   // const selectedCompanyIndex = document.querySelector('input[name="radCompanyDrop"]:checked').value;
//   const selectedCompany = resSites.mapping[selectedCompanyIndex];
//   // console.log(selectedCompanyIndex);
//   // console.log(resSites.mapping);
//   // console.log(resSites.mapping[selectedCompanyIndex]);
//   // console.log(selectedRegionName);
//   // console.log( selectedCompany);
//   selectedRegion = selectedCompany.region[selectedRegionName];

//   siteDetails =
//     `<li><input id="selectAll" type="checkbox" onclick="getSiteSocietyIdForData(1000)"/>Select All</li>` +
//     `<hr class="dropdown-divider">`;

//   for (let i = 0; i < selectedRegion.length; i++) {
//     const siteId = selectedRegion[i].pms_site_id;
//     const societyId = selectedRegion[i].society_id;
//     const value = `${siteId}|${societyId}`;
//     const checked = i === 0 ? "checked" : "";

//     siteDetails +=
//       `<li><input type="checkbox" name="chkSiteDrop" class="dropdown-check-list" value="${value}" onclick="getSiteSocietyIdForData(${i})" ${checked}>` +
//       selectedRegion[i].site_name +
//       `</input></li><li><hr class="dropdown-divider"></li>`;
//   }

//   siteDropdown.innerHTML = siteDetails;

//   if (link_project_id == null) {
//     getSiteSocietyIdForData(0);
//   } else {
//     getDetailsIfIdExists(link_project_id, link_project_name, link_society_id);
//   }



// }

function updateSiteDropdown(selectedCompanyIndex) {
  let siteDropdown = document.getElementById("showSites");
  let siteDetails = ``;
  const selectedCompany = resSites.mapping[selectedCompanyIndex];
  const selectedRegions = Array.from(document.querySelectorAll('input[name="selectedRegions"]:checked')).map(checkbox => checkbox.value);

  siteDetails = `<li><input id="selectAll" type="checkbox" onclick="getSiteSocietyIdForData(1000)"/>Select All</li><hr class="dropdown-divider">`;

  for (const selectedRegionName of selectedRegions) {
    const selectedRegion = selectedCompany.region[selectedRegionName];
    for (let i = 0; i < selectedRegion.length; i++) {
      const siteId = selectedRegion[i].pms_site_id;
      const societyId = selectedRegion[i].society_id;
      const value = `${siteId}|${societyId}`;
      siteDetails +=
        `<li><input type="checkbox" name="chkSiteDrop" class="dropdown-check-list" value="${value}" onclick="getSiteSocietyIdForData(${i})">` +
        selectedRegion[i].site_name +
        `</input></li><li><hr class="dropdown-divider"></li>`;
    }
  }
  siteDetails += ` <button class="button button2" id="apply" onclick="getResult()" style="background-color: rgb(1, 146, 1); border-radius: 4px; width: 130px; height: 35px; margin-top: 6px; color: white;">Apply</button>`;
  siteDropdown.innerHTML = siteDetails;

  // Select the first site by default
  const firstSiteCheckbox = siteDropdown.querySelector('input[name="chkSiteDrop"]');
  if (firstSiteCheckbox) {
    firstSiteCheckbox.checked = true;
  }

  if (link_project_id == null) {
    getSiteSocietyIdForData(0);
  } else {
    getDetailsIfIdExists(link_project_id, link_project_name, link_society_id);
  }
}
let savedLayout;

function getSiteSocietyIdForData(i) {
  if (i == 1000) {
    console.log("Hi");
    if (document.getElementById("selectAll").checked) {
      var eleSiteDrop = document.getElementsByName("chkSiteDrop");
      for (var i1 = 0; i1 < eleSiteDrop.length; i1++) {
        if (eleSiteDrop[i1].type == "checkbox") {
          eleSiteDrop[i1].checked = true;

        }
      }
    } else {
      var eleSiteDrop = document.getElementsByName("chkSiteDrop");
      for (var i1 = 0; i1 < eleSiteDrop.length; i1++) {
        if (eleSiteDrop[i1].type == "checkbox") {
          eleSiteDrop[i1].checked = false;

        }
      }
    }
  }

  let markedSiteDrop = "";
  let markedSocietyDrop = "";
  var markedCheckboxSites = document.querySelectorAll(
    'input[name="chkSiteDrop" ]:checked'
  );

  if (markedCheckboxSites.length < numberofRegion) {
    document.getElementById("selectAll").checked = false;
  }
  count = 0
  for (var mChecked of markedCheckboxSites) {
    if (markedSiteDrop == "") {
      var drop_ids = mChecked.value.split("|");
      markedSiteDrop = drop_ids[0];
      markedSocietyDrop = drop_ids[1];
      console.log();


    } else {
      var drop_ids = mChecked.value.split("|");

      markedSiteDrop = markedSiteDrop + "," + drop_ids[0];
      markedSocietyDrop = markedSocietyDrop + "," + drop_ids[1];
      console.log("Select");
      console.log(markedSiteDrop);
      console.log(markedSocietyDrop);
    }
    count = count + 1
  }

  countSiteDrop = markedSiteDrop;
  countSocietyDrop = markedSocietyDrop;
  // nameSiteDrop = resSites.sites[i].site_name;
  // alert(nameSiteDrop);
  console.log(markedSiteDrop);
  console.log(markedSocietyDrop);

  //   if (markedSiteDrop.split(",").length > 1) {

  //   // alert(markedSiteDrop.split(",").length);
  //   // alert(markedSiteDrop);
  //   // alert(markedSocietyDrop);

  //   firstSite.innerHTML = "Multiple Sites Selected"
  // }
  // else {

  //   for (let ind = 0; ind < resSites.sites.length; ind += 1) {

  //     if (markedSiteDrop == resSites.sites[ind].pms_site_id) {
  //       firstSite.innerHTML = resSites.sites[ind].site_name;

  //     }
  //   }

  // }



  if (markedSiteDrop.split(",").length > 1) {
    console.log("Hiiiiiiiiiiiiii hereeeeeeeeeeeeeee")
    // alert(markedSiteDrop.split(",").length);
    // alert(markedSiteDrop);
    // alert(markedSocietyDrop);

    firstSite.innerHTML = "Multiple Sites Selected"

  }
  else {
    console.log(selectedRegion);
    for (let ind = 0; ind < selectedRegion.length; ind += 1) {

      if (markedSiteDrop == selectedRegion[ind].pms_site_id) {



        firstSite.innerHTML = selectedRegion[ind].site_name;
      }
      console.log(firstSite.innerHTML);
    }

  }



  function getRegionIdForAllSelect(r) {
    var checkboxes = document.querySelectorAll(
      'input[type="checkbox"]:checked'
    );
    for (var checkbox of checkboxes) {
      checkbox.checked = this.checked;

    }
  }



  var checkList = document.getElementById("list");
  checkList.getElementsByClassName("anchor")[0].onclick = function (evt) {
    if (checkList.classList.contains("visible"))
      checkList.classList.remove("visible");
    else checkList.classList.add("visible");
  };

  console.log(markedSiteDrop.split("|"));

  globalSiteId = countSiteDrop;
  // alert(globalSiteId);

  // let globalSiteName = firstSite.innerHTML;
  // globalSiteId = resSites.sites[i].pms_site_id;
  // globalSocietyId = resSites.sites[i].society_id;



  // alert(markedSiteDrop);

  if (markedSiteDrop.split(",").length > 1) {
    firstSite.innerHTML = "Multiple Sites Selected"
  }
  else {
    // firstSite.innerHTML = resSites.sites[i].site_name;


    for (let ind = 0; ind < selectedRegion.length; ind += 1) {

      if (markedSiteDrop == selectedRegion[ind].pms_site_id) {
        firstSite.innerHTML = selectedRegion[ind].site_name;

      }
    }



  }

  // ---


  idLink = "?site_id=" + countSiteDrop + "&society_id=" + countSocietyDrop;
  localStorage.setItem('id_link',idLink);
  let link_project_names = urlParams.get("site_name");
  if (selectedRegion.length < 20) {
    for (var ind = 0; ind < selectedRegion.length; ind++) {
      if (markedSiteDrop == selectedRegion[ind].pms_site_id) {
        link_project_names = selectedRegion[ind].site_name
        console.log(link_project_names);
      }
    }
  } else {
    link_project_names = "Multiple Sites Selected"
  }
  //   if(resSites.sites.length >1){
  //     firstSite.innerHTML="Multiple Sites Selected"
  //   }else{
  //   for (var ind = 0; ind < resSites.sites.length; ind ++){
  //     if(markedSiteDrop == resSites.sites[ind].pms_site_id){
  //     link_project_names = resSites.sites[ind].site_name
  //     console.log(link_project_names);
  // //     if(link_project_names>1){
  // // firstSite.innerHTML = "Multiple Sites Selected"
  // //     }
  //     }
  //   }
  // }
  // siteid = "?site_id=" + globalSiteId;
  // getSiteSocietyIdForData(pms_site_id,site_name);

  console.log(markedSiteDrop)
  document.getElementById("toggleCustom").href =
    "custom.html?token=" +
    token
    // +
    // "&pms_site_id=" +
    // markedSiteDrop +
    // "&site_name=" +
    // link_project_names +
    // "&society_id=" + markedSocietyDrop;
  ;
  console.log(markedSiteDrop)
  // document.getElementById("toggleInventory").href =
  //   "inventory.html?token=" + token;

  // if (savedLayout && savedLayout.length > 0) {
  //   console.log(JSON.parse(data.dashboard));
  //   grid.load(savedLayout);
  //   loadDashboardData("custom", newDate, todaysDate);

  // } else {
  //   grid.load(items);
  //   loadDashboardData("custom", newDate, todaysDate);
  // }



  // grid.load(items);
  // loadDashboardData("daily", todaysDate, 0);
}

function initLoad(){
  let newIdLink = localStorage.getItem("id_link");
  let selectedWidgetsList = []

  fetch(`https://oig-reports.lockated.com/api-fm/user-dashboard/get-dashboard/?token=${token}&dashboard_name=fm_daily`)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      if (data.success === "1" && data.dashboard) {

        let savedLayout = JSON.parse(data.dashboard);

        if (savedLayout && savedLayout.length > 0) {
          console.log(JSON.parse(data.dashboard));
          for (let widget in savedLayout) {
            selectedWidgetsList.push(savedLayout[widget].id);
            console.log(savedLayout[widget]);
          }
          console.log(savedLayout);
          items = [];
          console.log(items)
          // items = savedLayout;

          // if (selectedWidgetsList.includes("a11")) {
          //   activeTotalAssetsAvailable = 1;
          //   checkTotalAssetsAvailable.style.color = "blue";
          //   items.push(a11);
          // } else {
          //   activeTotalAssetsAvailable = 0;
          //   checkTotalAssetsAvailable.style.color = "black";
          // }

          if (selectedWidgetsList.includes("a11")) {
            activeTotalAssetsAvailable = 1;
            checkTotalAssetsAvailable.checked = true;
            if (!items.includes(a11)) items.push(a11);
          } else {
            activeTotalAssetsAvailable = 0;
            checkTotalAssetsAvailable.checked = false;
            const index = items.indexOf(a11);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a12")) {
            activeAssetsInUse = 1;
            checkAssetsInUse.checked = true;
            if (!items.includes(a12)) items.push(a12);
          } else {
            activeAssetsInUse = 0;
            checkAssetsInUse.checked = false;
            const index = items.indexOf(a12);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a13")) {
            activeAssetInBreakdown = 1;
            checkAssetInBreakdown.checked = true;
            if (!items.includes(a13)) items.push(a13);
          } else {
            activeAssetInBreakdown = 0;
            checkAssetInBreakdown.checked = false;
            const index = items.indexOf(a13);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a14")) {
            activeCriticalAssetsInBreakdown = 1;
            checkCriticalAssetsInBreakdown.checked = true;
            if (!items.includes(a14)) items.push(a14);
          } else {
            activeCriticalAssetsInBreakdown = 0;
            checkCriticalAssetsInBreakdown.checked = false;
            const index = items.indexOf(a14);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a15")) {
            activePPMConductedAssets = 1;
            checkPPMConductedAssets.checked = true;
            if (!items.includes(a15)) items.push(a15);
          } else {
            activePPMConductedAssets = 0;
            checkPPMConductedAssets.checked = false;
            const index = items.indexOf(a15);
            if (index > -1) items.splice(index, 1);
          }


          // if (selectedWidgetsList.includes("a34")) {
          //   activeLTIR = 1;
          //   checkLTIR.style.color = "blue";
          //   items.push(a34);
          // } else {
          //   activeLTIR = 0;
          //   checkLTIR.style.color = "black";
          // }

          if (selectedWidgetsList.includes("a34")) {
            activeLTIR = 1;
            checkLTIR.checked = true;
            if (!items.includes(a34)) items.push(a34);
          } else {
            activeLTIR = 0;
            checkLTIR.checked = false;
            const index = items.indexOf(a34);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a35")) {
          //   activeZeroIncidentDays = 1;
          //   checkZeroIncidentDays.style.color = "blue";
          //   items.push(a35);
          // } else {
          //   activeZeroIncidentDays = 0;
          //   checkZeroIncidentDays.style.color = "black";
          // }

          if (selectedWidgetsList.includes("a35")) {
            activeZeroIncidentDays = 1;
            checkZeroIncidentDays.checked = true;
            if (!items.includes(a35)) items.push(a35);
          } else {
            activeZeroIncidentDays = 0;
            checkZeroIncidentDays.checked = false;
            const index = items.indexOf(a35);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a36")) {
            activeIncidentPerSqFt = 1;
            checkIncidentPerSqFt.checked = true;
            if (!items.includes(a36)) items.push(a36);
          } else {
            activeIncidentPerSqFt = 0;
            checkIncidentPerSqFt.checked = false;
            const index = items.indexOf(a36);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a37")) {
            activeIncidentNearMissGoodCatch = 1;
            checkIncidentNearMissGoodCatch.checked = true;
            if (!items.includes(a37)) items.push(a37);
          } else {
            activeIncidentNearMissGoodCatch = 0;
            checkIncidentNearMissGoodCatch.checked = false;
            const index = items.indexOf(a111);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a68")) {
            activeExecutiveEscalation = 1;
            checkExecutiveEscalation.checked = true;
            if (!items.includes(a68)) items.push(a68);
          } else {
            activeExecutiveEscalation = 0;
            checkExecutiveEscalation.checked = false;
            const index = items.indexOf(a68);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a16")) {
            activeTickets = 1;
            checkTickets.checked = true;
            if (!items.includes(a16)) items.push(a16);
          } else {
            activeTickets = 0;
            checkTickets.checked = false;
            const index = items.indexOf(a16);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a18")) {
            activeCategoryWiseTickets = 1;
            checkCategoryWiseTickets.checked = true;
            if (!items.includes(a18)) items.push(a18);
          } else {
            activeCategoryWiseTickets = 0;
            checkCategoryWiseTickets.checked = false;
            const index = items.indexOf(a18);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a19")) {
            activeCategoryWiseProactiveTickets = 1;
            checkCategoryWiseProactiveTickets.checked = true;
            if (!items.includes(a19)) items.push(a19);
          } else {
            activeCategoryWiseProactiveTickets = 0;
            checkCategoryWiseProactiveTickets.checked = false;
            const index = items.indexOf(a19);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a69")) {
            activeCustomerSentiments = 1;
            checkCustomerSentiments.checked = true;
            if (!items.includes(a69)) items.push(a69);
          } else {
            activeCustomerSentiments = 0;
            checkCustomerSentiments.checked = false;
            const index = items.indexOf(a69);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a39")) {
            activeCACategoryWiseTickets = 1;
            checkCACategoryWiseTickets.checked = true;
            if (!items.includes(a39)) items.push(a39);
          } else {
            activeCACategoryWiseTickets = 0;
            checkCACategoryWiseTickets.checked = false;
            const index = items.indexOf(a39);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a40")) {
            activeCACategoryWiseProactiveTickets = 1;
            checkCACategoryWiseProactiveTickets.checked = true;
            if (!items.includes(a40)) items.push(a40);
          } else {
            activeCACategoryWiseProactiveTickets = 0;
            checkCACategoryWiseProactiveTickets.checked = false;
            const index = items.indexOf(a40);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a20")) {
            activeTicketsAgeingMatrix = 1;
            checkTicketsAgeingMatrix.checked = true;
            if (!items.includes(a20)) items.push(a20);
          } else {
            activeTicketsAgeingMatrix = 0;
            checkTicketsAgeingMatrix.checked = false;
            const index = items.indexOf(a20);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a21")) {
            activeResolutionTAT = 1;
            checkResolutionTAT.checked = true;
            if (!items.includes(a21)) items.push(a21);
          } else {
            activeResolutionTAT = 0;
            checkResolutionTAT.checked = false;
            const index = items.indexOf(a21);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a22")) {
            activeResponseTAT = 1;
            checkResponseTAT.checked = true;
            if (!items.includes(a22)) items.push(a22);
          } else {
            activeResponseTAT = 0;
            checkResponseTAT.checked = false;
            const index = items.indexOf(a22);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a23")) {
            activeVisitors = 1;
            checkVisitors.checked = true;
            if (!items.includes(a23)) items.push(a23);
          } else {
            activeVisitors = 0;
            checkVisitors.checked = false;
            const index = items.indexOf(a23);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a25")) {
            activePowerConsumption = 1;
            checkPowerConsumption.checked = true;
            if (!items.includes(a25)) items.push(a25);
          } else {
            activePowerConsumption = 0;
            checkPowerConsumption.checked = false;
            const index = items.indexOf(a25);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a118")) {
            activePowerConsumptionTop = 1;
            checkPowerConsumption.checked = true;
            if (!items.includes(a118)) items.push(a118);
          } else {
            activePowerConsumptionTop = 0;
            checkPowerConsumption.checked = false;
            const index = items.indexOf(a118);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a26")) {
            activeWaterConsumption = 1;
            checkWaterConsumption.checked = true;
            if (!items.includes(a26)) items.push(a26);
          } else {
            activeWaterConsumption = 0;
            checkWaterConsumption.checked = false;
            const index = items.indexOf(a26);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a119")) {
            activeWaterConsumptionTop = 1;
            checkWaterConsumptionTop.checked = true;
            if (!items.includes(a119)) items.push(a119);
          } else {
            activeWaterConsumptionTop = 0;
            checkWaterConsumptionTop.checked = false;
            const index = items.indexOf(a119);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a120")) {
            activeTopChecklist = 1;
            checkTopChecklist.checked = true;
            if (!items.includes(a120)) items.push(a120);
          } else {
            activeTopChecklist = 0;
            checkTopChecklist.checked = false;
            const index = items.indexOf(a120);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a121")) {
          //   activeLTIRTop = 1;
          //   checkLTIRTop.checked = true;
          //   if (!items.includes(a121)) items.push(a121);
          // } else {
          //   activeLTIRTop = 0;
          //   checkLTIRTop.checked = false;
          //   const index = items.indexOf(a121);
          //   if (index > -1) items.splice(index, 1);
          // }

          // if (selectedWidgetsList.includes("a122")) {
          //   activeZeroIncidentDaysTop = 1;
          //   checkZeroIncidentDaysTop.checked = true;
          //   if (!items.includes(a122)) items.push(a122);
          // } else {
          //   activeZeroIncidentDaysTop = 0;
          //   checkZeroIncidentDaysTop.checked = false;
          //   const index = items.indexOf(a122);
          //   if (index > -1) items.splice(index, 1);
          // }

          // if (selectedWidgetsList.includes("a123")) {
          //   activeIncidentPerSqFtTop = 1;
          //   checkIncidentPerSqFtTop.checked = true;
          //   if (!items.includes(a123)) items.push(a123);
          // } else {
          //   activeIncidentPerSqFtTop = 0;
          //   checkIncidentPerSqFtTop.checked = false;
          //   const index = items.indexOf(a123);
          //   if (index > -1) items.splice(index, 1);
          // }

          // if (selectedWidgetsList.includes("a124")) {
          //   activeIncidentNearMissGoodCatchTop = 1;
          //   checkIncidentNearMissGoodCatchTop.checked = true;
          //   if (!items.includes(a124)) items.push(a124);
          // } else {
          //   activeIncidentNearMissGoodCatchTop = 0;
          //   checkIncidentNearMissGoodCatchTop.checked = false;
          //   const index = items.indexOf(a124);
          //   if (index > -1) items.splice(index, 1);
          // }


          if (selectedWidgetsList.includes("d11")) {
            activeInventoryConsumption = 1;
            checkInventoryConsumption.checked = true;
            if (!items.includes(d11)) items.push(d11);
          } else {
            activeInventoryConsumption = 0;
            checkInventoryConsumption.checked = false;
            const index = items.indexOf(d11);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d12")) {
            activeInventoryReport = 1;
            checkInventoryReport.checked = true;
            if (!items.includes(d12)) items.push(d12);
          } else {
            activeInventoryReport = 0;
            checkInventoryReport.checked = false;
            const index = items.indexOf(d12);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d13")) {
            activeCurrentStock = 1;
            checkCurrentStock.checked = true;
            if (!items.includes(d13)) items.push(d13);
          } else {
            activeCurrentStock = 0;
            checkCurrentStock.checked = false;
            const index = items.indexOf(d13);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d14")) {
            activeInventoryConsumptionGreen = 1;
            checkInventoryConsumptionGreen.checked = true;
            if (!items.includes(d14)) items.push(d14);
          } else {
            activeInventoryConsumptionGreen = 0;
            checkInventoryConsumptionGreen.checked = false;
            const index = items.indexOf(d14);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d15")) {
            activeInventoryConsumptionReportGreen = 1;
            checkInventoryConsumptionReportGreen.checked = true;
            if (!items.includes(d15)) items.push(d15);
          } else {
            activeInventoryConsumptionReportGreen = 0;
            checkInventoryConsumptionReportGreen.checked = false;
            const index = items.indexOf(d15);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d16")) {
            activeCurrentStockGreen = 1;
            checkCurrentStockGreen.checked = true;
            if (!items.includes(d16)) items.push(d16);
          } else {
            activeCurrentStockGreen = 0;
            checkCurrentStockGreen.checked = false;
            const index = items.indexOf(d16);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a27")) {
            activeCarbonEmission = 1;
            checkCarbonEmission.checked = true;
            if (!items.includes(a27)) items.push(a27);
          } else {
            activeCarbonEmission = 0;
            checkCarbonEmission.checked = false;
            const index = items.indexOf(a27);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a63")) {
            activeEnergyIntensity = 1;
            checkEnergyIntensity.checked = true;
            if (!items.includes(a63)) items.push(a63);
          } else {
            activeEnergyIntensity = 0;
            checkEnergyIntensity.checked = false;
            const index = items.indexOf(a63);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a28")) {
            activeFuelConsumption = 1;
            checkFuelConsumption.checked = true;
            items.push(a28);
            if (!items.includes(a28)) items.push(a28);
          } else {
            activeFuelConsumption = 0;
            checkFuelConsumption.checked = false;
            const index = items.indexOf(a28);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a61")) {
            activeFitout = 1;
            checkFitout.checked = true;
            if (!items.includes(a61)) items.push(a61);
          } else {
            activeFitout = 0;
            checkFitout.checked = false;
            const index = items.indexOf(a61);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a30")) {
            activeIncidents = 1;
            checkIncidents.checked = true;
            if (!items.includes(a30)) items.push(a30);
          } else {
            activeIncidents = 0;
            checkIncidents.checked = false;
            const index = items.indexOf(a30);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a125")) {
          //   activeIncidentsTop = 1;
          //   checkIncidentsTop.checked = true;
          //   if (!items.includes(a125)) items.push(a125);
          // } else {
          //   activeIncidentsTop = 0;
          //   checkIncidentsTop.checked = false;
          //   const index = items.indexOf(a125);
          //   if (index > -1) items.splice(index, 1);
          // }

          if (selectedWidgetsList.includes("a71")) {
            activeOpenEscalation = 1;
            checkOpenEscalation.checked = true;
            if (!items.includes(a71)) items.push(a71);
          } else {
            activeOpenEscalation = 0;
            checkOpenEscalation.checked = false;
            const index = items.indexOf(a71);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a72")) {
            activeCloseEscalation = 1;
            checkCloseEscalation.checked = true;
            if (!items.includes(a72)) items.push(a72);
          } else {
            activeCloseEscalation = 0;
            checkCloseEscalation.checked = false;
            const index = items.indexOf(a72);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a73")) {
            activeAvgEscalation = 1;
            checkAvgEscalation.checked = true;
            if (!items.includes(a73)) items.push(a73);
          } else {
            activeAvgEscalation = 0;
            checkAvgEscalation.checked = false;
            const index = items.indexOf(a73);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a31")) {
            activeCategoryWiseIncidents = 1;
            checkCategoryWiseIncidents.checked = true;
            if (!items.includes(a31)) items.push(a31);
          } else {
            activeCategoryWiseIncidents = 0;
            checkCategoryWiseIncidents.checked = false;
            const index = items.indexOf(a31);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a128")) {
          //   activeCategoryWiseIncidentsTop = 1;
          //   checkCategoryWiseIncidentsTop.checked = true;
          //   if (!items.includes(a128)) items.push(a128);
          // } else {
          //   activeCategoryWiseIncidentsTop = 0;
          //   checkCategoryWiseIncidentsTop.checked = false;
          //   const index = items.indexOf(a128);
          //   if (index > -1) items.splice(index, 1);
          // }

          if (selectedWidgetsList.includes("a32")) {
            activeManPowerAttendance = 1;
            checkManPowerAttendance.checked = true;
            if (!items.includes(a32)) items.push(a32);
          } else {
            activeManPowerAttendance = 0;
            checkManPowerAttendance.checked = false;
            const index = items.indexOf(a32);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a33")) {
            activeEventsFootfallAnalysis = 1;
            checkEventsFootfallAnalysis.checked = true;
            if (!items.includes(a33)) items.push(a33);
          } else {
            activeEventsFootfallAnalysis = 0;
            checkEventsFootfallAnalysis.checked = false;
            const index = items.indexOf(a33);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a38")) {
          //   activeRAC = 1;
          //   checkRAC.style.color = "blue";
          //   items.push(a38);
          // } else {
          //   activeRAC = 0;
          //   checkRAC.style.color = "black";
          // }
          
          // if (selectedWidgetsList.includes("a127")) {
          //   activeRACTop = 1;
          //   checkRACTop.checked = true;
          //   if (!items.includes(a127)) items.push(a127);
          // } else {
          //   activeRACTop = 0;
          //   checkRACTop.checked = false;
          //   const index = items.indexOf(a127);
          //   if (index > -1) items.splice(index, 1);
          // }

          if (selectedWidgetsList.includes("a41")) {
            activeSafeManHours = 1;
            checkSafeManHours.checked = true;
            if (!items.includes(a41)) items.push(a41);
          } else {
            activeSafeManHours = 0;
            checkSafeManHours.checked = false;
            const index = items.indexOf(a41);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a42")) {
            activeAssetsBreakdown = 1;
            checkAssetsBreakdown.checked = true;
            if (!items.includes(a42)) items.push(a42);
          } else {
            activeAssetsBreakdown = 0;
            checkAssetsBreakdown.checked = false;
            const index = items.indexOf(a42);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a44")) {
            activePyramid = 1;
            checkPyramid.checked = true;
            if (!items.includes(a44)) items.push(a44);
          } else {
            activePyramid = 0;
            checkPyramid.checked = false;
            const index = items.indexOf(a44);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a126")) {
          //   activePyramidTop = 1;
          //   checkPyramidTop.checked = true;
          //   if (!items.includes(a126)) items.push(a126);
          // } else {
          //   activePyramidTop = 0;
          //   checkPyramidTop.checked = false;
          //   const index = items.indexOf(a126);
          //   if (index > -1) items.splice(index, 1);
          // }


          if (selectedWidgetsList.includes("a46")) {
            activeRootCause = 1;
            checkRootCause.checked = true;
            if (!items.includes(a46)) items.push(a46);
          } else {
            activeRootCause = 0;
            checkRootCause.checked = false;
            const index = items.indexOf(a46);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a64")) {
            activeBodyInjuryChart = 1;
            checkBodyInjuryChart.checked = true;
            if (!items.includes(a64)) items.push(a64);
          } else {
            activeBodyInjuryChart = 0;
            checkBodyInjuryChart.checked = false;
            const index = items.indexOf(a64);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a67")) {
            activeOccupancy = 1;
            checkOccupancy.checked = true;
            if (!items.includes(a67)) items.push(a67);
          } else {
            activeOccupancy = 0;
            checkOccupancy.checked = false;
            const index = items.indexOf(a67);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a70")) {
            activeCustomAvg = 1;
            checkCustomAvg.checked = true;
            if (!items.includes(a70)) items.push(a70);
          } else {
            activeCustomAvg = 0;
            checkCustomAvg.checked = false;
            const index = items.indexOf(a70);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a74")) {
            activeFacilityInfo = 1;
            checkFacilityInfo.checked = true;
            if (!items.includes(a74)) items.push(a74);
          } else {
            activeFacilityInfo = 0;
            checkFacilityInfo.checked = false;
            const index = items.indexOf(a74);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a75")) {
            activeCheckList = 1;
            checkCheckList.checked = true;
            if (!items.includes(a75)) items.push(a75);
          } else {
            activeCheckList = 0;
            checkCheckList.checked = false;
            const index = items.indexOf(a75);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a116")) {
          //   activeAssetsBreakdownGraph = 1;
          //   checkAssetsBreakdownGraph.style.color = "blue";
          //   items.push(a116);
          // } else {
          //   activeAssetsBreakdownGraph = 0;
          //   checkAssetsBreakdownGraph.style.color = "black";
          // }


          if (selectedWidgetsList.includes("a117")) {
            activeWaste = 1;
            checkWaste.checked = true;
            if (!items.includes(a117)) items.push(a117);
          } else {
            activeWaste = 0;
            checkWaste.checked = false;
            const index = items.indexOf(a117);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a78")) {
            activeDeliveryVisitors = 1;
            checkDeliveryVisitors.checked = true;
            if (!items.includes(a78)) items.push(a78);
          } else {
            activeDeliveryVisitors = 0;
            checkDeliveryVisitors.checked = false;
            const index = items.indexOf(a78);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a79")) {
            activeReactiveProactiveTickets = 1;
            checkReactiveProactiveTickets.checked = true;
            if (!items.includes(a79)) items.push(a79);
          } else {
            activeReactiveProactiveTickets = 0;
            checkReactiveProactiveTickets.checked = false;
            const index = items.indexOf(a79);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a29")) {
            activeFitoutRequest = 1;
            checkFitoutRequest.checked = true;
            if (!items.includes(a29)) items.push(a29);
          } else {
            activeFitoutRequest = 0;
            checkFitoutRequest.checked = false;
            const index = items.indexOf(a29);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a80")) {
            activeRegisterdUser = 1;
            checkRegisterdUser.checked = true;
            if (!items.includes(a80)) items.push(a80);
          } else {
            activeRegisterdUser = 0;
            checkRegisterdUser.checked = false;
            const index = items.indexOf(a80);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a81")) {
            activeTotalDownloads = 1;
            checkTotalDownloads.checked = true;
            if (!items.includes(a81)) items.push(a81);
          } else {
            activeTotalDownloads = 0;
            checkTotalDownloads.checked = false;
            const index = items.indexOf(a81);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a82")) {
            activeZoneWiseEscalation = 1;
            checkZoneWiseEscalation.checked = true;
            if (!items.includes(a82)) items.push(a82);
          } else {
            activeZoneWiseEscalation = 0;
            checkZoneWiseEscalation.checked = false;
            const index = items.indexOf(a82);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a83")) {
            activeOpenAndCloseEscalation = 1;
            checkOpenAndCloseEscalation.checked = true;
            if (!items.includes(a83)) items.push(a83);
          } else {
            activeOpenAndCloseEscalation = 0;
            checkOpenAndCloseEscalation.checked = false;
            const index = items.indexOf(a83);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a84")) {
            activeCategoryWiseEscalation = 1;
            checkCategoryWiseEscalation.checked = true;
            if (!items.includes(a84)) items.push(a84);
          } else {
            activeCategoryWiseEscalation = 0;
            checkCategoryWiseEscalation.checked = false;
            const index = items.indexOf(a84);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a85")) {
            activeServicePartnerEvaluation = 1;
            checkServicePartnerEvaluation.checked = true;
            if (!items.includes(a85)) items.push(a85);
          } else {
            activeServicePartnerEvaluation = 0;
            checkServicePartnerEvaluation.checked = false;
            const index = items.indexOf(a85);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a100")) {
            activeClusterStats = 1;
            checkClusterStats.checked = true;
            if (!items.includes(a100)) items.push(a100);
          } else {
            activeClusterStats = 0;
            checkClusterStats.checked = false;
            const index = items.indexOf(a100);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a101")) {
            activeFunctionWise = 1;
            checkFunctionWise.checked = true;
            if (!items.includes(a101)) items.push(a101);
          } else {
            activeFunctionWise = 0;
            checkFunctionWise.checked = false;
            const index = items.indexOf(a101);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a102")) {
            activeGenderParticipation = 1;
            checkGenderParticipation.checked = true;
            if (!items.includes(a102)) items.push(a102);
          } else {
            activeGenderParticipation = 0;
            checkGenderParticipation.checked = false;
            const index = items.indexOf(a102);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a103")) {
            activeTrendsOverMonthSites = 1;
            checkTrendsOverMonthSites.checked = true;
            if (!items.includes(a103)) items.push(a103);
          } else {
            activeTrendsOverMonthSites = 0;
            checkTrendsOverMonthSites.checked = false;
            const index = items.indexOf(a103);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a48")) {
            activeGoodsIn = 1;
            checkGoodsIn.checked = true;
            if (!items.includes(a48)) items.push(a48);
          } else {
            activeGoodsIn = 0;
            checkGoodsIn.checked = false;
            const index = items.indexOf(a48);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a49")) {
            activeGoodsOut = 1;
            checkGoodsOut.checked = true;
            if (!items.includes(a49)) items.push(a49);
          } else {
            activeGoodsOut = 0;
            checkGoodsOut.checked = false;
            const index = items.indexOf(a49);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a59")) {
            activeGoodsInwards = 1;
            checkGoodsInwards.checked = true;
            if (!items.includes(a59)) items.push(a59);
          } else {
            activeGoodsInwards = 0;
            checkGoodsInwards.checked = false;
            const index = items.indexOf(a59);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a60")) {
            activeGoodsOutwards = 1;
            checkGoodsOutwards.checked = true;
            if (!items.includes(a60)) items.push(a60);
          } else {
            activeGoodsOutwards = 0;
            checkGoodsOutwards.checked = false;
            const index = items.indexOf(a60);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a104")) {
            activeTotalVisitorsII = 1;
            checkTotalVisitorsII.checked = true;
            if (!items.includes(a104)) items.push(a104);
          } else {
            activeTotalVisitorsII = 0;
            checkTotalVisitorsII.checked = false;
            const index = items.indexOf(a104);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a111")) {
            activeTotalStaff = 1;
            checkTotalStaff.checked = true;
            if (!items.includes(a111)) items.push(a111);
          } else {
            activeTotalStaff = 0;
            checkTotalStaff.checked = false;
            const index = items.indexOf(a111);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a112")) {
            activeStaffIn = 1;
            checkStaffIn.checked = true;
            if (!items.includes(a112)) items.push(a112);
          } else {
            activeStaffIn = 0;
            checkStaffIn.checked = false;
            const index = items.indexOf(a112);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a113")) {
            activeStaffOut = 1;
            checkStaffOut.checked = true;
            if (!items.includes(a113)) items.push(a113);
          } else {
            activeStaffOut = 0;
            checkStaffOut.checked = false;
            const index = items.indexOf(a113);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a106")) {
            activeExpectedVisitors = 1;
            checkExpectedVisitors.checked = true;
            if (!items.includes(a106)) items.push(a106);
          } else {
            activeExpectedVisitors = 0;
            checkExpectedVisitors.checked = false;
            const index = items.indexOf(a106);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a107")) {
            activeUnExpectedVisitors = 1;
            checkUnExpectedVisitors.checked = true;
            if (!items.includes(a107)) items.push(a107);
          } else {
            activeUnExpectedVisitors = 0;
            checkUnExpectedVisitors.checked = false;
            const index = items.indexOf(a107);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a105")) {
            activeTotalVisitors = 1;
            checkTotalVisitors.checked = true;
            if (!items.includes(a105)) items.push(a105);
          } else {
            activeTotalVisitors = 0;
            checkTotalVisitors.checked = false;
            const index = items.indexOf(a105);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b70")) {
            activeTotalParking = 1;
            checkTotalParking.checked = true;
            if (!items.includes(b70)) items.push(b70);
          } else {
            activeTotalParking = 0;
            checkTotalParking.checked = false;
            const index = items.indexOf(b70);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b71")) {
            activeFreeParking = 1;
            checkFreeParking.checked = true;
            if (!items.includes(b71)) items.push(b71);
          } else {
            activeFreeParking = 0;
            checkFreeParking.checked = false;
            const index = items.indexOf(b71);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b72")) {
            activePaidParking = 1;
            checkPaidParking.checked = true;
            if (!items.includes(b72)) items.push(b72);
          } else {
            activePaidParking = 0;
            checkPaidParking.checked = false;
            const index = items.indexOf(b72);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b73")) {
            activeOccupiedParking = 1;
            checkOccupiedParking.checked = true;
            if (!items.includes(b73)) items.push(b73);
          } else {
            activeOccupiedParking = 0;
            checkOccupiedParking.checked = false;
            const index = items.indexOf(b73);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b74")) {
            activeVacantParking = 1;
            checkVacantParking.checked = true;
            if (!items.includes(b74)) items.push(b74);
          } else {
            activeVacantParking = 0;
            checkVacantParking.checked = false;
            const index = items.indexOf(b74);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b76")) {
            activePermitSite = 1;
            checkPermitSite.checked = true;
            if (!items.includes(b76)) items.push(b76);

          } else {
            activePermitSite = 0;
            checkPermitSite.checked = false;
            const index = items.indexOf(b76);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("b77")) {
            activePermits = 1;
            checkPermits.checked = true;
            if (!items.includes(b77)) items.push(b77);

          } else {
            activePermits = 0;
            checkPermits.checked = false;
            const index = items.indexOf(b77);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b61")) {
            activeInventory = 1;
            checkInventory.checked = true;
            if (!items.includes(b61)) items.push(b61);

          } else {
            activeInventory = 0;
            checkInventory.checked = false;
            const index = items.indexOf(b61);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b34")) {
            activeTotalAmount = 1;
            checkTotalAmount.checked = true;
            if (!items.includes(b34)) items.push(b34);
          } else {
            activeTotalAmount = 0;
            checkTotalAmount.checked = false;
            const index = items.indexOf(b34);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b35")) {
            activeTotalReceived = 1;
            checkTotalReceived.checked = true;
            if (!items.includes(b35)) items.push(b35);
          } else {
            activeTotalReceived = 0;
            checkTotalReceived.checked = false;
            const index = items.indexOf(b35);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b36")) {
            activeTotalOutstanding = 1;
            checkTotalOutstanding.checked = true;
            if (!items.includes(b36)) items.push(b36);
          } else {
            activeTotalOutstanding = 0;
            checkTotalOutstanding.checked = false;
            const index = items.indexOf(b36);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b78")) {
            activeTotalOutStandingAmount = 1;
            checkTotalOutstandingAmount.checked = true;
            if (!items.includes(b78)) items.push(b78);
          } else {
            activeTotalOutStandingAmount = 0;
            checkTotalOutstandingAmount.checked = false;
            const index = items.indexOf(b78);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c11")) {
            activeDailyStepCount = 1;
            checkDailyStepCount.checked = true;
            if (!items.includes(c11)) items.push(c11);
          } else {
            activeDailyStepCount = 0;
            checkDailyStepCount.checked = false;
            const index = items.indexOf(c11);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c14")) {
            activeDepartmentStats = 1;
            checkDepartmentStats.checked = true;
            if (!items.includes(c14)) items.push(c14);
          } else {
            activeDepartmentStats = 0;
            checkDepartmentStats.checked = false;
            const index = items.indexOf(c14);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c15")) {
            activeEmpParticipationStats = 1;
            checkEmpParticipationStats.checked = true;
            if (!items.includes(c15)) items.push(c15);
          } else {
            activeEmpParticipationStats = 0;
            checkEmpParticipationStats.checked = false;
            const index = items.indexOf(c15);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c19")) {
            activeCommLeaderboard = 1;
            checkCommLeaderboard.checked = true;
            if (!items.includes(c19)) items.push(c19);
          } else {
            activeCommLeaderboard = 0;
            checkCommLeaderboard.checked = false;
            const index = items.indexOf(c19);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c21")) {
            activeCommLeaderboardFemale = 1;
            checkCommLeaderboardFemale.checked = true;
            if (!items.includes(c21)) items.push(c21);
          } else {
            activeCommLeaderboardFemale = 0;
            checkCommLeaderboardFemale.checked = false;
            const index = items.indexOf(c21);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a108")) {
            activeTotalGatePass = 1;
            checkTotalGatePass.checked = true;
            if (!items.includes(a108)) items.push(a108);
          } else {
            activeTotalGatePass = 0;
            checkTotalGatePass.checked = false;
            const index = items.indexOf(a108);
            if (index > -1) items.splice(index, 1);
          }

          
          if (selectedWidgetsList.includes("a109")) {
            activeReturnablePass = 1;
            checkReturnablePass.checked = true;
            if (!items.includes(a109)) items.push(a109_x);
          } else {
            activeReturnablePass = 0;
            checkReturnablePass.checked = false;
            const index = items.indexOf(a109);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a110")) {
            activeNonReturnablePass = 1;
            checkNonReturnablePass.checked = true;
            if (!items.includes(a110)) items.push(a110);
          } else {
            activeNonReturnablePass = 0;
            checkNonReturnablePass.checked = false;
            const index = items.indexOf(a110);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a114")) {
            activeTechnicalChecklist = 1;
            checkTechnicalChecklist.checked = true;
            if (!items.includes(a114)) items.push(a114);
          } else {
            activeTechnicalChecklist = 0;
            checkTechnicalChecklist.checked = false;
            const index = items.indexOf(a114);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a115")) {
            activeNonTechnicalChecklist = 1;
            checkNonTechnicalChecklist.checked = true;
            if (!items.includes(a115)) items.push(a115);
          } else {
            activeNonTechnicalChecklist = 0;
            checkNonTechnicalChecklist.checked = false;
            const index = items.indexOf(a115);
            if (index > -1) items.splice(index, 1);
          }
          console.log("hiiii i am hereeeeeeeee nowwww again");
          idLink = newIdLink;
          grid.load(savedLayout);
          loadDashboardData("custom", startDate.value, endDate.value);

        }  else {
          grid.load(items);
          loadDashboardData("daily", todaysDate, 0);
        }
      } else {

        grid.load(items);
        loadDashboardData("daily", todaysDate, 0);
      }
    })
    .catch(error => {
      console.error('Error:', error);

    });
}
initLoad();

function applySites() {
  let selectedWidgetsList = []

  fetch(`https://oig-reports.lockated.com/api-fm/user-dashboard/get-dashboard/?token=${token}&dashboard_name=fm_daily`)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      if (data.success === "1" && data.dashboard) {

        let savedLayout = JSON.parse(data.dashboard);

        if (savedLayout && savedLayout.length > 0) {
          console.log(JSON.parse(data.dashboard));
          for (let widget in savedLayout) {
            selectedWidgetsList.push(savedLayout[widget].id);
            console.log(savedLayout[widget]);
          }
          console.log(savedLayout);
          items = [];
          console.log(items)
          // items = savedLayout;

          // if (selectedWidgetsList.includes("a11")) {
          //   activeTotalAssetsAvailable = 1;
          //   checkTotalAssetsAvailable.style.color = "blue";
          //   items.push(a11);
          // } else {
          //   activeTotalAssetsAvailable = 0;
          //   checkTotalAssetsAvailable.style.color = "black";
          // }

          if (selectedWidgetsList.includes("a11")) {
            activeTotalAssetsAvailable = 1;
            checkTotalAssetsAvailable.checked = true;
            if (!items.includes(a11)) items.push(a11);
          } else {
            activeTotalAssetsAvailable = 0;
            checkTotalAssetsAvailable.checked = false;
            const index = items.indexOf(a11);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a12")) {
            activeAssetsInUse = 1;
            checkAssetsInUse.checked = true;
            if (!items.includes(a12)) items.push(a12);
          } else {
            activeAssetsInUse = 0;
            checkAssetsInUse.checked = false;
            const index = items.indexOf(a12);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a13")) {
            activeAssetInBreakdown = 1;
            checkAssetInBreakdown.checked = true;
            if (!items.includes(a13)) items.push(a13);
          } else {
            activeAssetInBreakdown = 0;
            checkAssetInBreakdown.checked = false;
            const index = items.indexOf(a13);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a14")) {
            activeCriticalAssetsInBreakdown = 1;
            checkCriticalAssetsInBreakdown.checked = true;
            if (!items.includes(a14)) items.push(a14);
          } else {
            activeCriticalAssetsInBreakdown = 0;
            checkCriticalAssetsInBreakdown.checked = false;
            const index = items.indexOf(a14);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a15")) {
            activePPMConductedAssets = 1;
            checkPPMConductedAssets.checked = true;
            if (!items.includes(a15)) items.push(a15);
          } else {
            activePPMConductedAssets = 0;
            checkPPMConductedAssets.checked = false;
            const index = items.indexOf(a15);
            if (index > -1) items.splice(index, 1);
          }


          // if (selectedWidgetsList.includes("a34")) {
          //   activeLTIR = 1;
          //   checkLTIR.style.color = "blue";
          //   items.push(a34);
          // } else {
          //   activeLTIR = 0;
          //   checkLTIR.style.color = "black";
          // }

          if (selectedWidgetsList.includes("a34")) {
            activeLTIR = 1;
            checkLTIR.checked = true;
            if (!items.includes(a34)) items.push(a34);
          } else {
            activeLTIR = 0;
            checkLTIR.checked = false;
            const index = items.indexOf(a34);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a35")) {
          //   activeZeroIncidentDays = 1;
          //   checkZeroIncidentDays.style.color = "blue";
          //   items.push(a35);
          // } else {
          //   activeZeroIncidentDays = 0;
          //   checkZeroIncidentDays.style.color = "black";
          // }

          if (selectedWidgetsList.includes("a35")) {
            activeZeroIncidentDays = 1;
            checkZeroIncidentDays.checked = true;
            if (!items.includes(a35)) items.push(a35);
          } else {
            activeZeroIncidentDays = 0;
            checkZeroIncidentDays.checked = false;
            const index = items.indexOf(a35);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a36")) {
            activeIncidentPerSqFt = 1;
            checkIncidentPerSqFt.checked = true;
            if (!items.includes(a36)) items.push(a36);
          } else {
            activeIncidentPerSqFt = 0;
            checkIncidentPerSqFt.checked = false;
            const index = items.indexOf(a36);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a37")) {
            activeIncidentNearMissGoodCatch = 1;
            checkIncidentNearMissGoodCatch.checked = true;
            if (!items.includes(a37)) items.push(a37);
          } else {
            activeIncidentNearMissGoodCatch = 0;
            checkIncidentNearMissGoodCatch.checked = false;
            const index = items.indexOf(a111);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a68")) {
            activeExecutiveEscalation = 1;
            checkExecutiveEscalation.checked = true;
            if (!items.includes(a68)) items.push(a68);
          } else {
            activeExecutiveEscalation = 0;
            checkExecutiveEscalation.checked = false;
            const index = items.indexOf(a68);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a16")) {
            activeTickets = 1;
            checkTickets.checked = true;
            if (!items.includes(a16)) items.push(a16);
          } else {
            activeTickets = 0;
            checkTickets.checked = false;
            const index = items.indexOf(a16);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a18")) {
            activeCategoryWiseTickets = 1;
            checkCategoryWiseTickets.checked = true;
            if (!items.includes(a18)) items.push(a18);
          } else {
            activeCategoryWiseTickets = 0;
            checkCategoryWiseTickets.checked = false;
            const index = items.indexOf(a18);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a19")) {
            activeCategoryWiseProactiveTickets = 1;
            checkCategoryWiseProactiveTickets.checked = true;
            if (!items.includes(a19)) items.push(a19);
          } else {
            activeCategoryWiseProactiveTickets = 0;
            checkCategoryWiseProactiveTickets.checked = false;
            const index = items.indexOf(a19);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a69")) {
            activeCustomerSentiments = 1;
            checkCustomerSentiments.checked = true;
            if (!items.includes(a69)) items.push(a69);
          } else {
            activeCustomerSentiments = 0;
            checkCustomerSentiments.checked = false;
            const index = items.indexOf(a69);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a39")) {
            activeCACategoryWiseTickets = 1;
            checkCACategoryWiseTickets.checked = true;
            if (!items.includes(a39)) items.push(a39);
          } else {
            activeCACategoryWiseTickets = 0;
            checkCACategoryWiseTickets.checked = false;
            const index = items.indexOf(a39);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a40")) {
            activeCACategoryWiseProactiveTickets = 1;
            checkCACategoryWiseProactiveTickets.checked = true;
            if (!items.includes(a40)) items.push(a40);
          } else {
            activeCACategoryWiseProactiveTickets = 0;
            checkCACategoryWiseProactiveTickets.checked = false;
            const index = items.indexOf(a40);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a20")) {
            activeTicketsAgeingMatrix = 1;
            checkTicketsAgeingMatrix.checked = true;
            if (!items.includes(a20)) items.push(a20);
          } else {
            activeTicketsAgeingMatrix = 0;
            checkTicketsAgeingMatrix.checked = false;
            const index = items.indexOf(a20);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a21")) {
            activeResolutionTAT = 1;
            checkResolutionTAT.checked = true;
            if (!items.includes(a21)) items.push(a21);
          } else {
            activeResolutionTAT = 0;
            checkResolutionTAT.checked = false;
            const index = items.indexOf(a21);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a22")) {
            activeResponseTAT = 1;
            checkResponseTAT.checked = true;
            if (!items.includes(a22)) items.push(a22);
          } else {
            activeResponseTAT = 0;
            checkResponseTAT.checked = false;
            const index = items.indexOf(a22);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a23")) {
            activeVisitors = 1;
            checkVisitors.checked = true;
            if (!items.includes(a23)) items.push(a23);
          } else {
            activeVisitors = 0;
            checkVisitors.checked = false;
            const index = items.indexOf(a23);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a25")) {
            activePowerConsumption = 1;
            checkPowerConsumption.checked = true;
            if (!items.includes(a25)) items.push(a25);
          } else {
            activePowerConsumption = 0;
            checkPowerConsumption.checked = false;
            const index = items.indexOf(a25);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a118")) {
            activePowerConsumptionTop = 1;
            checkPowerConsumption.checked = true;
            if (!items.includes(a118)) items.push(a118);
          } else {
            activePowerConsumptionTop = 0;
            checkPowerConsumption.checked = false;
            const index = items.indexOf(a118);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a26")) {
            activeWaterConsumption = 1;
            checkWaterConsumption.checked = true;
            if (!items.includes(a26)) items.push(a26);
          } else {
            activeWaterConsumption = 0;
            checkWaterConsumption.checked = false;
            const index = items.indexOf(a26);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a119")) {
            activeWaterConsumptionTop = 1;
            checkWaterConsumptionTop.checked = true;
            if (!items.includes(a119)) items.push(a119);
          } else {
            activeWaterConsumptionTop = 0;
            checkWaterConsumptionTop.checked = false;
            const index = items.indexOf(a119);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a120")) {
            activeTopChecklist = 1;
            checkTopChecklist.checked = true;
            if (!items.includes(a120)) items.push(a120);
          } else {
            activeTopChecklist = 0;
            checkTopChecklist.checked = false;
            const index = items.indexOf(a120);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a121")) {
          //   activeLTIRTop = 1;
          //   checkLTIRTop.checked = true;
          //   if (!items.includes(a121)) items.push(a121);
          // } else {
          //   activeLTIRTop = 0;
          //   checkLTIRTop.checked = false;
          //   const index = items.indexOf(a121);
          //   if (index > -1) items.splice(index, 1);
          // }

          // if (selectedWidgetsList.includes("a122")) {
          //   activeZeroIncidentDaysTop = 1;
          //   checkZeroIncidentDaysTop.checked = true;
          //   if (!items.includes(a122)) items.push(a122);
          // } else {
          //   activeZeroIncidentDaysTop = 0;
          //   checkZeroIncidentDaysTop.checked = false;
          //   const index = items.indexOf(a122);
          //   if (index > -1) items.splice(index, 1);
          // }

          // if (selectedWidgetsList.includes("a123")) {
          //   activeIncidentPerSqFtTop = 1;
          //   checkIncidentPerSqFtTop.checked = true;
          //   if (!items.includes(a123)) items.push(a123);
          // } else {
          //   activeIncidentPerSqFtTop = 0;
          //   checkIncidentPerSqFtTop.checked = false;
          //   const index = items.indexOf(a123);
          //   if (index > -1) items.splice(index, 1);
          // }

          // if (selectedWidgetsList.includes("a124")) {
          //   activeIncidentNearMissGoodCatchTop = 1;
          //   checkIncidentNearMissGoodCatchTop.checked = true;
          //   if (!items.includes(a124)) items.push(a124);
          // } else {
          //   activeIncidentNearMissGoodCatchTop = 0;
          //   checkIncidentNearMissGoodCatchTop.checked = false;
          //   const index = items.indexOf(a124);
          //   if (index > -1) items.splice(index, 1);
          // }


          if (selectedWidgetsList.includes("d11")) {
            activeInventoryConsumption = 1;
            checkInventoryConsumption.checked = true;
            if (!items.includes(d11)) items.push(d11);
          } else {
            activeInventoryConsumption = 0;
            checkInventoryConsumption.checked = false;
            const index = items.indexOf(d11);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d12")) {
            activeInventoryReport = 1;
            checkInventoryReport.checked = true;
            if (!items.includes(d12)) items.push(d12);
          } else {
            activeInventoryReport = 0;
            checkInventoryReport.checked = false;
            const index = items.indexOf(d12);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d13")) {
            activeCurrentStock = 1;
            checkCurrentStock.checked = true;
            if (!items.includes(d13)) items.push(d13);
          } else {
            activeCurrentStock = 0;
            checkCurrentStock.checked = false;
            const index = items.indexOf(d13);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d14")) {
            activeInventoryConsumptionGreen = 1;
            checkInventoryConsumptionGreen.checked = true;
            if (!items.includes(d14)) items.push(d14);
          } else {
            activeInventoryConsumptionGreen = 0;
            checkInventoryConsumptionGreen.checked = false;
            const index = items.indexOf(d14);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d15")) {
            activeInventoryConsumptionReportGreen = 1;
            checkInventoryConsumptionReportGreen.checked = true;
            if (!items.includes(d15)) items.push(d15);
          } else {
            activeInventoryConsumptionReportGreen = 0;
            checkInventoryConsumptionReportGreen.checked = false;
            const index = items.indexOf(d15);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("d16")) {
            activeCurrentStockGreen = 1;
            checkCurrentStockGreen.checked = true;
            if (!items.includes(d16)) items.push(d16);
          } else {
            activeCurrentStockGreen = 0;
            checkCurrentStockGreen.checked = false;
            const index = items.indexOf(d16);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a27")) {
            activeCarbonEmission = 1;
            checkCarbonEmission.checked = true;
            if (!items.includes(a27)) items.push(a27);
          } else {
            activeCarbonEmission = 0;
            checkCarbonEmission.checked = false;
            const index = items.indexOf(a27);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a63")) {
            activeEnergyIntensity = 1;
            checkEnergyIntensity.checked = true;
            if (!items.includes(a63)) items.push(a63);
          } else {
            activeEnergyIntensity = 0;
            checkEnergyIntensity.checked = false;
            const index = items.indexOf(a63);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a28")) {
            activeFuelConsumption = 1;
            checkFuelConsumption.checked = true;
            items.push(a28);
            if (!items.includes(a28)) items.push(a28);
          } else {
            activeFuelConsumption = 0;
            checkFuelConsumption.checked = false;
            const index = items.indexOf(a28);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a61")) {
            activeFitout = 1;
            checkFitout.checked = true;
            if (!items.includes(a61)) items.push(a61);
          } else {
            activeFitout = 0;
            checkFitout.checked = false;
            const index = items.indexOf(a61);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a30")) {
            activeIncidents = 1;
            checkIncidents.checked = true;
            if (!items.includes(a30)) items.push(a30);
          } else {
            activeIncidents = 0;
            checkIncidents.checked = false;
            const index = items.indexOf(a30);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a125")) {
          //   activeIncidentsTop = 1;
          //   checkIncidentsTop.checked = true;
          //   if (!items.includes(a125)) items.push(a125);
          // } else {
          //   activeIncidentsTop = 0;
          //   checkIncidentsTop.checked = false;
          //   const index = items.indexOf(a125);
          //   if (index > -1) items.splice(index, 1);
          // }

          if (selectedWidgetsList.includes("a71")) {
            activeOpenEscalation = 1;
            checkOpenEscalation.checked = true;
            if (!items.includes(a71)) items.push(a71);
          } else {
            activeOpenEscalation = 0;
            checkOpenEscalation.checked = false;
            const index = items.indexOf(a71);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a72")) {
            activeCloseEscalation = 1;
            checkCloseEscalation.checked = true;
            if (!items.includes(a72)) items.push(a72);
          } else {
            activeCloseEscalation = 0;
            checkCloseEscalation.checked = false;
            const index = items.indexOf(a72);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a73")) {
            activeAvgEscalation = 1;
            checkAvgEscalation.checked = true;
            if (!items.includes(a73)) items.push(a73);
          } else {
            activeAvgEscalation = 0;
            checkAvgEscalation.checked = false;
            const index = items.indexOf(a73);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a31")) {
            activeCategoryWiseIncidents = 1;
            checkCategoryWiseIncidents.checked = true;
            if (!items.includes(a31)) items.push(a31);
          } else {
            activeCategoryWiseIncidents = 0;
            checkCategoryWiseIncidents.checked = false;
            const index = items.indexOf(a31);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a128")) {
          //   activeCategoryWiseIncidentsTop = 1;
          //   checkCategoryWiseIncidentsTop.checked = true;
          //   if (!items.includes(a128)) items.push(a128);
          // } else {
          //   activeCategoryWiseIncidentsTop = 0;
          //   checkCategoryWiseIncidentsTop.checked = false;
          //   const index = items.indexOf(a128);
          //   if (index > -1) items.splice(index, 1);
          // }

          if (selectedWidgetsList.includes("a32")) {
            activeManPowerAttendance = 1;
            checkManPowerAttendance.checked = true;
            if (!items.includes(a32)) items.push(a32);
          } else {
            activeManPowerAttendance = 0;
            checkManPowerAttendance.checked = false;
            const index = items.indexOf(a32);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a33")) {
            activeEventsFootfallAnalysis = 1;
            checkEventsFootfallAnalysis.checked = true;
            if (!items.includes(a33)) items.push(a33);
          } else {
            activeEventsFootfallAnalysis = 0;
            checkEventsFootfallAnalysis.checked = false;
            const index = items.indexOf(a33);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a38")) {
          //   activeRAC = 1;
          //   checkRAC.style.color = "blue";
          //   items.push(a38);
          // } else {
          //   activeRAC = 0;
          //   checkRAC.style.color = "black";
          // }
          
          // if (selectedWidgetsList.includes("a127")) {
          //   activeRACTop = 1;
          //   checkRACTop.checked = true;
          //   if (!items.includes(a127)) items.push(a127);
          // } else {
          //   activeRACTop = 0;
          //   checkRACTop.checked = false;
          //   const index = items.indexOf(a127);
          //   if (index > -1) items.splice(index, 1);
          // }

          if (selectedWidgetsList.includes("a41")) {
            activeSafeManHours = 1;
            checkSafeManHours.checked = true;
            if (!items.includes(a41)) items.push(a41);
          } else {
            activeSafeManHours = 0;
            checkSafeManHours.checked = false;
            const index = items.indexOf(a41);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a42")) {
            activeAssetsBreakdown = 1;
            checkAssetsBreakdown.checked = true;
            if (!items.includes(a42)) items.push(a42);
          } else {
            activeAssetsBreakdown = 0;
            checkAssetsBreakdown.checked = false;
            const index = items.indexOf(a42);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a44")) {
            activePyramid = 1;
            checkPyramid.checked = true;
            if (!items.includes(a44)) items.push(a44);
          } else {
            activePyramid = 0;
            checkPyramid.checked = false;
            const index = items.indexOf(a44);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a126")) {
          //   activePyramidTop = 1;
          //   checkPyramidTop.checked = true;
          //   if (!items.includes(a126)) items.push(a126);
          // } else {
          //   activePyramidTop = 0;
          //   checkPyramidTop.checked = false;
          //   const index = items.indexOf(a126);
          //   if (index > -1) items.splice(index, 1);
          // }


          if (selectedWidgetsList.includes("a46")) {
            activeRootCause = 1;
            checkRootCause.checked = true;
            if (!items.includes(a46)) items.push(a46);
          } else {
            activeRootCause = 0;
            checkRootCause.checked = false;
            const index = items.indexOf(a46);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a64")) {
            activeBodyInjuryChart = 1;
            checkBodyInjuryChart.checked = true;
            if (!items.includes(a64)) items.push(a64);
          } else {
            activeBodyInjuryChart = 0;
            checkBodyInjuryChart.checked = false;
            const index = items.indexOf(a64);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a67")) {
            activeOccupancy = 1;
            checkOccupancy.checked = true;
            if (!items.includes(a67)) items.push(a67);
          } else {
            activeOccupancy = 0;
            checkOccupancy.checked = false;
            const index = items.indexOf(a67);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a70")) {
            activeCustomAvg = 1;
            checkCustomAvg.checked = true;
            if (!items.includes(a70)) items.push(a70);
          } else {
            activeCustomAvg = 0;
            checkCustomAvg.checked = false;
            const index = items.indexOf(a70);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a74")) {
            activeFacilityInfo = 1;
            checkFacilityInfo.checked = true;
            if (!items.includes(a74)) items.push(a74);
          } else {
            activeFacilityInfo = 0;
            checkFacilityInfo.checked = false;
            const index = items.indexOf(a74);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a75")) {
            activeCheckList = 1;
            checkCheckList.checked = true;
            if (!items.includes(a75)) items.push(a75);
          } else {
            activeCheckList = 0;
            checkCheckList.checked = false;
            const index = items.indexOf(a75);
            if (index > -1) items.splice(index, 1);
          }

          // if (selectedWidgetsList.includes("a116")) {
          //   activeAssetsBreakdownGraph = 1;
          //   checkAssetsBreakdownGraph.style.color = "blue";
          //   items.push(a116);
          // } else {
          //   activeAssetsBreakdownGraph = 0;
          //   checkAssetsBreakdownGraph.style.color = "black";
          // }


          if (selectedWidgetsList.includes("a117")) {
            activeWaste = 1;
            checkWaste.checked = true;
            if (!items.includes(a117)) items.push(a117);
          } else {
            activeWaste = 0;
            checkWaste.checked = false;
            const index = items.indexOf(a117);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a78")) {
            activeDeliveryVisitors = 1;
            checkDeliveryVisitors.checked = true;
            if (!items.includes(a78)) items.push(a78);
          } else {
            activeDeliveryVisitors = 0;
            checkDeliveryVisitors.checked = false;
            const index = items.indexOf(a78);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a79")) {
            activeReactiveProactiveTickets = 1;
            checkReactiveProactiveTickets.checked = true;
            if (!items.includes(a79)) items.push(a79);
          } else {
            activeReactiveProactiveTickets = 0;
            checkReactiveProactiveTickets.checked = false;
            const index = items.indexOf(a79);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a29")) {
            activeFitoutRequest = 1;
            checkFitoutRequest.checked = true;
            if (!items.includes(a29)) items.push(a29);
          } else {
            activeFitoutRequest = 0;
            checkFitoutRequest.checked = false;
            const index = items.indexOf(a29);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a80")) {
            activeRegisterdUser = 1;
            checkRegisterdUser.checked = true;
            if (!items.includes(a80)) items.push(a80);
          } else {
            activeRegisterdUser = 0;
            checkRegisterdUser.checked = false;
            const index = items.indexOf(a80);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a81")) {
            activeTotalDownloads = 1;
            checkTotalDownloads.checked = true;
            if (!items.includes(a81)) items.push(a81);
          } else {
            activeTotalDownloads = 0;
            checkTotalDownloads.checked = false;
            const index = items.indexOf(a81);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a82")) {
            activeZoneWiseEscalation = 1;
            checkZoneWiseEscalation.checked = true;
            if (!items.includes(a82)) items.push(a82);
          } else {
            activeZoneWiseEscalation = 0;
            checkZoneWiseEscalation.checked = false;
            const index = items.indexOf(a82);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a83")) {
            activeOpenAndCloseEscalation = 1;
            checkOpenAndCloseEscalation.checked = true;
            if (!items.includes(a83)) items.push(a83);
          } else {
            activeOpenAndCloseEscalation = 0;
            checkOpenAndCloseEscalation.checked = false;
            const index = items.indexOf(a83);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a84")) {
            activeCategoryWiseEscalation = 1;
            checkCategoryWiseEscalation.checked = true;
            if (!items.includes(a84)) items.push(a84);
          } else {
            activeCategoryWiseEscalation = 0;
            checkCategoryWiseEscalation.checked = false;
            const index = items.indexOf(a84);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a85")) {
            activeServicePartnerEvaluation = 1;
            checkServicePartnerEvaluation.checked = true;
            if (!items.includes(a85)) items.push(a85);
          } else {
            activeServicePartnerEvaluation = 0;
            checkServicePartnerEvaluation.checked = false;
            const index = items.indexOf(a85);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a100")) {
            activeClusterStats = 1;
            checkClusterStats.checked = true;
            if (!items.includes(a100)) items.push(a100);
          } else {
            activeClusterStats = 0;
            checkClusterStats.checked = false;
            const index = items.indexOf(a100);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a101")) {
            activeFunctionWise = 1;
            checkFunctionWise.checked = true;
            if (!items.includes(a101)) items.push(a101);
          } else {
            activeFunctionWise = 0;
            checkFunctionWise.checked = false;
            const index = items.indexOf(a101);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a102")) {
            activeGenderParticipation = 1;
            checkGenderParticipation.checked = true;
            if (!items.includes(a102)) items.push(a102);
          } else {
            activeGenderParticipation = 0;
            checkGenderParticipation.checked = false;
            const index = items.indexOf(a102);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a103")) {
            activeTrendsOverMonthSites = 1;
            checkTrendsOverMonthSites.checked = true;
            if (!items.includes(a103)) items.push(a103);
          } else {
            activeTrendsOverMonthSites = 0;
            checkTrendsOverMonthSites.checked = false;
            const index = items.indexOf(a103);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a48")) {
            activeGoodsIn = 1;
            checkGoodsIn.checked = true;
            if (!items.includes(a48)) items.push(a48);
          } else {
            activeGoodsIn = 0;
            checkGoodsIn.checked = false;
            const index = items.indexOf(a48);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a49")) {
            activeGoodsOut = 1;
            checkGoodsOut.checked = true;
            if (!items.includes(a49)) items.push(a49);
          } else {
            activeGoodsOut = 0;
            checkGoodsOut.checked = false;
            const index = items.indexOf(a49);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a59")) {
            activeGoodsInwards = 1;
            checkGoodsInwards.checked = true;
            if (!items.includes(a59)) items.push(a59);
          } else {
            activeGoodsInwards = 0;
            checkGoodsInwards.checked = false;
            const index = items.indexOf(a59);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a60")) {
            activeGoodsOutwards = 1;
            checkGoodsOutwards.checked = true;
            if (!items.includes(a60)) items.push(a60);
          } else {
            activeGoodsOutwards = 0;
            checkGoodsOutwards.checked = false;
            const index = items.indexOf(a60);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a104")) {
            activeTotalVisitorsII = 1;
            checkTotalVisitorsII.checked = true;
            if (!items.includes(a104)) items.push(a104);
          } else {
            activeTotalVisitorsII = 0;
            checkTotalVisitorsII.checked = false;
            const index = items.indexOf(a104);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a111")) {
            activeTotalStaff = 1;
            checkTotalStaff.checked = true;
            if (!items.includes(a111)) items.push(a111);
          } else {
            activeTotalStaff = 0;
            checkTotalStaff.checked = false;
            const index = items.indexOf(a111);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a112")) {
            activeStaffIn = 1;
            checkStaffIn.checked = true;
            if (!items.includes(a112)) items.push(a112);
          } else {
            activeStaffIn = 0;
            checkStaffIn.checked = false;
            const index = items.indexOf(a112);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a113")) {
            activeStaffOut = 1;
            checkStaffOut.checked = true;
            if (!items.includes(a113)) items.push(a113);
          } else {
            activeStaffOut = 0;
            checkStaffOut.checked = false;
            const index = items.indexOf(a113);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a106")) {
            activeExpectedVisitors = 1;
            checkExpectedVisitors.checked = true;
            if (!items.includes(a106)) items.push(a106);
          } else {
            activeExpectedVisitors = 0;
            checkExpectedVisitors.checked = false;
            const index = items.indexOf(a106);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a107")) {
            activeUnExpectedVisitors = 1;
            checkUnExpectedVisitors.checked = true;
            if (!items.includes(a107)) items.push(a107);
          } else {
            activeUnExpectedVisitors = 0;
            checkUnExpectedVisitors.checked = false;
            const index = items.indexOf(a107);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a105")) {
            activeTotalVisitors = 1;
            checkTotalVisitors.checked = true;
            if (!items.includes(a105)) items.push(a105);
          } else {
            activeTotalVisitors = 0;
            checkTotalVisitors.checked = false;
            const index = items.indexOf(a105);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b70")) {
            activeTotalParking = 1;
            checkTotalParking.checked = true;
            if (!items.includes(b70)) items.push(b70);
          } else {
            activeTotalParking = 0;
            checkTotalParking.checked = false;
            const index = items.indexOf(b70);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b71")) {
            activeFreeParking = 1;
            checkFreeParking.checked = true;
            if (!items.includes(b71)) items.push(b71);
          } else {
            activeFreeParking = 0;
            checkFreeParking.checked = false;
            const index = items.indexOf(b71);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b72")) {
            activePaidParking = 1;
            checkPaidParking.checked = true;
            if (!items.includes(b72)) items.push(b72);
          } else {
            activePaidParking = 0;
            checkPaidParking.checked = false;
            const index = items.indexOf(b72);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b73")) {
            activeOccupiedParking = 1;
            checkOccupiedParking.checked = true;
            if (!items.includes(b73)) items.push(b73);
          } else {
            activeOccupiedParking = 0;
            checkOccupiedParking.checked = false;
            const index = items.indexOf(b73);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b74")) {
            activeVacantParking = 1;
            checkVacantParking.checked = true;
            if (!items.includes(b74)) items.push(b74);
          } else {
            activeVacantParking = 0;
            checkVacantParking.checked = false;
            const index = items.indexOf(b74);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b76")) {
            activePermitSite = 1;
            checkPermitSite.checked = true;
            if (!items.includes(b76)) items.push(b76);

          } else {
            activePermitSite = 0;
            checkPermitSite.checked = false;
            const index = items.indexOf(b76);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("b77")) {
            activePermits = 1;
            checkPermits.checked = true;
            if (!items.includes(b77)) items.push(b77);

          } else {
            activePermits = 0;
            checkPermits.checked = false;
            const index = items.indexOf(b77);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b61")) {
            activeInventory = 1;
            checkInventory.checked = true;
            if (!items.includes(b61)) items.push(b61);

          } else {
            activeInventory = 0;
            checkInventory.checked = false;
            const index = items.indexOf(b61);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b34")) {
            activeTotalAmount = 1;
            checkTotalAmount.checked = true;
            if (!items.includes(b34)) items.push(b34);
          } else {
            activeTotalAmount = 0;
            checkTotalAmount.checked = false;
            const index = items.indexOf(b34);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b35")) {
            activeTotalReceived = 1;
            checkTotalReceived.checked = true;
            if (!items.includes(b35)) items.push(b35);
          } else {
            activeTotalReceived = 0;
            checkTotalReceived.checked = false;
            const index = items.indexOf(b35);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b36")) {
            activeTotalOutstanding = 1;
            checkTotalOutstanding.checked = true;
            if (!items.includes(b36)) items.push(b36);
          } else {
            activeTotalOutstanding = 0;
            checkTotalOutstanding.checked = false;
            const index = items.indexOf(b36);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("b78")) {
            activeTotalOutStandingAmount = 1;
            checkTotalOutstandingAmount.checked = true;
            if (!items.includes(b78)) items.push(b78);
          } else {
            activeTotalOutStandingAmount = 0;
            checkTotalOutstandingAmount.checked = false;
            const index = items.indexOf(b78);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c11")) {
            activeDailyStepCount = 1;
            checkDailyStepCount.checked = true;
            if (!items.includes(c11)) items.push(c11);
          } else {
            activeDailyStepCount = 0;
            checkDailyStepCount.checked = false;
            const index = items.indexOf(c11);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c14")) {
            activeDepartmentStats = 1;
            checkDepartmentStats.checked = true;
            if (!items.includes(c14)) items.push(c14);
          } else {
            activeDepartmentStats = 0;
            checkDepartmentStats.checked = false;
            const index = items.indexOf(c14);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c15")) {
            activeEmpParticipationStats = 1;
            checkEmpParticipationStats.checked = true;
            if (!items.includes(c15)) items.push(c15);
          } else {
            activeEmpParticipationStats = 0;
            checkEmpParticipationStats.checked = false;
            const index = items.indexOf(c15);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c19")) {
            activeCommLeaderboard = 1;
            checkCommLeaderboard.checked = true;
            if (!items.includes(c19)) items.push(c19);
          } else {
            activeCommLeaderboard = 0;
            checkCommLeaderboard.checked = false;
            const index = items.indexOf(c19);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("c21")) {
            activeCommLeaderboardFemale = 1;
            checkCommLeaderboardFemale.checked = true;
            if (!items.includes(c21)) items.push(c21);
          } else {
            activeCommLeaderboardFemale = 0;
            checkCommLeaderboardFemale.checked = false;
            const index = items.indexOf(c21);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a108")) {
            activeTotalGatePass = 1;
            checkTotalGatePass.checked = true;
            if (!items.includes(a108)) items.push(a108);
          } else {
            activeTotalGatePass = 0;
            checkTotalGatePass.checked = false;
            const index = items.indexOf(a108);
            if (index > -1) items.splice(index, 1);
          }

          
          if (selectedWidgetsList.includes("a109")) {
            activeReturnablePass = 1;
            checkReturnablePass.checked = true;
            if (!items.includes(a109)) items.push(a109_x);
          } else {
            activeReturnablePass = 0;
            checkReturnablePass.checked = false;
            const index = items.indexOf(a109);
            if (index > -1) items.splice(index, 1);
          }


          if (selectedWidgetsList.includes("a110")) {
            activeNonReturnablePass = 1;
            checkNonReturnablePass.checked = true;
            if (!items.includes(a110)) items.push(a110);
          } else {
            activeNonReturnablePass = 0;
            checkNonReturnablePass.checked = false;
            const index = items.indexOf(a110);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a114")) {
            activeTechnicalChecklist = 1;
            checkTechnicalChecklist.checked = true;
            if (!items.includes(a114)) items.push(a114);
          } else {
            activeTechnicalChecklist = 0;
            checkTechnicalChecklist.checked = false;
            const index = items.indexOf(a114);
            if (index > -1) items.splice(index, 1);
          }

          if (selectedWidgetsList.includes("a115")) {
            activeNonTechnicalChecklist = 1;
            checkNonTechnicalChecklist.checked = true;
            if (!items.includes(a115)) items.push(a115);
          } else {
            activeNonTechnicalChecklist = 0;
            checkNonTechnicalChecklist.checked = false;
            const index = items.indexOf(a115);
            if (index > -1) items.splice(index, 1);
          }
          console.log("hiiii i am hereeeeeeeee nowwww again");
          idLink = newIdLink;
          grid.load(savedLayout);
          loadDashboardData("custom", startDate.value, endDate.value);

        }  else {
          grid.load(items);
          loadDashboardData("daily", todaysDate, 0);
        }
      } else {

        grid.load(items);
        loadDashboardData("daily", todaysDate, 0);
      }
    })
    .catch(error => {
      console.error('Error:', error);

    });
}
// alert(globalSiteId);

function getDetailsIfIdExists(pro_id, pro_name, link_society_id) {
  countSiteDrop = pro_id;
  nameSiteDrop = pro_name;
  // alert(pro_name);
  firstSite.innerHTML = pro_name;
  let globalSiteName = firstSite.innerHTML;

  globalSiteId = pro_id;
  // alert(globalSiteId);
  // alert(link_society_id);
  // globalSocietyId = soc_id;
  idLink = "?site_id=" + pro_id + "&society_id=" + link_society_id;

  document.getElementById("toggleCustom").href =
    "custom.html?token=" +
    token
    +
    "&pms_site_id=" +
    pro_id +
    "&site_name=" +
    globalSiteName +
    "&society_id=" + link_society_id;
  ;

  // document.getElementById("toggleCustom").href = "index.html?token=" + token;
  // document.getElementById("toggleInventory").href =
  //   "inventory.html?token=" + token;

  // if (savedLayout && savedLayout.length > 0) {
  //   console.log(JSON.parse(data.dashboard));
  //   grid.load(savedLayout);
  //   loadDashboardData("daily", todaysDate, 0);

  // } else {
  //   grid.load(items);
  //   loadDashboardData("daily", todaysDate, 0);
  // }
  let selectedWidgetsList = []
  fetch(`https://oig-reports.lockated.com/api-fm/user-dashboard/get-dashboard/?token=${token}`)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      if (data.success === "1" && data.dashboard) {

        savedLayout = JSON.parse(data.dashboard);

        if (data.success === "1" && data.dashboard) {

          savedLayout = JSON.parse(data.dashboard);

          if (savedLayout && savedLayout.length > 0) {
            console.log(JSON.parse(data.dashboard));
            for (let widget in savedLayout) {
              selectedWidgetsList.push(savedLayout[widget].id);
              console.log(savedLayout[widget]);
            }
            console.log(savedLayout);
            items = [];
            console.log(items)
            // items = savedLayout;
  
            // if (selectedWidgetsList.includes("a11")) {
            //   activeTotalAssetsAvailable = 1;
            //   checkTotalAssetsAvailable.style.color = "blue";
            //   items.push(a11);
            // } else {
            //   activeTotalAssetsAvailable = 0;
            //   checkTotalAssetsAvailable.style.color = "black";
            // }
  
            if (selectedWidgetsList.includes("a11")) {
              activeTotalAssetsAvailable = 1;
              checkTotalAssetsAvailable.checked = true;
              if (!items.includes(a11)) items.push(a11);
            } else {
              activeTotalAssetsAvailable = 0;
              checkTotalAssetsAvailable.checked = false;
              const index = items.indexOf(a11);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a12")) {
              activeAssetsInUse = 1;
              checkAssetsInUse.checked = true;
              if (!items.includes(a12)) items.push(a12);
            } else {
              activeAssetsInUse = 0;
              checkAssetsInUse.checked = false;
              const index = items.indexOf(a12);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a13")) {
              activeAssetInBreakdown = 1;
              checkAssetInBreakdown.checked = true;
              if (!items.includes(a13)) items.push(a13);
            } else {
              activeAssetInBreakdown = 0;
              checkAssetInBreakdown.checked = false;
              const index = items.indexOf(a13);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a14")) {
              activeCriticalAssetsInBreakdown = 1;
              checkCriticalAssetsInBreakdown.checked = true;
              if (!items.includes(a14)) items.push(a14);
            } else {
              activeCriticalAssetsInBreakdown = 0;
              checkCriticalAssetsInBreakdown.checked = false;
              const index = items.indexOf(a14);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a15")) {
              activePPMConductedAssets = 1;
              checkPPMConductedAssets.checked = true;
              if (!items.includes(a15)) items.push(a15);
            } else {
              activePPMConductedAssets = 0;
              checkPPMConductedAssets.checked = false;
              const index = items.indexOf(a15);
              if (index > -1) items.splice(index, 1);
            }
  
  
            // if (selectedWidgetsList.includes("a34")) {
            //   activeLTIR = 1;
            //   checkLTIR.style.color = "blue";
            //   items.push(a34);
            // } else {
            //   activeLTIR = 0;
            //   checkLTIR.style.color = "black";
            // }
  
            if (selectedWidgetsList.includes("a34")) {
              activeLTIR = 1;
              checkLTIR.checked = true;
              if (!items.includes(a34)) items.push(a34);
            } else {
              activeLTIR = 0;
              checkLTIR.checked = false;
              const index = items.indexOf(a34);
              if (index > -1) items.splice(index, 1);
            }
  
            // if (selectedWidgetsList.includes("a35")) {
            //   activeZeroIncidentDays = 1;
            //   checkZeroIncidentDays.style.color = "blue";
            //   items.push(a35);
            // } else {
            //   activeZeroIncidentDays = 0;
            //   checkZeroIncidentDays.style.color = "black";
            // }
  
            if (selectedWidgetsList.includes("a35")) {
              activeZeroIncidentDays = 1;
              checkZeroIncidentDays.checked = true;
              if (!items.includes(a35)) items.push(a35);
            } else {
              activeZeroIncidentDays = 0;
              checkZeroIncidentDays.checked = false;
              const index = items.indexOf(a35);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a36")) {
              activeIncidentPerSqFt = 1;
              checkIncidentPerSqFt.checked = true;
              if (!items.includes(a36)) items.push(a36);
            } else {
              activeIncidentPerSqFt = 0;
              checkIncidentPerSqFt.checked = false;
              const index = items.indexOf(a36);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a37")) {
              activeIncidentNearMissGoodCatch = 1;
              checkIncidentNearMissGoodCatch.checked = true;
              if (!items.includes(a37)) items.push(a37);
            } else {
              activeIncidentNearMissGoodCatch = 0;
              checkIncidentNearMissGoodCatch.checked = false;
              const index = items.indexOf(a111);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a68")) {
              activeExecutiveEscalation = 1;
              checkExecutiveEscalation.checked = true;
              if (!items.includes(a68)) items.push(a68);
            } else {
              activeExecutiveEscalation = 0;
              checkExecutiveEscalation.checked = false;
              const index = items.indexOf(a68);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a16")) {
              activeTickets = 1;
              checkTickets.checked = true;
              if (!items.includes(a16)) items.push(a16);
            } else {
              activeTickets = 0;
              checkTickets.checked = false;
              const index = items.indexOf(a16);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a18")) {
              activeCategoryWiseTickets = 1;
              checkCategoryWiseTickets.checked = true;
              if (!items.includes(a18)) items.push(a18);
            } else {
              activeCategoryWiseTickets = 0;
              checkCategoryWiseTickets.checked = false;
              const index = items.indexOf(a18);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a19")) {
              activeCategoryWiseProactiveTickets = 1;
              checkCategoryWiseProactiveTickets.checked = true;
              if (!items.includes(a19)) items.push(a19);
            } else {
              activeCategoryWiseProactiveTickets = 0;
              checkCategoryWiseProactiveTickets.checked = false;
              const index = items.indexOf(a19);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a69")) {
              activeCustomerSentiments = 1;
              checkCustomerSentiments.checked = true;
              if (!items.includes(a69)) items.push(a69);
            } else {
              activeCustomerSentiments = 0;
              checkCustomerSentiments.checked = false;
              const index = items.indexOf(a69);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a39")) {
              activeCACategoryWiseTickets = 1;
              checkCACategoryWiseTickets.checked = true;
              if (!items.includes(a39)) items.push(a39);
            } else {
              activeCACategoryWiseTickets = 0;
              checkCACategoryWiseTickets.checked = false;
              const index = items.indexOf(a39);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a40")) {
              activeCACategoryWiseProactiveTickets = 1;
              checkCACategoryWiseProactiveTickets.checked = true;
              if (!items.includes(a40)) items.push(a40);
            } else {
              activeCACategoryWiseProactiveTickets = 0;
              checkCACategoryWiseProactiveTickets.checked = false;
              const index = items.indexOf(a40);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a20")) {
              activeTicketsAgeingMatrix = 1;
              checkTicketsAgeingMatrix.checked = true;
              if (!items.includes(a20)) items.push(a20);
            } else {
              activeTicketsAgeingMatrix = 0;
              checkTicketsAgeingMatrix.checked = false;
              const index = items.indexOf(a20);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a21")) {
              activeResolutionTAT = 1;
              checkResolutionTAT.checked = true;
              if (!items.includes(a21)) items.push(a21);
            } else {
              activeResolutionTAT = 0;
              checkResolutionTAT.checked = false;
              const index = items.indexOf(a21);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a22")) {
              activeResponseTAT = 1;
              checkResponseTAT.checked = true;
              if (!items.includes(a22)) items.push(a22);
            } else {
              activeResponseTAT = 0;
              checkResponseTAT.checked = false;
              const index = items.indexOf(a22);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a23")) {
              activeVisitors = 1;
              checkVisitors.checked = true;
              if (!items.includes(a23)) items.push(a23);
            } else {
              activeVisitors = 0;
              checkVisitors.checked = false;
              const index = items.indexOf(a23);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a25")) {
              activePowerConsumption = 1;
              checkPowerConsumption.checked = true;
              if (!items.includes(a25)) items.push(a25);
            } else {
              activePowerConsumption = 0;
              checkPowerConsumption.checked = false;
              const index = items.indexOf(a25);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a118")) {
              activePowerConsumptionTop = 1;
              checkPowerConsumption.checked = true;
              if (!items.includes(a118)) items.push(a118);
            } else {
              activePowerConsumptionTop = 0;
              checkPowerConsumption.checked = false;
              const index = items.indexOf(a118);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a26")) {
              activeWaterConsumption = 1;
              checkWaterConsumption.checked = true;
              if (!items.includes(a26)) items.push(a26);
            } else {
              activeWaterConsumption = 0;
              checkWaterConsumption.checked = false;
              const index = items.indexOf(a26);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a119")) {
              activeWaterConsumptionTop = 1;
              checkWaterConsumptionTop.checked = true;
              if (!items.includes(a119)) items.push(a119);
            } else {
              activeWaterConsumptionTop = 0;
              checkWaterConsumptionTop.checked = false;
              const index = items.indexOf(a119);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a120")) {
              activeTopChecklist = 1;
              checkTopChecklist.checked = true;
              if (!items.includes(a120)) items.push(a120);
            } else {
              activeTopChecklist = 0;
              checkTopChecklist.checked = false;
              const index = items.indexOf(a120);
              if (index > -1) items.splice(index, 1);
            }
  
            // if (selectedWidgetsList.includes("a121")) {
            //   activeLTIRTop = 1;
            //   checkLTIRTop.checked = true;
            //   if (!items.includes(a121)) items.push(a121);
            // } else {
            //   activeLTIRTop = 0;
            //   checkLTIRTop.checked = false;
            //   const index = items.indexOf(a121);
            //   if (index > -1) items.splice(index, 1);
            // }
  
            // if (selectedWidgetsList.includes("a122")) {
            //   activeZeroIncidentDaysTop = 1;
            //   checkZeroIncidentDaysTop.checked = true;
            //   if (!items.includes(a122)) items.push(a122);
            // } else {
            //   activeZeroIncidentDaysTop = 0;
            //   checkZeroIncidentDaysTop.checked = false;
            //   const index = items.indexOf(a122);
            //   if (index > -1) items.splice(index, 1);
            // }
  
            // if (selectedWidgetsList.includes("a123")) {
            //   activeIncidentPerSqFtTop = 1;
            //   checkIncidentPerSqFtTop.checked = true;
            //   if (!items.includes(a123)) items.push(a123);
            // } else {
            //   activeIncidentPerSqFtTop = 0;
            //   checkIncidentPerSqFtTop.checked = false;
            //   const index = items.indexOf(a123);
            //   if (index > -1) items.splice(index, 1);
            // }
  
            // if (selectedWidgetsList.includes("a124")) {
            //   activeIncidentNearMissGoodCatchTop = 1;
            //   checkIncidentNearMissGoodCatchTop.checked = true;
            //   if (!items.includes(a124)) items.push(a124);
            // } else {
            //   activeIncidentNearMissGoodCatchTop = 0;
            //   checkIncidentNearMissGoodCatchTop.checked = false;
            //   const index = items.indexOf(a124);
            //   if (index > -1) items.splice(index, 1);
            // }
  
  
            if (selectedWidgetsList.includes("d11")) {
              activeInventoryConsumption = 1;
              checkInventoryConsumption.checked = true;
              if (!items.includes(d11)) items.push(d11);
            } else {
              activeInventoryConsumption = 0;
              checkInventoryConsumption.checked = false;
              const index = items.indexOf(d11);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("d12")) {
              activeInventoryReport = 1;
              checkInventoryReport.checked = true;
              if (!items.includes(d12)) items.push(d12);
            } else {
              activeInventoryReport = 0;
              checkInventoryReport.checked = false;
              const index = items.indexOf(d12);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("d13")) {
              activeCurrentStock = 1;
              checkCurrentStock.checked = true;
              if (!items.includes(d13)) items.push(d13);
            } else {
              activeCurrentStock = 0;
              checkCurrentStock.checked = false;
              const index = items.indexOf(d13);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("d14")) {
              activeInventoryConsumptionGreen = 1;
              checkInventoryConsumptionGreen.checked = true;
              if (!items.includes(d14)) items.push(d14);
            } else {
              activeInventoryConsumptionGreen = 0;
              checkInventoryConsumptionGreen.checked = false;
              const index = items.indexOf(d14);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("d15")) {
              activeInventoryConsumptionReportGreen = 1;
              checkInventoryConsumptionReportGreen.checked = true;
              if (!items.includes(d15)) items.push(d15);
            } else {
              activeInventoryConsumptionReportGreen = 0;
              checkInventoryConsumptionReportGreen.checked = false;
              const index = items.indexOf(d15);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("d16")) {
              activeCurrentStockGreen = 1;
              checkCurrentStockGreen.checked = true;
              if (!items.includes(d16)) items.push(d16);
            } else {
              activeCurrentStockGreen = 0;
              checkCurrentStockGreen.checked = false;
              const index = items.indexOf(d16);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a27")) {
              activeCarbonEmission = 1;
              checkCarbonEmission.checked = true;
              if (!items.includes(a27)) items.push(a27);
            } else {
              activeCarbonEmission = 0;
              checkCarbonEmission.checked = false;
              const index = items.indexOf(a27);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a63")) {
              activeEnergyIntensity = 1;
              checkEnergyIntensity.checked = true;
              if (!items.includes(a63)) items.push(a63);
            } else {
              activeEnergyIntensity = 0;
              checkEnergyIntensity.checked = false;
              const index = items.indexOf(a63);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a28")) {
              activeFuelConsumption = 1;
              checkFuelConsumption.checked = true;
              items.push(a28);
              if (!items.includes(a28)) items.push(a28);
            } else {
              activeFuelConsumption = 0;
              checkFuelConsumption.checked = false;
              const index = items.indexOf(a28);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a61")) {
              activeFitout = 1;
              checkFitout.checked = true;
              if (!items.includes(a61)) items.push(a61);
            } else {
              activeFitout = 0;
              checkFitout.checked = false;
              const index = items.indexOf(a61);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a30")) {
              activeIncidents = 1;
              checkIncidents.checked = true;
              if (!items.includes(a30)) items.push(a30);
            } else {
              activeIncidents = 0;
              checkIncidents.checked = false;
              const index = items.indexOf(a30);
              if (index > -1) items.splice(index, 1);
            }
  
            // if (selectedWidgetsList.includes("a125")) {
            //   activeIncidentsTop = 1;
            //   checkIncidentsTop.checked = true;
            //   if (!items.includes(a125)) items.push(a125);
            // } else {
            //   activeIncidentsTop = 0;
            //   checkIncidentsTop.checked = false;
            //   const index = items.indexOf(a125);
            //   if (index > -1) items.splice(index, 1);
            // }
  
            if (selectedWidgetsList.includes("a71")) {
              activeOpenEscalation = 1;
              checkOpenEscalation.checked = true;
              if (!items.includes(a71)) items.push(a71);
            } else {
              activeOpenEscalation = 0;
              checkOpenEscalation.checked = false;
              const index = items.indexOf(a71);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a72")) {
              activeCloseEscalation = 1;
              checkCloseEscalation.checked = true;
              if (!items.includes(a72)) items.push(a72);
            } else {
              activeCloseEscalation = 0;
              checkCloseEscalation.checked = false;
              const index = items.indexOf(a72);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a73")) {
              activeAvgEscalation = 1;
              checkAvgEscalation.checked = true;
              if (!items.includes(a73)) items.push(a73);
            } else {
              activeAvgEscalation = 0;
              checkAvgEscalation.checked = false;
              const index = items.indexOf(a73);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a31")) {
              activeCategoryWiseIncidents = 1;
              checkCategoryWiseIncidents.checked = true;
              if (!items.includes(a31)) items.push(a31);
            } else {
              activeCategoryWiseIncidents = 0;
              checkCategoryWiseIncidents.checked = false;
              const index = items.indexOf(a31);
              if (index > -1) items.splice(index, 1);
            }
  
            // if (selectedWidgetsList.includes("a128")) {
            //   activeCategoryWiseIncidentsTop = 1;
            //   checkCategoryWiseIncidentsTop.checked = true;
            //   if (!items.includes(a128)) items.push(a128);
            // } else {
            //   activeCategoryWiseIncidentsTop = 0;
            //   checkCategoryWiseIncidentsTop.checked = false;
            //   const index = items.indexOf(a128);
            //   if (index > -1) items.splice(index, 1);
            // }
  
            if (selectedWidgetsList.includes("a32")) {
              activeManPowerAttendance = 1;
              checkManPowerAttendance.checked = true;
              if (!items.includes(a32)) items.push(a32);
            } else {
              activeManPowerAttendance = 0;
              checkManPowerAttendance.checked = false;
              const index = items.indexOf(a32);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a33")) {
              activeEventsFootfallAnalysis = 1;
              checkEventsFootfallAnalysis.checked = true;
              if (!items.includes(a33)) items.push(a33);
            } else {
              activeEventsFootfallAnalysis = 0;
              checkEventsFootfallAnalysis.checked = false;
              const index = items.indexOf(a33);
              if (index > -1) items.splice(index, 1);
            }
  
            // if (selectedWidgetsList.includes("a38")) {
            //   activeRAC = 1;
            //   checkRAC.style.color = "blue";
            //   items.push(a38);
            // } else {
            //   activeRAC = 0;
            //   checkRAC.style.color = "black";
            // }
            
            // if (selectedWidgetsList.includes("a127")) {
            //   activeRACTop = 1;
            //   checkRACTop.checked = true;
            //   if (!items.includes(a127)) items.push(a127);
            // } else {
            //   activeRACTop = 0;
            //   checkRACTop.checked = false;
            //   const index = items.indexOf(a127);
            //   if (index > -1) items.splice(index, 1);
            // }
  
            if (selectedWidgetsList.includes("a41")) {
              activeSafeManHours = 1;
              checkSafeManHours.checked = true;
              if (!items.includes(a41)) items.push(a41);
            } else {
              activeSafeManHours = 0;
              checkSafeManHours.checked = false;
              const index = items.indexOf(a41);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a42")) {
              activeAssetsBreakdown = 1;
              checkAssetsBreakdown.checked = true;
              if (!items.includes(a42)) items.push(a42);
            } else {
              activeAssetsBreakdown = 0;
              checkAssetsBreakdown.checked = false;
              const index = items.indexOf(a42);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a44")) {
              activePyramid = 1;
              checkPyramid.checked = true;
              if (!items.includes(a44)) items.push(a44);
            } else {
              activePyramid = 0;
              checkPyramid.checked = false;
              const index = items.indexOf(a44);
              if (index > -1) items.splice(index, 1);
            }
  
            // if (selectedWidgetsList.includes("a126")) {
            //   activePyramidTop = 1;
            //   checkPyramidTop.checked = true;
            //   if (!items.includes(a126)) items.push(a126);
            // } else {
            //   activePyramidTop = 0;
            //   checkPyramidTop.checked = false;
            //   const index = items.indexOf(a126);
            //   if (index > -1) items.splice(index, 1);
            // }
  
  
            if (selectedWidgetsList.includes("a46")) {
              activeRootCause = 1;
              checkRootCause.checked = true;
              if (!items.includes(a46)) items.push(a46);
            } else {
              activeRootCause = 0;
              checkRootCause.checked = false;
              const index = items.indexOf(a46);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a64")) {
              activeBodyInjuryChart = 1;
              checkBodyInjuryChart.checked = true;
              if (!items.includes(a64)) items.push(a64);
            } else {
              activeBodyInjuryChart = 0;
              checkBodyInjuryChart.checked = false;
              const index = items.indexOf(a64);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a67")) {
              activeOccupancy = 1;
              checkOccupancy.checked = true;
              if (!items.includes(a67)) items.push(a67);
            } else {
              activeOccupancy = 0;
              checkOccupancy.checked = false;
              const index = items.indexOf(a67);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a70")) {
              activeCustomAvg = 1;
              checkCustomAvg.checked = true;
              if (!items.includes(a70)) items.push(a70);
            } else {
              activeCustomAvg = 0;
              checkCustomAvg.checked = false;
              const index = items.indexOf(a70);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a74")) {
              activeFacilityInfo = 1;
              checkFacilityInfo.checked = true;
              if (!items.includes(a74)) items.push(a74);
            } else {
              activeFacilityInfo = 0;
              checkFacilityInfo.checked = false;
              const index = items.indexOf(a74);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a75")) {
              activeCheckList = 1;
              checkCheckList.checked = true;
              if (!items.includes(a75)) items.push(a75);
            } else {
              activeCheckList = 0;
              checkCheckList.checked = false;
              const index = items.indexOf(a75);
              if (index > -1) items.splice(index, 1);
            }
  
            // if (selectedWidgetsList.includes("a116")) {
            //   activeAssetsBreakdownGraph = 1;
            //   checkAssetsBreakdownGraph.style.color = "blue";
            //   items.push(a116);
            // } else {
            //   activeAssetsBreakdownGraph = 0;
            //   checkAssetsBreakdownGraph.style.color = "black";
            // }
  
  
            if (selectedWidgetsList.includes("a117")) {
              activeWaste = 1;
              checkWaste.checked = true;
              if (!items.includes(a117)) items.push(a117);
            } else {
              activeWaste = 0;
              checkWaste.checked = false;
              const index = items.indexOf(a117);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a78")) {
              activeDeliveryVisitors = 1;
              checkDeliveryVisitors.checked = true;
              if (!items.includes(a78)) items.push(a78);
            } else {
              activeDeliveryVisitors = 0;
              checkDeliveryVisitors.checked = false;
              const index = items.indexOf(a78);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a79")) {
              activeReactiveProactiveTickets = 1;
              checkReactiveProactiveTickets.checked = true;
              if (!items.includes(a79)) items.push(a79);
            } else {
              activeReactiveProactiveTickets = 0;
              checkReactiveProactiveTickets.checked = false;
              const index = items.indexOf(a79);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a29")) {
              activeFitoutRequest = 1;
              checkFitoutRequest.checked = true;
              if (!items.includes(a29)) items.push(a29);
            } else {
              activeFitoutRequest = 0;
              checkFitoutRequest.checked = false;
              const index = items.indexOf(a29);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a80")) {
              activeRegisterdUser = 1;
              checkRegisterdUser.checked = true;
              if (!items.includes(a80)) items.push(a80);
            } else {
              activeRegisterdUser = 0;
              checkRegisterdUser.checked = false;
              const index = items.indexOf(a80);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a81")) {
              activeTotalDownloads = 1;
              checkTotalDownloads.checked = true;
              if (!items.includes(a81)) items.push(a81);
            } else {
              activeTotalDownloads = 0;
              checkTotalDownloads.checked = false;
              const index = items.indexOf(a81);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a82")) {
              activeZoneWiseEscalation = 1;
              checkZoneWiseEscalation.checked = true;
              if (!items.includes(a82)) items.push(a82);
            } else {
              activeZoneWiseEscalation = 0;
              checkZoneWiseEscalation.checked = false;
              const index = items.indexOf(a82);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a83")) {
              activeOpenAndCloseEscalation = 1;
              checkOpenAndCloseEscalation.checked = true;
              if (!items.includes(a83)) items.push(a83);
            } else {
              activeOpenAndCloseEscalation = 0;
              checkOpenAndCloseEscalation.checked = false;
              const index = items.indexOf(a83);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a84")) {
              activeCategoryWiseEscalation = 1;
              checkCategoryWiseEscalation.checked = true;
              if (!items.includes(a84)) items.push(a84);
            } else {
              activeCategoryWiseEscalation = 0;
              checkCategoryWiseEscalation.checked = false;
              const index = items.indexOf(a84);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a85")) {
              activeServicePartnerEvaluation = 1;
              checkServicePartnerEvaluation.checked = true;
              if (!items.includes(a85)) items.push(a85);
            } else {
              activeServicePartnerEvaluation = 0;
              checkServicePartnerEvaluation.checked = false;
              const index = items.indexOf(a85);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a100")) {
              activeClusterStats = 1;
              checkClusterStats.checked = true;
              if (!items.includes(a100)) items.push(a100);
            } else {
              activeClusterStats = 0;
              checkClusterStats.checked = false;
              const index = items.indexOf(a100);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a101")) {
              activeFunctionWise = 1;
              checkFunctionWise.checked = true;
              if (!items.includes(a101)) items.push(a101);
            } else {
              activeFunctionWise = 0;
              checkFunctionWise.checked = false;
              const index = items.indexOf(a101);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a102")) {
              activeGenderParticipation = 1;
              checkGenderParticipation.checked = true;
              if (!items.includes(a102)) items.push(a102);
            } else {
              activeGenderParticipation = 0;
              checkGenderParticipation.checked = false;
              const index = items.indexOf(a102);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a103")) {
              activeTrendsOverMonthSites = 1;
              checkTrendsOverMonthSites.checked = true;
              if (!items.includes(a103)) items.push(a103);
            } else {
              activeTrendsOverMonthSites = 0;
              checkTrendsOverMonthSites.checked = false;
              const index = items.indexOf(a103);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a48")) {
              activeGoodsIn = 1;
              checkGoodsIn.checked = true;
              if (!items.includes(a48)) items.push(a48);
            } else {
              activeGoodsIn = 0;
              checkGoodsIn.checked = false;
              const index = items.indexOf(a48);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a49")) {
              activeGoodsOut = 1;
              checkGoodsOut.checked = true;
              if (!items.includes(a49)) items.push(a49);
            } else {
              activeGoodsOut = 0;
              checkGoodsOut.checked = false;
              const index = items.indexOf(a49);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a59")) {
              activeGoodsInwards = 1;
              checkGoodsInwards.checked = true;
              if (!items.includes(a59)) items.push(a59);
            } else {
              activeGoodsInwards = 0;
              checkGoodsInwards.checked = false;
              const index = items.indexOf(a59);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a60")) {
              activeGoodsOutwards = 1;
              checkGoodsOutwards.checked = true;
              if (!items.includes(a60)) items.push(a60);
            } else {
              activeGoodsOutwards = 0;
              checkGoodsOutwards.checked = false;
              const index = items.indexOf(a60);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a104")) {
              activeTotalVisitorsII = 1;
              checkTotalVisitorsII.checked = true;
              if (!items.includes(a104)) items.push(a104);
            } else {
              activeTotalVisitorsII = 0;
              checkTotalVisitorsII.checked = false;
              const index = items.indexOf(a104);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a111")) {
              activeTotalStaff = 1;
              checkTotalStaff.checked = true;
              if (!items.includes(a111)) items.push(a111);
            } else {
              activeTotalStaff = 0;
              checkTotalStaff.checked = false;
              const index = items.indexOf(a111);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a112")) {
              activeStaffIn = 1;
              checkStaffIn.checked = true;
              if (!items.includes(a112)) items.push(a112);
            } else {
              activeStaffIn = 0;
              checkStaffIn.checked = false;
              const index = items.indexOf(a112);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a113")) {
              activeStaffOut = 1;
              checkStaffOut.checked = true;
              if (!items.includes(a113)) items.push(a113);
            } else {
              activeStaffOut = 0;
              checkStaffOut.checked = false;
              const index = items.indexOf(a113);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a106")) {
              activeExpectedVisitors = 1;
              checkExpectedVisitors.checked = true;
              if (!items.includes(a106)) items.push(a106);
            } else {
              activeExpectedVisitors = 0;
              checkExpectedVisitors.checked = false;
              const index = items.indexOf(a106);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a107")) {
              activeUnExpectedVisitors = 1;
              checkUnExpectedVisitors.checked = true;
              if (!items.includes(a107)) items.push(a107);
            } else {
              activeUnExpectedVisitors = 0;
              checkUnExpectedVisitors.checked = false;
              const index = items.indexOf(a107);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a105")) {
              activeTotalVisitors = 1;
              checkTotalVisitors.checked = true;
              if (!items.includes(a105)) items.push(a105);
            } else {
              activeTotalVisitors = 0;
              checkTotalVisitors.checked = false;
              const index = items.indexOf(a105);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b70")) {
              activeTotalParking = 1;
              checkTotalParking.checked = true;
              if (!items.includes(b70)) items.push(b70);
            } else {
              activeTotalParking = 0;
              checkTotalParking.checked = false;
              const index = items.indexOf(b70);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b71")) {
              activeFreeParking = 1;
              checkFreeParking.checked = true;
              if (!items.includes(b71)) items.push(b71);
            } else {
              activeFreeParking = 0;
              checkFreeParking.checked = false;
              const index = items.indexOf(b71);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b72")) {
              activePaidParking = 1;
              checkPaidParking.checked = true;
              if (!items.includes(b72)) items.push(b72);
            } else {
              activePaidParking = 0;
              checkPaidParking.checked = false;
              const index = items.indexOf(b72);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b73")) {
              activeOccupiedParking = 1;
              checkOccupiedParking.checked = true;
              if (!items.includes(b73)) items.push(b73);
            } else {
              activeOccupiedParking = 0;
              checkOccupiedParking.checked = false;
              const index = items.indexOf(b73);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b74")) {
              activeVacantParking = 1;
              checkVacantParking.checked = true;
              if (!items.includes(b74)) items.push(b74);
            } else {
              activeVacantParking = 0;
              checkVacantParking.checked = false;
              const index = items.indexOf(b74);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b76")) {
              activePermitSite = 1;
              checkPermitSite.checked = true;
              if (!items.includes(b76)) items.push(b76);
  
            } else {
              activePermitSite = 0;
              checkPermitSite.checked = false;
              const index = items.indexOf(b76);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("b77")) {
              activePermits = 1;
              checkPermits.checked = true;
              if (!items.includes(b77)) items.push(b77);
  
            } else {
              activePermits = 0;
              checkPermits.checked = false;
              const index = items.indexOf(b77);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b61")) {
              activeInventory = 1;
              checkInventory.checked = true;
              if (!items.includes(b61)) items.push(b61);
  
            } else {
              activeInventory = 0;
              checkInventory.checked = false;
              const index = items.indexOf(b61);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b34")) {
              activeTotalAmount = 1;
              checkTotalAmount.checked = true;
              if (!items.includes(b34)) items.push(b34);
            } else {
              activeTotalAmount = 0;
              checkTotalAmount.checked = false;
              const index = items.indexOf(b34);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b35")) {
              activeTotalReceived = 1;
              checkTotalReceived.checked = true;
              if (!items.includes(b35)) items.push(b35);
            } else {
              activeTotalReceived = 0;
              checkTotalReceived.checked = false;
              const index = items.indexOf(b35);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b36")) {
              activeTotalOutstanding = 1;
              checkTotalOutstanding.checked = true;
              if (!items.includes(b36)) items.push(b36);
            } else {
              activeTotalOutstanding = 0;
              checkTotalOutstanding.checked = false;
              const index = items.indexOf(b36);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("b78")) {
              activeTotalOutStandingAmount = 1;
              checkTotalOutstandingAmount.checked = true;
              if (!items.includes(b78)) items.push(b78);
            } else {
              activeTotalOutStandingAmount = 0;
              checkTotalOutstandingAmount.checked = false;
              const index = items.indexOf(b78);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("c11")) {
              activeDailyStepCount = 1;
              checkDailyStepCount.checked = true;
              if (!items.includes(c11)) items.push(c11);
            } else {
              activeDailyStepCount = 0;
              checkDailyStepCount.checked = false;
              const index = items.indexOf(c11);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("c14")) {
              activeDepartmentStats = 1;
              checkDepartmentStats.checked = true;
              if (!items.includes(c14)) items.push(c14);
            } else {
              activeDepartmentStats = 0;
              checkDepartmentStats.checked = false;
              const index = items.indexOf(c14);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("c15")) {
              activeEmpParticipationStats = 1;
              checkEmpParticipationStats.checked = true;
              if (!items.includes(c15)) items.push(c15);
            } else {
              activeEmpParticipationStats = 0;
              checkEmpParticipationStats.checked = false;
              const index = items.indexOf(c15);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("c19")) {
              activeCommLeaderboard = 1;
              checkCommLeaderboard.checked = true;
              if (!items.includes(c19)) items.push(c19);
            } else {
              activeCommLeaderboard = 0;
              checkCommLeaderboard.checked = false;
              const index = items.indexOf(c19);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("c21")) {
              activeCommLeaderboardFemale = 1;
              checkCommLeaderboardFemale.checked = true;
              if (!items.includes(c21)) items.push(c21);
            } else {
              activeCommLeaderboardFemale = 0;
              checkCommLeaderboardFemale.checked = false;
              const index = items.indexOf(c21);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a108")) {
              activeTotalGatePass = 1;
              checkTotalGatePass.checked = true;
              if (!items.includes(a108)) items.push(a108);
            } else {
              activeTotalGatePass = 0;
              checkTotalGatePass.checked = false;
              const index = items.indexOf(a108);
              if (index > -1) items.splice(index, 1);
            }
  
            
            if (selectedWidgetsList.includes("a109")) {
              activeReturnablePass = 1;
              checkReturnablePass.checked = true;
              if (!items.includes(a109)) items.push(a109_x);
            } else {
              activeReturnablePass = 0;
              checkReturnablePass.checked = false;
              const index = items.indexOf(a109);
              if (index > -1) items.splice(index, 1);
            }
  
  
            if (selectedWidgetsList.includes("a110")) {
              activeNonReturnablePass = 1;
              checkNonReturnablePass.checked = true;
              if (!items.includes(a110)) items.push(a110);
            } else {
              activeNonReturnablePass = 0;
              checkNonReturnablePass.checked = false;
              const index = items.indexOf(a110);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a114")) {
              activeTechnicalChecklist = 1;
              checkTechnicalChecklist.checked = true;
              if (!items.includes(a114)) items.push(a114);
            } else {
              activeTechnicalChecklist = 0;
              checkTechnicalChecklist.checked = false;
              const index = items.indexOf(a114);
              if (index > -1) items.splice(index, 1);
            }
  
            if (selectedWidgetsList.includes("a115")) {
              activeNonTechnicalChecklist = 1;
              checkNonTechnicalChecklist.checked = true;
              if (!items.includes(a115)) items.push(a115);
            } else {
              activeNonTechnicalChecklist = 0;
              checkNonTechnicalChecklist.checked = false;
              const index = items.indexOf(a115);
              if (index > -1) items.splice(index, 1);
            }
            console.log("hiiii i am hereeeeeeeee nowwww again");
            idLink = newIdLink;
            grid.load(savedLayout);
            loadDashboardData("custom", startDate.value, endDate.value);
  
          } else {
            grid.load(items);
            loadDashboardData("daily", todaysDate, 0);
          }
        } else {
          grid.load(items);
          loadDashboardData("daily", todaysDate, 0);
        }
      } else {

        // grid.load(items);
        // console.error('Failed to retrieve saved data:', data);
        grid.load(items);
        loadDashboardData("daily", todaysDate, 0);
      }
    })
    .catch(error => {
      console.error('Error:', error);

    });


  // grid.load(items);
  // loadDashboardData("daily", todaysDate, 0);


}
// ------------------------------------------------------------------------------------------------------------------------

// function showToggleDaily() {
//   showDaily.style.display = "block";
//   showCustom.style.display = "none";
//   showInventory.style.display = "none";

//   toggleDaily.className = "l px-4 l-active";
//   toggleCustom.className = "l px-4";
//   toggleInventory.className = "l px-4";

//   const date = new Date();

//   let day = date.getDate();
//   let month = date.getMonth() + 1;
//   let year = date.getFullYear();

//   let todaysDate = `${year}-${month}-${day}`;

//   callLinks("daily");
//   // document.getElementById("toggleDaily").href = "index.html?token=" + token + "&site_id=" + globalSiteId;

//   grid.load(items);
//   loadDashboardData("daily", todaysDate, 0);
// }

// function showToggleCustom() {
//   showDaily.style.display = "none";
//   showCustom.style.display = "block";
//   showInventory.style.display = "none";

//   toggleDaily.className = "l px-4";
//   toggleCustom.className = "l px-4 l-active";
//   toggleInventory.className = "l px-4";

//   const date = new Date();

//   let day = date.getDate();
//   let month = date.getMonth() + 1;
//   let year = date.getFullYear();

//   let todaysDate = `${year}-${month}-${day}`;

//   callLinks("custom");
//   // document.getElementById("toggleCustom").href = "custom.html?token=" + token + "&site_id=" + globalSiteId  ;
//   grid.load(items);
//   loadDashboardData("custom", newDate, todaysDate);
// }
function showToggleDaily() {
  showDaily.style.display = "block";
  showCustom.style.display = "none";
  // showInventory.style.display = "none";

  toggleDaily.className = "l px-4 l-active";
  toggleCustom.className = "l px-4";
  toggleInventory.className = "l px-4";

  const date = new Date();

  let day = date.getDate();
  let month = date.getMonth() + 1;
  let year = date.getFullYear();

  let todaysDate = `${year}-${month}-${day}`;

  callLinks("daily");
  document.getElementById("toggleDaily").href = "index.html?token=" + token ;

  // if (savedLayout && savedLayout.length > 0) {
  //   console.log(JSON.parse(data.dashboard));
  grid.load(savedLayout);
  loadDashboardData("daily", todaysDate, 0);

  // } else {
  //   grid.load(items);
  //   loadDashboardData("daily", todaysDate, 0);

  // }


  // grid.load(items);
  // loadDashboardData("daily", todaysDate, 0);
}

function showToggleCustom() {
  showDaily.style.display = "none";
  showCustom.style.display = "block";
  // showInventory.style.display = "none";

  toggleDaily.className = "l px-4";
  toggleCustom.className = "l px-4 l-active";
  toggleInventory.className = "l px-4";

  const date = new Date();

  let day = date.getDate();
  let month = date.getMonth() + 1;
  let year = date.getFullYear();

  let todaysDate = `${year}-${month}-${day}`;

  callLinks("custom");
  console.log(globalSiteId);
  document.getElementById("toggleCustom").href = "custom.html?token=" + token ;
  // grid.load(items);
  // loadDashboardData("custom", newDate, todaysDate);

  // if (savedLayout && savedLayout.length > 0) {
  //   console.log(JSON.parse(data.dashboard));
  grid.load(savedLayout);
  loadDashboardData("custom", newDate, todaysDate);

  // } else {
  //   grid.load(items);
  //   loadDashboardData("custom", newDate, todaysDate);
  // }

}
function showToggleInventory() {
  showDaily.style.display = "none";
  showCustom.style.display = "none";
  showInventory.style.display = "block";

  toggleDaily.className = "l px-4";
  toggleCustom.className = "l px-4";
  toggleInventory.className = "l px-4 l-active";

  const date = new Date();

  let day = date.getDate();
  let month = date.getMonth() + 1;
  let year = date.getFullYear();

  let todaysDate = `${year}-${month}-${day}`;

  callLinks("inventory");
  document.getElementById("toggleInventory").href = "inventory.html?token=" + token;

  grid.load(items);
  loadDashboardData("inventory", todaysDate, todaysDate);
}


//   if (savedLayout && savedLayout.length > 0) {
//     console.log(JSON.parse(data.dashboard));
//     grid.load(savedLayout);
//     loadDashboardData("inventory", todaysDate, todaysDate);

//   } else {
//     grid.load(items);
//     loadDashboardData("inventory", todaysDate, todaysDate);

//   }
// }

function showDate() {
  callLinks("daily");
  // grid.load(items);
  // loadDashboardData("daily", currentDate.value, 0);
  // if (savedLayout && savedLayout.length > 0) {
  //   // console.log(JSON.parse(data.dashboard));
  //   grid.load(items);
  //   loadDashboardData("daily", currentDate.value, 0);

  // } else {
  //   grid.load(items);
  //   loadDashboardData("daily", currentDate.value, 0);
  // }
}

function getResult() {
  if (savedLayout && savedLayout.length > 0) {
    // console.log(JSON.parse(data.dashboard));
    grid.load(items);
    loadDashboardData("daily", currentDate.value, 0);

  } else {
    grid.load(items);
    loadDashboardData("daily", currentDate.value, 0);
  }
}

function showDateCustom() {
  if (startDate.value != "" && endDate.value != "") {
    console.log("Start Date - " + startDate.value);
    console.log("End Date - " + endDate.value);
    callLinks("custom");
    grid.load(items);
    loadDashboardData("custom", startDate.value, endDate.value);
  }
}

function showDateInventory() {
  if (startDate.value != "" && endDate.value != "") {
    console.log("Start Date - " + startDate.value);
    console.log("End Date - " + endDate.value);
    callLinks("inventory");
    grid.load(items);
    loadDashboardData("inventory", startDate.value, endDate.value);
  }
}

// Load all the Dashboard One Time
function loadDashboardData(type, firstDate, secondDate) {
  globalType = type;
  globalDateFirst = firstDate;
  globalDateSecond = secondDate;


  downloadTicketsLink = ip + "fm-excel-download/get-tickets-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst;
  downloadCategoryTicketsLink = ip + "fm-excel-download/get-category-wise-ticket-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadCategoryWiseProactiveTicketsLink = ip + "fm-excel-download/get-category-wise-proactive-ticket-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadCACategoryWiseTicketsLink = ip + "fm-excel-download/get-commonArea-category-wiseticket-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadCACategoryWiseProactiveTicketsLink = ip + "fm-excel-download/get-commonArea-category-wise-proactiveticket-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadResolutionTATLink = ip + "fm-excel-download/get-resolution-TAT-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadResponseTATLink = ip + "fm-excel-download/get-response-TAT-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadIncidentsLink = ip + "fm-excel-download/get-incident-chart-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadCategoryWiseIncidentsLink = ip + "fm-excel-download/get-incident-category-chart-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadPyramidLink = ip + "fm-excel-download/get-level-wise-incidents-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadOccupancyLink = ip + "fm-excel-download/get-occupancy-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadPowerConsumLink = ip + "fm-excel-download/get-power-consumption-Stacked-bargraph-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadWaterConsumBarLink = ip + "fm-excel-download/get-water-consumption-stacked-bargraph-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadDeliveryVisitorLink = ip + "charts-monthly/get-delivery-visitor-download/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,
    downloadEventsFootfallAnalysisLink = ip + "fm-excel-download/get-attendance-excel-data/" + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateFirst,

    downloadClusterWiseTotalLink = ip +
    "stepathon/get-cluster-wise-total-steps-taken-download/" + idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst;
  downloadFunctionWiseTotalLink = ip +
    "stepathon/get-function-wise-step-count-download/" + idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst;
  downloadGenderParticipationLink = ip +
    "stepathon/get-gender-participation-download/" + idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst;

  downloadTrendsMonthsLink = ip +
    "fm-excel-download/get-month-wise-inventory-consumption-excelexcel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond;
  downloadTrendsSitesLink = ip +
    "charts-monthly/get-inventory-consumption-over-site-excel/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond;

  downloadGoodInLink = ip +
    "charts-monthly/get-day-wise-goods-inward-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond;
  // +
  // "&building_id=" +
  // globalVisitorBuildingId;

  downloadGoodOutLink = ip +
    "charts-monthly/get-day-wise-goods-outward-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond;
  // +
  // "&building_id=" +
  // globalVisitorBuildingId;

  funCardTotalAsset();
  funCardTotalAssetInUseAndBreakDown();
  funCardConduct();
  funCardTotalCriticalAssetInBreakdown();
  funGetLTIR(type, firstDate, secondDate);
  funGetZeroIncidentDays();
  funGetIncidentPerSqFt();
  funCardCustomerAverage();
  funCardOpenCloseEscalation();
  funCardAvgEscalation();
  // funGetTotalFlats();

  // // funGetIncidentPerMillionSqFt();

  funGetIncidentNearMissGoodCatch();
  funChartTicket(type, firstDate, secondDate);
  funReactiveTicket(type, firstDate, secondDate);
  funCategoryTicket(type, firstDate, secondDate);
  funCategoryProactiveTicket(type, firstDate, secondDate);
  funCommonAreaCategoryTicket(type, firstDate, secondDate);
  funCommonAreaCategoryProactiveTicket(type, firstDate, secondDate);
  funAgeingMatrix(type, firstDate, secondDate);
  funChartCustomerSentiments(type, firstDate, secondDate);
  funTATResolution(type, firstDate, secondDate);
  funTATResponse(type, firstDate, secondDate);
  funVisitors(type, firstDate, secondDate);
  funVisitorsCards(type, firstDate, secondDate);

  funStaff(type, firstDate, secondDate);
  funStaffIn();
  funStaffOut();
  // funGoodsInward();
  // funOutwards();

  funFootfall();
  // funTotalVisitors(type, firstDate, secondDate);
  funTotalVisitors2(type, firstDate, secondDate);
  funGoodsIn(type, firstDate, secondDate);
  funGoodsOut(type, firstDate, secondDate);

  funPowerConsumption(type, firstDate, secondDate);
  funWaterConsumption(type, firstDate, secondDate);
  funCarbonEmissionScope1(type, firstDate, secondDate);
  funCarbonEmissionScope2(type, firstDate, secondDate);

  funEnergyIntensity(type, firstDate, secondDate);

  funFuelConsumption(type, firstDate, secondDate);

  funFitOutRequest(type, firstDate, secondDate);
  funFacilityInfo(type, firstDate, secondDate);
  funChecklist(type, firstDate, secondDate);
  funCardWaterNot(type, firstDate, secondDate);
  funCardDieselNot(type, firstDate, secondDate);

  funFitOutRequest(type, firstDate, secondDate);
  funIncidents(type, firstDate, secondDate);
  funIncidentsCategory(type, firstDate, secondDate);
  funManPower(type, firstDate, secondDate);
  funRCA(type, firstDate, secondDate);
  funGetSafeManHours(type, firstDate, secondDate);
  funAssetsBreakdown(type, firstDate, secondDate);
  funExecutiveEscalation(type, firstDate, secondDate);
  funPyramid(type, firstDate, secondDate);
  // funIncidentII(type, firstDate, secondDate);
  funRootCause(type, firstDate, secondDate);
  funBodyInjuryChart(type, firstDate, secondDate);
  funOccupancy(type, firstDate, secondDate);
  funDeliveryVisitor(type, firstDate, secondDate);
  funFitout(type, firstDate, secondDate);
  funFitoutOccupancy(type, firstDate, secondDate);

  funCardTotalRegisteredUsers();
  funCardTotalDownloads();

  funSiteWiseEscalation(type, firstDate, secondDate);
  funOpenCloseEscalation(type, firstDate, secondDate);
  funCategoryWiseEscalation(type, firstDate, secondDate);
  funAuditScore(type, firstDate, secondDate);


  fungenderParticipation(type, firstDate, secondDate);
  funClusterStats(type, firstDate, secondDate);
  funDailyStepStats(type, firstDate, secondDate);


  funInventoryOverMonthSites(type, firstDate, secondDate);
  funInventoryOverSites(type, firstDate, secondDate);
  funSitePermit(type, firstDate, secondDate);  //moved
  funPermitStatus(type, firstDate, secondDate);   //moved
  funInventory(type, firstDate, secondDate);   //moved
  // funTotalAmount(type, firstDate, secondDate);  //moved
  funIncidentSummary(type, firstDate, secondDate); //moved
  funOutstanding(type, firstDate, secondDate);
  funCardParking();  //moved

  funCommLeaderboard(firstDate, secondDate);
  funCommLeaderboardFemale(firstDate, secondDate);
  funClusterEmployeeParticiption(firstDate, secondDate);
  funDepartmentStats(firstDate, secondDate);
  funDailyStepCount();

  funTechnicalChecklist();
  funNonTechnicalChecklist();
  funChecklistTop();
  funAssetBreakDown();
  funDryWasteSegregation();
  funInventoryConsumption(type, firstDate, secondDate);
  funInventoryReport(type, firstDate, secondDate);
  funCurrentStock(type, firstDate, secondDate);

  funInventoryConsumptionGreen(type, firstDate, secondDate);
  funInventoryReportGreen(type, firstDate, secondDate);
  funCurrentStockGreen(type, firstDate, secondDate);
}

// --------------------------------------------------------------------------------------------------------------------------------
// Load Data First Time
// --------------------------------------------------------------------------------------------------------------------------------
function funCardTotalAsset() {
  let cardTotalAsset = document.getElementById("cardTotalAsset");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getTotalAssetCard + idLink, true);

  xhr_object.onload = function () {
    resfunCardTotalAsset = JSON.parse(this.responseText);
    console.log("Asset Total - ");
    console.log(resfunCardTotalAsset);
    cardTotalAsset.innerHTML = resfunCardTotalAsset.response + "";
  };
  xhr_object.send();
}

function funCardTotalAssetInUseAndBreakDown() {
  let cardUseAsset = document.getElementById("cardUseAsset");
  let cardBreakdownAsset = document.getElementById("cardBreakdownAsset");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getTotalAssetInUseAndBreakDownCard + idLink, true);

  xhr_object.onload = function () {
    resfunCardTotalAssetInUseAndBreakDown = JSON.parse(this.responseText);
    console.log("Asset In Use/Breakdown - ");
    console.log(resfunCardTotalAssetInUseAndBreakDown);
    cardUseAsset.innerHTML =
      resfunCardTotalAssetInUseAndBreakDown.response.InUse + "";
    cardBreakdownAsset.innerHTML =
      resfunCardTotalAssetInUseAndBreakDown.response.InBreakdown + "";
  };
  xhr_object.send();
}

function funCardConduct() {
  let cardConductedAssets = document.getElementById("cardConductedAssets");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getConducted + idLink, true);

  xhr_object.onload = function () {
    resfunPpmConducted = JSON.parse(this.responseText);
    console.log("Ppm Conducted - ");
    console.log(resfunPpmConducted);
    cardConductedAssets.innerHTML = resfunPpmConducted.response + "";
  };
  xhr_object.send();
}


function funCardCustomerAverage() {
  let cardCustomerAvg = document.getElementById("cardCustomerAvg");

  let xhr_object = new XMLHttpRequest();
  // xhr_object.open("GET", getCustomerAverage + idLink, true);

  if (globalType == "daily") {
    xhr_object.open("GET", getCustomerAverage + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getCustomerAverage + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

  xhr_object.onload = function () {
    resfunCardCustomerAverage = JSON.parse(this.responseText);
    console.log("Customer Average Rating - ");
    console.log(resfunCardCustomerAverage);
    cardCustomerAvg.innerHTML = resfunCardCustomerAverage.response + "";
  };
  xhr_object.send();
};


function funCardOpenCloseEscalation() {
  let cardOpenEscalation = document.getElementById("cardOpenEscalation");

  let xhr_object = new XMLHttpRequest();
  // xhr_object.open("GET", getCustomerAverage + idLink, true);

  if (globalType == "daily") {
    xhr_object.open("GET", getOpenCloseEscalation + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getOpenCloseEscalation + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

  xhr_object.onload = function () {
    resfunCardOpenCloseEscalation = JSON.parse(this.responseText);
    console.log("Open Escalation - ");
    console.log(resfunCardOpenCloseEscalation);
    cardOpenEscalation.innerHTML = resfunCardOpenCloseEscalation.response.Open + "";
  };
  xhr_object.send();

  // ----------------------------------------------
  let cardCloseEscalation = document.getElementById("cardCloseEscalation");
  let xhr_object_close = new XMLHttpRequest();
  // xhr_object.open("GET", getCustomerAverage + idLink, true);

  if (globalType == "daily") {
    xhr_object_close.open("GET", getOpenCloseEscalation + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object_close.open("GET", getOpenCloseEscalation + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

  xhr_object_close.onload = function () {
    resfunCardOpenCloseEscalation = JSON.parse(this.responseText);
    console.log("Close Escalation - ");
    console.log(resfunCardOpenCloseEscalation);
    cardCloseEscalation.innerHTML = resfunCardOpenCloseEscalation.response.Closed + "";
  };
  xhr_object_close.send();
}


function funCardAvgEscalation() {
  let cardAvgEscalation = document.getElementById("cardAvgEscalation");
  let xhr_object = new XMLHttpRequest();
  // xhr_object.open("GET", getCustomerAverage + idLink, true);

  if (globalType == "daily") {
    xhr_object.open("GET", getAvgEscalation + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getAvgEscalation + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

  xhr_object.onload = function () {
    resfunCardAvgEscalation = JSON.parse(this.responseText);
    console.log("Avg Escalation - ");
    console.log(resfunCardAvgEscalation);
    cardAvgEscalation.innerHTML = resfunCardAvgEscalation.response + "";
  };
  xhr_object.send();
}

function funCardTotalCriticalAssetInBreakdown() {
  let cardCriticalAsset = document.getElementById("cardCriticalAsset");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getTotalCriticalAssetInBreakdownCard + idLink, true);

  xhr_object.onload = function () {
    resfunCardTotalCriticalAssetInBreakdown = JSON.parse(this.responseText);
    console.log("Critical Asset In Breakdown - ");
    console.log(resfunCardTotalCriticalAssetInBreakdown);
    cardCriticalAsset.innerHTML =
      resfunCardTotalCriticalAssetInBreakdown.response + "";
  };
  xhr_object.send();
}

function funGetLTIR() {
  let cardLTIR = document.getElementById("cardLTIR");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open("GET", getLTIR + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getLTIR + idLink + "&date=" + globalDateFirst, true);
  }

  xhr_object.onload = function () {
    resfunGetLTIR = JSON.parse(this.responseText);
    console.log("LTIR - ");
    console.log(resfunGetLTIR);
    cardLTIR.innerHTML = resfunGetLTIR.response + "";
  };
  xhr_object.send();
}

function funGetZeroIncidentDays() {
  let cardZeroIncidentDays = document.getElementById("cardZeroIncidentDays");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getZeroIncidentDays + idLink, true);

  xhr_object.onload = function () {
    resfunGetZeroIncidentDays = JSON.parse(this.responseText);
    console.log("Zero Incidents - ");
    console.log(resfunGetZeroIncidentDays);
    cardZeroIncidentDays.innerHTML = resfunGetZeroIncidentDays.response + "";
  };
  xhr_object.send();
}

function funGetIncidentPerSqFt() {
  let cardIncidentPerSqFt = document.getElementById("cardIncidentPerSqFt");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getIncidentPerSqFt + idLink, true);

  xhr_object.onload = function () {
    resfunGetIncidentPerSqFt = JSON.parse(this.responseText);
    console.log("Incidents Per Sq. Ft. - ");
    console.log(resfunGetIncidentPerSqFt);
    cardIncidentPerSqFt.innerHTML = resfunGetIncidentPerSqFt.response + "";
  };
  xhr_object.send();
}

function funGetIncidentNearMissGoodCatch() {
  let cardIncidentNearMissGoodCatch = document.getElementById(
    "cardIncidentNearMissGoodCatch"
  );

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getIncidentNearMissGoodCatch + idLink, true);

  xhr_object.onload = function () {
    resfunGetIncidentNearMissGoodCatch = JSON.parse(this.responseText);
    console.log("Incidents Near Miss Good Catch - ");
    console.log(resfunGetIncidentNearMissGoodCatch);
    cardIncidentNearMissGoodCatch.innerHTML =
      resfunGetIncidentNearMissGoodCatch.response + "";
  };
  xhr_object.send();
}

let clickedTicket = true;

function funChartTicket() {
  let dt1NoData = document.getElementById("dt1NoData");
  let ticket_b1 = document.getElementById("ticket-b1");
  let loaderTicketB1Chart = document.getElementById("loaderTicketB1Chart");
  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getTicketsChart + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
  console.log(
    getTicketsChart +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );

  xhr_object.onload = function () {
    resfunChartTicket = JSON.parse(this.responseText);

    console.log("Ticket - ");
    console.log(resfunChartTicket);

    let total = resfunChartTicket.response.open + resfunChartTicket.response.closed;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }
    let currentChartType = "doughnut";
    // Added Now
    originalChartConfigTicket = {
      type: "doughnut",
      data: {
        labels: ["Open", "Closed"],
        datasets: [
          {
            label: "Tickets",
            backgroundColor: ["#e2445b", "#01c875"],
            data: [
              // resfunChartTicket.response.total,
              resfunChartTicket.response.open,
              resfunChartTicket.response.closed,
            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffff",
            // anchor: "end",
            // align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels, centerText],
    };
    let myChart = new Chart(ticket_b1, originalChartConfigTicket)

    loaderTicketB1Chart.style.display = "none";

    if (resfunChartTicket.response.total == 0) {
      dt1NoData.style.display = "block";
      ticket_b1.style.display = "none";
    } else {
      dt1NoData.style.display = "none";
      ticket_b1.style.display = "block";
    }



    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let ticketDrillDownLevel = 1;
    if (!funChartTicket.initialized) {
      ticket_b1.onclick = function (event) {

        if (clickedTicket == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelTicket").textContent = `Ticket: ${label}`;
            backgroundColor = myChart.data.datasets[0].backgroundColor[firstPoint.index];

            myChart.update();

            console.log(backgroundColor);
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            const dropdown = (document.getElementById("dataDropdown_ticket"));
            dropdown.style.display = "block";

          }

          dataDropdown_ticket.addEventListener("click", function (event) {
            // const selectedOption = event.target.id;
            // const firstPoint = points[0];
            // const label = myChart.data.labels[firstPoint.index];
            // const labelname = label;
            // const  backgroundColors =  myChart.data.datasets[0].backgroundColor[firstPoint.index] ;
            // console.log(selectedOption);

            if (event.target.id != "closeDropdown") {
            if (ticketDrillDownLevel === 1) {
              console.log("---------------------------------------")
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(backgroundColors);
              console.log(selectedOption);
              let xhr_object = new XMLHttpRequest();
              let apiURL;
              // First-level drill-down API
              // firstdrillDownSelectedOption  = 
              apiURL =
                getTicketDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,
                true

              xhr_object.open("GET", apiURL, true);
              downloadTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-tickets/" + idLink +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "",

                xhr_object.onload = function () {
                  resTicketDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resTicketDrill);

                  const labels = resTicketDrill.response.map(item => item[1]);
                  const data = resTicketDrill.response.map(item => item[0]);
                  // const labelname = label;
                  myChart.destroy();
                  myChart = new Chart(ticket_b1, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: backgroundColors,
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                          title: {
                            display: true,
                            text: labelname,
                            padding: {
                              top: 20,
                            }
                          }
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                }
              xhr_object.send();
              ticketDrillDownLevel = 2;

            }
            else if (ticketDrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              // Second-level drill-down API
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              console.log(backgroundColors);

              apiURL = getSecondLevelDrillDownTickets +
                idLink +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue,
                // alert("second drill down api");

                // Reset flag after second-level drill-down
                // secondLevelActive = false;

                console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-tickets/" + idLink +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue,

                xhr_object.onload = function () {
                  resTicketDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resTicketDrill);

                  const labels = resTicketDrill.response.map(item => item[1]);
                  const data = resTicketDrill.response.map(item => item[0]);
                  // const labelname = label;
                  myChart.destroy();
                  myChart = new Chart(ticket_b1, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: "#01c875",
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                          title: {
                            display: true,
                            text: labelname,
                            padding: {
                              top: 20,
                            }
                          }
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });

                }
              xhr_object.send();
              ticketDrillDownLevel = 3;
              return;
            }
          }
          else {
            if(ticketDrillDownLevel === 1) {
              restoreOriginalChartTicket();
            }
          }


            dataDropdown_ticket.style.display = "none";
          });
        } else if (clickedTicket == false) {
          alert("You have reached the maximum drill-down level.");
        }

      };
    }

    function restoreOriginalChartTicket() {
      if (originalChartConfigTicket) {
        myChart.destroy(); // Destroy the current chart
        funChartTicket();
        clickedTicket = true;

      }
    }

    refreshIconElement_ticket.addEventListener("click", restoreOriginalChartTicket);
  };

  xhr_object.send();
}

let clickedReactiveTicket = true;
function funReactiveTicket() {
  let ReactiveTicketNoData = document.getElementById("ReactiveTicketNoData");
  let reactiveTicket = document.getElementById("reactiveTicket");
  let loaderReactiveTicket = document.getElementById("loaderReactiveTicket");


  // loaderReactiveTicket.style.display = "block";
  // ReactiveTicketNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getReactiveTicket + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getReactiveTicket +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
  console.log(
    getReactiveTicket +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );

  xhr_object.onload = function () {
    resfunReactiveTicket = JSON.parse(this.responseText);

    console.log("Ticket - ");
    console.log(resfunReactiveTicket);

    let total = resfunReactiveTicket.response.total_tickets;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }

    // Added Now
    originalChartConfigReactive = {
      type: "doughnut",
      data: {
        labels: ["Proactive", "Reactive"],
        datasets: [
          {
            label: "Tickets",
            backgroundColor: ["#01c875", "#e2445b",],
            data: [
              // resfunChartTicket.response.total,
              resfunReactiveTicket.response.proactive_tickets,
              resfunReactiveTicket.response.reactive_tickets,
            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffff",
            // anchor: "end",
            // align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels, centerText],
    }

    let myChart = new Chart(reactiveTicket, originalChartConfigReactive)

    loaderReactiveTicket.style.display = "none";

    if (resfunReactiveTicket.response.total == 0) {
      ReactiveTicketNoData.style.display = "block";
      reactiveTicket.style.display = "none";
    } else {
      ReactiveTicketNoData.style.display = "none";
      reactiveTicket.style.display = "block";
    }

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let ReactiveProactivedrillDownLevel = 1;

    // if (!funReactiveTicket.initialized) {
    reactiveTicket.onclick = function (event) {

      if (clickedReactiveTicket == true) {
        const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

        if (points.length) {
          firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

          console.log(`Clicked on ${label} with value ${value}`);
          selectedlabelValue = label;
          document.getElementById("listItemLabelReactive").textContent = `Ticket: ${label}`;
          backgroundColor = myChart.data.datasets[0].backgroundColor[firstPoint.index];

          myChart.update();

          console.log(backgroundColor);
          // document.getElementById("listItemValue").textContent = `Value: ${value}`;

          // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
          // dropdown.show();

          const dropdown = (document.getElementById("dataDropdown_reactive"));
          dropdown.style.display = "block";


        }
        dataDropdown_reactive.addEventListener("click", function (event) {

          if (event.target.id != "closeDropdown") {
          if (ReactiveProactivedrillDownLevel === 1) {
            console.log(event.target.id);
            selectedOption = event.target.id;
            // handleDropdownClick(selectedOption);
            firstPoint = points[0]; // Assuming points is defined elsewhere
            labelname = myChart.data.labels[firstPoint.index];
            // const labelname = label;
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            console.log(selectedOption);


            let xhr_object = new XMLHttpRequest();
            let apiURL;

            apiURL =
              getTicketReactiveDrill +
              idLink +
              "&drilldown_by=" +
              selectedOption +
              "&status=" +
              labelname +
              "&date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond,
              true

            xhr_object.open("GET", apiURL, true);

            xhr_object.onload = function () {
              resTicketReactiveDrill = JSON.parse(this.responseText);
              console.log("Ticket Category Drill Down - ");
              console.log(resTicketReactiveDrill);

              const labels = resTicketReactiveDrill.response.map(item => item[1]);
              const dataValues = resTicketReactiveDrill.response.map(item => item[0]);
              console.log(labels);
              console.log(dataValues);
              myChart.destroy();
              myChart = new Chart(reactiveTicket, {
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: "Data",
                    data: dataValues,
                    backgroundColor: backgroundColors,
                    borderWidth: 1,
                  }]
                },
                options: {
                  responsive: true,
                  interaction: {
                    intersect: false,
                  },
                  scales: {
                    x: {
                      stacked: true,
                      title: {
                        display: true,
                        text: labelname,
                        padding: {
                          top: 20,
                        },
                      },
                    },
                    y: {
                      stacked: true,
                    },
                  },
                  maintainAspectRatio: false,
                  plugins: {
                    datalabels: {
                      color: "#000000",
                      anchor: "end",
                      align: "end",
                      offset: -6,
                      font: {
                        size: "10",
                        weight: "bold",
                      },
                      formatter: function (value, context) {
                        // Hide label if value is zero
                        return value === 0 ? '' : value;
                      },
                    },
                    legend: {
                      display: true,
                      position: "no",
                    },
                  },
                },
                plugins: [ChartDataLabels],
              });

            };

            xhr_object.send();
            ReactiveProactivedrillDownLevel = 2;

          }
          else if (ReactiveProactivedrillDownLevel === 2) {
            // alert(selectedOption);
            // alert(labelname);
            // alert(selectedlabelValue);
            const firstPoint = points[0];
            // alert(firstPoint.index);
            const selectedSecondOption = event.target.id;
            const labelSecond = myChart.data.labels[firstPoint.index];
            const labelnameSecond = labelSecond;
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            console.log(selectedSecondOption);
            console.log(selectedlabelValue);
            // console.log(backgroundColors);

            apiURL =
              getTicketReactiveDrillSecond +
              idLink +
              "&status=" +
              labelname +
              "&first_drilldown_by=" +
              selectedOption +
              "&sec_drilldown_by=" +
              selectedSecondOption +
              "&sec_drill_down_on=" +
              selectedlabelValue +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst;
            // alert("second drill down api");
            console.log(apiURL);

            xhr_object.open("GET", apiURL, true);

            xhr_object.onload = function () {
              resTicketReactiveDrill = JSON.parse(this.responseText);
              console.log("Ticket Category Drill Down - ");
              console.log(resTicketReactiveDrill);

              const labels = resTicketReactiveDrill.response.map(item => item[1]);
              const dataValues = resTicketReactiveDrill.response.map(item => item[0]);
              console.log(labels);
              console.log(dataValues);

              myChart = new Chart(reactiveTicket, {
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: "Data",
                    data: dataValues,
                    backgroundColor: backgroundColors,
                    borderWidth: 1,
                  }]
                },
                options: {
                  responsive: true,
                  interaction: {
                    intersect: false,
                  },
                  scales: {
                    x: {
                      stacked: true,
                      title: {
                        display: true,
                        text: labelname,
                        padding: {
                          top: 20,
                        },
                      },
                    },
                    y: {
                      stacked: true,
                    },
                  },
                  maintainAspectRatio: false,
                  plugins: {
                    datalabels: {
                      color: "#000000",
                      anchor: "end",
                      align: "end",
                      offset: -6,
                      font: {
                        size: "10",
                        weight: "bold",
                      },
                      formatter: function (value, context) {
                        // Hide label if value is zero
                        return value === 0 ? '' : value;
                      },
                    },
                    legend: {
                      display: true,
                      position: "no",
                    },
                  },
                },
                plugins: [ChartDataLabels],
              });

            };

            xhr_object.send();
            ReactiveProactivedrillDownLevel = 3;
            clickedReactiveTicket = false;
            return;

          }
        }
        else {
          if(clickedReactiveTicket === 1) {
            restoreOriginalChart();
          }
        }


          dataDropdown_reactive.style.display = "none";

        });
      } else if (clickedReactiveTicket == false) {
        alert("You have reached the maximum drill-down level.");
      }


    };
    // }

    function restoreOriginalChart() {
      if (originalChartConfigReactive) {
        myChart.destroy();
        funReactiveTicket();
        clickedReactiveTicket = true;
      }
    }

    refreshIconElement_reactive.addEventListener("click", restoreOriginalChart);



  };



  xhr_object.send();
}

function funTechnicalChecklist() {

  let TechnicalChecklistNoData = document.getElementById("TechnicalChecklistNoData");
  let TechnicalChecklist = document.getElementById("TechnicalChecklist");
  let loaderTechnicalChecklist = document.getElementById("loaderTechnicalChecklist");

  // loaderTechnicalChecklist.style.display = "block";
  // TechnicalChecklistNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getTechnicalChecklist + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getTechnicalChecklist +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log("Technical Checklist");
    console.log(
      getTechnicalChecklist +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true
    );
  }

  xhr_object.onload = function () {
    resfunTechnicalChecklist = JSON.parse(this.responseText);
    console.log("TechnicalChecklist -llllllllllllllllllllllllllll ");
    console.log(resfunTechnicalChecklist);
    // const labels = Object.keys(resfunTechnicalChecklist.response);
    // const data = Object.values(resfunTechnicalChecklist.response);
    let responseCLosed = [], responseOpen = [], responseWIP = []; responseOverdue = [];

    let valuesResponses = Object.values(resfunTechnicalChecklist.response);

    for (let i = 0; i < valuesResponses.length; i += 1) {
      responseCLosed[i] = valuesResponses[i].closed;
      responseOpen[i] = valuesResponses[i].open;
      responseWIP[i] = valuesResponses[i].work_in_progress;
      responseOverdue[i] = valuesResponses[i].overdue;
    }

    let xLabelsArray = Object.keys(resfunTechnicalChecklist.response);

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      xLabelsArray[i] = xLabelsArray[i].split(" ");
    }
    // Added now
    new Chart(TechnicalChecklist, {
      type: "bar",
      data: {
        labels: xLabelsArray,
        datasets: [
          {
            label: "Closed",
            backgroundColor: "#67c801",
            data: responseCLosed,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Open",
            backgroundColor: "#5E2750",
            data: responseOpen,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Work In Progress",
            backgroundColor: "#01C875",
            data: responseWIP,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Overdue",
            backgroundColor: "#FF5F1F",
            data: responseOverdue,
            barThickness: 70,
            borderWidth: 1,
          },
        ],
      },
      options: {
        tooltips: {
          displayColors: true,
          callbacks: {
            mode: 'x',
          },
        },
        scales: {
          xAxes: {
            stacked: true,
            gridLines: {
              display: false,
            }
          },
          yAxes: {
            stacked: true,
            ticks: {
              beginAtZero: true,
            },
            type: 'linear',
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderTechnicalChecklist.style.display = "none";

    if (resfunTechnicalChecklist.response.total == 0) {
      TechnicalChecklistNoData.style.display = "block";
      TechnicalChecklist.style.display = "none";
    } else {
      TechnicalChecklistNoData.style.display = "none";
      TechnicalChecklist.style.display = "block";
    }

  };

  xhr_object.send();

}

// loaderNonTechnicalChecklist, NonTechnicalChecklistNoData, NonTechnicalChecklist
// downloadNonTechnicalChecklist
function funNonTechnicalChecklist() {
  let NonTechnicalChecklistNoData = document.getElementById("NonTechnicalChecklistNoData");
  let NonTechnicalChecklist = document.getElementById("NonTechnicalChecklist");
  let loaderNonTechnicalChecklist = document.getElementById("loaderNonTechnicalChecklist");

  // loaderNonTechnicalChecklist.style.display = "block";
  // NonTechnicalChecklistNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getNonTechnicalChecklist + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getNonTechnicalChecklist +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log("NonTechnicalChecklist");
    console.log(
      getNonTechnicalChecklist +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true
    );
  }

  xhr_object.onload = function () {
    resfunNonTechnicalChecklist = JSON.parse(this.responseText);
    console.log("NonTechnicalChecklist - ");
    console.log(resfunNonTechnicalChecklist);
    // const labels = Object.keys(resfunNonTechnicalChecklist.response);
    // const data = Object.values(resfunNonTechnicalChecklist.response);

    let responseCLosed = [], responseOpen = [], responseWIP = []; responseOverdue = [];

    let valuesResponses = Object.values(resfunNonTechnicalChecklist.response);

    for (let i = 0; i < valuesResponses.length; i += 1) {
      responseCLosed[i] = valuesResponses[i].closed;
      responseOpen[i] = valuesResponses[i].open;
      responseWIP[i] = valuesResponses[i].work_in_progress;
      responseOverdue[i] = valuesResponses[i].overdue;
    }

    let xLabelsArray = Object.keys(resfunNonTechnicalChecklist.response);

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      xLabelsArray[i] = xLabelsArray[i].split(" ");
    }

    // Added now
    new Chart(NonTechnicalChecklist, {
      type: "bar",
      data: {
        labels: xLabelsArray,
        datasets: [
          {
            label: "Closed",
            backgroundColor: "#67c801",
            data: responseCLosed,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Open",
            backgroundColor: "#5E2750",
            data: responseOpen,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Work In Progress",
            backgroundColor: "#01C875",
            data: responseWIP,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Overdue",
            backgroundColor: "#FF5F1F",
            data: responseOverdue,
            barThickness: 70,
            borderWidth: 1,
          },
        ],
      },
      options: {
        tooltips: {
          displayColors: true,
          callbacks: {
            mode: 'x',
          },
        },
        scales: {
          xAxes: {
            stacked: true,
            gridLines: {
              display: false,
            }
          },
          yAxes: {
            stacked: true,
            ticks: {
              beginAtZero: true,
            },
            type: 'linear',
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderNonTechnicalChecklist.style.display = "none";

    if (resfunNonTechnicalChecklist.response.total == 0) {
      NonTechnicalChecklistNoData.style.display = "block";
      NonTechnicalChecklist.style.display = "none";
    } else {
      NonTechnicalChecklistNoData.style.display = "none";
      NonTechnicalChecklist.style.display = "block";
    }

  };
  xhr_object.send();

}


function funChecklistTop() {
  let ChecklistTopNoData = document.getElementById("ChecklistTopNoData");
  let ChecklistTop = document.getElementById("ChecklistTop");
  let loaderTopChecklist = document.getElementById("loaderTopChecklist");


  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getChecklistTop + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getChecklistTop +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
  console.log(
    getChecklistTop +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );


  xhr_object.onload = function () {
    resfunChecklistTop = JSON.parse(this.responseText);

    console.log("CheckList Top---------------------- - ");
    console.log(resfunChecklistTop);

    const labels = (resfunChecklistTop.response.map(item => item[1]));
    const data = (resfunChecklistTop.response.map(item => item[0]));


    originalChartConfigTopChecklist = {
      type: "bar",
      data: {
        labels: labels,
        datasets: [
          {
            label: "Checklist",
            backgroundColor: ["#67c801", "#5E2750", "#01C875", "#FF5F1F"],
            data: data,
            borderWidth: 1,
            stack: "Stack 0",
          }
        ],
      },


      options: {
        tooltips: {
          displayColors: true,
          callbacks: {
            mode: 'x',
          },
        },
        scales: {
          xAxes: [{
            stacked: false,
            gridLines: {
              display: false,
            }
          }],
          yAxes: [{
            stacked: false,
            ticks: {
              beginAtZero: true,
            },
            type: 'linear',
          }]
        },
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 8) + ("..");
              }
            }
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },

          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(ChecklistTop, originalChartConfigTopChecklist)

    loaderTopChecklist.style.display = "none";

    // if (resfunChartTicket.response == 0) {
    //   ChecklistNoData.style.display = "block";
    //   Checklist.style.display = "none";
    // } else {
    // ChecklistNoData.style.display = "none";
    ChecklistTop.style.display = "block";
    // }

    // refreshIconElement_Top10Checklist


    refreshIconElement_Top10Checklist.addEventListener("click", restoreOriginalChart);

    function restoreOriginalChart() {
      if (originalChartConfigTopChecklist) {
        myChart.destroy();
        loaderTopChecklist.style.display = "block";
        funChecklistTop();

      }
    }
  };

  xhr_object.send();



}


function funInventoryConsumption() {
  // loaderInventoryConsumption,inventoryConsumptionNoData,tblInventoryConsumptioninfo,tablebodyInventoryConsumption
  let inventoryConsumptionNoData = document.getElementById(
    "inventoryConsumptionNoData"
  );
  let tablebodyInventoryConsumption = document.getElementById(
    "tablebodyInventoryConsumption"
  );
  let tblInventoryConsumptioninfo = document.getElementById(
    "tblInventoryConsumptioninfo"
  );
  let loaderInventoryConsumption = document.getElementById(
    "loaderInventoryConsumption"
  );

  // tblInventoryConsumptioninfo.style.display = "none";
  // loaderInventoryConsumption.style.display = "block";
  // inventoryConsumptionNoData.style.display = "none";
  console.log(getInventoryConsumption);
  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getInventoryConsumption +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );
  console.log(
    getInventoryConsumption +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );
  console.log("========================================");
  // console.log(globalDateFirst);
  // console.log(getInventoryConsumption);
  xhr_object.onload = function () {
    resfunInventoryConsumption = JSON.parse(this.responseText);
    console.log("InventoryConsumption - ");
    console.log(resfunInventoryConsumption);

    let resfunInventoryConsumptionArray = resfunInventoryConsumption.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunInventoryConsumptionArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][0] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][1] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][2] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][3] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][4] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][5] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][6] +
        `</td>`;

      // `<td>` +
      // resfunInventoryConsumptionArray[x][7] +
      // `</td>` +
      // `<td>` +
      // resfunInventoryConsumptionArray[x][8] +
      // `</td>`  +`</tr>`;
      // `<td>` +
      // resfunInventoryConsumptionArray[x][9] +
      // `</td>`
      if (
        resfunInventoryConsumptionArray[x][7] < 0 ||
        resfunInventoryConsumptionArray[x][7] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails + `<td>` + resfunInventoryConsumptionArray[x][7] + `</td>`;
      }
      if (
        resfunInventoryConsumptionArray[x][8] < 0 ||
        resfunInventoryConsumptionArray[x][8] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails + `<td>` + resfunInventoryConsumptionArray[x][8] + `</td>`;
      }
      +`</tr>`;
    }
    tablebodyInventoryConsumption.innerHTML = allDetails;

    loaderInventoryConsumption.style.display = "none";
    if (resfunInventoryConsumptionArray.length == 0) {
      inventoryConsumptionNoData.style.display = "block";
      tblInventoryConsumptioninfo.style.display = "none";
    } else {
      inventoryConsumptionNoData.style.display = "none";
      tblInventoryConsumptioninfo.style.display = "inline-table";
    }
    // refreshIconElement_inventoryConsumption

   

    function restoreOriginalChart() {
      loaderInventoryConsumption.style.display = "block";
      funInventoryConsumption();
    }

    refreshIconElement_inventoryConsumption.addEventListener("click", restoreOriginalChart);
  };
  xhr_object.send();
}

function funInventoryReportGreen() {
  // loaderInventoryReportGreen,inventoryReportGreenNoData,inventory_report_green
  let loaderInventoryReportGreen = document.getElementById(
    "loaderInventoryReportGreen"
  );
  let inventoryReportGreenNoData = document.getElementById(
    "inventoryReportGreenNoData"
  );
  let inventory_report_green = document.getElementById(
    "inventory_report_green"
  );
  let inventoryReportGreen = document.getElementById("inventoryReportGreen");

  // inventory_report.style.display = "none";
  // loaderInventoryReportGreen.style.display = "block";
  // inventoryReportGreenNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getInventoryReportGreen +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunInventoryReportGreen = JSON.parse(this.responseText);

    console.log("Inventory Report - green");
    console.log(resfunInventoryReportGreen);

    let sum = 0;

    let valueName = [];
    let valueY = [];


    valueName = Object.keys(resfunInventoryReportGreen.response);
    valueY = Object.values(resfunInventoryReportGreen.response);
    console.log(valueName);
    console.log(valueY);

    let inventoryReportColor = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];



    originalChartConfigInventoryReportGreen = {
      type: "pie",
      data: {
        labels: valueName,
        datasets: [
          {
            label: "Inventory Report Green",
            data: valueY,
            backgroundColor: inventoryReportColor,
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(inventory_report_green, originalChartConfigInventoryReportGreen)
    for (let i = 0; i < valueY.length; i += 1) {
      if (valueY[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueY[i];
      }
    }


    loaderInventoryReportGreen.style.display = "none";
    if (sum == 0) {
      inventoryReportGreenNoData.style.display = "block";
      inventory_report_green.style.display = "none";
    } else {
      inventoryReportGreenNoData.style.display = "none";
      inventory_report_green.style.display = "block";
    }

    // refreshIconElement_inventoryReportGreen


    refreshIconElement_inventoryReportGreen.addEventListener("click", restoreOriginalChart);

    function restoreOriginalChart() {
      if (originalChartConfigInventoryReportGreen) {
        myChart.destroy();
        funInventoryReportGreen();

      }
    }
  };
  xhr_object.send();
}

// pie
function funInventoryReport() {
  // loaderInventoryReport,inventoryReportNoData,inventory_report
  let loaderInventoryReport = document.getElementById("loaderInventoryReport");
  let inventoryReportNoData = document.getElementById("inventoryReportNoData");
  let inventory_report = document.getElementById("inventory_report");
  let inventoryReport = document.getElementById("inventoryReport");

  // inventory_report.style.display = "none";
  // loaderInventoryReport.style.display = "block";
  // inventoryReportNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getInventoryReport +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunInventoryReport = JSON.parse(this.responseText);

    console.log("Inventory Report - ");
    console.log(resfunInventoryReport);

    let sum = 0;

    let valueN = [];
    let valueYa = [];

    // let arrayP = [];

    // for (let i = 0; i < resfunInventoryReport.response.length; i++) {
    //   valueN[i] = resfunInventoryReport.response[i].name;
    //   valueYa[i] = resfunInventoryReport.response[i].y;
    // }

    // for (let i = 0; i < valueN.length; i++) {
    //   if (valueYa[i] == null) {
    //     arrayP.push({ name: valueN[i], y: 0 });
    //   } else {
    //     arrayP.push({
    //       name: valueN[i],
    //       y: valueYa[i],
    //     });
    //   }
    // }

    valueN = Object.keys(resfunInventoryReport.response);
    valueYa = Object.values(resfunInventoryReport.response);
    console.log(valueN);
    console.log(valueYa);
    console.log("-----------------");
    let inventoryReportColors = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];

    // let legendList = "";
    // for (let i = 0; i < valueN.length; i++) {
    //   if (valueN[i] != null) {
    //     legendList +=
    //       '<i class="bi  bi-circle-fill " style="color:' +
    //       inventoryReportColors[i] +
    //       ';"></i> ' +
    //       valueN[i] +
    //       "-" +
    //       valueYa[i];
    //     "<br/>" + "<br/>";
    //   }
    // }
    // inventoryReport.innerHTML = legendList;

    // let total = valueN + valueYa;

    // const centerTexts = {
    //   id: "centerTexts",
    //   afterDatasetsDraw(chart, args, options) {
    //     const {
    //       ctx,
    //       chartArea: { left, right, top, bottom, width, height },
    //     } = chart;
    //     ctx.save();

    //     ctx.font = "bolder 18px Arial";
    //     ctx.fillStyle = "rgba(0, 0, 0, 1)";
    //     ctx.textAlign = "center";
    //     ctx.fillText("Total: " + total, width, height);
    //   },
    // };

    originalChartConfigInventory = {
      type: "bar",
      data: {
        labels: valueN,
        datasets: [
          {
            label: "Inventory Report",
            data: valueYa,
            backgroundColor: inventoryReportColors,
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(inventory_report, originalChartConfigInventory)


    for (let i = 0; i < valueYa.length; i += 1) {
      if (valueYa[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueYa[i];
      }
    }

    loaderInventoryReport.style.display = "none";
    if (sum == 0) {
      inventoryReportNoData.style.display = "block";
      inventory_report.style.display = "none";
    } else {
      inventoryReportNoData.style.display = "none";
      inventory_report.style.display = "block";
    }
    // refreshIconElement_inventoryConsumptionReport


    refreshIconElement_inventoryConsumptionReport.addEventListener("click", restoreOriginalChart);

    function restoreOriginalChart() {
      if (originalChartConfigInventory) {
        myChart.destroy();
        loaderInventoryReport.style.display = "block";
        funInventoryReport();

      }
    }
  };
  xhr_object.send();
}
// pie green
function funInventoryReportGreen() {
  // loaderInventoryReportGreen,inventoryReportGreenNoData,inventory_report_green
  let loaderInventoryReportGreen = document.getElementById(
    "loaderInventoryReportGreen"
  );
  let inventoryReportGreenNoData = document.getElementById(
    "inventoryReportGreenNoData"
  );
  let inventory_report_green = document.getElementById(
    "inventory_report_green"
  );
  let inventoryReportGreen = document.getElementById("inventoryReportGreen");

  // inventory_report.style.display = "none";
  // loaderInventoryReportGreen.style.display = "block";
  // inventoryReportGreenNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getInventoryReportGreen +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunInventoryReportGreen = JSON.parse(this.responseText);

    console.log("Inventory Report - green");
    console.log(resfunInventoryReportGreen);

    let sum = 0;

    let valueName = [];
    let valueY = [];


    valueName = Object.keys(resfunInventoryReportGreen.response);
    valueY = Object.values(resfunInventoryReportGreen.response);
    console.log(valueName);
    console.log(valueY);

    let inventoryReportColor = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];



    originalChartConfigInventoryReportGreen = {
      type: "pie",
      data: {
        labels: valueName,
        datasets: [
          {
            label: "Inventory Report Green",
            data: valueY,
            backgroundColor: inventoryReportColor,
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(inventory_report_green, originalChartConfigInventoryReportGreen)
    for (let i = 0; i < valueY.length; i += 1) {
      if (valueY[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueY[i];
      }
    }


    loaderInventoryReportGreen.style.display = "none";
    if (sum == 0) {
      inventoryReportGreenNoData.style.display = "block";
      inventory_report_green.style.display = "none";
    } else {
      inventoryReportGreenNoData.style.display = "none";
      inventory_report_green.style.display = "block";
    }

    // refreshIconElement_inventoryReportGreen

    function restoreOriginalChart() {
      if (originalChartConfigInventoryReportGreen) {
        myChart.destroy();
        loaderInventoryReportGreen.style.display = "block";
        funInventoryReportGreen();

      }
    }

    refreshIconElement_inventoryReportGreen.addEventListener("click", restoreOriginalChart);
  };
  xhr_object.send();
}

// bar
function funCurrentStock() {
  // loaderCurrentStock,CurrentStockNoData,current-Stock
  let loaderCurrentStock = document.getElementById("loaderCurrentStock");
  let barChartCurrentStock = document.getElementById("current-Stock");
  let CurrentStockNoData = document.getElementById("clusterStatsNoData");

  // barChartCurrentStock.style.display = "none";
  // loaderCurrentStock.style.display = "block";
  // CurrentStockNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getCurrentStock +
    idLink+
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunCurrentStock = JSON.parse(this.responseText);
    console.log("Cluster Stats - ");
    console.log(resfunCurrentStock);



    let xLabelsArray = [];
    xLabelsArray = Object.keys(resfunCurrentStock.response);

    let xLabelsArrayCurrent = [];
    let xLabelsArrayMini = [];

    console.log(xLabelsArray);

    let xLabelArrayValue = [];
    xLabelArrayValue = Object.values(resfunCurrentStock.response);

    for (let i = 0; i < xLabelArrayValue.length; i += 1) {
      xLabelsArrayCurrent[i] = xLabelArrayValue[i].Current_Stock;
      xLabelsArrayMini[i] = xLabelArrayValue[i].Minimum_Stock;
      console.log(xLabelsArrayCurrent[i]);
      console.log(xLabelsArrayMini[i]);
    }

    originalChartConfigCurrent = {
      type: "line",
      data: {
        labels: xLabelsArray,
        // labels: ["", "", ""],
        datasets: [
          {
            label: "Minimum Stock",
            backgroundColor: ["#e2445b"],
            data: xLabelsArrayMini,
            tension: 0.4,
            borderColor: ["#e2445b"],
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Current Stock",
            backgroundColor: ["#01c875"],
            data: xLabelsArrayCurrent,
            tension: 0.4,
            borderColor: ["#01c875"],
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            stacked: false,
          },
          y: {
            stacked: false,
            title: {
              display: true,
              text: "Total steps taken",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(barChartCurrentStock, originalChartConfigCurrent)

    loaderCurrentStock.style.display = "none";
    if (xLabelsArray.length == 0) {
      // CurrentStockNoData.style.display = "block";
      barChartCurrentStock.style.display = "none";
    } else {
      // CurrentStockNoData.style.display = "none";
      barChartCurrentStock.style.display = "block";
    }

    refreshIconElement_CurrentStock.addEventListener("click", restoreOriginalChart);

    function restoreOriginalChart() {
      if (originalChartConfigCurrent) {
        myChart.destroy();
        loaderCurrentStock.style.display = "block";
        funCurrentStock();

      }
    }
  };
  xhr_object.send();
}

// bar green
function funCurrentStockGreen() {
  // loaderCurrentStockGreen,CurrentStockGreenNoData,current-Stock-Green
  let loaderCurrentStockGreen = document.getElementById("loaderCurrentStockGreen");
  let barChartCurrentStockGreen = document.getElementById(
    "current-Stock-Green"
  );
  let CurrentStockGreenNoData = document.getElementById(
    "CurrentStockGreenNoData"
  );

  barChartCurrentStockGreen.style.display = "none";
  loaderCurrentStockGreen.style.display = "none";
  CurrentStockGreenNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunCurrentStockGreen = JSON.parse(this.responseText);
    console.log("current Stock----------------- - green ");
    console.log(resfunCurrentStockGreen);

    let xLabelsArrays = [];
    xLabelsArrays = Object.keys(resfunCurrentStockGreen.response);
    // let xLabelsArray = resfunCurrentStock.leaderboard;

    let xLabelsArrayCs = [];
    let xLabelsArrayMs = [];
    // object.value
    let xLabelArrayV = [];
    xLabelArrayV = Object.values(resfunCurrentStockGreen.response);

    for (let i = 0; i < xLabelArrayV.length; i += 1) {
      console.log(xLabelsArrays[i].Current_Stock);
      console.log(xLabelsArrays[i].Minimum_Stock);
      xLabelsArrayCs[i] = xLabelArrayV[i].Current_Stock;
      xLabelsArrayMs[i] = xLabelArrayV[i].Minimum_Stock;
    }

    originalChartConfigCurrentGreenStock = {
      type: "line",
      data: {
        labels: xLabelsArrays,
        // labels: ["", "", ""],
        datasets: [
          {
            label: "Minimum Stock",
            backgroundColor: ["#e2445b"],
            data: xLabelsArrayMs,
            tension: 0.4,
            borderColor: ["#e2445b"],
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Current Stock",
            backgroundColor: ["#01c875"],
            data: xLabelsArrayCs,
            tension: 0.4,
            borderColor: ["#01c875"],
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
            title: {
              display: true,
              text: "Total steps taken",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(barChartCurrentStockGreen, originalChartConfigCurrentGreenStock)

    loaderCurrentStockGreen.style.display = "none";
    if (xLabelsArrays.length == 0) {
      CurrentStockGreenNoData.style.display = "block";
      barChartCurrentStockGreen.style.display = "none";
    } else {
      CurrentStockGreenNoData.style.display = "none";
      barChartCurrentStockGreen.style.display = "block";
    }

   

    function restoreOriginalChart() {
      if (originalChartConfigCurrentGreenStock) {
        myChart.destroy();
        loaderCurrentStockGreen.style.display = "block";
        funCurrentStockGreen();

      }
    }

    refreshIconElement_currentStockGreen.addEventListener("click", restoreOriginalChart);

    // refreshIconElement_currentStockGreen


  };
  xhr_object.send();
}


function funAssetBreakDown() {  // loaderAssetBreakDown,AssetBreakDownNoData,AssetBreakDown ,assetbreak
  let AssetBreakDownNoData = document.getElementById("AssetBreakDownNoData");
  let AssetBreakDown = document.getElementById("AssetBreakDown");
  let loaderAssetBreakDown = document.getElementById(
    "loaderAssetBreakDown"
  );
  // let assetbreak = document.getElementById("assetbreak");

  // if (globalType == "daily") {
  //   assetbreak.innerHTML = "Asset Breakdown for " + globalDateFirst;
  // } else {
  //   assetbreak.innerHTML = "Asset Breakdown for " +
  //     convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond)
  // }

  // loaderAssetBreakDown.style.display = "block";
  // AssetBreakDownNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getAssetBreakDown + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(
      getAssetBreakDown + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getAssetBreakDown +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getAssetBreakDown +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunAssetBreakDown = JSON.parse(this.responseText);

    console.log("Asset Breakdown  - ");
    console.log(resfunAssetBreakDown);

    let arrAllObjects = Object.values(resfunAssetBreakDown.response);
    let arrCriticalBreak = [];
    let arrCriticalOperational = [];
    let arrNonCriticalBreak = [];
    let arrNonCriticalOperational = [];

    for (let i = 0; i < arrAllObjects.length; i++) {
      arrCriticalBreak.push(arrAllObjects[i].critical_breakdown_count);
      // arrCriticalOperational.push(arrAllObjects[i].Critical_Operational);
      arrNonCriticalBreak.push(arrAllObjects[i].non_critical_breakdown_count);
      // arrNonCriticalOperational.push(arrAllObjects[i].Non_Critical_Operational);

    }

    // Added now
    originalChartConfigAssetBreakDown = {
      type: "bar",
      data: {
        labels: Object.keys(resfunAssetBreakDown.response),
        datasets: [
          {
            label: "Critical Breakdown",
            backgroundColor: "rgba(255, 159, 64)",
            data: arrCriticalBreak,
            borderWidth: 1,
            stack: "Stack 0",
          },
          // {
          //   label: "Critical Operational",
          //   backgroundColor: ["#3d5a80"],
          //   data: arrCriticalOperational,
          //   borderWidth: 1,
          //   stack: "Stack 0",
          // },
          {
            label: "Non-Critical Breakdown",
            backgroundColor: ["#555555"],
            data: arrNonCriticalBreak,
            borderWidth: 1,
            stack: "Stack 1",
          },
          // {
          //   label: "Non-Critical Operational",
          //   backgroundColor: ["#98c1d9"],
          //   data: arrNonCriticalOperational,
          //   borderWidth: 1,
          //   stack: "Stack 1",
          // },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            // ticks: {
            //   callback: function (value) {
            //     return this.getLabelForValue(value).substr(0, 15);
            //   },
            // },
            beginAtZero: true,
            title: {
              display: true,
              text: 'Sites',
              padding: {
                top: 20,
              }
            }
          },
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Total Breakdown'
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            labels: {
              usePointStyle: true  // Enable point style icons
            },
            display: true,
            position: "top",
            align: "end"
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(AssetBreakDown, originalChartConfigAssetBreakDown)
    loaderAssetBreakDown.style.display = "none";

    if (resfunAssetBreakDown.response.length == 0) {
      AssetBreakDownNoData.style.display = "block";
      AssetBreakDown.style.display = "none";
    } else {
      AssetBreakDownNoData.style.display = "none";
      AssetBreakDown.style.display = "block";
    }

    // refreshIconElement_AssetBreakDown

    refreshIconElement_AssetBreakDown.addEventListener("click", restoreOriginalChartAssetBreakDown);

    function restoreOriginalChartAssetBreakDown() {
      if (originalChartConfigAssetBreakDown) {
        myChart.destroy();
        loaderAssetBreakDown.style.display = "block";
        funAssetBreakDown();

      }
    }
  };
  // loaderAssetBreakDown,AssetBreakDownNoData,AssetBreakDown ,assetbreak
  xhr_object.send();
}

function funInventoryConsumptionGreen() {
  // loaderInventoryConsumptionGreen,inventoryConsumptionGreenNoData,tblInventoryConsumptionGreeninfo,tablebodyInventoryConsumptionGreen
  let inventoryConsumptionGreenNoData = document.getElementById(
    "inventoryConsumptionGreenNoData"
  );
  let tablebodyInventoryConsumptionGreen = document.getElementById(
    "tablebodyInventoryConsumptionGreen"
  );
  let tblInventoryConsumptionGreeninfo = document.getElementById(
    "tblInventoryConsumptionGreeninfo"
  );
  let loaderInventoryConsumptionGreen = document.getElementById(
    "loaderInventoryConsumptionGreen"
  );

  // tblInventoryConsumptionGreeninfo.style.display = "none";
  // loaderInventoryConsumptionGreen.style.display = "block";
  // inventoryConsumptionGreenNoData.style.display = "none";
  console.log(getInventoryConsumptionGreen);
  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getInventoryConsumptionGreen +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );
  console.log(
    getInventoryConsumptionGreen +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );
  console.log("========================================");

  xhr_object.onload = function () {
    resfunInventoryConsumptionGreen = JSON.parse(this.responseText);
    console.log("InventoryConsumption -green ");
    console.log(resfunInventoryConsumptionGreen);

    let resfunInventoryConsumptionGreenArray =
      resfunInventoryConsumptionGreen.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunInventoryConsumptionGreenArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][0] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][1] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][2] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][3] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][4] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][5] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][6] +
        `</td>`;
      // `<td>` +
      // resfunInventoryConsumptionGreenArray[x][7] +
      // `</td>` +
      // `<td>` +
      // resfunInventoryConsumptionGreenArray[x][8] +
      // `</td>` +
      if (
        resfunInventoryConsumptionGreenArray[x][7] < 0 ||
        resfunInventoryConsumptionGreenArray[x][7] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails +
          `<td>` +
          resfunInventoryConsumptionGreenArray[x][7] +
          `</td>`;
      }
      if (
        resfunInventoryConsumptionGreenArray[x][8] < 0 ||
        resfunInventoryConsumptionGreenArray[x][8] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails +
          `<td>` +
          resfunInventoryConsumptionGreenArray[x][8] +
          `</td>`;
      }
      +`</tr>`;
    }
    tablebodyInventoryConsumptionGreen.innerHTML = allDetails;

    loaderInventoryConsumptionGreen.style.display = "none";
    if (resfunInventoryConsumptionGreenArray.length == 0) {
      inventoryConsumptionGreenNoData.style.display = "block";
      tblInventoryConsumptionGreeninfo.style.display = "none";
    } else {
      inventoryConsumptionGreenNoData.style.display = "none";
      tblInventoryConsumptionGreeninfo.style.display = "block";
    }

    // refreshIconElement_inventoryConsumptionGreen


  
    function restoreOriginalChartConsumptionGreen() {
      loaderInventoryConsumptionGreen.style.display = "block";
      funInventoryConsumptionGreen();
    }

    refreshIconElement_inventoryConsumptionGreen.addEventListener("click", restoreOriginalChartConsumptionGreen);

  };
  xhr_object.send();
}


function funDryWasteSegregation() {
  let dryWasteNoData = document.getElementById("dryWasteNoData");
  let dryWasteSegregation = document.getElementById("dryWasteSegregation");
  let loaderDryWaste = document.getElementById("loaderDryWaste");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getDryWasteSegregation + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(
      getDryWasteSegregation + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getDryWasteSegregation +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getDryWasteSegregation +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunDryWasteSegregation = JSON.parse(this.responseText);
  
    console.log("Dry Waste Segregation--------------------  - ");
    console.log(resfunDryWasteSegregation);
  
    // Extract data from the response
    let data = resfunDryWasteSegregation.response;
  
    // Check if data is defined and not empty
    if (data && Object.keys(data).length > 0) {
      let labels = Object.keys(data);
      let datasets = Object.values(data[labels[0]]).map((value, index) => ({
        label: value[1],
        data: labels.map((label) => parseInt(data[label][index][0])),
        backgroundColor: [
          "#730000",
          "#FDAB3D",
          "#E95420",
          "#77216F",
        ][index],
        borderColor: [
          "#730000",
          "#FDAB3D",
          "#E95420",
          "#77216F",
        ][index],
        borderWidth: 1,
      }));
  
      // Create the chart
      originalChartConfigDry = {
        type: "bar",
        data: {
          labels: labels,
          datasets: datasets,
        },
        options: {
          responsive: true,
          interaction: {
            intersect: false,
          },
          scales: {
            x: {
              stacked: true,
              title: {
                display: true,
                text: "Sites",
                padding: {
                  top: 20,
                },
              },
            },
            y: {
              stacked: true,
              title: {
                display: true,
                text: "Dry Garbage in kgs",
              },
            },
          },
          maintainAspectRatio: false,
          plugins: {
            datalabels: {
              color: "#000000",
              anchor: "end",
              align: "end",
              offset: -6,
              font: {
                size: "10",
                weight: "bold",
              },
            },
            legend: {
              labels: {
                usePointStyle: true,
              },
              display: true,
              position: "top",
              align: "end",
            },
          },
        },
        plugins: [ChartDataLabels],
      };
  
      let myChart = new Chart(dryWasteSegregation, originalChartConfigDry);
  
      loaderDryWaste.style.display = "none";
  
      if (Object.keys(resfunDryWasteSegregation.response).length == 0) {
        dryWasteNoData.style.display = "block";
        dryWasteSegregation.style.display = "none";
      } else {
        dryWasteNoData.style.display = "none";
        dryWasteSegregation.style.display = "block";
      }

      function restoreOriginalChartWaste() {
        if (originalChartConfigDry) {
          myChart.destroy();
          loaderDryWaste.style.display = "block";
          funDryWasteSegregation();
        }
      }
  
      refreshIconElement_waste.addEventListener("click", restoreOriginalChartWaste);
  

    } else {
      console.error("No data available or data structure is not as expected.");
      dryWasteNoData.style.display = "block";
      dryWasteSegregation.style.display = "none";
      loaderDryWaste.style.display = "none";
    }


  };
  xhr_object.send();
  
}


let clickedCategoryTicket = true;
function funCategoryTicket() {
  let categoryTicketNoData = document.getElementById("categoryTicketNoData");
  let catagory_ticket = document.getElementById("catagory-ticket");
  let loaderCategoryTicketChart = document.getElementById(
    "loaderCategoryTicketChart"
  );
  let dt2 = document.getElementById("dt2");

  // if (globalType == "daily") {
  //   dt2.innerHTML = "Unit Category-wise Tickets for " + globalDateFirst;
  // } else {
  // dt2.innerHTML = "Unit Category-wise Tickets for " +
  //   convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond)

  // }

  // loaderCategoryTicketChart.style.display = "block";
  // categoryTicketNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getUnitCategoryWiseTicketsChart + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(
      getUnitCategoryWiseTicketsChart + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getUnitCategoryWiseTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getUnitCategoryWiseTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  let currentChartType = "bar";
  xhr_object.onload = function () {
    resfunCategoryTicket = JSON.parse(this.responseText);

    console.log("Category Ticket - ");
    console.log(resfunCategoryTicket);

    // Added now
    originalChartConfigCategory = {
      type: "bar",
      data: {
        labels: resfunCategoryTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCategoryTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCategoryTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(catagory_ticket, originalChartConfigCategory)
    loaderCategoryTicketChart.style.display = "none";

    if (String(resfunCategoryTicket.response.total_tickets).length == 0) {
      categoryTicketNoData.style.display = "block";
      catagory_ticket.style.display = "none";
    } else {
      categoryTicketNoData.style.display = "none";
      catagory_ticket.style.display = "block";
    }

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let CategoryTicketdrillDownLevel = 1;
    if (!funCategoryTicket.initialized) {
      catagory_ticket.onclick = function (event) {

        if (clickedCategoryTicket == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelCategory").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_category"));
            dropdown.style.display = "block";


          }


          dataDropdown_category.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (CategoryTicketdrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getTicketCategoryDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&date=" +
                globalDateFirst,
                "&to_date=" +
                globalDateSecond,
                true

              xhr_object.open("GET", apiURL, true);

              downloadCategoryTicketsLink = ip + "fm-excel-download/get-drill-down-chart-categoryWiseTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              xhr_object.onload = function () {
                resTicketCategoryDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryDrill);

                const labels = Object.keys(resTicketCategoryDrill.response);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(catagory_ticket, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();
              CategoryTicketdrillDownLevel = 2;
            }
            else if (CategoryTicketdrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);

              apiURL =
                getTicketCategoryDrillSecond +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadCategoryTicketsLink = ip + "fm-excel-download/get-drill-down-chart-categoryWiseTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;

              xhr_object.onload = function () {
                resTicketCategoryDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryDrill);

                const labels = Object.keys(resTicketCategoryDrill.response);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"];

                // for (const label of labels) {
                //   datasets.push({
                //     label: label,
                //     data: statuses.map(status => resTicketCategoryDrill.response[label][status] || 0),
                //     backgroundColor: label === "Open" ? "#e2445b" : "#01c875",
                //     stack: "0",
                //   });
                // }

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: status,

                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(catagory_ticket, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedCategoryTicket = false;
              }

              xhr_object.send();
              CategoryTicketdrillDownLevel = 3;
              clickedCategoryTicket = false;
              return;
            }
          }
          else {
            if(CategoryTicketdrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_category.style.display = "none";



          });
        } else if (clickedCategoryTicket == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChart() {
      if (originalChartConfigCategory) {
        myChart.destroy(); // Destroy the current chart
        funCategoryTicket();
        clickedCategoryTicket = true;
        // CategoryTicketdrillDownLevel = 1;
      }
    }

    refreshIconElement_category.addEventListener("click", restoreOriginalChart);
  };

  xhr_object.send();
}

let clickedCategoryProactiveTicket = true;
function funCategoryProactiveTicket() {
  let categoryProactiveTicketNoData = document.getElementById(
    "categoryProactiveTicketNoData"
  );
  let catagory_proactive_ticket = document.getElementById("proactive-ticket");
  let loaderCategoryProactiveTicketChart = document.getElementById(
    "loaderCategoryProactiveTicketChart"
  );
  let dt3 = document.getElementById("dt3");

  // if (globalType == "daily") {
  //   dt3.innerHTML =
  //     "Unit Category-wise Proactive Tickets for " + convertDateFormat(globalDateFirst);
  // } else {
  //   dt3.innerHTML =
  //     "Unit Category-wise Proactive Tickets for " +
  //     + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  // }

  // loaderCategoryProactiveTicketChart.style.display = "block";
  // categoryProactiveTicketNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getUnitCategoryWiseProactiveTicketsChart +
      idLink +
      "&date=" +
      globalDateFirst,
      true
    );
    console.log(
      getUnitCategoryWiseProactiveTicketsChart +
      idLink +
      "&date=" +
      globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getUnitCategoryWiseProactiveTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getUnitCategoryWiseProactiveTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunCategoryProactiveTicket = JSON.parse(this.responseText);

    console.log("Proactive - ");
    console.log(resfunCategoryProactiveTicket);

    // Added now
    originalChartConfigProactive = {
      type: "bar",
      data: {
        labels: resfunCategoryProactiveTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCategoryProactiveTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCategoryProactiveTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(catagory_proactive_ticket, originalChartConfigProactive)

    loaderCategoryProactiveTicketChart.style.display = "none";
    if (
      String(resfunCategoryProactiveTicket.response.total_tickets).length == 0
    ) {
      categoryProactiveTicketNoData.style.display = "block";
      catagory_proactive_ticket.style.display = "none";
    } else {
      categoryProactiveTicketNoData.style.display = "none";
      catagory_proactive_ticket.style.display = "block";
    }

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let CategoryProactivedrillDownLevel = 1;
    if (!funCategoryProactiveTicket.initialized) {
      catagory_proactive_ticket.onclick = function (event) {

        if (clickedCategoryProactiveTicket == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelProactive").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_proactive"));
            dropdown.style.display = "block";


          }
          dataDropdown_proactive.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (CategoryProactivedrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getTicketCategoryProactiveDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&date=" +
                globalDateFirst,
                "&to_date=" +
                globalDateSecond,

                xhr_object.open("GET", apiURL, true);
              downloadCategoryWiseProactiveTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-categoryWiseProactiveTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;

              xhr_object.onload = function () {
                resTicketCategoryProactiveDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryProactiveDrill);

                const labels = Object.keys(resTicketCategoryProactiveDrill.response);
                const datasets = [];
                // const labelname = label;

                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryProactiveDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",

                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };

                myChart.destroy();
                myChart = new Chart(catagory_proactive_ticket, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                // clickedCategoryProactiveTicket = false;
              }

              xhr_object.send();
              CategoryProactivedrillDownLevel = 2;
            }
            else if (CategoryProactivedrillDownLevel === 2) {
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);

              apiURL =
                getTicketCategoryProactiveDrillSecond +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadCategoryWiseProactiveTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-categoryWiseProactiveTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;


              xhr_object.onload = function () {
                resTicketCategoryProactiveDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryProactiveDrill);

                const labels = Object.keys(resTicketCategoryProactiveDrill.response);
                const datasets = [];
                // const labelname = label;

                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryProactiveDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",

                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };

                myChart.destroy();
                myChart = new Chart(catagory_proactive_ticket, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();
              CategoryProactivedrillDownLevel = 3;
              clickedCategoryProactiveTicket = false;
              return;
            }
          }
          else {
            if(CategoryProactivedrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }
            dataDropdown_proactive.style.display = "none";
          });
        } else if (clickedCategoryProactiveTicket == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChart() {
      if (originalChartConfigProactive) {
        myChart.destroy(); // Destroy the current chart
        funCategoryProactiveTicket();
        clickedCategoryProactiveTicket = true;
      }
    }

    refreshIconElement_proactive.addEventListener("click", restoreOriginalChart);
  };

  xhr_object.send();
}

function funChartCustomerSentiments() {
  let CustomerSentimentsNoData = document.getElementById("CustomerSentimentsNoData");
  let customerSentiment = document.getElementById("customerSentiment");
  let loaderCustomerSentiments = document.getElementById("loaderCustomerSentiments");
  let sentiments = document.getElementById("sentiments");

  // loaderCustomerSentiments.style.display = "block";
  // customerSentiment.style.display = "none";
  // CustomerSentimentsNoData.style.display = "none";

  // if (globalType == "daily") {
  //   sentiments.innerHTML = "Customer Sentiments for " + globalDateFirst;
  // } else {
  //   sentiments.innerHTML =
  //     "Customer Sentiments for " + globalDateFirst + " to " + globalDateSecond;
  // }

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getCustomerSentimentsChart + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getCustomerSentimentsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
  console.log(
    getCustomerSentimentsChart +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );

  xhr_object.onload = function () {
    resfunChartCustomerSentiments = JSON.parse(this.responseText);

    console.log("Customer Sentiments - ");
    console.log(resfunChartCustomerSentiments);


    let total = resfunChartCustomerSentiments.response.Great + resfunChartCustomerSentiments.response.Good + resfunChartCustomerSentiments.response.Okay + resfunChartCustomerSentiments.response.Bad + resfunChartCustomerSentiments.response.Unacceptable;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }

    // let xValues = [], yValues = [];

    // xValues = Object.keys(resfunChartTicket.response.open);
    // yValues = Object.values(resfunChartTicket.response);

    // Added Now
    originalChartConfigSentiment = {
      type: "doughnut",
      data: {
        labels: ["Great", "Good", "Okay", "Bad", "Unacceptable"],
        datasets: [
          {
            label: "Customer",
            backgroundColor: ["#01c875", "#A1CD7A", "#F2C06C", "#F69380", "#D44B52",],
            data: [
              // resfunChartTicket.response.total,
              resfunChartCustomerSentiments.response.Great,
              resfunChartCustomerSentiments.response.Good,
              resfunChartCustomerSentiments.response.Okay,
              resfunChartCustomerSentiments.response.Bad,
              resfunChartCustomerSentiments.response.Unacceptable,

            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,

        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels, centerText],
    };

    let myChart = new Chart(customerSentiment, originalChartConfigSentiment)

    // loaderCustomerSentiments.style.display = "none";
    // // CustomerSentimentsNoData.style.display = "none";
    // customerSentiment.style.display = "block";
    // CustomerSentimentsNoData.style.display = "block";
    // loaderCustomerSentiments.style.display = "none";
    if (total == 0) {
      loaderCustomerSentiments.style.display = "none";
      customerSentiment.style.display = "none";
      CustomerSentimentsNoData.style.display = "block";

    } else {
      loaderCustomerSentiments.style.display = "none";
      customerSentiment.style.display = "block";
      // CustomerSentimentsNoData.style.display = "none";
    }

    // refreshIconElement_sentiments
    function restoreOriginalChartSentiment() {

      if (originalChartConfigSentiment) {
        myChart.destroy();
        funChartCustomerSentiments();
      }
    }

    refreshIconElement_sentiments.addEventListener("click", restoreOriginalChartSentiment);


  };

  xhr_object.send();
}

let clickedCommonAreaCategoryTicket = true;
function funCommonAreaCategoryTicket() {
  let categoryCATicketNoData = document.getElementById(
    "categoryCATicketNoData"
  );
  let catagory_ticket_ca = document.getElementById("catagory-ticket-ca");
  let loaderCACategoryTicketChart = document.getElementById(
    "loaderCACategoryTicketChart"
  );
  // let dt2_ca = document.getElementById("dt2_ca");

  // if (globalType == "daily") {
  //   dt2_ca.innerHTML =
  //     "Common Area Category-wise Tickets for " + convertDateFormat(globalDateFirst);
  // } else {
  //   dt2_ca.innerHTML =
  //     "Common Area Category-wise Tickets for " +
  //     + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  // }

  // loaderCACategoryTicketChart.style.display = "block";
  // categoryCATicketNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getCommonAreaCategoryWiseTicketsChart +
      idLink +
      "&date=" +
      globalDateFirst,
      true
    );
    console.log(
      getCommonAreaCategoryWiseTicketsChart +
      idLink +
      "&date=" +
      globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getCommonAreaCategoryWiseTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getCommonAreaCategoryWiseTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunCACategoryTicket = JSON.parse(this.responseText);

    console.log("Category CA Ticket - ");
    console.log(resfunCACategoryTicket);

    // Added now
    originalChartConfigCommon = {
      type: "bar",
      data: {
        labels: resfunCACategoryTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCACategoryTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCACategoryTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(catagory_ticket_ca, originalChartConfigCommon)
    loaderCACategoryTicketChart.style.display = "none";

    if (String(resfunCACategoryTicket.response.total_tickets).length == 0) {
      categoryCATicketNoData.style.display = "block";
      catagory_ticket_ca.style.display = "none";
    } else {
      categoryCATicketNoData.style.display = "none";
      catagory_ticket_ca.style.display = "block";
    }

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let CategoryCommomTicketdrillDownLevel = 1;
    if (!funCommonAreaCategoryTicket.initialized) {
      catagory_ticket_ca.onclick = function (event) {

        if (clickedCommonAreaCategoryTicket == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelCommon").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_common"));
            dropdown.style.display = "block";


          }

          dataDropdown_common.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (CategoryCommomTicketdrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;


              apiURL =
                getTicketCategoryCommonDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&date=" +
                globalDateFirst,
                // "&to_date=" +
                // globalDateSecond,

                xhr_object.open("GET", apiURL, true);

              downloadCACategoryWiseTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-CommonArea-categoryWiseTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;


              xhr_object.onload = function () {
                resTicketCategoryCommonDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryCommonDrill);

                const labels = Object.keys(resTicketCategoryCommonDrill.response);
                const datasets = [];
                // const labelname = label;

                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryCommonDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };

                myChart.destroy();
                myChart = new Chart(catagory_ticket_ca, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();
              CategoryCommomTicketdrillDownLevel = 2;

            }
            else if (CategoryCommomTicketdrillDownLevel === 2) {
              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);

              apiURL =
                getTicketCategoryCommonDrillSecond +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadCACategoryWiseTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-CommonArea-categoryWiseTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;

              xhr_object.onload = function () {
                resTicketCategoryCommonDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryCommonDrill);

                const labels = Object.keys(resTicketCategoryCommonDrill.response);
                const datasets = [];
                // const labelname = label;

                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryCommonDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };

                myChart.destroy();
                myChart = new Chart(catagory_ticket_ca, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();
              CategoryCommomTicketdrillDownLevel = 3;
              clickedCommonAreaCategoryTicket = false;
              return;
            }
          }
          else {
            if(CategoryCommomTicketdrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }


            dataDropdown_common.style.display = "none";

          });
        } else if (clickedCommonAreaCategoryTicket == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChart() {
      if (originalChartConfigProactive) {
        myChart.destroy();
        funCommonAreaCategoryTicket();
        clickedCommonAreaCategoryTicket = true;
      }
    }

    refreshIconElement_common.addEventListener("click", restoreOriginalChart);
  };

  xhr_object.send();
}

let clickedCommonAreaCategoryProactiveTicket = true;
function funCommonAreaCategoryProactiveTicket() {
  let categoryCAProactiveTicketNoData = document.getElementById(
    "categoryCAProactiveTicketNoData"
  );
  let catagory_proactive_ticket_ca = document.getElementById(
    "proactive-ticket-ca"
  );
  let loaderCACategoryProactiveTicketChart = document.getElementById(
    "loaderCACategoryProactiveTicketChart"
  );
  // let dt3_ca = document.getElementById("dt3_ca");

  // if (globalType == "daily") {
  //   dt3_ca.innerHTML =
  //     "Common Area Category-wise Proactive Tickets for " + convertDateFormat(globalDateFirst);
  // } else {
  //   dt3_ca.innerHTML =
  //     "Common Area Category-wise Proactive Tickets for " +
  //     + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  // }

  // loaderCACategoryProactiveTicketChart.style.display = "block";
  // categoryCAProactiveTicketNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getCommonAreaCategoryWiseProactiveTicketsChart +
      idLink +
      "&date=" +
      globalDateFirst,
      true
    );
    console.log(
      getCommonAreaCategoryWiseProactiveTicketsChart +
      idLink +
      "&date=" +
      globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getCommonAreaCategoryWiseProactiveTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getCommonAreaCategoryWiseProactiveTicketsChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunCACategoryProactiveTicket = JSON.parse(this.responseText);

    console.log("CA Proactive - ");
    console.log(resfunCACategoryProactiveTicket);

    // Added now
    originalChartConfigCommonProactive = {
      type: "bar",
      data: {
        labels: resfunCACategoryProactiveTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCACategoryProactiveTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCACategoryProactiveTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(catagory_proactive_ticket_ca, originalChartConfigCommonProactive)
    loaderCACategoryProactiveTicketChart.style.display = "none";
    if (
      String(resfunCACategoryProactiveTicket.response.total_tickets).length == 0
    ) {
      categoryCAProactiveTicketNoData.style.display = "block";
      catagory_proactive_ticket_ca.style.display = "none";
    } else {
      categoryCAProactiveTicketNoData.style.display = "none";
      catagory_proactive_ticket_ca.style.display = "block";
    }

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let CategoryCommonProactivedrillDownLevel;

    if (!funCommonAreaCategoryProactiveTicket.initialized) {

      catagory_proactive_ticket_ca.onclick = function (event) {
        if (clickedCommonAreaCategoryProactiveTicket == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelCommonProactive").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_commonproactive"));
            dropdown.style.display = "block";


          }

          dataDropdown_commonproactive.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (CategoryCommonProactivedrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getTicketCategoryCommonProactiveDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&date=" +
                globalDateFirst,
                // "&to_date=" +
                // globalDateSecond,

                xhr_object.open("GET", apiURL, true);

              downloadCACategoryWiseProactiveTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-CommonArea-categoryWiseProactiveTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;


              xhr_object.onload = function () {
                resTicketCategoryCommonProactiveDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryCommonProactiveDrill);

                const labels = Object.keys(resTicketCategoryCommonProactiveDrill.response);
                const datasets = [];

                // const labelname = label;

                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryCommonProactiveDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };

                myChart.destroy();
                myChart = new Chart(catagory_proactive_ticket_ca, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
              }

              xhr_object.send();
              CategoryCommonProactivedrillDownLevel = 2;

            }
            else if (CategoryCommonProactivedrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);

              apiURL =
                getTicketCategoryCommonProactiveDrillSecond +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);


              downloadCACategoryWiseProactiveTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-CommonArea-categoryWiseProactiveTicket/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&category=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;


              xhr_object.onload = function () {
                resTicketCategoryCommonProactiveDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resTicketCategoryCommonProactiveDrill);

                const labels = Object.keys(resTicketCategoryCommonProactiveDrill.response);
                const datasets = [];

                // const labelname = label;

                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTicketCategoryCommonProactiveDrill.response[label][status] || 0),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };

                myChart.destroy();
                myChart = new Chart(catagory_proactive_ticket_ca, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
              }

              xhr_object.send();
              CategoryCommonProactivedrillDownLevel = 3;
              clickedCommonAreaCategoryProactiveTicket = false;
              return;
            }
          }
          else {
            if(CategoryCommonProactivedrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }



            dataDropdown_commonproactive.style.display = "none";



          });
        } else if (clickedCommonAreaCategoryProactiveTicket == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChart() {
      if (originalChartConfigCommonProactive) {
        myChart.destroy();
        funCommonAreaCategoryProactiveTicket();
        clickedCommonAreaCategoryProactiveTicket = true;

      }
    }

    refreshIconElement_commonproactive.addEventListener("click", restoreOriginalChart);
  };

  xhr_object.send();
}

function funAgeingMatrix() {
  let ageingMatrixNoData = document.getElementById("ageingMatrixNoData");
  let tbl1info = document.getElementById("tbl1info");
  let loaderAgeingMatrix = document.getElementById("loaderAgeingMatrix");

  // loaderAgeingMatrix.style.display = "block";
  // ageingMatrixNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getAgeingMatrixChart + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getAgeingMatrixChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunAgeingMatrix = JSON.parse(this.responseText);
    let myAgeingArray = resfunAgeingMatrix.response;
    console.log("Ageing Matrix - ");
    console.log(resfunAgeingMatrix);

    allAgeingDetails =
      `<tr>` +
      `<td>` +
      "P1" +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P2" +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P3" +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P4" +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P5" +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T5 +
      `</td>` +
      `</tr>`;

    tablebodyTicketAgeing.innerHTML = allAgeingDetails;

    console.log("Ageing - ");
    console.log(myAgeingArray);

    daysTicketAgeing.innerHTML = resfunAgeingMatrix.average_days;

    loaderAgeingMatrix.style.display = "none";
    if (resfunAgeingMatrix.response.total_tickets == 0) {
      ageingMatrixNoData.style.display = "block";
      tbl1info.style.display = "none";
    } else {
      ageingMatrixNoData.style.display = "none";
      tbl1info.style.display = "block";
    }
    // refreshIconElement_TicketsAgeingMatrix

    refreshIconElement_TicketsAgeingMatrix.addEventListener("click", restoreOriginalChart);

    function restoreOriginalChart() {
      loaderAgeingMatrix.style.display = "block";
      tbl1info.style.display = "none";
      funAgeingMatrix();
    }
  };
  xhr_object.send();
}

let clickedTATResolution = true;
function funTATResolution() {
  let tatResolutionNoData = document.getElementById("tatResolutionNoData");
  let tat_resolution_chart = document.getElementById("resolution-b1");
  let loaderTATResolution = document.getElementById("loaderTATResolution");

  let tatResolutionAchieved = document.getElementById("tatResolutionAchieved");
  let tatResolutionBreached = document.getElementById("tatResolutionBreached");

  loaderTATResolution.style.display = "block";
  tatResolutionNoData.style.display = "none";
  tat_resolution_chart.style.visibility = "hidden";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getTATResolutionResponseChart + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getTATResolutionResponseChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunTATResolution = JSON.parse(this.responseText);

    console.log("TAT Resolution - ");
    console.log(resfunTATResolution);

    tatResolutionAchieved.innerHTML =
      resfunTATResolution.response.resolution.achieved + "";
    tatResolutionBreached.innerHTML =
      resfunTATResolution.response.resolution.breached + "";

    originalChartConfigResolutionTAT = {
      type: "bar",
      data: {
        labels: ["Achieved", "Breached"],
        datasets: [
          {
            label: "Resolution TAT Status",
            backgroundColor: ["#01C875", "#FDAB3D"],
            data: [
              resfunTATResolution.response.resolution.achieved,
              resfunTATResolution.response.resolution.breached,
            ],
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 8);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(tat_resolution_chart, originalChartConfigResolutionTAT)

    loaderTATResolution.style.display = "none";
    if (
      resfunTATResolution.response.resolution.achieved == 0 &&
      resfunTATResolution.response.resolution.breached == 0
    ) {
      tatResolutionNoData.style.display = "block";
      tat_resolution_chart.style.visibility = "hidden";
    } else {
      tatResolutionNoData.style.display = "none";
      tat_resolution_chart.style.visibility = "visible";
    }


    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let ResolutionTATdrillDownLevel = 1;
    let clickedTATResolution = true;


    if (!funTATResolution.initialized) {
      tat_resolution_chart.onclick = function (event) {

        if (clickedTATResolution == true) {

          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);

            document.getElementById("listItemLabelresolutionTAT").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            const dropdown = (document.getElementById("dataDropdown_resolutionTAT"));
            dropdown.style.display = "block";

          }
          dataDropdown_resolutionTAT.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (ResolutionTATdrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              label = myChart.data.labels[firstPoint.index];
              labelname = label;
              console.log(selectedOption);

              // if (selectedOption === "Tower" || "Flat_Type" || "Status" || "Created_By" || "Category" || "Sub_Category" || "Assign_To" || "Priority" || "Ticket_Title" || "Ticket_Type" || "Related_To" || "Proactive/Reactive" && currentChartType === "bar") {
              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getResolutionTATDrill +
                idLink +
                "&response=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drill_down_on=" +
                "" +
                "&sec_drilldown_by=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,
                console.log(apiURL);
              xhr_object.open("GET", apiURL, true);


              downloadResolutionTATLink = ip + "fm-excel-download/get-drill-down-for-chart-resolutionTAT/" + idLink +
                "&response=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drill_down_on=" +
                "" +
                "&sec_drilldown_by=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,


                xhr_object.onload = function () {
                  resResolutionTATDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resResolutionTATDrill);

                  const labels = resResolutionTATDrill.response.map(item => item[1]);
                  const data = resResolutionTATDrill.response.map(item => item[0]);

                  myChart.destroy();
                  myChart = new Chart(tat_resolution_chart, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: ["#e2445b"],
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                }

              ResolutionTATdrillDownLevel = 2;
              xhr_object.send();

            }
            else if (ResolutionTATdrillDownLevel === 2) {
              const firstPoint = points[0];
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);



              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getResolutionTATDrill +
                idLink +
                "&response=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,

                console.log(apiURL);
              xhr_object.open("GET", apiURL, true);


              downloadResolutionTATLink = ip + "fm-excel-download/get-drill-down-for-chart-resolutionTAT/" + idLink +
                "&response=" +
                labelname +
                "&drilldown_by=" +
                selectedOption +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,


                xhr_object.onload = function () {
                  resResolutionTATDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resResolutionTATDrill);

                  const labels = resResolutionTATDrill.response.map(item => item[1]);
                  const data = resResolutionTATDrill.response.map(item => item[0]);

                  myChart.destroy();
                  myChart = new Chart(tat_resolution_chart, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: ["#e2445b"],
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                  clickedTATResolution = false;
                }
              xhr_object.send();
              ResolutionTATdrillDownLevel = 3;
              clickedTATResolution = false;
              return;

            }
          }
          else {
            if(ResolutionTATdrillDownLevel === 1) {
              restoreOriginalChartTicket();
            }
          }
            dataDropdown_resolutionTAT.style.display = "none";
          });
        } else if (clickedTATResolution == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChartTicket() {
      if (originalChartConfigResolutionTAT) {
        myChart.destroy(); // Destroy the current chart
        funTATResolution();
        clickedTATResolution = true;
      }
    }

    refreshIconElement_resolutionTAT.addEventListener("click", restoreOriginalChartTicket);
  };

  xhr_object.send();
}

let clickedTATResponse = true;
function funTATResponse() {
  let tatResponseNoData = document.getElementById("tatResponseNoData");
  let tat_response_chart = document.getElementById("response-b1");
  let loaderTATResponse = document.getElementById("loaderTATResponse");

  let tatResponseAchieved = document.getElementById("tatResponseAchieved");
  let tatResponseBreached = document.getElementById("tatResponseBreached");

  loaderTATResponse.style.display = "block";
  tatResponseNoData.style.display = "none";
  tat_response_chart.style.visibility = "hidden";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getTATResolutionResponseChart + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getTATResolutionResponseChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunTATResponse = JSON.parse(this.responseText);

    console.log("TAT Response - ");
    console.log(resfunTATResponse);

    tatResponseAchieved.innerHTML =
      resfunTATResponse.response.response.achieved + "";
    tatResponseBreached.innerHTML =
      resfunTATResponse.response.response.breached + "";

    originalChartConfigResponseTAT = {
      type: "bar",
      data: {
        labels: ["Achieved", "Breached"],
        datasets: [
          {
            label: "Response TAT Status",
            backgroundColor: ["#01C875", "#FDAB3D"],
            data: [
              resfunTATResponse.response.response.achieved,
              resfunTATResponse.response.response.breached,
            ],
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 8);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(tat_response_chart, originalChartConfigResponseTAT)
    loaderTATResponse.style.display = "none";
    if (
      resfunTATResponse.response.response.achieved == 0 &&
      resfunTATResponse.response.response.breached == 0
    ) {
      tatResponseNoData.style.display = "block";
      tat_response_chart.style.visibility = "hidden";
    } else {
      tatResponseNoData.style.display = "none";
      tat_response_chart.style.visibility = "visible";
    }

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let ResponseTATdrillDownLevel = 1;
    let clickedTATResponse = true;

    if (!funTATResponse.initialized) {
      tat_response_chart.onclick = function (event) {

        if (clickedTATResponse == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);

            document.getElementById("listItemLabelresponseTAT").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            const dropdown = (document.getElementById("dataDropdown_responseTAT"));
            dropdown.style.display = "block";

          }
          dataDropdown_responseTAT.addEventListener("click", function (event) {

            if (event.target.id != "closeDropdown") {
            if (ResponseTATdrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              label = myChart.data.labels[firstPoint.index];
              labelname = label;
              console.log(selectedOption);

              // if (selectedOption === "Tower" || "Flat_Type" || "Status" || "Created_By" || "Category" || "Sub_Category" || "Assign_To" || "Priority" || "Ticket_Title" || "Ticket_Type" || "Related_To" || "Proactive/Reactive" && currentChartType === "bar") {
              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL = getResponseTATDrill +
                idLink +
                "&response=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drill_down_on=" +
                "" +
                "&sec_drilldown_by=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,

                console.log(apiURL);
              xhr_object.open("GET", apiURL, true);


              downloadResponseTATLink = ip + "fm-excel-download/get-drill-down-for-chart-responseTAT/" + idLink +
                "&response=" +
                labelname +
                "&drilldown_by=" +
                selectedOption +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,


                xhr_object.onload = function () {
                  resResponseTATDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resResponseTATDrill);

                  const labels = resResponseTATDrill.response.map(item => item[1]);
                  const data = resResponseTATDrill.response.map(item => item[0]);

                  myChart.destroy();
                  myChart = new Chart(tat_response_chart, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: ["#e2445b"],
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });

                  clickedTATResponse = false;
                }
              ResponseTATdrillDownLevel = 2;
              xhr_object.send();

            } else if (ResponseTATdrillDownLevel === 2) {
              const firstPoint = points[0];
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL = getResponseTATDrill +
                idLink +
                "&response=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drill_down_on=" +
                "" +
                "&sec_drilldown_by=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,

                console.log(apiURL);
              xhr_object.open("GET", apiURL, true);


              downloadResponseTATLink = ip + "fm-excel-download/get-drill-down-for-chart-responseTAT/" + idLink +
                "&response=" +
                labelname +
                "&drilldown_by=" +
                selectedOption +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,


                xhr_object.onload = function () {
                  resResponseTATDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resResponseTATDrill);

                  const labels = resResponseTATDrill.response.map(item => item[1]);
                  const data = resResponseTATDrill.response.map(item => item[0]);

                  myChart.destroy();
                  myChart = new Chart(tat_response_chart, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: ["#e2445b"],
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                }
              xhr_object.send();
              ResponseTATdrillDownLevel = 3;
              clickedTATResponse = false;
              return;
            }
          }
          else {
            if(ResponseTATdrillDownLevel === 1) {
              restoreOriginalChartTicket();
            }
          }
            dataDropdown_responseTAT.style.display = "none";
          });
        } else if (clickedTATResponse == false) {
          alert("You have reached the maximum drill-down level.");
        }



      };
    }
    function restoreOriginalChartTicket() {
      if (originalChartConfigResponseTAT) {
        myChart.destroy(); // Destroy the current chart
        funTATResponse();
        clickedTATResponse = true;
      }
    }

    refreshIconElement_responseTAT.addEventListener("click", restoreOriginalChartTicket);
  };

  xhr_object.send();
}

function funVisitors() {
  let visTotalVehicles = document.getElementById("visTotalVehicles");
  let visTotalVisitors = document.getElementById("visTotalVisitors");
  let visExpectedVisitors = document.getElementById("visExpectedVisitors");
  let visUnExpectedVisitors = document.getElementById("visUnExpectedVisitors");
  let visTotalGatePass = document.getElementById("visTotalGatePass");
  let visReturnGatePass = document.getElementById("visReturnGatePass");
  let visNonReturnGatePass = document.getElementById("visNonReturnGatePass");


  // let visTotalStaff = document.getElementById("visTotalStaff");
  // let visStaffIn = document.getElementById("visStaffIn");
  // let visStaffOut = document.getElementById("visStaffOut");
  // let visGoodsInwards = document.getElementById("visGoodsInwards");
  // let visOutwards = document.getElementById("visOutwards");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getVisitors + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getVisitors + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getVisitors +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getVisitors +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunVisitors = JSON.parse(this.responseText);

    console.log("Visitors - ");
    console.log(resfunVisitors);

    visTotalVehicles.innerHTML = resfunVisitors.response.totalVehicle + "";
    visTotalVisitors.innerHTML = resfunVisitors.response.totalVisitors + "";
    visExpectedVisitors.innerHTML = resfunVisitors.response.expectedVisitors + "";
    visUnExpectedVisitors.innerHTML = resfunVisitors.response.unexpectedVisitors + "";
    visTotalGatePass.innerHTML = resfunVisitors.response.totalGatePass + "";
    visReturnGatePass.innerHTML = resfunVisitors.response.returnable_gatePass + "";
    visNonReturnGatePass.innerHTML = resfunVisitors.response.non_returnable_gatePass + "";

    refreshIconElement_Visitors.addEventListener("click", restoreOriginalChartVisitors);

    function restoreOriginalChartVisitors() {
      funVisitors();
    }
    // visTotalStaff.innerHTML = resfunVisitors.response.totalStaff + "";
    // visStaffIn.innerHTML = resfunVisitors.response.staffIn + "";
    // visStaffOut.innerHTML = resfunVisitors.response.staffOut + "";
    // visGoodsInwards.innerHTML = resfunVisitors.response.goodsInwards + "";
    // visOutwards.innerHTML = resfunVisitors.response.outwards + "";


  };
  // refreshIconElement_Visitors


  xhr_object.send();
}

function funVisitorsCards() {
  let visTotalVehiclesCards = document.getElementById("visTotalVehiclesCards");
  let visTotalVisitorsCards = document.getElementById("visTotalVisitorsCards");
  let visExpectedVisitorsCards = document.getElementById("visExpectedVisitorsCards");
  let visUnExpectedVisitorsCards = document.getElementById("visUnExpectedVisitorsCards");
  let visTotalGatePass = document.getElementById("visTotalGatePass");
  let visReturnGatePass = document.getElementById("visReturnGatePass");
  let visNonReturnGatePass = document.getElementById("visNonReturnGatePass");


  // let visTotalStaff = document.getElementById("visTotalStaff");
  // let visStaffIn = document.getElementById("visStaffIn");
  // let visStaffOut = document.getElementById("visStaffOut");
  // let visGoodsInwards = document.getElementById("visGoodsInwards");
  // let visOutwards = document.getElementById("visOutwards");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getVisitorsCards + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getVisitorsCards + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getVisitorsCards +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getVisitorsCards +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunVisitorsCards = JSON.parse(this.responseText);

    console.log("Visitors cards----------------- - ");
    console.log(resfunVisitorsCards);

    // visTotalVehiclesCards.innerHTML = resfunVisitorsCards.response.totalVehicle + "";
    visTotalVisitorsCards.innerHTML = resfunVisitorsCards.response.totalVisitors + "";
    visExpectedVisitorsCards.innerHTML = resfunVisitorsCards.response.expectedVisitors + "";
    visUnExpectedVisitorsCards.innerHTML = resfunVisitorsCards.response.unexpectedVisitors + "";
    visTotalGatePass.innerHTML = resfunVisitorsCards.response.totalGatePass + "";
    // visReturnGatePass.innerHTML = resfunVisitorsCards.response.returnable_gatePass + "";
    // visNonReturnGatePass.innerHTML = resfunVisitorsCards.response.non_returnable_gatePass + "";


    // visTotalStaff.innerHTML = resfunVisitors.response.totalStaff + "";
    // visStaffIn.innerHTML = resfunVisitors.response.staffIn + "";
    // visStaffOut.innerHTML = resfunVisitors.response.staffOut + "";
    // visGoodsInwards.innerHTML = resfunVisitors.response.goodsInwards + "";
    // visOutwards.innerHTML = resfunVisitors.response.outwards + "";
  };
  xhr_object.send();
}
// totalstaff
function funStaff() {
  let visTotalStaff = document.getElementById("visTotalStaff");
  let visTotalStaffCard = document.getElementById("visTotalStaffCard");
  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getStaff + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getStaff + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getStaff +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getStaff +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunStaff = JSON.parse(this.responseText);

    console.log("Staff - ");
    console.log(resfunStaff);
    visTotalStaff.innerHTML = resfunStaff.response + "";
    visTotalStaffCard.innerHTML = resfunStaff.response + "";

    // visTotalStaff.innerHTML = resfunStaff.response.totalStaff + "";
    // visStaffIn.innerHTML = resfunStaff.response.staffIn + "";
    // visStaffOut.innerHTML = resfunStaff.response.staffOut + "";
    // visGoodsInwards.innerHTML = resfunStaff.response.goodsInwards + "";
    // visOutwards.innerHTML = resfunStaff.response.outwards + "";
  };
  xhr_object.send();
}
// staffin
function funStaffIn() {
  let visStaffIn = document.getElementById("visStaffIn");
  let visStaffInCard = document.getElementById("visStaffInCard");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getStaffIn + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getStaffIn + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getStaffIn +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getStaffIn +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunStaffIn = JSON.parse(this.responseText);

    console.log("StaffIn - ");
    console.log(resfunStaffIn);

    visStaffIn.innerHTML = resfunStaff.response + "";
    visStaffInCard.innerHTML = resfunStaff.response + "";
  };
  xhr_object.send();
}
// staffOut
function funStaffOut() {
  let visStaffOut = document.getElementById("visStaffOut");
  let visStaffOutCard = document.getElementById("visStaffOutCard");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getStaffOut + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getStaffOut + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getStaffOut +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getStaffOut +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunStaffOut = JSON.parse(this.responseText);

    console.log("staff out - ");
    console.log(resfunStaffOut);

    visStaffOut.innerHTML = resfunStaffOut.response + "";
    visStaffOutCard.innerHTML = resfunStaffOut.response + "";
  };
  xhr_object.send();
}
// goodsinwards
function funGoodsInward() {
  let visGoodsInwards = document.getElementById("visGoodsInwards");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getGoodsInwards + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getGoodsInwards + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getGoodsInwards +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getGoodsInwards +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunGoodsInwards = JSON.parse(this.responseText);

    console.log("GoodsInwards - ");
    console.log(resfunGoodsInwards);

    visGoodsInwards.innerHTML = resfunGoodsInwards.response + "";
  };
  xhr_object.send();
}
function funOutwards() {
  let visOutwards = document.getElementById("visOutwards");
  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getOutwards + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getOutwards + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getOutwards +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getOutwards +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunOutwards = JSON.parse(this.responseText);

    console.log("Outwards - ");
    console.log(resfunOutwards);
    visOutwards.innerHTML = resfunOutwards.response + "";
  };
  xhr_object.send();
}

let clickedPowerConsumption = true;

function funPowerConsumption() {
  let titlePowerConsumation = document.getElementById("titlePowerConsumation");

  let pcTotalHtMeter = document.getElementById("pcTotalHtMeter");
  let pcTotalTransformer = document.getElementById("pcTotalTransformer");
  let pcTotalDg = document.getElementById("pcTotalDg");
  let pcTotalDieselConsumed = document.getElementById("pcTotalDieselConsumed");
  let pcTotalDieselConsumedPie = document.getElementById(
    "pcTotalDieselConsumedPie"
  );

  let loaderPowerConsumPie = document.getElementById("loaderPowerConsumPie");
  let powerConsumPieNoData = document.getElementById("powerConsumPieNoData");
  let power_consume_pie = document.getElementById("power-consume-pie");
  let psPie1 = document.getElementById("psPie1");
  let psPie2 = document.getElementById("psPie2");
  let psPie3 = document.getElementById("psPie3");
  let psPie4 = document.getElementById("psPie4");
  let psPie5 = document.getElementById("psPie5");

  let loaderPowerConsum = document.getElementById("loaderPowerConsum");
  let powerConsumNoData = document.getElementById("powerConsumNoData");
  let power_consumption = document.getElementById("power-consumption");

  let loaderPowerConsumMonth = document.getElementById("loaderPowerConsumMonth");
  let powerConsumNoDataMonth = document.getElementById("powerConsumNoDataMonth");
  let power_consumption_month = document.getElementById("power-consumption-month");

  let loaderSitePower = document.getElementById("loaderSitePower");
  let SitePowerNoData = document.getElementById("SitePowerNoData");
  let SitePowerConsumption = document.getElementById("SitePowerConsumption");


  let timeSeriesPowerConsumptionAssetwise = document.getElementById(
    "power-consumption-assetwise"
  );
  // let loaderPowerConsumAssetWiseTimeSeries = document.getElementById(
  //   "loaderPowerConsumAssetWiseTimeSeries"
  // );
  // let powerConsumAssetWiseTimeSeriesNoData = document.getElementById(
  //   "powerConsumAssetWiseTimeSeriesNoData"
  // );

  // if (globalType == "daily") {
  //   titlePowerConsumation.innerHTML =
  //     "Power Consumption for " + convertDateFormat(globalDateFirst);
  // } else {
  //   titlePowerConsumation.innerHTML =
  //     "Power Consumption for " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  // }

  // ----------------------------------------------

  let xhr_object1 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object1.open(
      "GET",
      getMainMeterTotalConsumption + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(
      getMainMeterTotalConsumption + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object1.open(
      "GET",
      getMainMeterTotalConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getMainMeterTotalConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object1.onload = function () {
    resfunPowerConsumptionObject1 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 1 - ");
    console.log(resfunPowerConsumptionObject1);
    if (resfunPowerConsumptionObject1.response == null) {
      pcTotalHtMeter.innerHTML = "0 kwh";
    } else {
      pcTotalHtMeter.innerHTML =
        resfunPowerConsumptionObject1.response + " kwh";
    }
  };
  xhr_object1.send();

  // ----------------------------------------------

  let xhr_object2 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object2.open(
      "GET",
      getTransformerTotal + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getTransformerTotal + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object2.open(
      "GET",
      getTransformerTotal +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getTransformerTotal +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object2.onload = function () {
    resfunPowerConsumptionObject2 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 2 - ");
    console.log(resfunPowerConsumptionObject2);
    if (resfunPowerConsumptionObject2.response == null) {
      pcTotalTransformer.innerHTML = "0 kwh";
    } else {
      pcTotalTransformer.innerHTML =
        resfunPowerConsumptionObject2.response + " kwh";
    }
  };
  xhr_object2.send();

  // ----------------------------------------------

  let xhr_object3 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object3.open(
      "GET",
      getDGTotal + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getDGTotal + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object3.open(
      "GET",
      getDGTotal +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getDGTotal +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object3.onload = function () {
    resfunPowerConsumptionObject3 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 3 - ");
    console.log(resfunPowerConsumptionObject3);
    if (resfunPowerConsumptionObject3.response == null) {
      pcTotalDg.innerHTML = "0 kwh";
    } else {
      pcTotalDg.innerHTML = resfunPowerConsumptionObject3.response + " kwh";
    }
  };
  xhr_object3.send();

  // ----------------------------------------------

  let xhr_object4 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object4.open(
      "GET",
      getDieselConsumption + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getDieselConsumption + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object4.open(
      "GET",
      getDieselConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getDieselConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object4.onload = function () {
    resfunPowerConsumptionObject4 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 4 - ");
    console.log(resfunPowerConsumptionObject4);
    if (resfunPowerConsumptionObject4.response == null) {
      pcTotalDieselConsumed.innerHTML = "0 liters";
    } else {
      pcTotalDieselConsumed.innerHTML =
        resfunPowerConsumptionObject4.response + " liters";

    }
  };
  xhr_object4.send();

  // ----------------------------------------------

  // loaderPowerConsumPie.style.display = "block";
  // powerConsumPieNoData.style.display = "none";

  let xhr_object5 = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object5.open(
      "GET",
      getCumulativeConsumptionPieChart + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log("Power Consumption Object 5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555 - ");

    console.log(
      getCumulativeConsumptionPieChart + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object5.open(
      "GET",
      getCumulativeConsumptionPieChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log("Power Consumption Object 5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555 - ");

    console.log(
      getCumulativeConsumptionPieChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object5.onload = function () {
    resfunPowerConsumptionObject5 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555 - ");
    console.log(resfunPowerConsumptionObject5);

    let valueChartNameLabel = Object.keys(resfunPowerConsumptionObject5.pie);
    let valueChartYLabel = Object.values(resfunPowerConsumptionObject5.pie);

    console.log("Power Consum Pie Chart - " + valueChartNameLabel);

    if (valueChartNameLabel[0] != null) {
      psPie1.innerHTML =
        '<i class="bi  bi-square-fill " style="color:#F2C06C;"></i> ' +
        valueChartNameLabel[0] + " - <b>" + valueChartYLabel[0] + " KWH</b>" +
        "<br/>";
    }

    if (valueChartNameLabel[1] != null) {
      psPie2.innerHTML =
        '<i class="bi  bi-square-fill " style="color:#F8EA94;"></i> ' +
        valueChartNameLabel[1] + " - <b>" + valueChartYLabel[1] + " KWH</b>" +
        "<br/>";
    }

    if (valueChartNameLabel[2] != null) {
      psPie3.innerHTML =
        '<i class="bi  bi-square-fill " style="color:#A1CD7A;"></i> ' +
        valueChartNameLabel[2] + " -  <b>" + valueChartYLabel[2] + " KWH </b>" +
        "<br/>";
    }

    if (valueChartNameLabel[3] != null) {
      psPie4.innerHTML =
        '<i class="bi  bi-square-fill " style="color:#D44B52;"></i> ' +
        valueChartNameLabel[3] + " - <b>" + valueChartYLabel[3] + " KWH</b>" +
        "<br/>";
    }

    if (valueChartNameLabel[4] != null) {
      psPie5.innerHTML =
        '<i class="bi  bi-square-fill " style="color:#F69380;"></i> ' +
        valueChartNameLabel[4] + " - <b>" + valueChartYLabel[4] + " KWH</b>" +
        "<br/>";
    }


    let valueChartName = Object.keys(resfunPowerConsumptionObject5.percentage);
    let valueChartY = Object.values(resfunPowerConsumptionObject5.percentage);
    // Added Now
    new Chart(power_consume_pie, {
      type: "pie",
      data: {
        labels: valueChartName,
        datasets: [
          {
            label: "Borewell 1",
            data: valueChartY,
            backgroundColor: [
              "#F2C06C",
              "#F8EA94",
              "#A1CD7A",
              "#D44B52",
              "#F69380",
            ],
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: (value, context) => {
              const dataset = context.chart.data.datasets[context.datasetIndex];
              const total = dataset.data.reduce((sum, value) => sum + value, 0);
              const percentage = ((value / total) * 100).toFixed(1);
              return `${percentage}%`;
            },
          },
          legend: {
            display: false,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    let sum = 0;

    for (let i = 0; i < valueChartY.length; i += 1) {
      if (valueChartY[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueChartY[i];
      }
    }


    if (resfunPowerConsumptionObject5.total_consumption == null) {
      pcTotalDieselConsumedPie.innerHTML = "0 KWH";
    } else {
      pcTotalDieselConsumedPie.innerHTML =
        resfunPowerConsumptionObject5.total_consumption + " KWH";
    }

    loaderPowerConsumPie.style.display = "none";
    if (sum == 0) {
      powerConsumPieNoData.style.display = "block";
      power_consume_pie.style.display = "none";
    } else {
      powerConsumPieNoData.style.display = "none";
      power_consume_pie.style.display = "block";
    }
  };
  xhr_object5.send();

  // ----------------------------------------------

  // power_consumption.style.display = "none";
  // loaderPowerConsum.style.display = "block";
  // powerConsumNoData.style.display = "none";

  let xhr_object6 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object6.open(
      "GET",
      getPowerConsumptionBarChart + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(
      getPowerConsumptionBarChart + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object6.open(
      "GET",
      getPowerConsumptionBarChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getPowerConsumptionBarChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object6.onload = function () {
    resfunPowerConsumptionObject6 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 6 - ");
    console.log(resfunPowerConsumptionObject6);

    let arrAllObjects = Object.values(resfunPowerConsumptionObject6.response);
    let arrSolar = [];
    let arrDG = [];
    let arrHtMeter = [];
    let arrTotal = [];
    let arrAverage = [];

    for (let i = 0; i < arrAllObjects.length; i++) {
      arrSolar.push(arrAllObjects[i].Solar);
      arrDG.push(arrAllObjects[i].dg);
      arrHtMeter.push(arrAllObjects[i].htMeter);
      arrAverage.push(arrAllObjects[i].average);
    }
    console.log("++++++++++++++++++++++++++++++++++++++++++++++++Satcked Bar+++++++++++++++++++++++++++++++++++++++++++++++++++++++++")
    console.log(arrSolar);
    console.log(arrDG);
    console.log(arrHtMeter);
    console.log(arrAverage);

    let currentChartType = "bar"
    // Added now
    originalChartConfigPower = {
      type: "bar",
      data: {
        labels: Object.keys(resfunPowerConsumptionObject6.response),
        datasets: [
          {
            label: "HT Meter",
            backgroundColor: ["#E95420"],
            data: arrHtMeter,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Solar",
            backgroundColor: ["#77216f"],
            data: arrSolar,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "DG",
            backgroundColor: ["#f2ad6c"],
            data: arrDG,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            type: "line",
            tension: 1,
            label: "Average",
            backgroundColor: ["#16a60c"],
            data: arrAverage,
            borderWidth: 0.4,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }

    let myChart = new Chart(power_consumption, originalChartConfigPower)

    loaderPowerConsum.style.display = "none";
    powerConsumNoData.style.display = "none";
    power_consumption.style.display = "block";


    if (!funPowerConsumption.initialized) {
      power_consumption.onclick = function (event) {

        if (clickedPowerConsumption == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);

            document.getElementById("listItemLabelpower").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            const dropdown = (document.getElementById("dataDropdown_power"));
            dropdown.style.display = "block";

          }
          dataDropdown_power.addEventListener("click", function (event) {
            const selectedOption = event.target.id;
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const labelname = label;
            console.log(selectedOption);
            if (event.target.id != "closeDropdown") {
            if (selectedOption === "Asset_Name" && currentChartType === "bar") {
              let xhr_object = new XMLHttpRequest();
              xhr_object.open(
                "GET",
                getPowerDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,
                true
              );

              console.log(
                getPowerDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,
              );

              downloadPowerConsumLink = ip + "fm-excel-download/get-drill-down-for-powerConsumptionStackedBarGraph/" + idLink +
                "&drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,


                xhr_object.onload = function () {
                  resPowerDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resPowerDrill);

                  const labels = resPowerDrill.response.map(item => item[0]);
                  const dataValues = Array.from({ length: labels.length }, () => Math.floor(Math.random() * 100));

                  myChart.destroy();
                  myChart = new Chart(power_consumption, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: dataValues,
                        backgroundColor: ["#e2445b"],
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                  clickedPowerConsumption = false;
                }

              xhr_object.send();
              funPowerConsumption.initialized = true;
            }
          }
          else {
            
            restoreOriginalChartTicket();
            
          }


            dataDropdown_power.style.display = "none";
          });
        } else if (clickedPowerConsumption == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChartTicket() {
      if (originalChartConfigPower) {
        myChart.destroy(); // Destroy the current chart
        funPowerConsumption();
        clickedPowerConsumption = true;
      }
    }

    refreshIconElement_power.addEventListener("click", restoreOriginalChartTicket);
  };
  xhr_object6.send();

  // ----------------------------------------------
  let clickedPowerMonth = true;
  // power_consumption_month.style.display = "none";
  // loaderPowerConsum.style.display = "block";
  // powerConsumNoData.style.display = "none";
  // loaderPowerConsumMonth
  // powerConsumNoDataMonth
  // power_consumption_month
  // downloadPowerConsumMonth getPowerConsumptionBarChartMonthWise getPowerMonthDrill

  let xhr_object7 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object7.open(
      "GET",
      getPowerConsumptionBarChartMonthWise + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(
      getPowerConsumptionBarChartMonthWise + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object7.open(
      "GET",
      getPowerConsumptionBarChartMonthWise +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getPowerConsumptionBarChartMonthWise +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object7.onload = function () {
    resfunPowerConsumptionObject7 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 7 - ");
    console.log(resfunPowerConsumptionObject7);

    let arrAllObjects = Object.values(resfunPowerConsumptionObject7.response);
    let arrSolar = [];
    let arrDG = [];
    let arrDGpercent = [];
    let arrMains = [];
    let arrSolar_avg = [];
    let arrSolar_avg_precent = [];
    let arrDg_avg = [];
    let arrMains_avg = [];
    let arrMains_avg_precent = [];
    let arrconsum = [];

    for (let i = 0; i < arrAllObjects.length; i++) {
      arrSolar.push(arrAllObjects[i].Solar);
      arrDG.push(arrAllObjects[i].dg);
      arrDGpercent.push(arrAllObjects[i].dg_percentage);
      arrMains.push(arrAllObjects[i].mains);
      arrSolar_avg.push(arrAllObjects[i].solar_area_avg);
      arrSolar_avg_precent.push(arrAllObjects[i].solar_percentage);
      arrDg_avg.push(arrAllObjects[i].dg_area_avg);
      arrMains_avg.push(arrAllObjects[i].mains_area_avg);
      arrMains_avg_precent.push(arrAllObjects[i].mains_percentage);
      arrconsum.push(arrAllObjects[i].consumption_per_sq_feet)

    }
    console.log("++++++++++++++++++++++++++++++++++++++++++++++++Stacked  Bar+++++++++++++++++++++++++++++++++++++++++++++++++++++++++")
    console.log(arrSolar);
    console.log(arrDG);
    // console.log(arrMains_avg_precent);
    // console.log(arrHtMeter);
    // console.log(arrAverage);

    let currentChartType = "bar"
    // Added now
    originalChartConfigPowerMonth = {
      type: "bar",
      data: {
        labels: Object.keys(resfunPowerConsumptionObject7.response),
        datasets: [
          // {
          //   label: "Mains",
          //   backgroundColor: ["#E95420"],
          //   data: arrMains,
          //   borderWidth: 1,
          //   borderColor: "#E95420",
          //   stack: "Stack 0",
          // },
          {
            label: "Mains",
            backgroundColor: ["#E95420"],
            data: arrMains,
            borderWidth: 1,
            borderColor: "#E95420",
            stack: "Stack 0",
            datalabels: {
              formatter: function (value, context) {
                const percentValue = arrMains_avg_precent[context.dataIndex];
                return !isNaN(percentValue) ? percentValue.toFixed(2) + '%' : ' ';
              },
              color: "#000", // Set the desired font color (white)
              anchor: "center",
              align: "center",
              offset: 0,
              font: {
                size: "10",
                weight: "bold",
              },
              display: true, // Make sure datalabels are enabled
            },
          },


          {
            label: "Renewable",
            backgroundColor: ["#FDAB3D"],
            data: arrSolar,
            borderWidth: 1,
            borderColor: "#FDAB3D",
            stack: "Stack 0",
            datalabels: {
              formatter: function (value, context) {
                const percentValue = arrSolar_avg_precent[context.dataIndex];
                return !isNaN(percentValue) ? percentValue.toFixed(2) + '%' : ' ';
              },
              color: "#000", // Set the desired font color (white)
              anchor: "center",
              align: "center",
              offset: 0,
              font: {
                size: "10",
                weight: "bold",
              },
              display: true, // Make sure datalabels are enabled
            },
          },
          // {
          //   label: "DG",
          //   backgroundColor: ["#77216F"],
          //   data: arrDG,
          //   borderWidth: 1,
          //   borderColor: "#77216F",
          //   stack: "Stack 0",
          // },
          {
            label: "DG",
            backgroundColor: ["#77216F"],
            data: arrDG,
            borderWidth: 1,
            borderColor: "#77216F",
            stack: "Stack 0",
            datalabels: {
              formatter: function (value, context) {
                const percentValue = arrDGpercent[context.dataIndex];
                return !isNaN(percentValue) ? percentValue.toFixed(2) + '%' : ' ';
              },
              color: "#000", // Set the desired font color (white)
              anchor: "center",
              align: "center",
              offset: 0,
              font: {
                size: "10",
                weight: "bold",
              },
              display: true, // Make sure datalabels are enabled
            },
          },
          // {
          //   type: "line",
          //   tension: 0,
          //   label: "Mains",
          //   backgroundColor: ["#730000"],
          //   data: arrMains_avg,
          //   borderWidth: 0.4,
          //   borderColor: "#E95420",
          //   stack: "Stack 0",
          //   yAxisID: 'percentage',
          // },
          {
            type: "line",
            tension: 0,
            label: "Consumption per sq.ft",
            backgroundColor: ["#730000"],
            data: arrconsum,
            borderWidth: 0.4,
            borderColor: "#E95420",
            stack: "Stack 0",
            yAxisID: 'percentage',
          },
          // {
          //   type: "line",
          //   tension: 0,
          //   label: "Renewable",
          //   backgroundColor: ["#7be382"],
          //   data: arrSolar_avg,
          //   borderWidth: 0.4,
          //   borderColor: "#FDAB3D",
          //   stack: "Stack 0",
          //   yAxisID: 'percentage',
          //   // datalabels: {
          //   //   formatter: function(value, context) {
          //   //     return arrSolar_avg_precent[context.dataIndex].toFixed(2) + '%';
          //   //   },
          //   //   color: "#000", // Set the desired font color (white)
          //   //   anchor: "middle", // Change to "middle" if you want it in the middle
          //   //   align: "center", // Change to "center" if you want it in the middle
          //   //   offset: 0,
          //   //   font: {
          //   //     size: "10",
          //   //     weight: "bold",
          //   //   },
          //   //   display: true, // Make sure datalabels are enabled
          //   // },
          // },

          // {
          //   type: "line",
          //   tension: 0,
          //   label: "DG",
          //   backgroundColor: ["#98c1d9"],
          //   data: arrDg_avg,
          //   borderWidth: 0.4,
          //   borderColor: "#77216F",
          //   stack: "Stack 0",
          //   yAxisID: 'percentage',
          // },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            // ticks: {
            //   callback: function (value) {
            //     return this.getLabelForValue(value).substr(0, 15);
            //   },
            // },
            beginAtZero: true,
            title: {
              display: true,
              text: 'Months',
              padding: {
                top: 20,
              }
            }
          },
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Consumption kVAh'
            },
          },
          percentage: {
            beginAtZero: true,
            position: 'right',
            title: {
              display: true,
              text: 'Consumption Sq.ft '
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            display: true,
          },
          legend: {
            labels: {
              usePointStyle: true  // Enable point style icons
            },
            display: true,
            position: "top",
            align: "center",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(power_consumption_month, originalChartConfigPowerMonth)

    let listItemLabelmonthpower_wise = document.getElementById("listItemLabelmonthpower_wise")


    // loaderPowerConsumMonth
    // powerConsumNoDataMonth
    // power_consumption_month
    // downloadPowerConsumMonth


    loaderPowerConsumMonth.style.display = "none";
    powerConsumNoDataMonth.style.display = "none";
    power_consumption_month.style.display = "block";

    power_consumption_month.onclick = function (event) {

      if (clickedPowerMonth == true) {
        const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

        if (points.length) {
          const firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

          console.log(`Clicked on ${label} with value ${value}`);

          listItemLabelmonthpower_wise.textContent = ` ${label}`;
          // console.log(listItemLabelpower);
          // document.getElementById("listItemValue").textContent = `Value: ${value}`;

          const dropdown = (document.getElementById("dataDropdown_monthpower_wise"));
          console.log(dropdown);
          dropdown.style.display = "block";

        }
        dataDropdown_monthpower_wise.addEventListener("click", function (event) {
          const selectedOption = event.target.id;
          const firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const labelname = label;
          console.log(selectedOption);
          if (event.target.id != "closeDropdown") {
          if (selectedOption === "Asset_Name" && currentChartType === "bar") {
            let xhr_object = new XMLHttpRequest();
            xhr_object.open(
              "GET",
              getPowerMonthDrill +
              "?site_name=" +
              labelname +
              "&drilldown_by=" +
              selectedOption +
              "&site_id=" +
              countSiteDrop +
              "&society_id=" +
              countSocietyDrop +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond,
              true
            );

            console.log(
              getPowerMonthDrill +
              "?site_name=" +
              labelname +
              "&drilldown_by=" +
              selectedOption +
              "&site_id=" +
              countSiteDrop +
              "&society_id=" +
              countSocietyDrop +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond,
            );
            console.log("-----------DOWNLOAD--------------------------------")
            // console.log(ip + "supervisor-monthly/get-month-wise-power-consumption-drill-down-excel/" + idLink +
            // "?site_name=" +
            // labelname +
            // "&drilldown_by=" +
            // selectedOption +
            // "&site_id=" +
            // countSiteDrop +
            // "&society_id=" +
            // countSocietyDrop +
            // "&from_date=" +
            // globalDateFirst +
            // "&to_date=" +
            // globalDateSecond)

            console.log(ip + "supervisor-monthly/get-month-wise-power-consumption-drill-down-excel/" + idLink +
              "&site_name=" +
              labelname +
              "&drilldown_by=" +
              selectedOption +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond)

            downloadPowerConsumLink = ip + "supervisor-monthly/get-month-wise-power-consumption-drill-down-excel/" + idLink +
              "&site_name=" +
              labelname +
              "&drilldown_by=" +
              selectedOption +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond,




              xhr_object.onload = function () {
                resPowerDrill1 = JSON.parse(this.responseText);
                console.log("Tickets Drill Down1 - ");
                console.log(resPowerDrill1);

                const labels = resPowerDrill1.res.map(item => item[0]);
                const dataValues = resPowerDrill1.res.map(item => item[2]);

                myChart.destroy();
                myChart = new Chart(power_consumption_month, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: "Data",
                      data: dataValues,
                      backgroundColor: ["#e2445b"],
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedPowerMonth = false;
                power_consumption_month.style.display = "block";

              }

            xhr_object.send();
            return;
          }
        }
        else {
          
          restoreOriginalChartTicket();
          
        }

          dataDropdown_monthpower_wise.style.display = "none";
        });
      } else if (clickedPowerMonth == false) {
        alert("You have reached the maximum drill-down level.");
      }


    };

    function restoreOriginalChartTicket() {
      if (originalChartConfigPowerMonth) {
        myChart.destroy();
        funPowerConsumption();
        clickedPowerMonth = true;
        power_consumption_month.style.display = "block";
      }
    }

    refreshIconElement_monthpower.addEventListener("click", restoreOriginalChartTicket);
  };
  xhr_object7.send();

  // ---------------------------------------------------------

  // -----------------------------------------------

  let clickedPowerConsumption = true;

  // SitePowerConsumption.style.display = "none";
  // loaderSitePower.style.display = "block";
  // SitePowerNoData.style.display = "none";

  let xhr_object8 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object8.open(
      "GET",
      getSitePowerConsumption + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(
      getSitePowerConsumption + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object8.open(
      "GET",
      getSitePowerConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getSitePowerConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object8.onload = function () {
    resfunPowerConsumptionObject8 = JSON.parse(this.responseText);
    console.log("Power Consumption Object 8 - ");
    console.log(resfunPowerConsumptionObject8);

    let arrAllObjects = Object.values(resfunPowerConsumptionObject8.response);
    let arrSolar = [];
    let arrSolaravg = [];
    let arrDG = [];
    let arrDGavg = [];
    let arrMains = [];
    let arrMainsavg = [];
    // let arrTotal = [];
    // let arrAverage = [];
    let arrSolarpercent = [];
    let arrDGpercent = [];
    let arrMainspercent = [];
    let arrconsum = [];

    for (let i = 0; i < arrAllObjects.length; i++) {
      arrSolar.push(arrAllObjects[i].Solar);
      arrSolaravg.push(arrAllObjects[i].solar_area_avg);
      arrDG.push(arrAllObjects[i].dg);
      arrDGavg.push(arrAllObjects[i].dg_area_avg);
      arrMains.push(arrAllObjects[i].main);
      arrMainsavg.push(arrAllObjects[i].consumption_per_sq_feet);
      // arrTotal.push(arrAllObjects[i].total);
      // arrAverage.push(arrAllObjects[i].average);
      arrSolarpercent.push(arrAllObjects[i].solar_percentage);
      arrDGpercent.push(arrAllObjects[i].dg_percentage);
      arrMainspercent.push(arrAllObjects[i].main_percentage);
      arrconsum.push(arrAllObjects[i].consumption_per_sq_feet)

    }
    console.log("++++++++++++++++++++++++++++++++++++++++++++++++Satcked  site Bar+++++++++++++++++++++++++++++++++++++++++++++++++++++++++")
    console.log(arrSolar);
    console.log(arrDG);
    console.log(arrDGpercent);
    // console.log(arrHtMeter);
    // console.log(arrAverage);

    let currentChartType = "bar"
    // Added now
    originalChartConfigPower = {
      type: "bar",
      data: {
        labels: Object.keys(resfunPowerConsumptionObject8.response),
        datasets: [


          // {
          //   label: "DG",
          //   backgroundColor: ["#77216F"],
          //   data: arrDG,
          //   borderWidth: 1,
          //   borderColor: "#77216F",
          //   stack: "Stack 0",
          //   order: 2,
          // },
          {
            label: "DG",
            backgroundColor: ["#77216F"],
            data: arrDG,
            borderWidth: 1,
            borderColor: "#77216F",
            stack: "Stack 0",
            order: 2,
            datalabels: {
              display: true,
              formatter: function (value, context) {
                const percentValue = arrDGpercent[context.dataIndex];
                return !isNaN(percentValue) ? percentValue.toFixed(2) : ' ';
              },
              color: "#000", // Set the desired font color (white)
              anchor: "center",
              align: "center",
              offset: 0,
              font: {
                size: "10",
                weight: "bold",
              },
              display: true, // Make sure datalabels are enabled
            },
          },

          {
            label: "Renewable",
            backgroundColor: ["#FDAB3D"],
            data: arrSolar,
            borderWidth: 1,
            borderColor: "#FDAB3D",
            stack: "Stack 0",
            order: 2,
            datalabels: {
              formatter: function (value, context) {
                const percentValue = arrSolarpercent[context.dataIndex];
                return !isNaN(percentValue) ? percentValue.toFixed(2) : ' ';
              },
              color: "#000", // Set the desired font color (white)
              anchor: "center",
              align: "center",
              offset: 0,
              font: {
                size: "10",
                weight: "bold",
              },
              display: true, // Make sure datalabels are enabled
            },
          },

          // {arrMainspercent,
          //   label: "Mains",
          //   backgroundColor: ["#E95420"],
          //   data: arrMains,
          //   borderWidth: 1,
          //   borderColor: "#E95420",
          //   stack: "Stack 0",
          //   order: 2,
          // },
          {
            label: "Mains",
            backgroundColor: ["#E95420"],
            data: arrMains,
            borderWidth: 1,
            borderColor: "#E95420",
            stack: "Stack 0",
            order: 2,
            datalabels: {
              formatter: function (value, context) {
                const percentValue = arrMainspercent[context.dataIndex];
                return !isNaN(percentValue) ? percentValue.toFixed(2) : ' ';
              },
              color: "#000", // Set the desired font color (white)
              anchor: "center",
              align: "center",
              offset: 0,
              font: {
                size: "10",
                weight: "bold",
              },
              display: true, // Make sure datalabels are enabled
            },
          },


          // {
          //   label: "Total",
          //   backgroundColor: ["#f2ad6c"],
          //   data: arrTotal,
          //   borderWidth: 1,
          //   borderColor: "#f2ad6c",
          //   stack: "Stack 0",
          //   order:2,
          // },
          // {
          //   type: "line",
          //   tension: 0,
          //   label: "Main",
          //   backgroundColor: ["#730000"],
          //   data: arrMainsavg,
          //   borderWidth: 0.4,
          //   borderColor: "#730000",
          //   stack: "Stack 1",
          //   order: 1,
          //   yAxisID: 'percentage',
          // },
          {
            type: "line",
            tension: 0,
            label: "Consumption per sq.ft",
            backgroundColor: ["#730000"],
            data: arrconsum,
            borderWidth: 0.4,
            borderColor: "#730000",
            stack: "Stack 1",
            order: 1,
            yAxisID: 'percentage',
          },
          // {
          //   type: "line",
          //   tension: 0,
          //   label: "Cost per sq.ft",
          //   backgroundColor: ["#7be382"],
          //   data: arrSolaravg,
          //   borderWidth: 0.4,
          //   borderColor: "#7be382",
          //   stack: "Stack 1",
          //   order: 1,
          //   // yAxisID:'percentage',
          // },
          // {
          //   type: "line",
          //   tension: 0,
          //   label: "DG",
          //   backgroundColor: ["#98c1d9"],
          //   data: arrDGavg,
          //   borderWidth: 0.4,
          //   borderColor:"#98c1d9",
          //   stack: "Stack 1",
          //   order:1,
          //   // yAxisID:'percentage',
          // },
          // {
          //   type: "line",
          //   tension: 0,
          //   label: "Total",
          //   backgroundColor: ["#f2ad6c"],
          //   data: arrAverage,
          //   borderWidth: 0.4,
          //   borderColor:"#f2ad6c",
          //   stack: "Stack 1",
          //   order:1,
          //   // yAxisID:'percentage',
          // },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            // ticks: {
            //   callback: function (value) {
            //     return this.getLabelForValue(value).substr(0, 15);
            //   },
            // },
            beginAtZero: true,
            title: {
              display: true,
              text: 'Sites',
              padding: {
                top: 20,
              }
            }
          },
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Consumption kVAh'
            },
          },
          percentage: {
            beginAtZero: true,
            position: 'right',
            title: {
              display: true,
              text: 'Per Sq.ft '
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            display: true,
          },
          legend: {
            labels: {
              usePointStyle: true  // Enable point style icons
            },
            display: true,
            position: "top",
            align: "center",
          },
        },
      },
      plugins: [ChartDataLabels],
    }

    let myChart = new Chart(SitePowerConsumption, originalChartConfigPower)

    let listItemLabelpower = document.getElementById("listItemLabelpower")
    loaderSitePower.style.display = "none";
    SitePowerNoData.style.display = "none";
    SitePowerConsumption.style.display = "block";

    SitePowerConsumption.onclick = function (event) {

      if (clickedPowerConsumption == true) {
        const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

        if (points.length) {
          const firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

          console.log(`Clicked on ${label} with value ${value}`);

          listItemLabelpower.textContent = ` ${label}`;
          // console.log(listItemLabelpower);
          // document.getElementById("listItemValue").textContent = `Value: ${value}`;

          const dropdown = (document.getElementById("dataDropdown_power"));
          console.log(dropdown);
          dropdown.style.display = "block";

        }
        dataDropdown_power.addEventListener("click", function (event) {
          const selectedOption = event.target.id;
          const firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const labelname = label;
          console.log(selectedOption);
          if (event.target.id != "closeDropdown") {
          if (selectedOption === "Asset_Name" && currentChartType === "bar") {
            let xhr_object = new XMLHttpRequest();
            xhr_object.open(
              "GET",
              getPowerDrill +
              "?site_name=" +
              labelname +
              "&drilldown_by=" +
              selectedOption +
              "&site_id=" +
              countSiteDrop +
              "&society_id=" +
              countSocietyDrop +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond,
              true
            );

            console.log(
              getPowerDrill +
              "?site_name=" +
              labelname +
              "&drilldown_by=" +
              selectedOption +
              "&site_id=" +
              countSiteDrop +
              "&society_id=" +
              countSocietyDrop +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond,
            );

            // downloadPowerConsumLink = ip + "fm-excel-download/get-drill-down-for-powerConsumptionStackedBarGraph/" + idLink +
            //   "&drilldown_by=" +
            //   selectedOption +
            //   "&date=" +
            //   labelname +
            //   "&from_date=" +
            //   globalDateFirst +
            //   "&to_date=" +
            //   globalDateSecond,


            xhr_object.onload = function () {
              resPowerDrill = JSON.parse(this.responseText);
              console.log("Tickets Drill Down - ");
              console.log(resPowerDrill);

              const labels = resPowerDrill.res.map(item => item[0]);
              const dataValues = resPowerDrill.res.map(item => item[2]);

              myChart.destroy();
              myChart = new Chart(SitePowerConsumption, {
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: "Data",
                    data: dataValues,
                    backgroundColor: ["#e2445b"],
                  }]
                },
                options: {
                  responsive: true,
                  interaction: {
                    intersect: false,
                  },
                  scales: {
                    x: {
                      stacked: true,
                    },
                    y: {
                      stacked: true,
                    },
                  },
                  maintainAspectRatio: false,
                  scales: {
                    x: {
                    },
                  },
                  plugins: {
                    datalabels: {
                      color: "#000000",
                      anchor: "end",
                      align: "end",
                      offset: -6,
                      font: {
                        size: "10",
                        weight: "bold",
                      },
                      formatter: function (value, context) {
                        // Hide label if value is zero
                        return value === 0 ? '' : value;
                      }
                    },
                    legend: {
                      display: true,
                      position: "no",
                    },
                  },
                },
                plugins: [ChartDataLabels],
              });
              clickedPowerConsumption = false;
              SitePowerConsumption.style.display = "block";
            }

            xhr_object.send();
          }
        }
        else {
          
          restoreOriginalChartTicket();
          
        }

          dataDropdown_power.style.display = "none";
        });
      } else if (clickedPowerConsumption == false) {
        alert("You have reached the maximum drill-down level.");
      }


    };

    function restoreOriginalChartTicket() {
      if (originalChartConfigPower) {
        myChart.destroy();
        funPowerConsumption();
        clickedPowerConsumption = true;
        SitePowerConsumption.style.display = "block";
      }
    }

    refreshIconElement_power.addEventListener("click", restoreOriginalChartTicket);
  };
  xhr_object8.send();

  //   timeSeriesPowerConsumptionAssetwise.style.display = "none";
  //   // loaderPowerConsumAssetWiseTimeSeries.style.display = "block";
  //   powerConsumAssetWiseTimeSeriesNoData.style.display = "none";

  //   let xhr_object7 = new XMLHttpRequest();
  //   if (globalType == "daily") {
  //     xhr_object7.open(
  //       "GET",
  //       getPowerConsumptionTimeSeries + idLink + "&date=" + globalDateFirst,
  //       true
  //     );
  //     console.log(
  //       getPowerConsumptionTimeSeries + idLink + "&date=" + globalDateFirst
  //     );
  //   } else {
  //     xhr_object7.open(
  //       "GET",
  //       getPowerConsumptionTimeSeries +
  //       idLink +
  //       "&from_date=" +
  //       globalDateFirst +
  //       "&to_date=" +
  //       globalDateSecond,
  //       true
  //     );
  //     console.log(
  //       getPowerConsumptionTimeSeries +
  //       idLink +
  //       "&from_date=" +
  //       globalDateFirst +
  //       "&to_date=" +
  //       globalDateSecond
  //     );
  //   }
  //   // xhr_object7.open("GET", getPowerConsumptionTimeSeries, true);

  //   xhr_object7.onload = function () {
  //     resfunPowerConsumptionObject7 = JSON.parse(this.responseText);
  //     console.log("Assetwise Time Series - ");
  //     console.log(resfunPowerConsumptionObject7);

  //     let responseKVA = [],
  //       responseKWH = [],
  //       responseIAN = [],
  //       responseEL = [],
  //       responseBI = [],
  //       responseRH = [],
  //       responseCAMTS = [],
  //       responseCAMFF = [],
  //       responseCAMF = [],
  //       responseCAMS = [],
  //       responseFPO = [],
  //       responseFPT = [],
  //       responseFEM = [];
  //     let valuesResponses = Object.values(resfunPowerConsumptionObject7.response);
  //     console.log("All Values --------------------");
  //     console.log(resfunPowerConsumptionObject7.response);
  //     console.log(valuesResponses);

  //     for (let i = 0; i < valuesResponses.length; i += 1) {
  //       // responseKVA[i] = valuesResponses[i].KVA;
  //       // responseKWH[i] = valuesResponses[i].KWH;
  //       // responseIAN[i] = valuesResponses[i].IAN;
  //       // responseKVA.push(valuesResponses[i][]);
  //       // responseKWH.push(valuesResponses[i].KWH);
  //       // responseIAN.push(valuesResponses[i].IAN);
  //       responseCAMTS[i] =
  //         valuesResponses[i][
  //         "Common Area Meter - ( Tower 3 to 7 )-Meter Reading (In KWH)"
  //         ];
  //       responseCAMFF[i] =
  //         valuesResponses[i][
  //         "Common Area Meter - ( Tower -5 )-Meter Reading (In KWH)"
  //         ];
  //       responseCAMF[i] =
  //         valuesResponses[i][
  //         "Common Area Meter - ( Tower - 4 )-Meter Reading (In KWH)"
  //         ];
  //       responseCAMS[i] =
  //         valuesResponses[i][
  //         "Common Area Meter - ( Tower - 6 )-Meter Reading (In KWH)"
  //         ];

  //       responseKVA[i] =
  //         valuesResponses[i]["DG Set -Batt Charger Output Volt DC"];
  //       responseKWH[i] =
  //         valuesResponses[i]["DG Set -Batt Charger Output Current A"];
  //       responseIAN[i] = valuesResponses[i]["DG Set -Battery Voltage"];
  //       responseEL[i] = valuesResponses[i]["DG Set -Battery Electrolyte level"];
  //       responseBI[i] = valuesResponses[i]["DG Set -Battery Indicator"];
  //       responseRH[i] = valuesResponses[i]["DG Set -Running Hours"];

  //       responseFPO[i] =
  //         valuesResponses[i]["Fire Pump 1 Meter-Meter Reading (In KWH)"];
  //       responseFPT[i] =
  //         valuesResponses[i]["Fire Pump 2 Meter-Meter Reading (In KWH)"];
  //       responseFEM[i] =
  //         valuesResponses[i][
  //         "Fire emergency Meter - ( Tower 3 to 7 )-Meter Reading (In KWH)"
  //         ];
  //     }

  //     console.log(responseKVA);
  //     console.log(responseKWH);
  //     console.log(responseIAN);

  //     // Added now
  // //     new Chart(timeSeriesPowerConsumptionAssetwise, {
  // //       type: "bar",
  // //       data: {
  // //         labels: Object.keys(resfunPowerConsumptionObject7.response),
  // //         datasets: [
  // //           {
  // //             label:
  // //               "Common Area Meter - ( Tower 3 to 7 )-Meter Reading (In KWH)",
  // //             backgroundColor: ["#77216F"],
  // //             data: responseCAMTS,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "Common Area Meter - ( Tower -5 )-Meter Reading (In KWH)",
  // //             backgroundColor: ["#01C875"],
  // //             data: responseCAMFF,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "Common Area Meter - ( Tower - 4 )-Meter Reading (In KWH)",
  // //             backgroundColor: ["#E2445B"],
  // //             data: responseCAMF,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "Common Area Meter - ( Tower - 6 )-Meter Reading (In KWH)",
  // //             backgroundColor: ["#E2445B"],
  // //             data: responseCAMS,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "DG Set -Batt Charger Output Volt DC",
  // //             backgroundColor: ["#77216F"],
  // //             data: responseKVA,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "DG Set -Batt Charger Output Current A",
  // //             backgroundColor: ["#01C875"],
  // //             data: responseKWH,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "DG Set -Battery Voltage",
  // //             backgroundColor: ["#E2445B"],
  // //             data: responseIAN,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "DG Set -Battery Electrolyte level",
  // //             backgroundColor: ["#E95420"],
  // //             data: responseEL,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "DG Set -Battery Indicator",
  // //             backgroundColor: ["#77216f"],
  // //             data: responseBI,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "DG Set -Running Hours",
  // //             backgroundColor: ["#F69380"],
  // //             data: responseRH,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "Fire Pump 1 Meter-Meter Reading (In KWH)",
  // //             backgroundColor: ["#E95420"],
  // //             data: responseFPO,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label: "Fire Pump 2 Meter-Meter Reading (In KWH)",
  // //             backgroundColor: ["#77216f"],
  // //             data: responseFPT,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //           {
  // //             label:
  // //               "Fire emergency Meter - ( Tower 3 to 7 )-Meter Reading (In KWH)",
  // //             backgroundColor: ["#F69380"],
  // //             data: responseFEM,
  // //             tension: 0.4,
  // //             borderWidth: 1,
  // //             stack: "Stack 0",
  // //           },
  // //         ],
  // //       },
  // //       options: {
  // //         responsive: true,
  // //         interaction: {
  // //           intersect: false,
  // //         },
  // //         scales: {
  // //           x: {
  // //             stacked: true,
  // //           },
  // //           y: {
  // //             stacked: true,
  // //           },
  // //         },
  // //         maintainAspectRatio: false,
  // //         scales: {
  // //           x: {
  // //             ticks: {
  // //               callback: function (value) {
  // //                 return this.getLabelForValue(value).substr(0, 15);
  // //               },
  // //             },
  // //           },
  // //         },
  // //         plugins: {
  // //           datalabels: {
  // //             color: "#000000",
  // //             anchor: "end",
  // //             align: "end",
  // //             offset: -6,
  // //             font: {
  // //               size: "10",
  // //               weight: "bold",
  // //             },
  // //           },
  // //           legend: {
  // //             display: true,
  // //             position: "no",
  // //           },
  // //         },
  // //       },
  // //       plugins: [ChartDataLabels],
  // //     });

  // //     // loaderPowerConsumAssetWiseTimeSeries.style.display = "block";
  // //     if (Object.keys(resfunPowerConsumptionObject7.response).length == 0) {
  // //       powerConsumAssetWiseTimeSeriesNoData.style.display = "block";
  // //       timeSeriesPowerConsumptionAssetwise.style.display = "none";
  // //     } else {
  // //       powerConsumAssetWiseTimeSeriesNoData.style.display = "none";
  // //       timeSeriesPowerConsumptionAssetwise.style.display = "block";
  // //     }
  // };
  // xhr_object7.send();
}

function funFitoutOccupancy() {
  let fitoutUnoccupied = document.getElementById("fitoutUnoccupiedFlats");
  let fitoutOccupied = document.getElementById("fitoutOccupiedFlats");

  let ftFitoutFlats = document.getElementById("ftFitoutFlats");


  let xhr_object1 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object1.open(
      "GET",
      getFitoutOccupiedUnoccupied + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(
      getFitoutOccupiedUnoccupied + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object1.open(
      "GET",
      getFitoutOccupiedUnoccupied +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getFitoutOccupiedUnoccupied +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object1.onload = function () {
    resFunoccupency1 = JSON.parse(this.responseText);
    console.log("fitout occupency ++++++++++++============================================================================1 - ");
    console.log(resFunoccupency1);
    if (resFunoccupency1.response == null) {
      fitoutUnoccupied.innerHTML = "0";
      fitoutOccupied.innerHTML = "0";
    } else {
      fitoutUnoccupied.innerHTML =
        resFunoccupency1.response.unoccupied_count;
      fitoutOccupied.innerHTML = resFunoccupency1.response.occupied_count;

    }
  };
  xhr_object1.send();

  // ----------------------------------------------

  let xhr_object2 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object2.open(
      "GET",
      getFtFitoutFlat + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getFtFitoutFlat + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object2.open(
      "GET",
      getFtFitoutFlat +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getFtFitoutFlat +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object2.onload = function () {
    resfunFtFitout2 = JSON.parse(this.responseText);
    console.log("Ft fitout flat 2 - ");
    console.log(resfunFtFitout2);
    if (resfunFtFitout2.response == null) {
      ftFitoutFlats.innerHTML = "0";
    } else {
      ftFitoutFlats.innerHTML =
        resfunFtFitout2.response + "";
    }
  };
  xhr_object2.send();
}

function funWaterConsumption() {
  let titleWaterConsumption = document.getElementById("titleWaterConsumption");

  let wcTotalConsumption = document.getElementById("wcTotalConsumption");
  let wcTotalDomestic = document.getElementById("wcTotalDomestic");
  let wcFlushingTotal = document.getElementById("wcFlushingTotal");
  let wcTotalIrrigation = document.getElementById("wcTotalIrrigation");
  let wcTotalSTP = document.getElementById("wcTotalSTP");

  let loaderWaterConsumPie = document.getElementById("loaderWaterConsumPie");
  let waterConsumPieNoData = document.getElementById("waterConsumPieNoData");
  let water_consume_pie = document.getElementById("water-consume-pie");
  let wsPie1 = document.getElementById("wsPie1");

  let loaderWaterConsum = document.getElementById("loaderWaterConsum");
  let waterConsumNoData = document.getElementById("waterConsumNoData");
  let water_consumption = document.getElementById("water-consumption");

  // if (globalType == "daily") {
  //   titleWaterConsumption.innerHTML =
  //     "Water Consumption for " + convertDateFormat(globalDateFirst);
  // } else {
  //   titleWaterConsumption.innerHTML =
  //     "Water Consumption for " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  // }

  // ----------------------------------------------

  let xhr_object1 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object1.open(
      "GET",
      getTotalWaterConsumption + idLink + "&from_date=" + globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(getTotalWaterConsumption + idLink + "&from_date=" + globalDateFirst +
      "&to_date=" +
      globalDateFirst);
  } else {
    xhr_object1.open(
      "GET",
      getTotalWaterConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getTotalWaterConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object1.onload = function () {
    resfunWaterConsumptionObject1 = JSON.parse(this.responseText);
    console.log("Water Consumption Object 1 - ");
    console.log(resfunWaterConsumptionObject1);
    if (resfunWaterConsumptionObject1.response == null) {
      wcTotalConsumption.innerHTML = "0 KL";
    } else {
      wcTotalConsumption.innerHTML =
        resfunWaterConsumptionObject1.response + " KL";
    }
  };
  xhr_object1.send();

  // ----------------------------------------------


  let xhr_object8 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object8.open(
      "GET",
      getTotalSTP + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getTotalSTP + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object8.open(
      "GET",
      getTotalSTP +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getTotalSTP +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object8.onload = function () {
    resfunWaterConsumptionObject8 = JSON.parse(this.responseText);
    console.log("Water Consumption Object 8 - ");
    console.log(resfunWaterConsumptionObject8);
    if (resfunWaterConsumptionObject8.response == null) {
      wcTotalSTP.innerHTML = "0 KL";
    } else {
      wcTotalSTP.innerHTML =
        resfunWaterConsumptionObject8.response + " KL";
    }
  };
  xhr_object8.send();


  //---------------------------------------------------------

  let xhr_object2 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object2.open(
      "GET",
      getWaterConsumption + idLink + "&from_date=" + globalDateFirst  +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(getWaterConsumption + idLink + "&from_date=" + globalDateFirst  +
      "&to_date=" +
      globalDateFirst);
  } else {
    xhr_object2.open(
      "GET",
      getWaterConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getWaterConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object2.onload = function () {

    resfunWaterConsumptionObject2 = JSON.parse(this.responseText);
    console.log("Water Consumption Object 2 - ");
    console.log(resfunWaterConsumptionObject2);
    if (resfunWaterConsumptionObject2.response["Domestic KL"] == null) {
      wcTotalDomestic.innerHTML = "0 KL";
    } else {
      wcTotalDomestic.innerHTML =
        resfunWaterConsumptionObject2.response["Domestic KL"] + " KL";
    }

    if (resfunWaterConsumptionObject2.response["Flushing KL"] == null) {
      wcFlushingTotal.innerHTML = "0 KL";
    } else {
      wcFlushingTotal.innerHTML =
        resfunWaterConsumptionObject2.response["Flushing KL"] + " KL";
    }

    if (resfunWaterConsumptionObject2.response["Irrigation KL"] == null) {
      wcTotalIrrigation.innerHTML = "0 KL";
    } else {
      wcTotalIrrigation.innerHTML =
        resfunWaterConsumptionObject2.response["Irrigation KL"] + " KL";
    }
  };
  xhr_object2.send();

  // ----------------------------------------------

  // loaderWaterConsumPie.style.display = "block";
  // waterConsumPieNoData.style.display = "none";

  let xhr_object5 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object5.open(
      "GET",
      getWaterSourcePieChart + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getWaterSourcePieChart + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object5.open(
      "GET",
      getWaterSourcePieChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getWaterSourcePieChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object5.onload = function () {
    resfunWaterConsumptionObject5 = JSON.parse(this.responseText);
    console.log("Water Consumption Object 5 - ");
    console.log(resfunWaterConsumptionObject5);

    let valueChartName = Object.keys(resfunWaterConsumptionObject5.response);
    let valueChartY = Object.values(resfunWaterConsumptionObject5.response);

    console.log(valueChartY);

    let waterPieChartColors = [
      "#F2C06C",
      "#F8EA94",
      "#A1CD7A",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];



    // Added Now
    new Chart(water_consume_pie, {
      type: "bar",
      data: {
        labels: valueChartName,
        datasets: [
          {
            label: "Water Resource",
            data: valueChartY,
            backgroundColor: waterPieChartColors,
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              callback: function (value) {
                return value + "%"
              }
            },
            title: {
              display: true,
              text: 'Consumption in %'
            }
          },
          x: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Water Resources',
              padding: {
                top: 1,
              }
            }
          }


        },
        plugins: {

          title: {
            fullSize: true,
            display: true,
            text: 'Water Resources',
            color: 'black',
            align: 'center',
            font: {
              weight: 'bold'
            },
            font: {
              size: 14
            },
            padding: {
              top: 1,
              bottom: 30
            }
          },

          datalabels: {
            color: "#000000",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: false,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    let sum = 0;

    for (let i = 0; i < valueChartY.length; i += 1) {
      if (valueChartY[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueChartY[i];
      }
    }

    loaderWaterConsumPie.style.display = "none";
    if (sum == 0) {
      waterConsumPieNoData.style.display = "block";
      water_consume_pie.style.display = "none";
    } else {
      waterConsumPieNoData.style.display = "none";
      water_consume_pie.style.display = "block";
    }
  };
  xhr_object5.send();

  // ---------------------------------------------------------------------------------------------------



  let loaderWaterConsumLPCD = document.getElementById("loaderWaterConsumLPCD");
  let waterConsumLPCDNoData = document.getElementById("waterConsumLPCDNoData");
  let water_consume_lpcd = document.getElementById("water-consume-lpcd");
  let wsLPCD = document.getElementById("wsLPCD");


  // loaderWaterConsumLPCD.style.display = "block";
  // waterConsumLPCDNoData.style.display = "none";

  let xhr_object7 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object7.open(
      "GET",
      getWaterSourceLPCDChart + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getWaterSourceLPCDChart + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object7.open(
      "GET",
      getWaterSourceLPCDChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getWaterSourceLPCDChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object7.onload = function () {
    resfunWaterConsumptionObjectLPCD = JSON.parse(this.responseText);
    console.log("Water Consumption Object 5 - ");
    console.log(resfunWaterConsumptionObjectLPCD);

    let valueChartName = Object.keys(resfunWaterConsumptionObjectLPCD.response);
    let valueChartY = Object.values(resfunWaterConsumptionObjectLPCD.response);

    console.log(valueChartY);

    let waterPieChartColors = [
      "#F2C06C",
      "#F8EA94",
      "#A1CD7A",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];




    new Chart(water_consume_lpcd, {
      type: "bar",
      data: {
        labels: valueChartName,
        datasets: [
          {
            label: "Water Consumption",
            data: valueChartY,
            backgroundColor: waterPieChartColors,
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              callback: function (value) {
                return value
              }
            },
            title: {
              display: true,
              text: 'Domestic Water(LPCD)',
            }
          },
          x: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Towers',
              padding: {
                top: 40,
              }
            }
          }

        },
        plugins: {


          title: {
            fullSize: true,
            display: true,
            text: 'LPCD',
            color: 'black',
            align: 'center',
            font: {
              weight: 'bold'
            },
            font: {
              size: 14
            },
            padding: {
              top: 1,
              bottom: 30
            }
          },

          datalabels: {
            color: "#000000",
            font: {
              size: "14",
              weight: "bold",
            },
            ticks: {
              callback: function (value) {
                return value + "%"
              }
            },
          },
          legend: {
            display: false,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    let sum = 0;

    for (let i = 0; i < valueChartY.length; i += 1) {
      if (valueChartY[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueChartY[i];
      }
    }

    loaderWaterConsumLPCD.style.display = "none";
    if (sum == 0) {
      waterConsumLPCDNoData.style.display = "block";
      water_consume_lpcd.style.display = "none";
    } else {
      waterConsumLPCDNoData.style.display = "none";
      water_consume_lpcd.style.display = "block";
    }
  };
  xhr_object7.send();




  //- ----------------------------------------------------------------------------------------------------
  // water_consumption.style.display = "none";
  // loaderWaterConsum.style.display = "block";
  // waterConsumNoData.style.display = "none";

  let xhr_object6 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object6.open(
      "GET",
      getWaterConsumptionStackedBarChart + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(
      getWaterConsumptionStackedBarChart + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object6.open(
      "GET",
      getWaterConsumptionStackedBarChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getWaterConsumptionStackedBarChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object6.onload = function () {
    resfunWaterConsumptionObject6 = JSON.parse(this.responseText);
    console.log("Water Consumption Object 6 - ");
    console.log(resfunWaterConsumptionObject6);
    let arrAllObjects = Object.values(resfunWaterConsumptionObject6.response);
    let arrdomestic_KL = [];
    let arrflushing_KL = [];
    let arrirrigation_KL = [];
    let arrTotal = [];
    let arrAverage = [];

    for (let i = 0; i < arrAllObjects.length; i++) {
      arrdomestic_KL.push(arrAllObjects[i].domestic_KL);
      arrflushing_KL.push(arrAllObjects[i].flushing_KL);
      arrirrigation_KL.push(arrAllObjects[i].irrigation_KL);
      arrTotal.push(arrAllObjects[i].total);
      arrAverage.push(arrAllObjects[i].average);
    }
    let currentChartType = "bar"
    // Added now
    originalChartConfigWater = {
      type: "bar",
      data: {
        labels: Object.keys(resfunWaterConsumptionObject6.response),
        datasets: [
          {
            label: "Domestic KL",
            backgroundColor: ["#E95420"],
            data: arrdomestic_KL,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Flushing KL",
            backgroundColor: ["#77216f"],
            data: arrflushing_KL,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Irrigation KL",
            backgroundColor: ["#f2ad6c"],
            data: arrirrigation_KL,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            type: "line",
            tension: 1,
            label: "Average",
            backgroundColor: ["#ffffff"],
            data: arrAverage,
            borderWidth: 0.9,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },

        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
            beginAtZero: true,
            title: {
              display: true,
              text: 'Date',
              padding: {
                top: 20,
              }
            }

          },
          y: {
            beginAtZero: true,
            ticks: {
              callback: function (value) {
                return value + ""
              }
            },

            title: {
              display: true,
              text: 'Consumption (KL)'
            }
          }
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(water_consumption, originalChartConfigWater)

    loaderWaterConsum.style.display = "none";
    waterConsumNoData.style.display = "none";
    water_consumption.style.display = "block";
    let clickedWaterConsumption = true;

    if (!funWaterConsumption.initialized) {
      water_consumption.onclick = function (event) {

        if (clickedWaterConsumption == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);

            document.getElementById("listItemLabelwater").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            const dropdown = (document.getElementById("dataDropdown_water"));
            dropdown.style.display = "block";

          }
          dataDropdown_water.addEventListener("click", function (event) {
            const selectedOption = event.target.id;
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const labelname = label;
            console.log(selectedOption);
            if (event.target.id != "closeDropdown") {
            if (selectedOption === "Asset_Name" && currentChartType === "bar") {
              let xhr_object = new XMLHttpRequest();
              xhr_object.open(
                "GET",
                getWaterDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,
                true
              );

              console.log(
                getWaterDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,
              );

              xhr_object.onload = function () {
                resWaterDrill = JSON.parse(this.responseText);
                console.log("Tickets Drill Down - ");
                console.log(resWaterDrill);

                const labels = resWaterDrill.response.map(item => item[0]);
                const dataValues = Array.from({ length: labels.length }, () => Math.floor(Math.random() * 100));

                myChart.destroy();
                myChart = new Chart(water_consumption, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: "Data",
                      data: dataValues,
                      backgroundColor: ["#e2445b"],
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedWaterConsumption = false;
              }

              xhr_object.send();
              funWaterConsumption.initialized = true;
            }
          }
          else {
            
            restoreOriginalChartTicket();
            
          }

            dataDropdown_water.style.display = "none";
          });
        } else if (clickedWaterConsumption == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChartTicket() {
      if (originalChartConfigWater) {
        myChart.destroy(); // Destroy the current chart
        funWaterConsumption();
        clickedWaterConsumption = true;
      }
    }

    refreshIconElement_water.addEventListener("click", restoreOriginalChartTicket);
  };
  xhr_object6.send();
}

function funFootfall() {
  console.log("Footfall - --===============");
  let footfallNoData = document.getElementById("footfallNoData");
  // let footfall_bar = document.getElementById("footfall_bar ");
  // let loaderFootfall = document.getElementById("loaderFootfall");

  // loaderFootfall.style.display = "block";
  // footfallNoData.style.display = "none";
  // footfall_bar.style.display = "block";

  // let eff1 = document.getElementById("eff1");
  // eff1.innerHTML = " Events Footfall Analysis ";

  console.log("Footfall - --===============");
  console.log(getFootfall + idLink + "&date=" + globalDateFirst);
  let xhr_object = new XMLHttpRequest();

  xhr_object.open("GET", getFootfall + idLink + "&date=" + globalDateFirst, true);
  console.log(getFootfall + idLink + "&date=" + globalDateFirst);

  xhr_object.onload = function () {
    resfunFootfall = JSON.parse(this.responseText);

    console.log("Footfall - ");
    console.log(resfunFootfall);
    console.log(Object.keys(resfunFootfall.response));
    console.log(Object.values(resfunFootfall.response));
    originalChartConfigFootfall = {
      type: "bar",
      data: {
        labels: Object.keys(resfunFootfall.response),
        datasets: [
          {
            label: "Footfall",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: Object.values(resfunFootfall.response),
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }

    let myChart = new Chart(footfall_bar, originalChartConfigFootfall)

    // loaderFootfall.style.display = "none";
    // footfall_bar.style.display = "block";

    // let sum = 0;
    // let resValues = Object.values(resfunFootfall.response);

    // for (let i = 0; i < resValues.length; i += 1) {
    //   sum = resValues[i] + sum;
    // }

    // loaderFootfall.style.display = "none";
    // footfall_bar.style.display = "block";
    if (Object.keys(resfunFootfall.response).length == 0) {
      footfallNoData.style.display = "block";
      footfall_bar.style.display = "none";
    } else {
      footfallNoData.style.display = "none";
      footfall_bar.style.display = "block";
    }
    let clickedFootfall = true;
    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let FootfalldrillDownLevel = 1;

    if (!funFootfall.initialized) {
      footfall_bar.onclick = function (event) {

        if (clickedFootfall == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelFootFall").textContent = `Ticket: ${label}`;

            backgroundColor = myChart.data.datasets[0].backgroundColor[firstPoint.index];

            myChart.update();

            console.log(backgroundColor);
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_footfall"));
            dropdown.style.display = "block";


          }


          dataDropdown_footfall.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (FootfalldrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              label = myChart.data.labels[firstPoint.index];
              labelname = label;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getFootFallDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&date=" +
                globalDateFirst,
                // "&to_date=" +
                // globalDateSecond,

                xhr_object.open("GET", apiURL, true);



              downloadEventsFootfallAnalysisLink = ip + "fm-excel-download/get-drill-down-for-footfall-analysis/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;

              xhr_object.onload = function () {
                resFootFallDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resFootFallDrill);

                const labels = resFootFallDrill.response.map(item => item[0]);
                const dataValues = resFootFallDrill.response.map(item => item[1]);

                myChart.destroy();
                myChart = new Chart(footfall_bar, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: 'Data Values',
                      data: dataValues,
                      backgroundColor: [
                        "#77216F",
                        "#01C875",
                        "#E2445B",
                        "#E95420",
                        "#A1CD7A",
                      ],
                      borderColor: 'rgba(75, 192, 192, 1)',
                      borderWidth: 1
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
              }
              xhr_object.send();
              FootfalldrillDownLevel = 2;
            }
            else if (FootfalldrillDownLevel === 2) {
              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);

              apiURL =
                getFootFallDrillSecond +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);


              downloadEventsFootfallAnalysisLink = ip + "fm-excel-download/get-drill-down-for-footfall-analysis/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&date=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;

              xhr_object.onload = function () {
                resFootFallDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resFootFallDrill);

                const labels = resFootFallDrill.response.map(item => item[0]);
                const dataValues = resFootFallDrill.response.map(item => item[1]);

                myChart.destroy();
                myChart = new Chart(footfall_bar, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: 'Data Values',
                      data: dataValues,
                      backgroundColor: [
                        "#77216F",
                        "#01C875",
                        "#E2445B",
                        "#E95420",
                        "#A1CD7A",
                      ],
                      borderColor: 'rgba(75, 192, 192, 1)',
                      borderWidth: 1
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
              }
              xhr_object.send();
              FootfalldrillDownLevel = 3;
              clickedFootfall = false;
              return;
            }
          }
          else {
            if(FootfalldrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_footfall.style.display = "none";
          });
        } else if (clickedFootfall == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChart() {
      if (originalChartConfigFootfall) {
        myChart.destroy(); // Destroy the current chart
        funFootfall();
        clickedFootfall = true;
      }
    }

    refreshIconElement_footfall.addEventListener("click", restoreOriginalChart);
  };
  xhr_object.send();
}

function funCarbonEmissionScope1() {
  let cEScope1 = document.getElementById("cEScope1");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getCarbonEmissionScope1 + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getCarbonEmissionScope1 + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getCarbonEmissionScope1 +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getCarbonEmissionScope1 +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunCarbonEmissionScope1 = JSON.parse(this.responseText);
    console.log("Carbon Emmision Scope 1 - ");
    console.log(resfunCarbonEmissionScope1);
    cEScope1.innerHTML = resfunCarbonEmissionScope1.response + " kg CO2";
  };
  xhr_object.send();
}

// function funCarbonEmissionScope2() {
//   let cEScope2 = document.getElementById("cEScope2");

//   cEScope2.innerHTML = "0" + " kg CO2";
// }

function funCarbonEmissionScope2() {
  let cEScope2 = document.getElementById("cEScope2");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getCarbonEmissionScope2 + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getCarbonEmissionScope2 + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getCarbonEmissionScope2 +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getCarbonEmissionScope2 +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunCarbonEmissionScope2 = JSON.parse(this.responseText);
    console.log("Carbon Emmision Scope 1 - ");
    console.log(resfunCarbonEmissionScope2);
    cEScope2.innerHTML = resfunCarbonEmissionScope2.response + " kg CO2";
  };
  xhr_object.send();
}

function funEnergyIntensity() {
  let energyIntensity = document.getElementById("energyIntensity");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getEnergyIntensity + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getEnergyIntensity + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getEnergyIntensity +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getEnergyIntensity +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resgetEnergyIntensity = JSON.parse(this.responseText);
    console.log("Carbon Emmision Scope 1 - ");
    console.log(resgetEnergyIntensity);
    energyIntensity.innerHTML = resgetEnergyIntensity.response;
  };
  xhr_object.send();
}

function funFuelConsumption() {
  let fuelConsmVal = document.getElementById("fuelConsmVal");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getFuelConsumption + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getFuelConsumption + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getFuelConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getFuelConsumption +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunFuelConsumption = JSON.parse(this.responseText);
    console.log("Fuel Consumption - ");
    console.log(resfunFuelConsumption);
    fuelConsmVal.innerHTML = resfunFuelConsumption.response + " liters";
  };
  xhr_object.send();
}

function funFitOutRequest() {
  let fitOutVal = document.getElementById("fitOutVal");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getFitoutCount + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getFitoutCount + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getFitoutCount +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getFitoutCount +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunFitOutRequest = JSON.parse(this.responseText);
    console.log("Fit Out Request - ");
    console.log(resfunFitOutRequest);
    fitOutVal.innerHTML = resfunFitOutRequest.response + "";
  };
  xhr_object.send();
}

let clickedIncidents = true;
function funIncidents() {
  let incidentsOpen = document.getElementById("fitOutVal");
  let incidentsInProgress = document.getElementById("fitOutVal");
  let incidentsPending = document.getElementById("fitOutVal");
  let incidentsClosed = document.getElementById("fitOutVal");

  let loaderIncident = document.getElementById("loaderIncident");
  let incidentNoData = document.getElementById("incidentNoData");
  let incident_dount = document.getElementById("incident-dount");

  // loaderIncident.style.display = "block";
  // incidentNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getIncidents + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getIncidents + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getIncidents +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getIncidents +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunIncidents = JSON.parse(this.responseText);
    console.log("Incidents - ");
    console.log(resfunIncidents);

    // incidentsOpen.innerHTML = resfunIncidents.response["Open"];
    // incidentsInProgress.innerHTML = resfunIncidents.response["In Progress"];
    // incidentsPending.innerHTML = resfunIncidents.response["Pending"];
    // incidentsClosed.innerHTML = resfunIncidents.response["Closed"];

    let sum =
      resfunIncidents.response["Open"] +
      resfunIncidents.response["In Progress"] +
      resfunIncidents.response["Pending"] +
      resfunIncidents.response["Closed"];

    originalChartConfigIncident = {
      type: "doughnut",
      data: {
        labels: ["Open", "Work In Progress", "Pending", "Closed"],
        datasets: [
          {
            label: "Delivered Amount",
            data: [
              resfunIncidents.response["Open"],
              resfunIncidents.response["In Progress"],
              resfunIncidents.response["Pending"],
              resfunIncidents.response["Closed"],
            ],
            backgroundColor: ["#77216f", "#f2c06c", "#e2445b", "#a1cd7a"],
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(incident_dount, originalChartConfigIncident)

    loaderIncident.style.display = "none";
    if (sum == 0) {
      incidentNoData.style.display = "block";
      incident_dount.style.display = "none";
    } else {
      incidentNoData.style.display = "none";
      incident_dount.style.display = "block";
    }

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let IncidentdrillDownLevel = 1;

    if (!funIncidents.initialized) {
      incident_dount.onclick = function (event) {

        if (clickedIncidents == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelIncident").textContent = `Ticket: ${label}`;
            const backgroundColor = myChart.data.datasets[0].backgroundColor[firstPoint.index];

            myChart.update();

            console.log(backgroundColor);
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            const dropdown = (document.getElementById("dataDropdown_incident"));
            dropdown.style.display = "block";

          }

          dataDropdown_incident.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (drillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              // First-level drill-down API
              apiURL =
                getIncidentDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&date=" +
                globalDateFirst,
                // "&to_date=" +
                // globalDateSecond,

                console.log(apiURL);

              xhr_object.open("GET", apiURL, true);


              downloadIncidentsLink = ip + "fm-excel-download/get-drill-down-for-card-incidentChart-excel-data/" + idLink +
                "&drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst,

                xhr_object.onload = function () {
                  const resIncidentDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down second-------------------- - ");
                  console.log(resIncidentDrill);

                  const labels = resIncidentDrill.response.map(item => item[0]);
                  const data = resIncidentDrill.response.map(item => item[2]);

                  myChart.destroy();
                  myChart = new Chart(incident_dount, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: backgroundColors
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {},
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                };

              xhr_object.send();
              drillDownLevel = 2;


            }
            else if (drillDownLevel === 2) {
              // Second-level drill-down API
              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);

              apiURL = getSecondLevelDrillDownIncident +
                idLink +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              // alert("second drill down api");

              // Reset flag after second-level drill-down
              // secondLevelActive = false;

              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadIncidentsLink = ip + "fm-excel-download/get-drill-down-for-card-incidentChart-excel-data/" + idLink +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;

              xhr_object.onload = function () {
                const resIncidentDrill = JSON.parse(this.responseText);
                console.log("Tickets Drill Down second-------------------- - ");
                console.log(resIncidentDrill);

                const labels = resIncidentDrill.response.map(item => item[0]);
                const data = resIncidentDrill.response.map(item => item[2]);

                myChart.destroy();
                myChart = new Chart(incident_dount, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: "Data",
                      data: data,
                      backgroundColor: backgroundColors
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {},
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
              };

              xhr_object.send();
              drillDownLevel = 3;
              clickedIncidents = false;
              return;
            }
          }
          else {
            if(IncidentdrillDownLevel === 1) {
              restoreOriginalChartTicket();
            }
          }



            dataDropdown_incident.style.display = "none";
          });
        } else if (clickedIncidents == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChartTicket() {
      if (originalChartConfigIncident) {
        myChart.destroy(); // Destroy the current chart
        funIncidents();
        clickedIncidents = true;

      }
    }

    refreshIconElement_incident.addEventListener("click", restoreOriginalChartTicket);
  };
  xhr_object.send();
}

let clickedIncidentsCategory = true;
function funIncidentsCategory() {
  let incidentsCatMechanical = document.getElementById(
    "incidentsCatMechanical"
  );
  let incidentsCatEngineering = document.getElementById(
    "incidentsCatEngineering"
  );
  let incidentsCatHealthSafety = document.getElementById(
    "incidentsCatHealthSafety"
  );
  let incidentsCatOther = document.getElementById("incidentsCatOther");

  let loaderIncidentCategory = document.getElementById(
    "loaderIncidentCategory"
  );
  let incidentCategoryNoData = document.getElementById(
    "incidentCategoryNoData"
  );
  let incident_category_pie = document.getElementById("incident-category-pie");

  // loaderIncidentCategory.style.display = "block";
  // incidentCategoryNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getIncidentsCategory + idLink + "&date=" + globalDateFirst,
      true
    );
    console.log(getIncidentsCategory + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getIncidentsCategory +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getIncidentsCategory +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object.onload = function () {
    resfunIncidentsCategory = JSON.parse(this.responseText);

    console.log("Incident Category - ");
    console.log(resfunIncidentsCategory.response);

    let xValues = [], yValues = [];

    xValues = Object.keys(resfunIncidentsCategory.response);
    yValues = Object.values(resfunIncidentsCategory.response);

    let incidentCategoryPieColors = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];

    originalChartConfigIncidentCategory = {
      type: "pie",
      data: {
        labels: xValues,
        datasets: [
          {
            label: "Share",
            data: yValues,
            backgroundColor: incidentCategoryPieColors,
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    }

    let myChart = new Chart(incident_category_pie, originalChartConfigIncidentCategory)

    loaderIncidentCategory.style.display = "none";
    incidentCategoryNoData.style.display = "none";
    incident_category_pie.style.display = "block";

    // if (!funIncidentsCategory.initialized) {
    //   incident_category_pie.onclick = function (event) {

    //     if (clickedIncidentsCategory == true) {
    //       const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

    //       if (points.length) {
    //         const firstPoint = points[0];
    //         const label = myChart.data.labels[firstPoint.index];
    //         const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];


    //         console.log(`Clicked on ${label} with value ${value}`);

    //         document.getElementById("listItemLabelIncidentCategory").textContent = `Ticket: ${label}`;
    //         const backgroundColor = myChart.data.datasets[0].backgroundColor[firstPoint.index];




    //         myChart.update();

    //         console.log(backgroundColor);
    //         // document.getElementById("listItemValue").textContent = `Value: ${value}`;

    //         const dropdown = (document.getElementById("dataDropdown_incidentcategory"));
    //         dropdown.style.display = "none";

    //       }
    //       dataDropdown_incidentcategory.addEventListener("click", function (event) {
    //         const selectedOption = event.target.id;
    //         const firstPoint = points[0];
    //         const label = myChart.data.labels[firstPoint.index];
    //         const labelname = label;
    //         const backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
    //         console.log(selectedOption);


    //         if (selectedOption === "Tower" || "Primary_Category" || "Secondary_Category" || "Created_Date" || "Level_Wise" || "Reported_By'" && currentChartType === "pie") {
    //           let xhr_object = new XMLHttpRequest();
    //           xhr_object.open(
    //             "GET",
    //             getIncidentCategoryDrill +
    //             idLink +
    //             "&category=" +
    //             labelname +
    //             "&drilldown_by=" +
    //             selectedOption +
    //             "&from_date=" +
    //             globalDateFirst +
    //             "&to_date=" +
    //             globalDateSecond,
    //             true
    //           );

    //           console.log(
    //             getIncidentCategoryDrill +
    //             idLink +
    //             "&category=" +
    //             labelname +
    //             "&drilldown_by=" +
    //             selectedOption +
    //             "&from_date=" +
    //             globalDateFirst +
    //             "&to_date=" +
    //             globalDateSecond,
    //           );

    //           downloadCategoryWiseIncidentsLink = ip + "fm-excel-download/get-drill-down-for-card-incidentCategoryChart-excel-data/" + idLink +
    //           "&category=" +
    //           labelname +
    //             "&drilldown_by=" +
    //             selectedOption +
    //             "&from_date=" +
    //             globalDateFirst +
    //             "&to_date=" +
    //             globalDateSecond,


    //             xhr_object.onload = function () {
    //               resIncidentCategoryDrill = JSON.parse(this.responseText);
    //               console.log("Tickets Drill Down - ");
    //               console.log(resIncidentCategoryDrill);

    //               const labels = resIncidentCategoryDrill.response.map(item => item[1]);
    //               const data = resIncidentCategoryDrill.response.map(item => item[0]);


    //               myChart.destroy();
    //               myChart = new Chart(incident_category_pie, {
    //                 type: "bar",
    //                 data: {
    //                   labels: labels,
    //                   datasets: [{
    //                     label: "Data",
    //                     data: data,
    //                     backgroundColor: backgroundColors,
    //                   }]
    //                 },
    //                 options: {
    //                   responsive: true,
    //                   interaction: {
    //                     intersect: false,
    //                   },
    //                   scales: {
    //                     x: {
    //                       stacked: true,
    //                     },
    //                     y: {
    //                       stacked: true,
    //                     },
    //                   },
    //                   maintainAspectRatio: false,
    //                   scales: {
    //                     x: {
    //                     },
    //                   },
    //                   plugins: {
    //                     datalabels: {
    //                       color: "#000000",
    //                       anchor: "end",
    //                       align: "end",
    //                       offset: -6,
    //                       font: {
    //                         size: "10",
    //                         weight: "bold",
    //                       },
    //                       formatter: function (value, context) {
    //                         // Hide label if value is zero
    //                         return value === 0 ? '' : value;
    //                       }
    //                     },
    //                     legend: {
    //                       display: true,
    //                       position: "no",
    //                     },
    //                   },
    //                 },
    //                 plugins: [ChartDataLabels],
    //               });
    //               clickedIncidentsCategory = false;
    //             }

    //           xhr_object.send();
    //           funIncidentsCategory.initialized = true;
    //         }

    //         dataDropdown_incidentcategory.style.display = "none";
    //       });
    //     }


    //   };
    // }
    // refreshIconElement_incidentcategory.addEventListener("click", restoreOriginalChartTicket);

    // function restoreOriginalChartTicket() {
    //   if (originalChartConfigIncidentCategory) {
    //     myChart.destroy(); // Destroy the current chart
    //     myChart = new Chart(incident_category_pie, originalChartConfigIncidentCategory);
    //     clickedIncidentsCategory = true;
    //   }
    // }

    // refreshIconElement_categoryIncident


    refreshIconElement_categoryIncident.addEventListener("click", restoreOriginalChartTicket);

    function restoreOriginalChartTicket() {
      if (originalChartConfigIncidentCategory) {
        myChart.destroy(); // Destroy the current chart
        loaderIncidentCategory.style.display = "block";
        funIncidentsCategory();
      }
    }

  };
  xhr_object.send();

}

let clickedOccupancy = true;
function funOccupancy() {
  let occupancyNoData = document.getElementById("occupancyNoData");
  let Occupancy_sum = document.getElementById("Occupancy_sum");
  let loaderOccupancy = document.getElementById("loaderOccupancy");
  let occupancy = document.getElementById("occupancy");

  // loaderOccupancy.style.display = "block";
  // occupancyNoData.style.display = "none";

  // if (globalType == "daily") {
  //   occupancy.innerHTML = "Chart for " + globalDateFirst;
  // } else {
  //   occupancy.innerHTML =
  //     "Chart for " + globalDateFirst + " to " + globalDateSecond;
  // }

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getOccupancyChart + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getOccupancyChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
    console.log(
      getOccupancyChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object.onload = function () {
    resfunOccupancy = JSON.parse(this.responseText);
    console.log("Occupancy Summary - ");
    console.log(resfunOccupancy);

    // let nameOccupancy = Object.keys(resfunOccupancy.response);
    // Added Now
    originalChartConfig = {
      type: "bar",
      data: {
        labels: resfunOccupancy.response.Keys,
        datasets: [
          {
            scale: 10,
            scaleStartValue: 0,
            scaleStepWidth: 1,
            label: "Occupied",
            backgroundColor: ["#01c875"],
            data: resfunOccupancy.response.yes,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            scale: 10,
            scaleStartValue: 0,
            scaleStepWidth: 1,
            label: "Unoccupied",
            backgroundColor: [" #e2445b"],
            data: resfunOccupancy.response.no,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
            beginAtZero: true, // Start the y-axis at zero
            suggestedMax: 40 /// Set a suggested maximum value for the y-axis
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    }
    let myChart = new Chart(Occupancy_sum, originalChartConfig)
    loaderOccupancy.style.display = "none";

    if (resfunOccupancy.response.total == 0) {
      occupancyNoData.style.display = "block";
      Occupancy_sum.style.display = "none";
    } else {
      occupancyNoData.style.display = "none";
      Occupancy_sum.style.display = "block";
    }
    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let clickedOccupancy = true;
    let OccupancydrillDownLevel = 1;
    if (!funOccupancy.initialized) {
      Occupancy_sum.onclick = function (event) {

        if (clickedOccupancy == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);

            document.getElementById("listItemLabel").textContent = `Tower: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown"));
            dropdown.style.display = "block";


          }
          dataDropdown.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (OccupancydrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              label = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              labelname = label;
              console.log(selectedOption);

              // if (selectedOption === "Status" || "Flat" || "Flat_Type" || "Possession" || "Sold" || "Date_Of_Possession" && currentChartType === "bar") {


              let xhr_object = new XMLHttpRequest();
              let apiURL;
              apiURL =
                getTowerDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&tower_name=" +
                labelname +
                "&date=" +
                globalDateFirst,
                // "&to_date=" +
                // globalDateSecond,

                xhr_object.open("GET", apiURL, true);

              console.log(
                getTowerDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&tower_name=" +
                labelname +
                "&date=" +
                globalDateFirst,
                // "&to_date=" +
                // globalDateSecond,
                true
              );

              xhr_object.onload = function () {
                resTowerDrill = JSON.parse(this.responseText);
                console.log("Tower Drill Down - ");
                console.log(resTowerDrill);

                const labels = Object.keys(resTowerDrill.response);
                const datasets = [];
                const labelname = label;

                const statuses = ["Yes", "No", "Occupied", "Unoccupied"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  let backgroundColor;
                  if ((status === "Yes" || status === "Occupied")) {
                    backgroundColor = "#01c875"; // Set color for "Yes" and "Occupied"
                  } else if ((status === "No" || status === "Unoccupied")) {
                    backgroundColor = "#e2445b"; // Set color for "No" and other statuses
                  }
                  datasets.push({
                    label: status,
                    data: labels.map(label => resTowerDrill.response[label][status] || 0),
                    // backgroundColor: status === "Yes" ? "#01c875" : "#e2445b",
                    backgroundColor,
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };

                myChart.destroy();
                myChart = new Chart(Occupancy_sum, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                // clickedOccupancy = false;
              }

              xhr_object.send();
              OccupancydrillDownLevel = 2;
            }
            else if (OccupancydrillDownLevel === 2) {

              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);

              apiURL =
                getTowerDrillSec +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&tower_name=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              console.log("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadOccupancyLink = ip + "fm-excel-download/get-drill-down-for-occupancy/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&tower_name=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond,

                xhr_object.onload = function () {
                  resTowerDrill = JSON.parse(this.responseText);
                  console.log("Tower 2 Drill Down - ");
                  console.log(resTowerDrill);

                  const labels = Object.keys(resTowerDrill.response);
                  const datasets = [];

                  // const labelname = label;

                  // const statuses = ["Yes", "No"]; // Assuming these are the possible statuses

                  // for (const status of statuses) {
                  //   datasets.push({
                  //     label: status,
                  //     data: labels.map(label => resTowerDrill.response[label][status] || 0),
                  //     backgroundColor: status === "Yes" ? "#e2445b" : "#01c875",
                  //     stack: "0"
                  //   });
                  // }

                  const statuses = ["Yes", "No", "Occupied", "Unoccupied"]; // Assuming these are the possible statuses

                  for (const status of statuses) {
                    let backgroundColor;
                    if ((status === "Yes" || status === "Occupied")) {
                      backgroundColor = "#01c875"; // Set color for "Yes" and "Occupied"
                    } else if ((status === "No" || status === "Unoccupied")) {
                      backgroundColor = "#e2445b"; // Set color for "No" and other statuses
                    }
                    datasets.push({
                      label: status,
                      data: labels.map(label => resTowerDrill.response[label][status] || 0),
                      // backgroundColor: status === "Yes" ? "#01c875" : "#e2445b",
                      backgroundColor,
                      stack: "0"
                    });
                  }

                  const barData = {
                    labels: labels,
                    datasets: datasets,
                  };

                  myChart.destroy();
                  myChart = new Chart(Occupancy_sum, {
                    type: "bar",
                    data: barData,
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                          title: {
                            display: true,
                            text: labelname,
                            padding: {
                              top: 20,
                            }
                          }
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                  // clickedOccupancy =false;
                }

              xhr_object.send();
              OccupancydrillDownLevel = 3;
              clickedOccupancy = false;
              return;

            }
          }
          else {
            if(OccupancydrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown.style.display = "none";


          });
        } else if (clickedOccupancy == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }

    function restoreOriginalChart() {
      if (originalChartConfig) {
        myChart.destroy(); // Destroy the current chart
        funOccupancy();
        clickedOccupancy = true;

      }
    }

    refreshIconElement.addEventListener("click", restoreOriginalChart);
  };

  xhr_object.send();
}

function funDeliveryVisitor() {
  let DeliveryNoData = document.getElementById("DeliveryNoData");
  let deliveryVisitor = document.getElementById("deliveryVisitor");
  let loaderDelivery = document.getElementById("loaderDelivery");


  // loaderDelivery.style.display = "block";
  // DeliveryNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getDeliveryVisitor + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getDeliveryVisitor +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
    console.log(
      getDeliveryVisitor +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunDeliveryVisitor = JSON.parse(this.responseText);
    console.log("Delivery Visitors - ");
    console.log(resfunDeliveryVisitor);
    // Added now
    originalChartConfigVisitors = {
      type: "bar",
      data: {
        labels: Object.keys(resfunDeliveryVisitor.response),
        datasets: [
          {
            // label: Object.keys(resfunDeliveryVisitor.response),
            backgroundColor: ["#01c875"],
            data: Object.values(resfunDeliveryVisitor.response),
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }

    let myChart = new Chart(deliveryVisitor, originalChartConfigVisitors)
    loaderDelivery.style.display = "none";

    if (resfunDeliveryVisitor.response == 0) {
      DeliveryNoData.style.display = "block";
      deliveryVisitor.style.display = "none";
    } else {
      DeliveryNoData.style.display = "none";
      deliveryVisitor.style.display = "block";
    }

    let clickedDeliveryVisitor = true;
    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let visitorsDeliverydrillDownLevel = 1;
    if (!funDeliveryVisitor.initialized) {
      deliveryVisitor.onclick = function (event) {

        if (clickedDeliveryVisitor == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelVisitors").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_visitors"));
            dropdown.style.display = "block";


          }

          dataDropdown_visitors.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            if (visitorsDeliverydrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getVisitorsDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&visitor=" +
                labelname +
                "&date=" +
                globalDateFirst,
                // "&to_date=" +
                // globalDateSecond,

                xhr_object.open("GET", apiURL, true);

              downloadDeliveryVisitorLink = ip + "fm-excel-download/get-drill-down-for-visitors/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&visitor=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;


              xhr_object.onload = function () {
                resVisitorsDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resVisitorsDrill);

                const labels = resVisitorsDrill.response.map(item => item[0]);
                const dataValues = resVisitorsDrill.response.map(item => item[1]);
                // const labelname = label;

                myChart.destroy();
                myChart = new Chart(deliveryVisitor, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: 'Data Values',
                      data: dataValues,
                      backgroundColor: [
                        "#77216F",
                        "#01C875",
                        "#E2445B",
                        "#E95420",
                        "#A1CD7A",
                      ],
                      borderColor: 'rgba(75, 192, 192, 1)',
                      borderWidth: 1
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
              }
              xhr_object.send();
              visitorsDeliverydrillDownLevel = 2;
            }
            else if (visitorsDeliverydrillDownLevel === 2) {
              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);

              apiURL =
                getVisitorsDrillSecond +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&visitor=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);


              downloadDeliveryVisitorLink = ip + "fm-excel-download/get-drill-down-for-visitors/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&visitor=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst;

              xhr_object.onload = function () {
                resVisitorsDrill = JSON.parse(this.responseText);
                console.log("Ticket Category Drill Down - ");
                console.log(resVisitorsDrill);

                const labels = resVisitorsDrill.response.map(item => item[0]);
                const dataValues = resVisitorsDrill.response.map(item => item[1]);
                // const labelname = label;

                myChart.destroy();
                myChart = new Chart(deliveryVisitor, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: 'Data Values',
                      data: dataValues,
                      backgroundColor: [
                        "#77216F",
                        "#01C875",
                        "#E2445B",
                        "#E95420",
                        "#A1CD7A",
                      ],
                      borderColor: 'rgba(75, 192, 192, 1)',
                      borderWidth: 1
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                          padding: {
                            top: 20,
                          }
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
              }
              xhr_object.send();
              visitorsDeliverydrillDownLevel = 3;
              clickedDeliveryVisitor = false;
              return;
            }
          }
          else {
            if(visitorsDeliverydrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_visitors.style.display = "none";


          });
        } else if (clickedDeliveryVisitor == false) {
          alert("You have reached the maximum drill-down level.");
        }





      };
    }

    function restoreOriginalChart() {
      if (originalChartConfigVisitors) {
        myChart.destroy(); // Destroy the current chart
        funDeliveryVisitor();
        clickedDeliveryVisitor = true;

      }
    }

    refreshIconElement_visitors.addEventListener("click", restoreOriginalChart);


  };
  xhr_object.send();
}

function funFitout() {
  let FitoutNoData = document.getElementById("FitoutNoData");
  let loaderFitout = document.getElementById("loaderFitout");
  let tblFitout = document.getElementById("tblFitout");
  let tablebodyFitout = document.getElementById("tablebodyFitout");

  tblFitout.style.display = "none";
  loaderFitout.style.display = "block";
  FitoutNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getFitout
      +idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getFitout +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunFitout = JSON.parse(this.responseText);

    console.log(resfunFitout.response);

    console.log(getFitout + idLink);

    let resfunFitoutArray = resfunFitout.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunFitoutArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        // `<td>` +
        // index +
        // `</td>` +
        `<td style="text-align: left;">` +
        resfunFitoutArray[x][0] +
        `</td>` +
        `<td style="text-align: left;">` +
        resfunFitoutArray[x][1] +
        `</td>` +
        `<td style="text-align: left;">` +
        resfunFitoutArray[x][2] +
        `</td>` +

        `<td style="text-align: left;">` +
        resfunFitoutArray[x][4] +
        `</td>` +
        `<td style="text-align: left;">` +
        resfunFitoutArray[x][5] +
        `</td>` +
        `<td style="text-align: left;">` +
        resfunFitoutArray[x][6] +
        `</td>`;
      allDetails = allDetails + `</tr>`;
    }
    tablebodyFitout.innerHTML = allDetails;

    loaderFitout.style.display = "none";
    if (resfunFitout.length == 0) {
      FitoutNoData.style.display = "block";
      tblFitout.style.display = "none";
    } else {
      FitoutNoData.style.display = "none";
      tblFitout.style.display = "inline-table";
    }
    // // infoFitOutTableIcon, FitOutTableDiv,  closeFitOutTable,   FitOutTableInfo
    // infoFitOutTableIcon.addEventListener("click", InfoModal);
    // let FitOutTableDiv = document.getElementById('FitOutTableDiv');
    // let closeFitOutTable = document.getElementById('closeFitOutTable');
    // function InfoModal(event) {
    //   event.stopPropagation();
    //   FitOutTableDiv.style.display = "block";
    //   if (resfunFitout.info) {
    //     let FitOutTableInfo = document.getElementById("FitOutTableInfo");
    //     let FitOutTableInfo2 = document.getElementById("FitOutTableInfo2");


    //     FitOutTableInfo.innerHTML = "<b>Formula :</b> " + resfunFitout.info.formula;
    //     FitOutTableInfo2.innerHTML = "<b>Info  : </b>" + resfunFitout.info.info;
    //     // $('#infoModal').modal('show');
    //   } else {
    //     console.error("Formula not found in response info.");
    //   }
    // }
    // document.addEventListener("click", function (event) {
    //   if (!FitOutTableDiv.contains(event.target) && event.target.id !== 'infoFitOutTableIcon') {
    //     closeFitOutTableDiv();
    //   }
    // });
    // closeFitOutTable.addEventListener("click", closeFitOutTableDiv);
    // function closeFitOutTableDiv() {
    //   FitOutTableDiv.style.display = "none";
    // }
    // // Stop propagation to prevent the document click event from firing when clicking inside the dropdown
    // FitOutTableDiv.addEventListener("click", function (event) {
    //   event.stopPropagation();
    // });

    function restoreOriginal() {
      funFitout()
    }

    refreshIconElementActiveFitout.addEventListener("click", restoreOriginal);




  };
  xhr_object.send();
}

function Refresh_a61() {
  let fitoutUnoccupiedFlats = document.getElementById("fitoutUnoccupiedFlats");
  let fitoutOccupiedFlats = document.getElementById("fitoutOccupiedFlats");
  let loader = document.getElementById("loader_a61");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    fitoutUnoccupiedFlats.innerHTML = "";
    fitoutOccupiedFlats.innerHTML = "";

    let xhr_object1 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object1.open(
        "GET",
        getFitoutOccupiedUnoccupied + idLink + "&date=" + globalDateFirst,
        true
      );
      console.log(
        getFitoutOccupiedUnoccupied + idLink + "&date=" + globalDateFirst
      );
    } else {
      xhr_object1.open(
        "GET",
        getFitoutOccupiedUnoccupied +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getFitoutOccupiedUnoccupied +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object1.onload = function () {
      resFunoccupency1 = JSON.parse(this.responseText);
      console.log("fitout occupency ++++++++++++============================================================================1 - ");
      console.log(resFunoccupency1);

      // Check if response exists and if it's greater than 0 hours
      if ( resFunoccupency1.response !== null && parseFloat(resFunoccupency1.response) > 0) {
        fitoutUnoccupiedFlats.innerHTML = resFunoccupency1.response.unoccupied_count;
        fitoutOccupiedFlats.innerHTML = resFunoccupency1.response.occupied_count;
      } else {
        fitoutUnoccupiedFlats.innerHTML = "No data available";
        fitoutOccupiedFlats.innerHTML = "No data available";
        fitoutUnoccupiedFlats.style.fontSize = "30px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object1.send();

  }

  fetchData();

}



function Refresh_a61FitOut() {
  let ftFitoutFlats = document.getElementById("ftFitoutFlats");
  let loader = document.getElementById("loader_a61FitOut");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    ftFitoutFlats.innerHTML = "";

    let xhr_object2 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object2.open(
        "GET",
        getFtFitoutFlat + idLink + "&date=" + globalDateFirst,
        true
      );
      console.log(getFtFitoutFlat + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object2.open(
        "GET",
        getFtFitoutFlat +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getFtFitoutFlat +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object2.onload = function () {
      resfunFtFitout2 = JSON.parse(this.responseText);
      console.log("Ft fitout flat 2 - ");
      console.log(resfunFtFitout2);
      // Check if response exists and if it's greater than 0 hours
      if (resfunFtFitout2.response && parseFloat(resfunFtFitout2.response) > 0) {
        ftFitoutFlats.innerHTML =
          resfunFtFitout2.response + "";

      } else {
        ftFitoutFlats.innerHTML = "No data available";
        ftFitoutFlats.style.fontSize = "30px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object2.send();

  }

  fetchData();

}

function funFacilityInfo() {
  let facilityinfoNoData = document.getElementById("facilityinfoNoData");
  let tblfacilityinfo = document.getElementById("tblfacilityinfo");
  let tablebodyfacilityinfo = document.getElementById("tablebodyfacilityinfo");
  let loaderfacilityinfo = document.getElementById("loaderfacilityinfo");

  // tblfacilityinfo.style.display = "none";
  // loaderfacilityinfo.style.display = "block";
  // facilityinfoNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getFacilityInfo + idLink +  "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getFacilityInfo +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunFacilityInfo = JSON.parse(this.responseText);
    console.log("Facility Info - ");
    console.log(resfunFacilityInfo);

    let resfunFacilityInfoArray = resfunFacilityInfo.facilities_info;
    let allDetails = '';

    for (let index = 0; index < resfunFacilityInfoArray.length; index++) {
      let facilityName = resfunFacilityInfoArray[index].facility_name;
      let bookingCount = resfunFacilityInfoArray[index].booking_count;
      let bookingBy = resfunFacilityInfoArray[index].booked_by;
      let bookingStatus = resfunFacilityInfoArray[index].booking_status;
      let tower = resfunFacilityInfoArray[index].tower;
      // let flat = resfunFacilityInfoArray[index].flat;
      let scheduleDate = resfunFacilityInfoArray[index].schedule_date;
      let scheduleslot = resfunFacilityInfoArray[index].schedule_slot;


      allDetails +=
        `<tr>` +
        `<td>` + (index + 1) + `</td>` +
        `<td>` + facilityName + `</td>` +
        // `<td>` + bookingCount + `</td>` +
        `<td>` + bookingBy + `</td>` +
        `<td>` + bookingStatus + `</td>` +
        `<td>` + tower + `</td>` +
        // `<td>` + flat + `</td>` +
        `<td>` + scheduleDate + `</td>` +
        `<td>` + scheduleslot + `</td>` +
        `</tr>`;
    }
    tablebodyfacilityinfo.innerHTML = allDetails;

    loaderfacilityinfo.style.display = "none";
    if (resfunFacilityInfoArray.length == 0) {
      facilityinfoNoData.style.display = "block";
      tblfacilityinfo.style.display = "none";
    } else {
      facilityinfoNoData.style.display = "none";
      tblfacilityinfo.style.display = "table"; // Use "table" instead of "inline-table"
    }
    // refreshIconElement_FacilitiesInfo

    refreshIconElement_FacilitiesInfo.addEventListener("click", restoreOriginalChart);

    function restoreOriginalChart() {
      loaderfacilityinfo.style.display = "block";
      tblfacilityinfo.style.display = "none";
      funFacilityInfo();
    }
  };
  xhr_object.send();
}
function funChecklist() {
  let ChecklistNoData = document.getElementById("ChecklistNoData");
  let Checklist = document.getElementById("Checklist");
  let loaderChecklist = document.getElementById("loaderChecklist");


  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getChecklist + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getChecklist +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
  console.log(
    getTicketsChart +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );

  // xhr_object.onload = function () {
  //   resfunChecklist = JSON.parse(this.responseText);

  //   console.log("CheckList - ");
  //   console.log(resfunChecklist);

  //   let responseCLosed = [], responseOpen = [], responseWIP = []; responseOverdue = [];

  //   let valuesResponses = Object.values(resfunChecklist.response);

  //   for (let i = 0; i < valuesResponses.length; i += 1) {
  //     responseCLosed[i] = valuesResponses[i].closed;
  //     responseOpen[i] = valuesResponses[i].open;
  //     responseWIP[i] = valuesResponses[i].work_in_progress;
  //     responseOverdue[i] = valuesResponses[i].overdue;
  //   }

  //   let xLabelsArray = Object.keys(resfunChecklist.response);

  //   for (let i = 0; i < xLabelsArray.length; i += 1) {
  //     xLabelsArray[i] = xLabelsArray[i].split(" ");
  //   }

  //   new Chart(Checklist, {
  //     type: "bar",
  //     data: {
  //       labels: xLabelsArray,
  //       datasets: [
  //         {
  //           label: "Closed",
  //           backgroundColor: "#67c801",
  //           data: responseCLosed,
  //           barThickness: 70,
  //           borderWidth: 1,
  //         },
  //         {
  //           label: "Open",
  //           backgroundColor: "#5E2750",
  //           data: responseOpen,
  //           barThickness: 70,
  //           borderWidth: 1,
  //         },
  //         {
  //           label: "Work In Progress",
  //           backgroundColor: "#01C875",
  //           data: responseWIP,
  //           barThickness: 70,
  //           borderWidth: 1,
  //         },
  //         {
  //           label: "Overdue",
  //           backgroundColor: "#FF5F1F",
  //           data: responseOverdue,
  //           barThickness: 70,
  //           borderWidth: 1,
  //         },
  //       ],
  //     },
  //     options: {
  //       tooltips: {
  //         displayColors: true,
  //         callbacks: {
  //           mode: 'x',
  //         },
  //       },
  //       scales: {
  //         xAxes: {
  //           stacked: true,
  //           gridLines: {
  //             display: false,
  //           }
  //         },
  //         yAxes: {
  //           stacked: true,
  //           ticks: {
  //             beginAtZero: true,
  //           },
  //           type: 'linear',
  //         }
  //       },
  //       responsive: true,
  //       maintainAspectRatio: false,
  //       plugins: {
  //         datalabels: {
  //           color: "#000000",
  //           anchor: "end",
  //           align: "end",
  //           offset: -6,
  //           font: {
  //             size: "10",
  //             weight: 'bold'
  //           }
  //         },
  //         legend: {
  //           display: true,
  //           position: "bottom",
  //         },
  //       },
  //     },
  //     plugins: [ChartDataLabels],
  //   });

  //   loaderChecklist.style.display = "none";

  //   // if (resfunChartTicket.response == 0) {
  //   //   ChecklistNoData.style.display = "block";
  //   //   Checklist.style.display = "none";
  //   // } else {
  //   // ChecklistNoData.style.display = "none";
  //   Checklist.style.display = "block";
  //   // }
  // };

  // xhr_object.send();


  xhr_object.onload = function () {
    resfunChecklist = JSON.parse(this.responseText);

    console.log("CheckList - ");
    console.log(resfunChecklist);

    const labels = Object.keys(resfunChecklist.response.Checklist);
    const data = Object.values(resfunChecklist.response.Checklist);

    // let responseCLosed = [], responseOpen = [], responseWIP = [], responseOverdue = [];

    // responseCLosed.push(resfunChecklist.response.Checklist.closed);
    // responseOpen.push(resfunChecklist.response.Checklist.open);
    // responseWIP.push(resfunChecklist.response.Checklist.work_in_progress);
    // responseOverdue.push(resfunChecklist.response.Checklist.overdue);

    // let xLabelsArray = ["Checklist"];

    originalChartConfigChecklist = {
      type: "bar",
      // data: {
      //   labels: xLabelsArray,
      //   datasets: [
      //     {
      //       label: "Closed",
      //       backgroundColor: "#67c801",
      //       data: responseCLosed,
      //       barThickness: 20,
      //       borderWidth: 1,
      //     },
      //     {
      //       label: "Open",
      //       backgroundColor: "#5E2750",
      //       data: responseOpen,
      //       barThickness: 20,
      //       borderWidth: 1,
      //     },
      //     {
      //       label: "Work In Progress",
      //       backgroundColor: "#01C875",
      //       data: responseWIP,
      //       barThickness: 20,
      //       borderWidth: 1,
      //     },
      //     {
      //       label: "Overdue",
      //       backgroundColor: "#FF5F1F",
      //       data: responseOverdue,
      //       barThickness: 20,
      //       borderWidth: 1,
      //     },
      //   ],
      // },

      data: {
        labels: labels,
        datasets: [
          {
            label: " Checklist",
            backgroundColor: ["#67c801", "#5E2750", "#01C875", "#FF5F1F"],
            data: data,
            borderWidth: 1,
            stack: "Stack 0",
          }
        ],
      },


      options: {
        tooltips: {
          displayColors: true,
          callbacks: {
            mode: 'x',
          },
        },
        scales: {
          xAxes: [{
            stacked: false,
            gridLines: {
              display: false,
            }
          }],
          yAxes: [{
            stacked: false,
            ticks: {
              beginAtZero: true,
            },
            type: 'linear',
          }]
        },
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },
          legend: {
            labels: {
              generateLabels: function (chart) {
                const data = chart.data;
                if (data.labels.length && data.datasets.length) {
                  return data.labels.map((label, i) => ({
                    text: label,
                    fillStyle: data.datasets[0].backgroundColor[i],
                    hidden: false,
                    lineCap: 'butt',
                    lineDash: [],
                    lineDashOffset: 0,
                    lineJoin: 'miter',
                    lineWidth: 0,
                    strokeStyle: 'rgba(0,0,0,0)',
                    // Custom legend item with rectangle point style
                    pointStyle: 'rect',
                    rotation: 0
                  }));
                }
                return [];
              }
            },
            display: true,
            position: "bottom",
            align: "center"
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(Checklist, originalChartConfigChecklist)


    loaderChecklist.style.display = "none";

    // if (resfunChartTicket.response == 0) {
    //   ChecklistNoData.style.display = "block";
    //   Checklist.style.display = "none";
    // } else {
    // ChecklistNoData.style.display = "none";
    Checklist.style.display = "block";
    // }

    // refreshIconElement_checklist

    function restoreOriginalChartChecklist() {

      if (originalChartConfigChecklist) {
        myChart.destroy();
        funChecklist();
      }
    }

    refreshIconElement_checklist.addEventListener("click", restoreOriginalChartChecklist);
  };

  xhr_object.send();



}


function funCardDieselNot() {
  let cardDieselNot = document.getElementById("cardDieselNot");
  let xhr_object = new XMLHttpRequest();
  // xhr_object.open("GET", getCustomerAverage + idLink, true);

  if (globalType == "daily") {
    xhr_object.open("GET", getcardDieselNot + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getcardDieselNot + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

  xhr_object.onload = function () {
    resfunCardDieselNot = JSON.parse(this.responseText);
    console.log("Total Diesel Non Cosumption - ");
    console.log(resfunCardDieselNot);
    cardDieselNot.innerHTML = resfunCardDieselNot.response + "";
  };
  xhr_object.send();
}

function funCardWaterNot() {
  let cardWaterNot = document.getElementById("cardWaterNot");
  let xhr_object = new XMLHttpRequest();
  // xhr_object.open("GET", getCustomerAverage + idLink, true);

  if (globalType == "daily") {
    xhr_object.open("GET", getcardWaterNot + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getcardWaterNot + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

  xhr_object.onload = function () {
    resfunCardWaterNot = JSON.parse(this.responseText);
    console.log("Total Diesel Non Cosumption - ");
    console.log(resfunCardWaterNot);
    cardWaterNot.innerHTML = resfunCardWaterNot.response + "";
  };
  xhr_object.send();
}

function funManPower() {
  let ManPowerNoData = document.getElementById("ManPowerNoData");
  let loaderManPower = document.getElementById("loaderManPower");
  let tblManPowerinfo = document.getElementById("tblManPowerinfo");
  let tablebodyManPower = document.getElementById("tablebodyManPower");

  // tblManPowerinfo.style.display = "none";
  // loaderManPower.style.display = "block";
  // ManPowerNoData.style.display = "none";

  // getIncidentManPower
  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getIncidentManPower
      +idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getIncidentManPower +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunManPower = JSON.parse(this.responseText);
    console.log("ManPower - 1");
    console.log(resfunManPower.response);
    console.log("ManPower - 1-------------------================------------");
    console.log(getIncidentManPower + idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond);

    let resfunManPowerArray = resfunManPower.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunManPowerArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        // `<td>` +
        // index +
        // `</td>` +
        `<td>` +
        resfunManPowerArray[x][0] +
        `</td>` +
        `<td>` +
        resfunManPowerArray[x][1] +
        `</td>`;
      // `<td>` +
      // resfunManPowerArray[x][2] +
      // `</td>` +
      // `<td>` +
      // resfunManPowerArray[x][3] +
      // `</td>`;
      allDetails = allDetails + `</tr>`;
    }
    tablebodyManPower.innerHTML = allDetails;

    loaderManPower.style.display = "none";
    if (resfunManPower.length == 0) {
      ManPowerNoData.style.display = "block";
      tblManPowerinfo.style.display = "none";
    } else {
      ManPowerNoData.style.display = "none";
      tblManPowerinfo.style.display = "inline-table";
    }
    // refreshIconElement_manPower

    refreshIconElement_manPower.addEventListener("click", restoreOriginalChartManpower);

    function restoreOriginalChartManpower() {
      loaderManPower.style.display = "block";
      tblManPowerinfo.style.display = "none";
      funManPower();
    }

  };
  xhr_object.send();
}

function funRCA() {
  let RCANoData = document.getElementById("RCANoData");
  let tblRCAinfo = document.getElementById("tblRCAinfo");
  let tablebodyRCA = document.getElementById("tablebodyRCA");
  let loaderRCA = document.getElementById("loaderRCA");

  // tblRCAinfo.style.display = "none";
  // loaderRCA.style.display = "block";
  // RCANoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getIncidentsRCATable + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getIncidentsRCATable +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  // console.log("RCA -1 ");
  // console.log(resfunRCA.response);
  xhr_object.onload = function () {
    resfunRCA = JSON.parse(this.responseText);
    console.log("RCA - 1");
    console.log(resfunRCA);

    console.log(getIncidentsRCATable + idLink);

    let resfunRCAArray = resfunRCA.response;
    allDetails = ``;
    var index = 0;

    for (let x in resfunRCAArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][0] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][1] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][2] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][3] +
        `</td>`;

      if (resfunRCAArray[x][4] < 0 || resfunRCAArray[x][4] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][4] + `</td>`;
      }
      // `<td>` +
      // resfunRCAArray[x][5] +
      // `</td>`
      if (resfunRCAArray[x][5] < 0 || resfunRCAArray[x][5] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][5] + `</td>`;
      }
      if (resfunRCAArray[x][6] < 0 || resfunRCAArray[x][6] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][6] + `</td>`;
      }
      if (resfunRCAArray[x][7] < 0 || resfunRCAArray[x][7] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][7] + `</td>`;
      }

      if (resfunRCAArray[x][13] < 0 || resfunRCAArray[x][13] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][13] + `</td>`;
      }

      if (resfunRCAArray[x][8] < 0 || resfunRCAArray[x][8] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][8] + `</td>`;
      }

      if (resfunRCAArray[x][9] < 0 || resfunRCAArray[x][9] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][9] + `</td>`;
      }
      if (resfunRCAArray[x][10] < 0 || resfunRCAArray[x][10] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][10] + `</td>`;
      }
      if (resfunRCAArray[x][11] < 0 || resfunRCAArray[x][11] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][11] + `</td>`;
      }
      if (resfunRCAArray[x][12] < 0 || resfunRCAArray[x][12] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][12] + `</td>`;
      }

      allDetails = allDetails + `</tr>`;
    }
    tablebodyRCA.innerHTML = allDetails;

    loaderRCA.style.display = "none";
    if (resfunRCAArray.length == 0) {
      RCANoData.style.display = "block";
      tblRCAinfo.style.display = "none";
    } else {
      RCANoData.style.display = "none";
      tblRCAinfo.style.display = "block";
    }

    // refreshIconElement_incidentSummary


    function restoreOriginalChartIncident() {
        loaderRCA.style.display = "block";
        funRCA();
    }

    refreshIconElement_incidentSummary.addEventListener("click", restoreOriginalChartIncident);
  };
  xhr_object.send();
}

function funGetSafeManHours() {
  let cardSafeManHours = document.getElementById("cardSafeManHours");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getSafeManHours + idLink + "&date=" + globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunGetSafeManHours = JSON.parse(this.responseText);
    console.log("Safe Man Hours - ");
    console.log(resfunGetSafeManHours);
    cardSafeManHours.innerHTML = resfunGetSafeManHours.response + "";
  };
  xhr_object.send();
}

function funAssetsBreakdown() {
  let assetsBreakdownNoData = document.getElementById("assetsBreakdownNoData");
  let tblAssetsBreakdowninfo = document.getElementById(
    "tblAssetsBreakdowninfo"
  );
  let tablebodyAssetsBreakdown = document.getElementById(
    "tablebodyAssetsBreakdown"
  );
  // let loaderAssetsBreakdown = document.getElementById("loaderAssetsBreakdown");

  // tblAssetsBreakdowninfo.style.display = "none";
  // loaderAssetsBreakdown.style.display = "block";
  // assetsBreakdownNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getAssetsBreakdown + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getAssetsBreakdown +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunAssetsBreakdown = JSON.parse(this.responseText);
    console.log("AssetsBreakdown - ");
    console.log(resfunAssetsBreakdown);

    let resfunAssetsBreakdownArray = resfunAssetsBreakdown.response.values;
    allDetails = ``;
    var index = 0;

    for (let x in resfunAssetsBreakdownArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][0] +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][1] +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][2] +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][3] +
        `</td>`;

      if (
        resfunAssetsBreakdownArray[x][4] < 0 ||
        resfunAssetsBreakdownArray[x][4] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails + `<td>` + resfunAssetsBreakdownArray[x][4] + `</td>`;
      }

      if (
        resfunAssetsBreakdownArray[x][5] < 0 ||
        resfunAssetsBreakdownArray[x][5] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails + `<td>` + resfunAssetsBreakdownArray[x][5] + `</td>`;
      }
      allDetails = allDetails + `</tr>`;
    }
    tablebodyAssetsBreakdown.innerHTML = allDetails;

    loaderAssetsBreakdown.style.display = "none";
    if (resfunAssetsBreakdownArray.length == 0) {
      assetsBreakdownNoData.style.display = "block";
      tblAssetsBreakdowninfo.style.display = "none";
    } else {
      assetsBreakdownNoData.style.display = "none";
      tblAssetsBreakdowninfo.style.display = "block";
    }
  };
  xhr_object.send();
}


function funExecutiveEscalation() {
  let executiveEscalationNoData = document.getElementById("executiveEscalationNoData");
  let tblExecutiveEscalationinfo = document.getElementById(
    "tblExecutiveEscalationinfo"
  );
  let tablebodyExecutiveEscalation = document.getElementById(
    "tablebodyExecutiveEscalation"
  );
  let loaderExecutiveEscalation = document.getElementById("loaderExecutiveEscalation");

  // tblExecutiveEscalationinfo.style.display = "none";
  // loaderExecutiveEscalation.style.display = "block";
  // executiveEscalationNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getExecutiveEscalation + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getExecutiveEscalation +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunExecutiveEscalation = JSON.parse(this.responseText);
    console.log("Executive Escalation - ");
    console.log(resfunExecutiveEscalation);

    let resfunExecutiveEscalationArray = resfunExecutiveEscalation.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunExecutiveEscalationArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        // `<td>` +
        // index +
        // `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][0] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][1] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][2] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][3] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][4] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][5] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][6] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][8] +
        `</td>`;

      allDetails = allDetails + `</tr>`;
    }
    tablebodyExecutiveEscalation.innerHTML = allDetails;

    loaderExecutiveEscalation.style.display = "none";
    if (resfunExecutiveEscalationArray.length == 0) {
      executiveEscalationNoData.style.display = "block";
      tblExecutiveEscalationinfo.style.display = "none";
    } else {
      executiveEscalationNoData.style.display = "none";
      tblExecutiveEscalationinfo.style.display = "inline-table";
    }

    // refreshIconElement_executive

    function restoreOriginalChartExecutive() {
      loaderExecutiveEscalation.style.display = "block";
      funExecutiveEscalation();
    }

    refreshIconElement_executive.addEventListener("click", restoreOriginalChartExecutive);
  };
  xhr_object.send();
}


let clickedPyramid = true;
function funPyramid(type, firstDate, secondDate) {
  let chartPyramidNoData = document.getElementById("chartPyramidNoData");
  let chartPyramid = document.getElementById("chartPyramid");
  let loaderPyramid = document.getElementById("loaderPyramid");
  let pyr = document.getElementById("pyr");

  // chartPyramid.style.display = "none";
  // loaderPyramid.style.display = "block";
  // chartPyramidNoData.style.display = "none";
  console.log(resfunPyramid);

  // if (globalType == "daily") {
  //   pyr.innerHTML = "  Level Wise Incident " + globalDateFirst;
  // } else {
  //   pyr.innerHTML = " Level Wise Incident " + globalDateFirst + " to " + globalDateSecond;
  // }

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getPyramid + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(getPyramid + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getPyramid +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    // console.log(
    //   getPyramid + idLink + "&from_date=" + firstDate + "&to_date=" + secondDate
    // );
  }

  xhr_object.onload = function () {
    resfunPyramid = JSON.parse(this.responseText);

    // let valueChartName = Object.keys(resfunPyramid.response);
    // let valueChartY = Object.values(resfunPyramid.response);
    const valueChartName = Object.keys(resfunPyramid.response);
    const valueChartY = Object.values(resfunPyramid.response);

    console.log("Pyramid- ");
    console.log(resfunPyramid);
    console.log(valueChartName);
    originalChartConfigIncidentLevel = {
      type: "bar",
      data: {
        labels: valueChartName,
        datasets: [
          {
            // label:"Incident",
            data: valueChartY,
            axis: "y",
            fill: true,
            backgroundColor: ["#D44B52", "#F69380", "#FDAB3D", "#01C875"],
            borderWidth: 1,
          },
        ],
      },
      options: {
        indexAxis: "y",
        responsive: true,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            labels: {
              generateLabels: function (chart) {
                const data = chart.data;
                if (data.labels.length && data.datasets.length) {
                  return data.labels.map((label, i) => ({
                    text: label,
                    fillStyle: data.datasets[0].backgroundColor[i],
                    hidden: false,
                    lineCap: 'butt',
                    lineDash: [],
                    lineDashOffset: 0,
                    lineJoin: 'miter',
                    lineWidth: 0,
                    strokeStyle: 'rgba(0,0,0,0)',
                    // Custom legend item with rectangle point style
                    pointStyle: 'rect',
                    rotation: 0
                  }));
                }
                return [];
              }
            },
            display: true,
            position: "bottom",
            align: "center"
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    
    
    let myChart = new Chart(chartPyramid, originalChartConfigIncidentLevel)
    loaderPyramid.style.display = "none";
    if (resfunPyramid.response == 0) {
      chartPyramidNoData.style.display = "block";
      chartPyramid.style.display = "none";
    } else {
      chartPyramidNoData.style.display = "none";
      chartPyramid.style.display = "block";
    }

    // refreshIconElement_levelIncidents


    function restoreOriginalChartIncident() {

      if (originalChartConfigIncidentLevel) {
        myChart.destroy();
        funPyramid();
      }
    }

    refreshIconElement_levelIncidents.addEventListener("click", restoreOriginalChartIncident);

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let clickedPyramid = true;
    let IncidentWisedrillDownLevel = 1;

    if (!funPyramid.initialized) {
      chartPyramid.onclick = function (event) {

        if (clickedPyramid == false) {

          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            label = myChart.data.labels[firstPoint.index];
            value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelIncidentLevel").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            const dropdown = (document.getElementById("dataDropdown_incidentlevel"));
            dropdown.style.display = "block";
            console.log(backgroundColors);
          }

          dataDropdown_incidentlevel.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
              if (IncidentWisedrillDownLevel === 1) {
                selectedOption = event.target.id;
                firstPoint = points[0];
                label = myChart.data.labels[firstPoint.index];
                labelname = label;
                backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
                console.log(selectedOption);


                let xhr_object = new XMLHttpRequest();
                let apiURL;

                apiURL =
                  getIncidentLevelDrillSecond +
                  idLink +
                  "&level=" +
                  labelname +
                  "&first_drilldown_by=" +
                  selectedOption +
                  "&sec_drill_down_on=" +
                  "" +
                  "&sec_drilldown_by=" +
                  "" +
                  "&from_date=" +
                  globalDateFirst +
                  "&to_date=" +
                  globalDateSecond;

                xhr_object.open("GET", apiURL, true);

                downloadPyramidLink = ip + "fm-excel-download/get-drill-down-for-levelWiseIncidents/" + idLink +
                  "&first_drilldown_by=" +
                  selectedOption +
                  "&level=" +
                  labelname +
                  "&sec_drill_down_on=" +
                  "" +
                  "&sec_drilldown_by=" +
                  "" +
                  "&from_date=" +
                  globalDateFirst +
                  "&to_date=" +
                  globalDateSecond;



                xhr_object.onload = function () {
                  resIncidentLevelDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - 1");
                  console.log(resIncidentLevelDrill);

                  const labels = resIncidentLevelDrill.response.map(item => item[1]);
                  const data = resIncidentLevelDrill.response.map(item => item[0]);


                  myChart.destroy();
                  myChart = new Chart(chartPyramid, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: backgroundColors,
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                }

                xhr_object.send();
                IncidentWisedrillDownLevel = 2;
              }
              else if (IncidentWisedrillDownLevel === 2) {
                // alert(selectedOption);
                // alert(labelname);
                // alert(selectedlabelValue);
                const firstPoint = points[0];
                // alert(firstPoint.index);
                const selectedSecondOption = event.target.id;
                const labelSecond = myChart.data.labels[firstPoint.index];
                const labelnameSecond = labelSecond;
                backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
                console.log(selectedSecondOption);
                console.log(selectedlabelValue);
                // console.log(backgroundColors);

                apiURL =
                  getIncidentLevelDrillSecond +
                  idLink +
                  "&level=" +
                  labelname +
                  "&first_drilldown_by=" +
                  selectedOption +
                  "&sec_drill_down_on=" +
                  selectedlabelValue +
                  "&sec_drilldown_by=" +
                  selectedSecondOption +
                  "&from_date=" +
                  globalDateFirst +
                  "&to_date=" +
                  globalDateSecond;
                // alert("second drill down api");
                console.log(apiURL);

                xhr_object.open("GET", apiURL, true);

                downloadPyramidLink = ip + "fm-excel-download/get-drill-down-for-levelWiseIncidents/" + idLink +
                  "&first_drilldown_by=" +
                  selectedOption +
                  "&level=" +
                  labelname +
                  "&sec_drilldown_by=" +
                  selectedSecondOption +
                  "&sec_drill_down_on=" +
                  selectedlabelValue +
                  "&from_date=" +
                  globalDateFirst +
                  "&to_date=" +
                  globalDateSecond;

                xhr_object.onload = function () {
                  resIncidentLevelDrill = JSON.parse(this.responseText);
                  console.log("Tickets Drill Down - ");
                  console.log(resIncidentLevelDrill);

                  const labels = resIncidentLevelDrill.response.map(item => item[1]);
                  const data = resIncidentLevelDrill.response.map(item => item[0]);


                  myChart.destroy();
                  myChart = new Chart(chartPyramid, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: "#F69380",
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                }

                xhr_object.send();
                IncidentWisedrillDownLevel = 3;
                clickedPyramid = false;
                return;

              }
            }
            else {
              if (IncidentWisedrillDownLevel === 1) {
                restoreOriginalChartTicket();
              }
            }

            dataDropdown_incidentlevel.style.display = "none";
          });
        } else if (clickedPyramid == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChartTicket() {
      if (originalChartConfigIncidentLevel) {
        myChart.destroy(); // Destroy the current chart
        funPyramid();
        clickedPyramid = true;
        IncidentWisedrillDownLevel = 1;
      }
    }

    refreshIconElement_incidentlevel.addEventListener("click", restoreOriginalChartTicket);
  };
  xhr_object.send();
}

// function funIncidentII(type, firstDate, secondDate) {
//   let incidentSpan = document.getElementById("incidentSpan");
//   let loaderIncidentII = document.getElementById("loaderIncidentII");
//   let incidentIINoData = document.getElementById("incidentIINoData");
//   let incident_II_pie = document.getElementById("incident_II_pie");

//   // incident_II_pie.style.display ="none";
//   loaderIncidentII.style.display = "block";
//   incidentIINoData.style.display = "none";

//   let xhr_object = new XMLHttpRequest();

//   if (globalType == "daily") {
//     xhr_object.open(
//       "GET",
//       getIncidentII + idLink + "&date=" + globalDateFirst,
//       true
//     );
//     console.log("incidentII");
//     console.log(getIncidentII + idLink + "&date=" + globalDateFirst);
//   } else {
//     xhr_object.open(
//       "GET",
//       getIncidentII +
//       idLink +
//       "&from_date=" +
//       globalDateFirst +
//       "&to_date=" +
//       globalDateSecond,
//       true
//     );
//     console.log(
//       getIncidentII +
//       idLink +
//       "&from_date=" +
//       globalDateFirst +
//       "&to_date=" +
//       globalDateSecond
//     );
//   }

//   xhr_object.onload = function () {
//     resfunIncidentII = JSON.parse(this.responseText);

//     console.log("Incident II- ");
//     console.log(resfunIncidentII.response);

//     let sum = 0;

//     let valueName = [];
//     let valueY = [];

//     let arrayPie = [];

//     for (let i = 0; i < resfunIncidentII.response.length; i++) {
//       valueName[i] = resfunIncidentII.response[i].name;
//       valueY[i] = resfunIncidentII.response[i].y;
//     }

//     for (let i = 0; i < valueName.length; i++) {
//       if (valueY[i] == null) {
//         arrayPie.push({ name: valueName[i], y: 0 });
//       } else {
//         arrayPie.push({
//           name: valueName[i],
//           y: valueY[i],
//         });
//       }
//     }

//     let incidentChartColors = [
//       "#F8EA94",
//       "#A1CD7A",
//       "#F2C06C",
//       "#D44B52",
//       "#F69380",
//       "#FF933C",
//       "#FFBD3C",
//       "#B4FF3C",
//       "#4BFF3C",
//       "#F69380",
//       "#3CFF93",
//       "#3CDEFF",
//       "#3C4BFF",
//       "#BD3CFF",
//       "#FF3CFC",
//       "#5F8900",
//       "#008913",
//       "#007C89",
//       "#280089",
//       "#890069",
//     ];

//     // let legendList = "";
//     // for (let i = 0; i < valueName.length; i++) {
//     //   if (valueName[i] != null) {
//     //     legendList +=
//     //       '<i class="bi  bi-circle-fill " style="color:' +
//     //       incidentChartColors[i] +
//     //       ';"></i> ' +
//     //       valueName[i] +
//     //       "-" +
//     //       valueY[i];
//     //     "<br/>" + "";
//     //   }
//     // }
//     // incidentSpan.innerHTML = legendList;

//     let total = valueName + valueY;
//     const centerT = {
//       id: "centerT",
//       afterDatasetsDraw(chart, args, options) {
//         const {
//           ctx,
//           chartArea: { left, right, top, bottom, width, height },
//         } = chart;
//         ctx.save();

//         ctx.font = "bolder 18px Arial";
//         ctx.fillStyle = "rgba(0, 0, 0, 1)";
//         ctx.textAlign = "center";
//         ctx.fillText("Total: " + total, width, height);
//       },
//     };
//     new Chart(incident_II_pie, {
//       type: "pie",
//       data: {
//         labels: valueName,
//         datasets: [
//           {
//             label: "Incident Pyramid",
//             data: valueY,
//             backgroundColor: incidentChartColors,
//             // resfunIncidentII.values,
//             radius: "80%",
//             borderWidth: 1,
//           },
//         ],
//       },
//       options: {
//         indexAxis: "y",
//         responsive: true,
//         maintainAspectRatio: false,
//         plugins: {
//           datalabels: {
//             color: "#ffffff",
//             font: {
//               size: "14",
//               weight: "bold",
//             },
//           },
//           legend: {
//             display: true,
//             position: "bottom",
//           },
//         },
//       },
//       plugins: [ChartDataLabels],
//     });
//     // console.log("arraypie")
//     // console.log(arrayPie);

//     // let sum = 0;

//     // if (Charts !=null){
//     //     Charts.destory();
//     // }

//     for (let i = 0; i < valueY.length; i += 1) {
//       if (valueY[i] == null) {
//         let a = 0;
//         sum += a;
//       } else {
//         sum += valueY[i];
//       }
//     }
//     loaderIncidentII.style.display = "none";
//     if (sum == 0) {
//       incidentIINoData.style.display = "block";
//       incident_II_pie.style.display = "none";
//     } else {
//       incidentIINoData.style.display = "none";
//       incident_II_pie.style.display = "block";
//     }
//   };
//   xhr_object.send();
// }

function funRootCause(type, firstDate, secondDate) {
  let incidentRoot = document.getElementById("incidentRoot");
  let loaderRootCause = document.getElementById("loaderRootCause");
  let rootCauseNoData = document.getElementById("rootCauseNoData");
  let root_Cause_pie = document.getElementById("root_Cause_pie");

  // root_Cause_pie.style.display = "none";
  // loaderRootCause.style.display = "block";
  // rootCauseNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getRootCause + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log("incidentII");
    console.log(getRootCause + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getRootCause +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getRootCause +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunRootCause = JSON.parse(this.responseText);

    console.log("RootCause ");
    console.log(resfunRootCause);

    let sum = 0;

    let valueN = [];
    let valueYa = [];

    let arrayP = [];

    for (let i = 0; i < resfunRootCause.response.length; i++) {
      valueN[i] = resfunRootCause.response[i].name;
      valueYa[i] = resfunRootCause.response[i].y;
    }

    for (let i = 0; i < valueN.length; i++) {
      if (valueYa[i] == null) {
        arrayP.push({ name: valueN[i], y: 0 });
      } else {
        arrayP.push({
          name: valueN[i],
          y: valueYa[i],
        });
      }
    }

    let incidentRootColors = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];

    // let legendList = "";
    // for (let i = 0; i < valueN.length; i++) {
    //   if (valueN[i] != null) {
    //     legendList +=
    //       '<i class="bi  bi-circle-fill " style="color:' +
    //       incidentRootColors[i] +
    //       ';"></i> ' +
    //       valueN[i] +
    //       "-" +
    //       valueYa[i];
    //     "<br/>" + "<br/>";
    //   }
    // }
    // incidentRoot.innerHTML = legendList;

    let total = valueN + valueYa;
    const centerTexts = {
      id: "centerTexts",
      afterDatasetsDraw(chart, args, options) {
        const {
          ctx,
          chartArea: { left, right, top, bottom, width, height },
        } = chart;
        ctx.save();

        ctx.font = "bolder 18px Arial";
        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.textAlign = "center";
        ctx.fillText("Total: " + total, width, height);
      },
    };
    originalChartConfigroot = {
      type: "pie",

      data: {
        labels: valueN,
        datasets: [
          {
            label: "Incident Root Cause",
            data: valueYa,
            backgroundColor: incidentRootColors,
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        indexAxis: "y",
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(root_Cause_pie, originalChartConfigroot)
    // console.log("arraypie");
    // console.log(arrayP);

    for (let i = 0; i < valueYa.length; i += 1) {
      if (valueYa[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueYa[i];
      }
    }

    loaderRootCause.style.display = "none";
    if (sum == 0) {
      rootCauseNoData.style.display = "block";
      root_Cause_pie.style.display = "none";
    } else {
      rootCauseNoData.style.display = "none";
      root_Cause_pie.style.display = "block";
    }

    // refreshIconElement_primaryRoot


    function restoreOriginalChartRoot() {

      if (originalChartConfigroot) {
        myChart.destroy();
        loaderRootCause.style.display = "block";
        funRootCause();
      }
    }

    refreshIconElement_primaryRoot.addEventListener("click", restoreOriginalChartRoot);


  };
  xhr_object.send();
}



function funBodyInjuryChart() {

  let bodyInjuryChart = document.getElementById("bodyInjuryChart");
  let loaderBodyInjuryChart = document.getElementById("loaderBodyInjuryChart");
  let bodyInjuryChartNoData = document.getElementById("bodyInjuryChartNoData");

  // root_Cause_pie.style.display = "none";
  // loaderBodyInjuryChart.style.display = "block";
  // bodyInjuryChartNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getBodyInjuryChart
      + idLink + "&date=" + globalDateFirst,
      true
    );
    // console.log("incidentII");
    // console.log(getRootCause + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getBodyInjuryChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getBodyInjuryChart +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );

  }

  xhr_object.onload = function () {
    resBodyInjuryChart = JSON.parse(this.responseText);

    console.log("Injury Chat =++++++++++++++++++++++========================+++++++++++++++++++++++++++++++++++++++++++++++++++++ ");
    console.log(resBodyInjuryChart);
    console.log(resBodyInjuryChart.response)

    bodyInjuryChart.src = resBodyInjuryChart.response;
    console.log("------hey");
    console.log(bodyInjuryChart);
    console.log(bodyInjuryChart.src);

    loaderBodyInjuryChart.style.display = "none";
    bodyInjuryChartNoData.style.display = "none";
    bodyInjuryChart.style.display = "block";

    // refreshIconElement_bodyInjury

    refreshIconElement_bodyInjury.addEventListener("click", restoreOriginalChartBodyInjury);

    function restoreOriginalChartBodyInjury() {
      loaderBodyInjuryChart.style.display = "block";
      bodyInjuryChart.style.display = "none";
      funBodyInjuryChart();
    }


  };
  xhr_object.send();
}
// Dropdown------------------------------------------------

// -----------------
// building_id not site_id is used in charts
// loaderTotalVisitors,totalVisitorsNoData,total-visitors
function funTotalVisitors() {
  let totalVisitorsNoData = document.getElementById("totalVisitorsNoData");
  let total_visitors = document.getElementById("total-visitors");
  let loaderTotalVisitors = document.getElementById("loaderTotalVisitors");
  let dt2_tv = document.getElementById("dt2_tv");

  let dp = document.getElementById("drop");

  let xhr_object_dropdown = new XMLHttpRequest();

  xhr_object_dropdown.open("GET", getTotalVisitorsDorpdown + idLink, true);

  xhr_object_dropdown.onload = function () {
    resfunTotalVisitorsDropdown = JSON.parse(this.responseText);
    let siteoption = `<option value="Select Building" selected>Select Building</option>`;
    var index = 0;
    let responseBuildings = resfunTotalVisitorsDropdown.response;
    console.log(responseBuildings);
    for (let x in responseBuildings) {
      index += 1;
      siteoption +=
        `<option value="` +
        responseBuildings[x].id +
        `">` +
        responseBuildings[x].name +
        `</option>`;
    }
    dp.innerHTML = siteoption;
  };
  xhr_object_dropdown.send();

  loaderTotalVisitors.style.display = "none";
  totalVisitorsNoData.style.display = "block";

  dp.onchange = function () {
    globalVisitorBuildingId = dp.value;
    console.log(dp.value);
    if (globalType == "daily") {
      dt2_tv.innerHTML = "Total Visitors " + convertDateFormat(globalDateFirst);
    } else {
      dt2_tv.innerHTML =
        "Total Visitors " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    }

    loaderTotalVisitors.style.display = "block";
    totalVisitorsNoData.style.display = "none";

    let xhr_object = new XMLHttpRequest();

    if (globalType == "daily") {
      xhr_object.open(
        "GET",
        getTotalVisitors +
        "?building_id=" +
        dp.value +
        "&date=" +
        globalDateFirst,
        true
      );
      console.log(" get Total Visitor");
      console.log(
        getTotalVisitors +
        "?building_id=" +
        dp.value +
        "&date=" +
        globalDateFirst
      );
    } else {
      xhr_object.open(
        "GET",
        getTotalVisitors +
        "?building_id=" +
        dp.value +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getTotalVisitors +
        "?building_id=" +
        dp.value +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object.onload = function () {
      resfunTotalVisitors = JSON.parse(this.responseText);

      console.log("Total Visitors  - ");
      console.log(resfunTotalVisitors);

      // Added now
      new Chart(total_visitors, {
        type: "bar",
        data: {
          labels: Object.keys(resfunTotalVisitors.response),
          datasets: [
            {
              label: "Visitors",
              backgroundColor: [
                "#77216F",
                "#01C875",
                "#E2445B",
                "#E95420",
                "#A1CD7A",
              ],
              data: Object.values(resfunTotalVisitors.response),
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          interaction: {
            intersect: false,
          },
          scales: {
            x: {
              stacked: true,
            },
            y: {
              stacked: true,
            },
          },
          maintainAspectRatio: false,
          scales: {
            x: {
              ticks: {
                callback: function (value) {
                  return this.getLabelForValue(value).substr(0, 15);
                },
              },
            },
          },
          plugins: {
            datalabels: {
              color: "#000000",
              anchor: "end",
              align: "end",
              offset: -6,
              font: {
                size: "10",
                weight: "bold",
              },
            },
            legend: {
              display: true,
              position: "no",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderTotalVisitors.style.display = "none";

      let sum = 0;
      let resValues = Object.values(resfunTotalVisitors.response);

      for (let i = 0; i < resValues.length; i += 1) {
        sum = resValues[i] + sum;
      }

      // if (sum == 0) {
      //   totalVisitorsNoData.style.display = "block";
      //   total_visitors.style.display = "none";
      // } else {
      totalVisitorsNoData.style.display = "none";
      total_visitors.style.display = "block";
      // }
    };

    xhr_object.send();
  };
}

// showGoodsIn(),loaderGoodsIn,goodsInNoData,goods-in
let clickedGoodsIn = true;
function funGoodsIn() {
  // let goodsInNoData = document.getElementById("goodsInNoData");
  let goods_in = document.getElementById("goods_in");
  let loaderGoodsIn = document.getElementById("loaderGoodsIn");
  let dt2_gi = document.getElementById("dt2_gi");

  // loaderGoodsIn.style.display = "none";
  // goods_in.style.display = "block";
  // goodsInNoData.style.display = "block";

  // if (globalType == "daily") {
  //   dt2_gi.innerHTML = " Goods In " + globalDateFirst;
  // } else {
  //   dt2_gi.innerHTML =
  //     " Goods In " + globalDateFirst + " to " + globalDateSecond;
  // }

  // loaderGoodsIn.style.display = "block";
  // goodsInNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getGoodsIn + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log("getGoodsIn");
    console.log(getGoodsIn + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getGoodsIn +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunGoodsIn = JSON.parse(this.responseText);

    let valueGoodsInName = Object.keys(resfunGoodsIn.response);
    let valueGoodsInY = Object.values(resfunGoodsIn.response);

    console.log("Goods in- ");
    console.log(resfunGoodsIn);
    // console.log(valueGoodsInName);

    originalChartGoodsIn = {
      type: "bar",
      data: {
        labels: valueGoodsInName,
        datasets: [
          {
            // label:"Incident",
            // `data: Object.values(resfunGoodsIn.response),`
            // axis: "y",
            // fill: true,
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: valueGoodsInY,
            borderWidth: 1,
          },
        ],
      },
      options: {
        // indexAxis: "y",
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#ffffff",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(goods_in, originalChartGoodsIn)

    loaderGoodsIn.style.display = "none";
    // goods_in.style.display = "block";


    let sum = 0;
    let resValue = Object.values(resfunGoodsIn.response);

    for (let i = 0; i < resValue.length; i += 1) {
      sum = resValue[i] + sum;
    }
    if (sum == 0) {
      // goodsInNoData.style.display = "block";
      goods_in.style.display = "none";
    } else {
      // goodsInNoData.style.display = "none";
      goods_in.style.display = "block";
    }

    // showGoodsIn(),loaderGoodsIn,goodsInNoData,goods-in   refreshIconElement_goodsIn    listItemLabelGoodsIn  clickedGoodsIn  dataDropdown_goodsIn  GoodIndrillDownLevel
    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let GoodIndrillDownLevel = 1;
    if (!funGoodsIn.initialized) {
      goods_in.onclick = function (event) {

        if (clickedGoodsIn == true) {

          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelGoodsIn").textContent = `Ticket: ${label}`;
            myChart.update();
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_goodsIn"));
            dropdown.style.display = "block";


          }

          dataDropdown_goodsIn.addEventListener("click", function (event) {

            // if (selectedOption === "Tower" || "Flat_Type" || "Status" || "Created_By" || "Proactive/Reactive" || "Category" || "Sub_Category" || "Assign_To" || "Priority" || "Ticket_Type" || "Related_To" && currentChartType === "bar") {
              if (event.target.id != "closeDropdown") {
            if (GoodIndrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getGoodsInDrill +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;

              console.log("TicketCategoryDrill  1");
              console.log(apiURL);
              xhr_object.open("GET", apiURL, true);



              downloadGoodInLink = ip + "fm-excel-download/get-goods-inward-drill-down-excel/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resfunGoodsInDrill = JSON.parse(this.responseText);
                console.log("resfunGoodsInDrill Drill Down -1 ");
                console.log(resfunGoodsInDrill);

                // const labels = Object.keys(resfunGoodsInDrill.response);
                const labels = resfunGoodsInDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resfunGoodsInDrill.response[label][status] || 0),
                    data: resfunGoodsInDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(goods_in, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();

              GoodIndrillDownLevel = 2;
            } else if (GoodIndrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);

              apiURL =
                getGoodsInDrill +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadGoodInLink = ip + "fm-excel-download/get-goods-inward-drill-down-excel/" +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resfunGoodsInDrill = JSON.parse(this.responseText);
                console.log("resfunGoodsInDrill Drill Down -2 ");
                // resfunGoodsInDrill
                // const labels = Object.keys(resfunGoodsInDrill.response);
                const labels = resfunGoodsInDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"];

                // for (const label of labels) {
                //   datasets.push({
                //     label: label,
                //     data: statuses.map(status => resfunGoodsInDrill.response[label][status] || 0),
                //     backgroundColor: label === "Open" ? "#e2445b" : "#01c875",
                //     stack: "0",
                //   });
                // }

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resfunGoodsInDrill.response[label][status] || 0),
                    data: resfunGoodsInDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: status,

                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(goods_in, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedGoodsIn = false;
              }

              xhr_object.send();
              GoodIndrillDownLevel = 3;
              clickedGoodsIn = false;
              return;
            }
          }
          else {
            if(GoodIndrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_goodsIn.style.display = "none";

          });

        } else if (clickedGoodsIn == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChart() {
      if (originalChartGoodsIn) {
        myChart.destroy(); // Destroy the current chart
        funGoodsIn();
        clickedGoodsIn = true;
      }
    }

    refreshIconElement_goodsIn.addEventListener("click", restoreOriginalChart);




  };
  xhr_object.send();
}

// dt2_go // showGoodsOut(),loaderGoodsOut,goodsOutNoData,goods-out
// refreshIconElement_goodsOut  dataDropdown_goodsOut listItemLabelGoodsOut clickedGoodsOut
let clickedGoodsOut = true;
function funGoodsOut() {
  let goodsOutNoData = document.getElementById("goodsOutNoData");
  let goods_out = document.getElementById("goods_out");
  let loaderGoodsOut = document.getElementById("loaderGoodsOut");
  let dt2_go = document.getElementById("dt2_go");

  // loaderGoodsOut.style.display = "none";
  // goods_out.style.display = "block";
  // goodsOutNoData.style.display = "none";

  // if (globalType == "daily") {
  //   dt2_go.innerHTML = " Goods Outward " + globalDateFirst;
  // } else {
  //   dt2_go.innerHTML =
  //     " Goods Outward " + globalDateFirst + " to " + globalDateSecond;
  // }

  // loaderGoodsOut.style.display = "block";
  // goodsOutNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getGoodsOut + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log("getGoodsOut");
    console.log(getGoodsOut + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getGoodsOut +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunGoodsOut = JSON.parse(this.responseText);

    // let valueGoodsOutName = Object.keys(resfunGoodsOut.response);
    // let valueGoodsOutY = Object.values(resfunGoodsOut.response);
    console.log("Goods Out- ");
    console.log(resfunGoodsOut);
    // console.log(valueGoodsOutName);

    originalChartGoodsOut = {
      type: "bar",
      data: {
        labels: Object.keys(resfunGoodsOut.response),
        datasets: [
          {
            // label:"Incident",
            data: Object.values(resfunGoodsOut.response),
            axis: "y",
            fill: true,
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],

            borderWidth: 1,
          },
        ],
      },
      options: {
        // indexAxis: "y",
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#ffffff",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(goods_out, originalChartGoodsOut)

    loaderGoodsOut.style.display = "none";

    let sum = 0;
    let resValueOut = Object.values(resfunGoodsOut.response);
    for (let i = 0; i < resValueOut.length; i += 1) {
      sum = resValueOut[i] + sum;
    }
    if (sum == 0) {
      goodsOutNoData.style.display = "block";
      goods_out.style.display = "none";
    } else {
      goodsOutNoData.style.display = "none";
      goods_out.style.display = "block";
    }

    // dt2_go // showGoodsOut(),loaderGoodsOut,goodsOutNoData,goods-out
    // refreshIconElement_goodsOut  dataDropdown_goodsOut listItemLabelGoodsOut clickedGoodsOut  originalChartGoodsOut
    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let GoodOutdrillDownLevel = 1;
    if (!funGoodsOut.initialized) {
      goods_in.onclick = function (event) {

        if (clickedGoodsOut == true) {

          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelGoodsOut").textContent = `Ticket: ${label}`;
            myChart.update();
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_goodsOut"));
            dropdown.style.display = "block";


          }

          dataDropdown_goodsOut.addEventListener("click", function (event) {

            // if (selectedOption === "Tower" || "Flat_Type" || "Status" || "Created_By" || "Proactive/Reactive" || "Category" || "Sub_Category" || "Assign_To" || "Priority" || "Ticket_Type" || "Related_To" && currentChartType === "bar") {
           if (event.target.id != "closeDropdown") {
            if (GoodIndrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getGoodsOutDrill +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;

              console.log("TicketCategoryDrill  1");
              console.log(apiURL);
              xhr_object.open("GET", apiURL, true);



              downloadGoodOutLink = ip + "fm-excel-download/get-goods-outward-drill-down-excel/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resfunGoodsOutDrill = JSON.parse(this.responseText);
                console.log("resfunGoodsOutDrill Drill Down -1 ");
                console.log(resfunGoodsOutDrill);

                // const labels = Object.keys(resfunGoodsOutDrill.response);
                const labels = resfunGoodsOutDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resfunGoodsOutDrill.response[label][status] || 0),
                    data: resfunGoodsOutDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(goods_out, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();

              GoodOutdrillDownLevel = 2;
            } else if (GoodOutdrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);

              apiURL =
                getGoodsOutDrill +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadGoodOutLink = ip + "fm-excel-download/get-goods-outward-drill-down-excel/" +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resfunGoodsOutDrill = JSON.parse(this.responseText);
                console.log("resfunGoodsOutDrill Drill Down -2 ");
                // resfunGoodsOutDrill
                // const labels = Object.keys(resfunGoodsInDrill.response);
                const labels = resfunGoodsInDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"];

                // for (const label of labels) {
                //   datasets.push({
                //     label: label,
                //     data: statuses.map(status => resfunGoodsOutDrill.response[label][status] || 0),
                //     backgroundColor: label === "Open" ? "#e2445b" : "#01c875",
                //     stack: "0",
                //   });
                // }

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resfunGoodsOutDrill.response[label][status] || 0),
                    data: resfunGoodsOutDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: status,

                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(goods_out, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedGoodsOut = false;
              }

              xhr_object.send();
              GoodOutdrillDownLevel = 3;
              clickedGoodsOut = false;
              return;
            }
          }
          else {
            if(GoodOutdrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_goodsOut.style.display = "none";


          });

        } else if (clickedGoodsOut == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChart() {
      if (originalChartGoodsOut) {
        myChart.destroy(); // Destroy the current chart
        funGoodsOut();
        clickedGoodsOut = true;

      }
    }

    refreshIconElement_goodsOut.addEventListener("click", restoreOriginalChart);



  };
  xhr_object.send();
}

function funCardTotalRegisteredUsers() {
  let cardRegisterdUser = document.getElementById("cardRegisterdUser");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getTotalusers + idLink, true);

  xhr_object.onload = function () {
    totalUsrers = JSON.parse(this.responseText);
    console.log("Asset Total - ");
    console.log(totalUsrers);
    cardRegisterdUser.innerHTML = totalUsrers.response + "";
  };
  xhr_object.send();
}

function funCardTotalDownloads() {
  let cardDownloads = document.getElementById("cardDownloads");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getTotalDownloads + idLink, true);
  console.log("++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++");
  console.log(getTotalDownloads + idLink);
  xhr_object.onload = function () {
    totalDownloads = JSON.parse(this.responseText);
    console.log("Asset Dowenload adata - ");
    console.log(totalDownloads);
    cardDownloads.innerHTML = totalDownloads.response + "";
  };
  xhr_object.send();
}

let clickedSiteWiseEscalation = true;
// zonewise
function funSiteWiseEscalation() {
  let SiteWiseEscalationNoData = document.getElementById("SiteWiseEscalationNoData");
  let SiteWiseEscalation = document.getElementById("SiteWiseEscalation");
  let loaderSiteWiseEscalation = document.getElementById("loaderSiteWiseEscalation");
  // let occupancy = document.getElementById("occupancy");

  // loaderSiteWiseEscalation.style.display = "block";
  // SiteWiseEscalationNoData.style.display = "none";

  // if (globalType == "daily") {
  //   occupancy.innerHTML = "Chart for " + globalDateFirst;
  // } else {
  //   occupancy.innerHTML =
  //     "Chart for " + globalDateFirst + " to " + globalDateSecond;
  // }


  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getSiteWiseEscalation + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getSiteWiseEscalation +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
    console.log(
      getSiteWiseEscalation +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunSiteWiseEscalation = JSON.parse(this.responseText);
    console.log("Site Wise Escalation - ");
    console.log(resfunSiteWiseEscalation);

    let xLabelsArray = Object.keys(resfunSiteWiseEscalation.response);

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      xLabelsArray[i] = xLabelsArray[i].split(" ");
    }
    // Added now
    originalChartConfigZoneWise = {
      type: "bar",
      data: {
        labels: xLabelsArray,
        datasets: [
          {
            label: "Site Wise",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: Object.values(resfunSiteWiseEscalation.response),
            borderWidth: 1,

          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,

        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(SiteWiseEscalation, originalChartConfigZoneWise)

    loaderSiteWiseEscalation.style.display = "none";

    if (Object.keys(resfunSiteWiseEscalation.response).length == 0) {
      SiteWiseEscalationNoData.style.display = "block";
      SiteWiseEscalation.style.display = "none";
    } else {
      SiteWiseEscalationNoData.style.display = "none";
      SiteWiseEscalation.style.display = "block";
    }

    // refreshIconElement_ZoneWise

    refreshIconElement_ZoneWise.addEventListener("click", restoreOriginalChartZoneWise);

    function restoreOriginalChartZoneWise() {
      if (originalChartConfigZoneWise) {
        myChart.destroy();
        loaderSiteWiseEscalation.style.display = "block";
        funSiteWiseEscalation();

      }
    }


  };


  xhr_object.send();
}
// let clickedOpenCloseEscalation = true;
function funOpenCloseEscalation() { // loaderOpenCloseEscalation,OpenCloseEscalationNoData,OpenCloseEscalation
  let clickedOpenCloseEscalation = true;
  let OpenCloseEscalationNoData = document.getElementById("OpenCloseEscalationNoData");
  let OpenCloseEscalation = document.getElementById("OpenCloseEscalation");
  let loaderOpenCloseEscalation = document.getElementById("loaderOpenCloseEscalation");
  // let dt1 = document.getElementById("dt1");

  // loaderOpenCloseEscalation.style.display = "block";
  // OpenCloseEscalationNoData.style.display = "none";

  // if (globalType == "daily") {
  //   dt1.innerHTML = "Tickets for " + globalDateFirst;
  // } else {
  //   dt1.innerHTML =
  //     "Tickets for " + globalDateFirst + " to " + globalDateSecond;
  // }

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getOpenCloseEscalation + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getOpenCloseEscalation +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
  console.log(
    getOpenCloseEscalation +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );

  xhr_object.onload = function () {
    resfunOpenCloseEscalation = JSON.parse(this.responseText);

    console.log("Open & Close Escalation - ");
    console.log(resfunOpenCloseEscalation);


    let total = resfunOpenCloseEscalation.response.Open + resfunOpenCloseEscalation.response.Closed;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }

    // let xValues = [], yValues = [];

    // xValues = Object.keys(resfunChartTicket.response.open);
    // yValues = Object.values(resfunChartTicket.response);

    // Added Now
    originalChartOpenCloseEscalation = {
      type: "doughnut",
      data: {
        labels: ["Open", "Closed"],
        datasets: [
          {
            label: "Escalation",
            backgroundColor: ["#e2445b", "#01c875"],
            data: [
              // resfunChartTicket.response.total,
              resfunOpenCloseEscalation.response.Open,
              resfunOpenCloseEscalation.response.Closed
            ],
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,

        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels, centerText],
    };
    let myChart = new Chart(OpenCloseEscalation, originalChartOpenCloseEscalation)

    loaderOpenCloseEscalation.style.display = "none";

    if (resfunOpenCloseEscalation.response.length == 0) {
      OpenCloseEscalationNoData.style.display = "block";
      OpenCloseEscalation.style.display = "none";
      // } else {
      //   OpenCloseEscalationNoData.style.display = "none";
      //   OpenCloseEscalation.style.display = "block";
    }

    // --------
    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;

    // let OpenCloseEscalationdrillDownLevel = 1;

    OpenCloseEscalation.onclick = function (event) {
      if (clickedOpenCloseEscalation == true) {
        // alert('hi')
        const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

        if (points.length) {
          firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

          console.log(`Clicked on ${label} with value ${value}`);
          selectedlabelValue = label;
          // document.getElementById("listItemLabelOpenClose").textContent = `Ticket: ${label}`;
          const listItemLabelOpenClose = document.getElementById("listItemLabelOpenClose");
          if (listItemLabelOpenClose) {
            listItemLabelOpenClose.textContent = `Ticket: ${label}`;
          }

          myChart.update();

          const dropdown = (document.getElementById("dataDropdown_openClose"));
          dropdown.style.display = "block";


        }



        dataDropdown_openClose.addEventListener("click", function (event) {
          if (event.target.id != "closeDropdown") {
          if (OpenCloseEscalationdrillDownLevel === 1) {
            console.log(event.target.id);
            selectedOption = event.target.id;
            // handleDropdownClick(selectedOption);
            firstPoint = points[0]; // Assuming points is defined elsewhere

            labelname = myChart.data.labels[firstPoint.index];
            // const labelname = label;
            // const selectedSecondOption = event.target.id;
            // const labelSecond = myChart.data.labels[firstPoint.index];
            // const labelnameSecond = labelSecond; 
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            console.log(selectedOption);
            // console.log(selectedSecondOption);


            let xhr_object = new XMLHttpRequest();
            let apiURL;
            // "&drilldown_by=" +
            // selectedOption +
            apiURL =
              getOpenCloseDrill +
              idLink +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst +
              "&status=" +
              labelname +
              "&first_drilldown_by=" +
              selectedOption +
              "&sec_drilldown_by=" +
              '' +
              "&sec_drill_down_on=" +
              '',

              // downloadTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-tickets/" + idLink + 
              // "&from_date=" +
              //   globalDateFirst +
              //   "&to_date=" +
              //   globalDateSecond +
              //   "&status=" +
              //   labelname +
              //   "&first_drilldown_by=" +
              //   selectedOption +
              //   "&sec_drilldown_by=" +
              //   "" +
              //   "&sec_drill_down_on=" +
              //   "",

              xhr_object.open("GET", apiURL, true);

            xhr_object.onload = function () {
              resfunOpenCloseDrill = JSON.parse(this.responseText);
              console.log("Open Close Escalation Drill Down - ");
              console.log(resfunOpenCloseDrill);

              const labels = resfunOpenCloseDrill.response.map(item => item[1]);
              const dataValues = resfunOpenCloseDrill.response.map(item => item[0]);
              console.log(labels);
              console.log(dataValues);
              myChart.destroy();
              myChart = new Chart(OpenCloseEscalation, {
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: "Data",
                    data: dataValues,
                    backgroundColor: backgroundColors,
                    borderWidth: 1,
                  }]
                },
                options: {
                  responsive: true,
                  interaction: {
                    intersect: false,
                  },
                  scales: {
                    x: {
                      stacked: true,
                      title: {
                        display: true,
                        text: labelname,
                        padding: {
                          top: 20,
                        },
                      },
                    },
                    y: {
                      stacked: true,
                    },
                  },
                  maintainAspectRatio: false,
                  plugins: {
                    datalabels: {
                      color: "#000000",
                      anchor: "end",
                      align: "end",
                      offset: -6,
                      font: {
                        size: "10",
                        weight: "bold",
                      },
                      formatter: function (value, context) {
                        // Hide label if value is zero
                        return value === 0 ? '' : value;
                      },
                    },
                    legend: {
                      display: true,
                      position: "no",
                    },
                  },
                },
                plugins: [ChartDataLabels],
              });

            };

            xhr_object.send();

            OpenCloseEscalationdrillDownLevel = 2;

          }
          else if (OpenCloseEscalationdrillDownLevel === 2) {
            // alert(selectedOption);
            // alert(labelname);
            // alert(selectedlabelValue);
            const firstPoint = points[0];
            // alert(firstPoint.index);
            const selectedSecondOption = event.target.id;
            const labelSecond = myChart.data.labels[firstPoint.index];
            const labelnameSecond = labelSecond;
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            console.log(selectedSecondOption);
            console.log(selectedlabelValue);
            // console.log(backgroundColors);

            apiURL =
              getOpenCloseDrill +
              idLink +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst +
              "&status=" +
              labelname +
              "&first_drilldown_by=" +
              selectedOption +
              "&sec_drilldown_by=" +
              selectedSecondOption +
              "&sec_drill_down_on=" +
              selectedlabelValue,
              // alert("second drill down api");

              downloadTicketsLink = ip + "fm-excel-download/get-drill-down-for-chart-tickets/" +
              idLink +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst +
              "&status=" +
              labelname +
              "&first_drilldown_by=" +
              selectedOption +
              "&sec_drilldown_by=" +
              selectedSecondOption +
              "&sec_drill_down_on=" +
              selectedlabelValue,
              // alert(downloadTicketsLink);

              console.log(apiURL);

            xhr_object.open("GET", apiURL, true);

            xhr_object.onload = function () {
              resfunOpenCloseDrill = JSON.parse(this.responseText);
              console.log("Open close 2 Drill Down - ");
              console.log(resfunOpenCloseDrill);

              const labels = resfunOpenCloseDrill.response.map(item => item[1]);
              const dataValues = resfunOpenCloseDrill.response.map(item => item[0]);
              console.log(labels);
              console.log(dataValues);

              myChart.destroy();
              myChart = new Chart(OpenCloseEscalation, {
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: "Data",
                    data: dataValues,
                    backgroundColor: backgroundColors,
                    borderWidth: 1,
                  }]
                },
                options: {
                  responsive: true,
                  interaction: {
                    intersect: false,
                  },
                  scales: {
                    x: {
                      stacked: true,
                      title: {
                        display: true,
                        text: labelname,
                        padding: {
                          top: 20,
                        },
                      },
                    },
                    y: {
                      stacked: true,
                    },
                  },
                  maintainAspectRatio: false,
                  plugins: {
                    datalabels: {
                      color: "#000000",
                      anchor: "end",
                      align: "end",
                      offset: -6,
                      font: {
                        size: "10",
                        weight: "bold",
                      },
                      formatter: function (value, context) {
                        // Hide label if value is zero
                        return value === 0 ? '' : value;
                      },
                    },
                    legend: {
                      display: true,
                      position: "no",
                    },
                  },
                },
                plugins: [ChartDataLabels],
              });

            };

            xhr_object.send();
            OpenCloseEscalationdrillDownLevel = 3;
            clickedOpenCloseEscalation = false;
          }
        }
        else {
          if(OpenCloseEscalationdrillDownLevel === 1) {
            restoreOriginalChart();
          }
        }


          dataDropdown_openClose.style.display = "none";
        });
      } else if (clickedOpenCloseEscalation == false) {
        alert("You have reached the maximum drill-down level.");
      }


    };
    // ---------
    function restoreOriginalChartTicket() {
      if (originalChartOpenCloseEscalation) {
        myChart.destroy(); // Destroy the current chart
        funOpenCloseEscalation();
        clickedOpenCloseEscalation = true;
      }
    }

    refreshIconElement_openClose.addEventListener("click", restoreOriginalChartTicket);
  };

  xhr_object.send();
}
let clickedCategoryWiseEscalation = true;
function funCategoryWiseEscalation() { // CategoryEscalation,loaderCategoryEscalation,NoDataCategoryEscalation
  let NoDataCategoryEscalation = document.getElementById("NoDataCategoryEscalation");
  let CategoryEscalation = document.getElementById("CategoryEscalation");
  let loaderCategoryEscalation = document.getElementById("loaderCategoryEscalation");
  // let dt1 = document.getElementById("dt1");

  // loaderCategoryEscalation.style.display = "block";
  // NoDataCategoryEscalation.style.display = "none";

  // if (globalType == "daily") {
  //   dt1.innerHTML = "Tickets for " + globalDateFirst;
  // } else {
  //   dt1.innerHTML =
  //     "Tickets for " + globalDateFirst + " to " + globalDateSecond;
  // }

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getCategoryEscalation + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getCategoryEscalation +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww");
  console.log(
    getCategoryEscalation +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond
  );

  xhr_object.onload = function () {
    resfunCategoryWiseEscalation = JSON.parse(this.responseText);

    console.log("Category Wise Executive Escalation - ");
    console.log(resfunCategoryWiseEscalation);


    let xValues = [], yValues = [];

    xValues = Object.keys(resfunCategoryWiseEscalation.response);
    yValues = Object.values(resfunCategoryWiseEscalation.response);

    let CategoryEscalationPieColors = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];


    // Added Now
    originalChartConfigTopCategoryEscalation = {
      type: "pie",
      data: {
        labels: xValues,
        datasets: [
          {
            label: "Category",
            backgroundColor: CategoryEscalationPieColors,
            data: yValues,
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,

        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(CategoryEscalation, originalChartConfigTopCategoryEscalation)

    loaderCategoryEscalation.style.display = "none";
    NoDataCategoryEscalation.style.display = "none";
    CategoryEscalation.style.display = "block";


    // refreshIconElement_categoryExecutive

    refreshIconElement_categoryExecutive.addEventListener("click", restoreOriginalChartcategoryExecutive);

    function restoreOriginalChartcategoryExecutive() {
      if (originalChartConfigTopCategoryEscalation) {
        myChart.destroy();
        loaderCategoryEscalation.style.display = "block";
        funCategoryWiseEscalation();

      }
    }
  };

  xhr_object.send();
}

function funAuditScore() {
  let AuditScoreNoData = document.getElementById("AuditScoreNoData");
  let tblAuditScoreinfo = document.getElementById(
    "tblAuditScoreinfo"
  );
  let tablebodyAuditScore = document.getElementById(
    "tablebodyAuditScore"
  );
  let loaderAuditScore = document.getElementById("loaderAuditScore");


  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getAuditScore + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getAuditScore +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    // Assuming your API response is in the correct format
    let resfunAuditScore = JSON.parse(this.responseText);

    console.log("Audit Score - ");
    console.log(resfunAuditScore);

    let resfunAuditScoreArray = resfunAuditScore.response;
    allDetails = ``;

    for (let i = 0; i < resfunAuditScoreArray.length; i++) {
      let rowData = resfunAuditScoreArray[i];
      allDetails +=
        `<tr>` +
        `<td>` + (i + 1) + `</td>` +
        `<td>` + rowData[0] + `</td>` +
        `<td>` + (rowData[1] ? rowData[1] : '-') + `</td>` +
        `<td>` + (rowData[2] ? new Date(rowData[2]).toLocaleDateString() : '-') + `</td>` +
        `<td>` + (rowData[3] ? rowData[3] : '-') + `</td>` +
        `<td>` + (rowData[4] ? rowData[4] : '-') + `</td>` +
        `</tr>`;
    }
    tablebodyAuditScore.innerHTML = allDetails;


    loaderAuditScore.style.display = "none";
    if (Object.keys(resfunAuditScoreArray).length === 0) {
      AuditScoreNoData.style.display = "block";
      tblAuditScoreinfo.style.display = "none";
    } else {
      AuditScoreNoData.style.display = "none";
      tblAuditScoreinfo.style.display = "inline-table";
    }

    // refreshIconElement_servicePartner


    refreshIconElement_servicePartner.addEventListener("click", restoreOriginalChart);

    function restoreOriginalChart() {
       loaderAuditScore.style.display = "block";
      funAuditScore();
    }
  };

  xhr_object.send();
}

let clickedClusterStats = true;
function funClusterStats() {
  let loaderClusterStats = document.getElementById("loaderClusterStats");
  let barChartClusterStats = document.getElementById("cluster-stats");
  let clusterStatsNoData = document.getElementById("clusterStatsNoData");

  //   let dt3 = document.getElementById("dt3");
  // // globalDateFirst != 0 && globalDateSecond != 0 && globalDateFirst != globalDateSecond
  //   if (globalDateFirst != 0  && globalDateFirst != globalDateSecond){
  //     dt3.innerHTML =
  //       "Cluster Stats : " +
  //       globalDateFirst +
  //       " to " +
  //       globalDateSecond;
  //   }else {
  //     dt3.innerHTML = "Cluster Stats : " + globalDateFirst;
  //   } 

  // barChartClusterStats.style.display = "none";
  // loaderClusterStats.style.display = "block";
  // clusterStatsNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getClusterStats +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunClusterStats = JSON.parse(this.responseText);
    console.log("Cluster Stats - ");
    console.log(resfunClusterStats);


    let responseValues = [];
    let responseLabels = [];

    // Extracting data from the response
    resfunClusterStats.response1.forEach(item => {
      // Check if the first element is not null
      if (item[0] !== null) {
        responseLabels.push(item[0]);
        responseValues.push(item[1]);
      }
    });
    let currentChartType = "bar"

    const orginalClusterStats = {
      type: "bar",
      data: {
        labels: responseLabels,
        datasets: [
          {
            label: "Cluster",
            backgroundColor: ["#E95420"],
            data: responseValues,
            borderWidth: 1,
            borderColor: "#E95420",
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            title: {
              display: true,
              text: "Cluster",
            },
          },
          y: {
            title: {
              display: true,
              text: "Total steps taken",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(barChartClusterStats, orginalClusterStats)

    loaderClusterStats.style.display = "none";
    if (resfunClusterStats.length == 0) {
      clusterStatsNoData.style.display = "block";
      barChartClusterStats.style.display = "none";
    } else {
      clusterStatsNoData.style.display = "none";
      barChartClusterStats.style.display = "block";
    }
    if (!funClusterStats.initialized) {
      barChartClusterStats.onclick = function (event) {

        if (clickedClusterStats == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);

            document.getElementById("listItemLabelCusterStats").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;
            myChart.update();


          }
          const dropdown = (document.getElementById("dataDropdown_custerStats"));
          dropdown.style.display = "block";


          dataDropdown_custerStats.addEventListener("click", function (event) {
            const selectedOption = event.target.id;
            const firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const labelname = label;
            console.log(selectedOption);
            if (event.target.id != "closeDropdown") {
            if (selectedOption === "User_Name" && currentChartType === "bar") {
              let xhr_object = new XMLHttpRequest();
              xhr_object.open(
                "GET",
                getCusterStatsDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst,
                true
              );
              console.log(
                getCusterStatsDrill +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst,
              );
              // alert(downloadClusterWiseTotalLink);

              downloadClusterWiseTotalLink = ip + "stepathon/get-cluster-wise-total-steps-taken-drill-down-download/" + idLink +
                idLink +
                "&drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateFirst,



                xhr_object.onload = function () {
                  resCusterStats = JSON.parse(this.responseText);
                  console.log("CusterStats Drill Down - ");
                  console.log(resCusterStats);

                  const labels = resCusterStats.response.map(item => item[1]);
                  const data = resCusterStats.response.map(item => item[0]);

                  myChart.destroy();
                  barChartClusterStats.style.display = "block";
                  myChart = new Chart(barChartClusterStats, {
                    type: "bar",
                    data: {
                      labels: labels,
                      datasets: [{
                        label: "Data",
                        data: data,
                        backgroundColor: ["#e2445b"],
                      }]
                    },
                    options: {
                      responsive: true,
                      interaction: {
                        intersect: false,
                      },
                      scales: {
                        x: {
                          stacked: true,
                        },
                        y: {
                          stacked: true,
                        },
                      },
                      maintainAspectRatio: false,
                      scales: {
                        x: {
                        },
                      },
                      plugins: {
                        datalabels: {
                          color: "#000000",
                          anchor: "end",
                          align: "end",
                          offset: -6,
                          font: {
                            size: "10",
                            weight: "bold",
                          },
                          formatter: function (value, context) {
                            // Hide label if value is zero
                            return value === 0 ? '' : value;
                          }
                        },
                        legend: {
                          display: true,
                          position: "no",
                        },
                      },
                    },
                    plugins: [ChartDataLabels],
                  });
                  clickedClusterStats = false;
                }

              xhr_object.send();
              // funClusterStats.initialized =true;
            }
          }
          else {
            restoreOriginalClusterStats();
          }

            dataDropdown_custerStats.style.display = "none";
          });
        } else if (clickedClusterStats == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalClusterStats() {
      if (orginalClusterStats) {
        myChart.destroy(); // Destroy the current chart
        funClusterStats();
        clickedClusterStats = true;
      }
    }

    refreshIconElement_custerStats.addEventListener("click", restoreOriginalClusterStats);

  };
  xhr_object.send();
}

let clickedDailyStepStats = true;
function funDailyStepStats() {
  let loaderDailyStep = document.getElementById("loaderDailyStep");
  let barChartDailyStep = document.getElementById("barChartDailyStep");
  let dailyStepNoData = document.getElementById("dailyStepNoData");

  // barChartDailyStep.style.display = "none";
  // loaderDailyStep.style.display = "block";
  // dailyStepNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getDailyStepStats +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );
  console.log(
    getDailyStepStats +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunDailyStepStats = JSON.parse(this.responseText);
    console.log("Function employee--------- - ");
    console.log(resfunDailyStepStats);


    let responseValues = [];
    let responseLabels = [];

    // Extracting data from the response
    resfunDailyStepStats.response1.forEach(item => {
      // Check if the first element is not null
      if (item[0] !== null) {
        responseLabels.push(item[0]);
        responseValues.push(item[1]);
      }
    });
    let currentChartType = "bar"
    originalChartConfigDailyStepStats = {
      type: "bar",
      data: {
        labels: responseLabels,
        datasets: [
          {
            label: "Function",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: responseValues,
            borderRadius: 15,
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          yAxes: [
            {
              ticks: {
                beginAtZero: true,
              },
            },
          ],
          y: {
            title: {
              display: true,
              text: "Cumulative steps taken",
            },
          },
          x: {
            title: {
              display: true,
              text: "Date",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(barChartDailyStep, originalChartConfigDailyStepStats)

    loaderDailyStep.style.display = "none";
    if (resfunDailyStepStats.length == 0) {
      dailyStepNoData.style.display = "block";
      barChartDailyStep.style.display = "none";
    } else {
      dailyStepNoData.style.display = "none";
      barChartDailyStep.style.display = "block";
    }



    // if (!funDailyStepStats.initialized) {
    barChartDailyStep.onclick = function (event) {

      if (clickedDailyStepStats == true) {
        const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

        if (points.length) {
          const firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

          console.log(`Clicked on ${label} with value ${value}`);

          document.getElementById("listItemLabelDailyStepStats").textContent = `Ticket: ${label}`;
          // document.getElementById("listItemValue").textContent = `Value: ${value}`;
          // myChart.update();
          const dropdown = (document.getElementById("dataDropdown_dailyStepStats"));
          dropdown.style.display = "block";
        }


        dataDropdown_dailyStepStats.addEventListener("click", function (event) {
          const selectedOption = event.target.id;
          const firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const labelname = label;
          console.log(selectedOption);
          if (event.target.id != "closeDropdown") {
          if (selectedOption === "User_Name" && currentChartType === "bar") {
            let xhr_object = new XMLHttpRequest();
            xhr_object.open(
              "GET",
              getDailyStepStatsDrill +
              idLink +
              "&drilldown_by=" +
              selectedOption +
              "&status=" +
              labelname +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst,
              true
            );

            console.log(
              getDailyStepStatsDrill +
              idLink +
              "&drilldown_by=" +
              selectedOption +
              "&status=" +
              labelname +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst,
            );
            // alert(downloadFunctionWiseTotalLink);

            downloadFunctionWiseTotalLink = ip + "stepathon/get-function-wise-step-count-drill-down-download/" +
              idLink +
              "&drilldown_by=" +
              selectedOption +
              "&status=" +
              labelname +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst,



              xhr_object.onload = function () {
                resDailyStepStatsDrill = JSON.parse(this.responseText);
                console.log("DailyStepStats Drill Down - ");
                console.log(resDailyStepStatsDrill);

                const labels = resDailyStepStatsDrill.response.map(item => item[1]);
                const data = resDailyStepStatsDrill.response.map(item => item[0]);

                myChart.destroy();
                barChartDailyStep.style.display = "block";
                myChart = new Chart(barChartDailyStep, {
                  type: "bar",
                  data: {
                    labels: labels,
                    datasets: [{
                      label: "Data",
                      data: data,
                      backgroundColor: ["#e2445b"],
                    }]
                  },
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        stacked: true,
                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedDailyStepStats = false;
              }

            xhr_object.send();
            // funDailyStepStats.initialized =true;
          }
        }
        else {
          restoreOriginalChartTicket();
        }

          dataDropdown_dailyStepStats.style.display = "none";

          currentChartType = "bar";
        });
      } else if (clickedDailyStepStats == false) {
        alert("You have reached the maximum drill-down level.");
      }


    };
    // }
    // 
    function restoreOriginalChartTicket() {
      if (originalChartConfigDailyStepStats) {
        myChart.destroy(); // Destroy the current chart
        funDailyStepStats();
        clickedDailyStepStats = true;
      }
    }

    refreshIconElement_dailyStepStats.addEventListener("click", restoreOriginalChartTicket);

  };
  xhr_object.send();
}

let clickedGenderParticipation = true;
function fungenderParticipation() {
  let genderNoData = document.getElementById("genderNoData");
  let genderParticipation = document.getElementById("genderParticipation");
  let loaderGender = document.getElementById("loaderGender");

  // loaderGender.style.display = "block";
  // genderNoData.style.display = "none";
  // genderParticipation.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET",
    getGender +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst
    ,
    true
  );

  xhr_object.onload = function () {
    resfungenderParticipation = JSON.parse(this.responseText);
    console.log("Gender Participation");
    console.log(resfungenderParticipation);

    // Get the counts of male and female participants
    let femaleCount = parseInt(resfungenderParticipation.response1.female);
    let maleCount = parseInt(resfungenderParticipation.response1.male);

    // Update the pie chart data
    originalGenderParticipation = {
      type: "pie",
      data: {
        labels: ["Female", "Male"],
        datasets: [
          {
            label: "Gender",
            backgroundColor: ["#e2445b", "#01c875"],
            data: [femaleCount, maleCount], // Use the raw counts here
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffff",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              return value === 0 ? "" : value; // Display the raw count value
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    let myChart = new Chart(genderParticipation, originalGenderParticipation)
    loaderGender.style.display = "none";

    if (femaleCount + maleCount === 0) {
      genderNoData.style.display = "block";
      genderParticipation.style.display = "none";
    } else {
      genderNoData.style.display = "none";
      genderParticipation.style.display = "block";
    }



    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    if (!fungenderParticipation.initialized) {
      genderParticipation.onclick = function (event) {

        if (clickedGenderParticipation == true) {
          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelGenderParticipation").textContent = `Ticket: ${label}`;
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;
            // const backgroundColor = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            myChart.update();

            // console.log(backgroundColor);
          };

          const dropdown = (document.getElementById("dataDropdown_genderParticipation"));
          dropdown.style.display = "block";


          dataDropdown_genderParticipation.addEventListener("click", function (event) {
            if (event.target.id != "closeDropdown") {
            console.log("---------------------------------------")
            selectedOption = event.target.id;
            firstPoint = points[0];
            labelname = myChart.data.labels[firstPoint.index];
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            // cticket - b1onsole.log(backgroundColors);
            console.log(selectedOption);
            let xhr_object = new XMLHttpRequest();
            let apiURL;
            // First-level drill-down API
            // firstdrillDownSelectedOption  = 
            apiURL =
              getGenderParticipationDrill +
              idLink +
              "&drilldown_by=" +
              selectedOption +
              "&status=" +
              labelname +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst;
            console.log("GenderParticipation drill down 1");
            console.log(apiURL);

            // alert(downloadGenderParticipationLink);

            downloadGenderParticipationLink = ip + "stepathon/get-gender-participation-drill-down-download/" +
              idLink +
              "&drilldown_by=" +
              selectedOption +
              "&status=" +
              labelname +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateFirst,

              // alert("ifirst download")
              console.log(downloadGenderParticipationLink)

            xhr_object.open("GET", apiURL, true);

            xhr_object.onload = function () {
              resGenderParticipationDrill = JSON.parse(this.responseText);
              console.log("GenderParticipation Drill Down I- ");
              console.log(resGenderParticipationDrill);

              const labels = resGenderParticipationDrill.response.map(item => item[1]);
              const data = resGenderParticipationDrill.response.map(item => item[0]);
              // const labelname = label;
              myChart.destroy();
              myChart = new Chart(genderParticipation, {
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: "Data",
                    data: data,
                    backgroundColor: backgroundColors,
                  }]
                },
                options: {
                  responsive: true,
                  interaction: {
                    intersect: false,
                  },
                  scales: {
                    x: {
                      stacked: true,
                    },
                    y: {
                      stacked: true,
                    },
                  },
                  maintainAspectRatio: false,
                  scales: {
                    x: {
                      title: {
                        display: true,
                        text: labelname,
                        padding: {
                          top: 20,
                        }
                      }
                    },
                  },
                  plugins: {
                    datalabels: {
                      color: "#000000",
                      anchor: "end",
                      align: "end",
                      offset: -6,
                      font: {
                        size: "10",
                        weight: "bold",
                      },
                      formatter: function (value, context) {
                        // Hide label if value is zero
                        return value === 0 ? '' : value;
                      }
                    },
                    legend: {
                      display: true,
                      position: "no",
                    },
                  },
                },
                plugins: [ChartDataLabels],
              });

            }
            xhr_object.send();
          }
          else {
            restoreOriginalGenderParticipation();
          }

            dataDropdown_genderParticipation.style.display = "none";

          });

        } else if (clickedGenderParticipation == false) {
          alert("You have reached the maximum drill-down level.");
        }
        // edit

        fungenderParticipation.initialized = true;
      };
    }
    function restoreOriginalGenderParticipation() {

      if (originalGenderParticipation) {
        myChart.destroy(); // Destroy the current chart
        fungenderParticipation();
        clickedGenderParticipation = true;
      }
    }

    refreshIconElement_genderParticipation.addEventListener("click", restoreOriginalGenderParticipation);



  };

  xhr_object.send();

}

let clickedTrendsOverMonths = true;
// refreshIconElement_trendOverMonth   dataDropdown_trendOverMonth  listItemLabelTrendOverMonth
function funInventoryOverMonthSites() {
  let loaderTrendsMonths = document.getElementById("loaderTrendsMonths");
  let TrendsMonthsNoData = document.getElementById("TrendsMonthsNoData");
  let trendsOverMonths = document.getElementById("trendsOverMonths");

  // ---------------------------------------------------
  // trendsOverMonths.style.display = "block";
  // loaderTrendsMonths.style.display = "block";
  // TrendsMonthsNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      gettrendsOverMonths + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(
      gettrendsOverMonths + idLink + "&date=" + globalDateFirst
    );
  }
  else {
    xhr_object.open(
      "GET",
      gettrendsOverMonths +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      gettrendsOverMonths +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfuntrendsOverMonths = JSON.parse(this.responseText);
    console.log("Inventory Trends Over Months - ");
    console.log(resfuntrendsOverMonths);


    let months = Object.keys(resfuntrendsOverMonths.response);
    let consumptionData = Object.values(resfuntrendsOverMonths.response).map(
      (item) => item.trend_over_month
    );


    // Added now
    originalChartTrendsOverMonths = {
      type: "bar",
      data: {
        labels: months,
        datasets: [
          {
            label: "Inventory Consumption",
            backgroundColor: ["#77216f"],
            data: consumptionData,
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        // interaction: {
        //   intersect: false,
        // },

        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
            beginAtZero: true,
            title: {
              display: true,
              text: 'Months',
              padding: {
                top: 20,
              }
            }

          },
          y: {
            beginAtZero: true,
            // ticks: {
            //   callback: function (value) {
            //     return value + "%"
            //   }
            // },
            title: {
              display: true,
              text: 'Total Cost'
            }
          }
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            ticks: {
              callback: function (value) {
                return value
              }
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(trendsOverMonths, originalChartTrendsOverMonths)

    loaderTrendsMonths.style.display = "none";
    TrendsMonthsNoData.style.display = "none";
    trendsOverMonths.style.display = "block";

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    let InventoryOverMonthSitesdrillDownLevel = 1;

    if (!funInventoryOverMonthSites.initialized) {
      trendsOverMonths.onclick = function (event) {

        if (clickedTrendsOverMonths == true) {

          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelTrendOverMonth").textContent = `Ticket: ${label}`;
            myChart.update();
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_trendOverMonth"));
            dropdown.style.display = "block";


          }

          dataDropdown_trendOverMonth.addEventListener("click", function (event) {

            // if (selectedOption === "Tower" || "Flat_Type" || "Status" || "Created_By" || "Proactive/Reactive" || "Category" || "Sub_Category" || "Assign_To" || "Priority" || "Ticket_Type" || "Related_To" && currentChartType === "bar") {
              if (event.target.id != "closeDropdown") {
            if (InventoryOverMonthSitesdrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getInventoryOverMonthDrill +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;

              console.log("TicketCategoryDrill  1");
              console.log(apiURL);
              xhr_object.open("GET", apiURL, true);



              downloadTrendsMonthsLink = ip + "supervisor-monthly/get-inventory-consumption-over-months-drill-down-excel/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resTrendsOverMonthsDrill = JSON.parse(this.responseText);
                console.log("TrendsOverMonths Drill Down -1 ");
                console.log(resTrendsOverMonthsDrill);

                // const labels = Object.keys(resTrendsOverMonthsDrill.response);
                const labels = resTrendsOverMonthsDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resTrendsOverMonthsDrill.response[label][status] || 0),
                    data: resTrendsOverMonthsDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(trendsOverMonths, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();

              InventoryOverMonthSitesdrillDownLevel = 2;
            } else if (InventoryOverMonthSitesdrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);

              apiURL =
                getInventoryOverMonthDrillSecond +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadTrendsMonthsLink = ip + "supervisor-monthly/get-inventory-consumption-over-months-drill-down-excel/" +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resTrendsOverMonthsDrill = JSON.parse(this.responseText);
                console.log("TrendsOverMonths Drill Down -2 ");
                console.log(resTrendsOverMonthsDrill);

                // const labels = Object.keys(resTrendsOverMonthsDrill.response);
                const labels = resTrendsOverMonthsDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"];

                // for (const label of labels) {
                //   datasets.push({
                //     label: label,
                //     data: statuses.map(status => resTrendsOverMonthsDrill.response[label][status] || 0),
                //     backgroundColor: label === "Open" ? "#e2445b" : "#01c875",
                //     stack: "0",
                //   });
                // }

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resTrendsOverMonthsDrill.response[label][status] || 0),
                    data: resTrendsOverMonthsDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: status,

                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(trendsOverMonths, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedTrendsOverMonths = false;
              }

              xhr_object.send();
              InventoryOverMonthSitesdrillDownLevel = 3;
              clickedTrendsOverMonths = false;
              return;
            }
          }
          else {
            if(InventoryOverMonthSitesdrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_trendOverMonth.style.display = "none";


          });

        } else if (clickedTrendsOverMonths == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChart() {
      if (originalChartTrendsOverMonths) {
        myChart.destroy(); // Destroy the current chart
        funInventoryOverMonthSites();
        clickedTrendsOverMonths = true;

      }
    }

    refreshIconElement_trendOverMonth.addEventListener("click", restoreOriginalChart);

  };
  xhr_object.send();


}

let clickedTrendsOverSites = true;
function funInventoryOverSites() {
  let loaderTrendsSites = document.getElementById("loaderTrendsSites");
  let TrendsSitesNoData = document.getElementById("TrendsSitesNoData");
  let trendsOverSites = document.getElementById("trendsOverSites");


  // -------------------------------------------------------
  // TrendsOverSites

  // trendsOverSites.style.display = "block";
  // loaderTrendsSites.style.display = "block";
  // TrendsSitesNoData.style.display = "none";

  let xhr_object1 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object1.open(
      "GET",
      gettrendsOverSites + idLink +"&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(
      gettrendsOverSites + idLink + "&date=" + globalDateFirst
    );
  }
  else {
    xhr_object1.open(
      "GET",
      gettrendsOverSites +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      gettrendsOverSites +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }



  xhr_object1.onload = function () {
    resfuntrendsOverSites = JSON.parse(this.responseText);
    console.log("Inventory Trends Over Sites - ");
    console.log(resfuntrendsOverSites);

    // let responseValues = [resfuntrendsOverSites.response[0]];
    // let responseLabels = [resfuntrendsOverSites.response[1]];
    let responseLabels = Object.keys(resfuntrendsOverSites.response); // Get the first key in response object
    let responseValues = Object.values(resfuntrendsOverSites.response);
  

    // Added now
    originalChartTrendsOverSites = {
      type: "bar",
      data: {
        labels: responseLabels,
        datasets: [
          {
            label: "Trends over Months",
            backgroundColor: ["#E95420"],
            data: responseValues,
            borderWidth: 1,
            borderColor: "#E95420",
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        // interaction: {
        //   intersect: false,
        // },

        scales: {
          x: {
            // ticks: {
            //   callback: function (value) {
            //     return this.getLabelForValue(value).substr(0, 15);
            //   },
            // },
            beginAtZero: true,
            title: {
              display: true,
              text: 'Sites',
              padding: {
                top: 20,
              }
            }

          },
          y: {
            beginAtZero: true,
            // ticks: {
            //   callback: function (value) {
            //     return value + "%"
            //   }
            // },
            title: {
              display: true,
              text: 'Total Cost'
            }
          }
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            ticks: {
              callback: function (value) {
                return value
              }
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    let myChart = new Chart(trendsOverSites, originalChartTrendsOverSites)
    let listItemLabelTrendsOverSites = document.getElementById("listItemLabelTrendsOverSites")

    loaderTrendsSites.style.display = "none";
    TrendsSitesNoData.style.display = "none";
    trendsOverSites.style.display = "block";

    // if ((resfuntrendsOverSites.response).length == 0) {
    //   loaderTrendsSites.style.display = "none";
    //   TrendsSitesNoData.style.display = "none";
    //   trendsOverSites.style.display = "block";

    // } else {
    //   loaderTrendsSites.style.display = "none";
    //   trendsOverSites.style.display = "block";
    // }


    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;

    if (!funInventoryOverSites.initialized) {
      trendsOverSites.onclick = function (event) {
        let TrendsOverSitesdrillDownLevel = 1;
        if (clickedTrendsOverSites == true) {

          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelTrendsOverSites").textContent = `Ticket: ${label}`;
            // console.log(label)
            // listItemLabelTrendsOverSites.textContent = ` ${label}`;
            console.log(label)
            myChart.update();
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_trendsOverSites"));
            // let dataDropdown_trendsOverSites = document.getElementById("dataDropdown_trendsOverSites")
            dropdown.style.display = "block";


          }

          dataDropdown_trendsOverSites.addEventListener("click", function (event) {

            if (event.target.id != "closeDropdown") {
            if (TrendsOverSitesdrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              // "&drilldown_by=" +
              apiURL =
                getTrendsOverSitesDrill
                +
                idLink +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;

              console.log("TicketCategoryDrill  1");
              console.log(apiURL);
              xhr_object.open("GET", apiURL, true);

              downloadTrendsSitesLink = ip + "supervisor-monthly/get-inventory-consumption-over-site-drill-down-excel/" + idLink +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;

              xhr_object.onload = function () {
                resTrendsOverSitesDrill = JSON.parse(this.responseText);
                console.log("TrendsOverSitesDrill Drill Down -1 ");
                console.log(resTrendsOverSitesDrill);

                // const labels = Object.keys(resTrendsOverSitesDrill.response);
                const labels = resTrendsOverSitesDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resTrendsOverSitesDrill.response[label][status] || 0),
                    data: resTrendsOverSitesDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(trendsOverSites, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();
              TrendsOverSitesdrillDownLevel = 2;
            }
            else if (TrendsOverSitesdrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);
              // let xhr_object = new XMLHttpRequest();
              apiURL =
                getTrendsOverSitesDrillSecond +
                idLink +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadTrendsSitesLink = ip + "supervisor-monthly/get-inventory-consumption-over-site-drill-down-excel/" +
                idLink +
                "&status=" +
                labelname +
                "&first_drilldown_by=" +
                selectedOption +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resTrendsOverSitesDrill = JSON.parse(this.responseText);
                console.log("Trends Over Sites Drill Down -2 ");
                console.log(resTrendsOverSitesDrill);

                // const labels = Object.keys(resTrendsOverSitesDrill.response);
                const labels = resTrendsOverSitesDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"];

                // for (const label of labels) {
                //   datasets.push({
                //     label: label,
                //     data: statuses.map(status => resTrendsOverMonths.response[label][status] || 0),
                //     backgroundColor: label === "Open" ? "#e2445b" : "#01c875",
                //     stack: "0",
                //   });
                // }

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resTrendsOverSitesDrill.response[label][status] || 0),
                    data: resTrendsOverSitesDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: status,

                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(trendsOverSites, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedTrendsOverSites = false;
              }

              xhr_object.send();
              TrendsOverSitesdrillDownLevel = 3;
              clickedTrendsOverSites = false;
              return;
            }
          }
          else {
            if(TrendsOverSitesdrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_trendsOverSites.style.display = "none";


          });

        } else if (clickedTrendsOverSites == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChart() {
      if (originalChartTrendsOverSites) {
        myChart.destroy(); // Destroy the current chart
        funInventoryOverSites();
        clickedTrendsOverSites = true;

      }
    }

    refreshIconElement_trendsOverSites.addEventListener("click", restoreOriginalChart);


  };
  xhr_object1.send();


}

// showTotalVisitors2(),loaderTotalVisitorsII,totalVisitorsNoDataII,total-visitors-II  refreshIconElement_totalVisitorII  dataDropdown_totalVisitorII  listItemLabelTotalVisitorII

let clickedTotalVisitors2 = true;
function funTotalVisitors2() {
  let totalVisitorsNoDataII = document.getElementById("totalVisitorsNoDataII");
  let total_visitors_II = document.getElementById("total-visitors-II");
  let loaderTotalVisitorsII = document.getElementById("loaderTotalVisitorsII");
  let dt2_tv = document.getElementById("dt2_tv");

  // loaderTotalVisitorsII.style.display = "none";
  // totalVisitorsNoDataII.style.display = "block";

  // if (globalType == "daily") {
  //   dt2_tv.innerHTML = "Total Visitors " + globalDateFirst;
  // } else {
  //   dt2_tv.innerHTML =
  //     "Total Visitors " + globalDateFirst + " to " + globalDateSecond;
  // }

  // loaderTotalVisitorsII.style.display = "block";
  // totalVisitorsNoDataII.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getTotalVisitorsII + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(" get Total Visitor");
    console.log(getTotalVisitorsII + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object.open(
      "GET",
      getTotalVisitorsII +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getTotalVisitorsII +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunTotalVisitorsII = JSON.parse(this.responseText);

    console.log("Total Visitors  - ");
    console.log(resfunTotalVisitorsII);

    // var total_visitors_II = total_visitors_II.getContext('2d');

    // const ctx = document.getElementById("myChart").getContext('2d');
    // if (typeof myChart !== 'null') {
    //     myChart.destroy();
    //   }
    let label_key = Object.keys(resfunTotalVisitorsII.response);
    let data_value = Object.values(resfunTotalVisitorsII.response);

    originalChartTotalVisitorII = {
      type: "bar",
      data: {
        labels: label_key,
        datasets: [
          {
            label: "Visitors",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: data_value,
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    };
    // char.destory();
    // Destroy the existing chart

    let myChart = new Chart(total_visitors_II, originalChartTotalVisitorII)

    loaderTotalVisitorsII.style.display = "none";
    totalVisitorsNoDataII.style.display = "none";
    total_visitors_II.style.display = "block";

    // let sum = 0;
    // let resValues = Object.values(resfunTotalVisitorsII.response);

    // for (let i = 0; i < resValues.length; i += 1) {
    //   sum = resValues[i] + sum;
    // }

    // // if (sum == 0) {
    // //   totalVisitorsNoDataII.style.display = "block";
    // //   total_visitors_II.style.display = "none";
    // // } else {
    //   totalVisitorsNoDataII.style.display = "none";
    //   total_visitors_II.style.display = "block";
    // // }
    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;
    // refreshIconElement_totalVisitorII  dataDropdown_totalVisitorII  listItemLabelTotalVisitorII TotalVisitorIIdrillDownLevel  originalChartTotalVisitorII  total_visitors_II
    if (!funTotalVisitors2.initialized) {
      total_visitors_II.onclick = function (event) {
        let TotalVisitorIIdrillDownLevel = 1;
        if (clickedTotalVisitors2 == true) {

          const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

          if (points.length) {
            firstPoint = points[0];
            const label = myChart.data.labels[firstPoint.index];
            const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];

            console.log(`Clicked on ${label} with value ${value}`);
            selectedlabelValue = label;
            document.getElementById("listItemLabelTotalVisitorII").textContent = `Ticket: ${label}`;
            myChart.update();
            // document.getElementById("listItemValue").textContent = `Value: ${value}`;

            // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
            // dropdown.show();

            const dropdown = (document.getElementById("dataDropdown_totalVisitorII"));
            dropdown.style.display = "block";


          }

          dataDropdown_totalVisitorII.addEventListener("click", function (event) {

            // if (selectedOption === "Tower" || "Flat_Type" || "Status" || "Created_By" || "Proactive/Reactive" || "Category" || "Sub_Category" || "Assign_To" || "Priority" || "Ticket_Type" || "Related_To" && currentChartType === "bar") {
              if (event.target.id != "closeDropdown") {
            if (TotalVisitorIIdrillDownLevel === 1) {
              selectedOption = event.target.id;
              firstPoint = points[0];
              labelname = myChart.data.labels[firstPoint.index];
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedOption);

              let xhr_object = new XMLHttpRequest();
              let apiURL;

              apiURL =
                getTotalVisitorsIIDrillDown +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;

              console.log("TicketCategoryDrill  1");
              console.log(apiURL);
              xhr_object.open("GET", apiURL, true);



              downloadTotalVisitorIILink = ip + "fm-excel-download/get-site-wise-visitors-drill-down-excel/" + idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                "" +
                "&sec_drill_down_on=" +
                "" +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resfunTotalVisitorsIIDrill = JSON.parse(this.responseText);
                console.log("TrendsOverMonths Drill Down -1 ");
                console.log(resfunTotalVisitorsIIDrill);

                // const labels = Object.keys(resfunTotalVisitorsIIDrill.response);
                const labels = resfunTotalVisitorsIIDrill.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"]; // Assuming these are the possible statuses

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resfunTotalVisitorsIIDrill.response[label][status] || 0),
                    data: resfunTotalVisitorsIIDrill.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: "0"
                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(total_visitors_II, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });

              }

              xhr_object.send();

              TotalVisitorIIdrillDownLevel = 2;
            } else if (TotalVisitorIIdrillDownLevel === 2) {

              // alert(selectedOption);
              // alert(labelname);
              // alert(selectedlabelValue);
              const firstPoint = points[0];
              // alert(firstPoint.index);
              const selectedSecondOption = event.target.id;
              const labelSecond = myChart.data.labels[firstPoint.index];
              const labelnameSecond = labelSecond;
              backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
              console.log(selectedSecondOption);
              console.log(selectedlabelValue);
              // console.log(backgroundColors);

              apiURL =
                getTotalVisitorsIIDrillDown +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;
              // alert("second drill down api");
              console.log(apiURL);

              xhr_object.open("GET", apiURL, true);

              downloadTotalVisitorIILink = ip + "fm-excel-download/get-site-wise-visitors-drill-down-excel/" +
                idLink +
                "&first_drilldown_by=" +
                selectedOption +
                "&status=" +
                labelname +
                "&sec_drilldown_by=" +
                selectedSecondOption +
                "&sec_drill_down_on=" +
                selectedlabelValue +
                "&from_date=" +
                globalDateFirst +
                "&to_date=" +
                globalDateSecond;


              xhr_object.onload = function () {
                resfunTotalVisitorsIIDrillSecond = JSON.parse(this.responseText);
                console.log("resfunTotalVisitorsIIDrillSecond Drill Down -2 ");
                // resfunTotalVisitorsIIDrillSecond
                // const labels = Object.keys(resfunTotalVisitorsIIDrillSecond.response);
                const labels = resfunTotalVisitorsIIDrillSecond.response.map(item => item[1]);
                const datasets = [];

                // const labelname = label;
                // console.log(labelname);


                const statuses = ["Open", "Closed"];

                // for (const label of labels) {
                //   datasets.push({
                //     label: label,
                //     data: statuses.map(status => resfunTotalVisitorsIIDrillSecond.response[label][status] || 0),
                //     backgroundColor: label === "Open" ? "#e2445b" : "#01c875",
                //     stack: "0",
                //   });
                // }

                for (const status of statuses) {
                  datasets.push({
                    label: status,
                    // data: labels.map(label => resfunTotalVisitorsIIDrillSecond.response[label][status] || 0),
                    data: resfunTotalVisitorsIIDrillSecond.response.map(item => item[0]),
                    backgroundColor: status === "Open" ? "#e2445b" : "#01c875",
                    stack: status,

                  });
                }

                const barData = {
                  labels: labels,
                  datasets: datasets,
                };



                myChart.destroy();
                myChart = new Chart(total_visitors_II, {
                  type: "bar",
                  data: barData,
                  options: {
                    responsive: true,
                    interaction: {
                      intersect: false,
                    },
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }

                      },
                      y: {
                        stacked: true,
                      },
                    },
                    maintainAspectRatio: false,
                    scales: {
                      x: {
                        title: {
                          display: true,
                          text: labelname,
                        }
                      },
                    },
                    plugins: {
                      datalabels: {
                        color: "#000000",
                        anchor: "end",
                        align: "end",
                        offset: -6,
                        font: {
                          size: "10",
                          weight: "bold",
                        },
                        formatter: function (value, context) {
                          // Hide label if value is zero
                          return value === 0 ? '' : value;
                        }
                      },
                      legend: {
                        display: true,
                        position: "no",
                      },
                    },
                  },
                  plugins: [ChartDataLabels],
                });
                clickedTotalVisitors2 = false;
              }

              xhr_object.send();
              TotalVisitorIIdrillDownLevel = 3;
              clickedTotalVisitors2 = false;
              return;
            }
          }
          else {
            if(TotalVisitorIIdrillDownLevel === 1) {
              restoreOriginalChart();
            }
          }

            dataDropdown_totalVisitorII.style.display = "none";

          });

        } else if (clickedTotalVisitors2 == false) {
          alert("You have reached the maximum drill-down level.");
        }


      };
    }
    function restoreOriginalChart() {
      if (originalChartTotalVisitorII) {
        myChart.destroy(); // Destroy the current chart
        funTotalVisitors2();
        clickedTotalVisitors2 = true;

      }
    }

    refreshIconElement_totalVisitorII.addEventListener("click", restoreOriginalChart);


    // refreshIconElement_totalVisitorII  dataDropdown_totalVisitorII  listItemLabelTotalVisitorII
  };

  xhr_object.send();
}

function funSitePermit() {
  // loaderSitePermit,SitePermitNoData,sitePermit
  let SitePermitNoData = document.getElementById("SitePermitNoData");
  let sitePermit = document.getElementById("sitePermit");
  let loaderSitePermit = document.getElementById(
    "loaderSitePermit"
  );


  // loaderSitePermit.style.display = "block";
  // SitePermitNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getSitePermit + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(
      getSitePermit + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getSitePermit +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getSitePermit +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  // xhr_object.onload = function () {
  //   // Parse the JSON response
  //   var resfunSitePermit = JSON.parse(this.responseText);

  //   console.log("Permit Site------------------- - ");
  //   console.log(resfunSitePermit);

  //   const locations = Object.keys(resfunSitePermit.response);
  //   const categories = resfunSitePermit.response[locations[0]].map(item => item[1]);
  //   const data = categories.map((category, index) => (
  //     locations.map(location => resfunSitePermit.response[location].find(item => item[index] === category))
  //   ));


  //   // Your existing code to generate random color
  //   function getRandomColor() {
  //     const letters = "0123456789ABCDEF";
  //     let color = "#";
  //     for (let i = 0; i < 6; i++) {
  //       color += letters[Math.floor(Math.random() * 16)];
  //     }
  //     return color;
  //   }

  //   // Create a new Chart
  //   new Chart(sitePermit, {
  //     type: "bar",
  //     data: {
  //       labels: locations,
  //       datasets: categories.map((category, index) => ({
  //         label: category,
  //         data: data.map(locationData => locationData[index]),
  //         backgroundColor: getRandomColor(),
  //         stack: "Stack 0",
  //       })),
  //     },
  //     options: {
  //       responsive: true,
  //       interaction: {
  //         intersect: false,
  //       },
  //       scales: {
  //         x: {
  //           beginAtZero: true,
  //           title: {
  //             display: true,
  //             text: 'Sites',
  //             padding: {
  //               top: 20,
  //             },
  //           },
  //         },
  //         y: {
  //           stacked: true, // Stack bars on the y-axis
  //           beginAtZero: true,
  //           title: {
  //             display: true,
  //             text: 'Type of Permits created'
  //           },
  //         },
  //       },
  //       maintainAspectRatio: false,
  //       plugins: {
  //         datalabels: {
  //           color: "#000000",
  //           anchor: "end",
  //           align: "end",
  //           offset: -6,
  //           font: {
  //             size: "10",
  //             weight: "bold",
  //           },
  //         },
  //         legend: {
  //           labels: {
  //             usePointStyle: true,
  //           },
  //           display: true,
  //           position: "top",
  //           align: "end"
  //         },
  //       },
  //     },
  //   });


  //   loaderSitePermit.style.display = "none";

  //   // if (labels.length === 0) {
  //   //   SitePermitNoData.style.display = "block";
  //   //   sitePermit.style.display = "none";
  //   // } else {
  //     SitePermitNoData.style.display = "none";
  //     sitePermit.style.display = "block";
  //   // }
  // };


  xhr_object.onload = function () {
    // Parse the JSON response
    var resfunSitePermit = JSON.parse(this.responseText);

    console.log("Permit Site------------------- - ");
    console.log(resfunSitePermit);

    const locations = Object.keys(resfunSitePermit.response);
    const categories = Array.from(
      new Set(
        locations.flatMap(
          (location) => resfunSitePermit.response[location].map((item) => item[1])
        )
      )
    );

    const data = locations.map((location) =>
      categories.map((category) => {
        const foundItem = resfunSitePermit.response[location].find(
          (item) => item[1] === category
        );
        return foundItem ? foundItem[0] : 0;
      })
    );

    // Your existing code to generate random color
    function getRandomColor() {
      const letters = "0123456789ABCDEF";
      let color = "#";
      for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

    // Create a new Chart
    new Chart(sitePermit, {
      type: "bar",
      data: {
        labels: locations,
        datasets: categories.map((category, index) => ({
          label: category,
          data: data.map((locationData) => locationData[index]),
          backgroundColor: getRandomColor(),
          stack: "Stack 0",
        })),
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            beginAtZero: true,
            title: {
              display: true,
              text: "Sites",
              padding: {
                top: 20,
              },
            },
          },
          y: {
            stacked: true, // Stack bars on the y-axis
            beginAtZero: true,
            title: {
              display: true,
              text: "Type of Permits created",
            },
          },
        },
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            labels: {
              usePointStyle: true,
            },
            display: true,
            position: "top",
            align: "end",
          },
        },
      },
    });

    loaderSitePermit.style.display = "none";

    // if (labels.length === 0) {
    //   SitePermitNoData.style.display = "block";
    //   sitePermit.style.display = "none";
    // } else {
    SitePermitNoData.style.display = "none";
    sitePermit.style.display = "block";
    // }
  };

  xhr_object.send();

  function getRandomColor() {
    return "#" + Math.floor(Math.random() * 16777215).toString(16);
  }


}


function funPermitStatus() {
  // permitStatus,loaderPermitStatus,PermitStatusNoData
  let PermitStatusNoData = document.getElementById("PermitStatusNoData");
  let permitStatus = document.getElementById("permitStatus");
  let loaderPermitStatus = document.getElementById(
    "loaderPermitStatus"
  );


  // loaderPermitStatus.style.display = "block";
  // PermitStatusNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getPermitStatus + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(
      getPermitStatus + idLink + "&date=" + globalDateFirst
    );
  } else {
    xhr_object.open(
      "GET",
      getPermitStatus +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getPermitStatus +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }

  xhr_object.onload = function () {
    resfunPermitStatus = JSON.parse(this.responseText);

    console.log("Permit Status------------------------ - ");
    console.log(resfunPermitStatus);

    let total = resfunPermitStatus.response.Closed + resfunPermitStatus.response.Extended + resfunPermitStatus.response.Open;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }

    // Specify colors for each segment
    // var backgroundColors = ["#5ae717", "yellow", "red"];

    // Create a new Chart
    myChart = new Chart(permitStatus, {
      type: "doughnut",
      data: {
        labels: ["Closed", "Extended", "Open"],
        datasets: [
          {
            label: "Permit Status",
            backgroundColor: ["#5ae717", "yellow", "red"],
            data: [
              resfunPermitStatus.response.Closed,
              resfunPermitStatus.response.Extended,
              resfunPermitStatus.response.Open,

            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffff",
            // anchor: "end",
            // align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels, centerText],
    });

    loaderPermitStatus.style.display = "none";

    if (labels.length === 0) {
      PermitStatusNoData.style.display = "block";
      permitStatus.style.display = "none";
    } else {
      PermitStatusNoData.style.display = "none";
      permitStatus.style.display = "block";
    }

    // Manually draw total in the center
    var ctx = myChart.ctx;
    var centerX = myChart.width / 2;
    var centerY = myChart.height / 2;

    ctx.font = "16px Arial";
    ctx.fillStyle = "#000000";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText("Total: " + total, centerX, centerY);
  };

  xhr_object.send();




}

function funInventory() {  // overStock,underStock,totalInventory titleInventory,capitalBlock , valueConsumable,valueSpares
  console.log("inventoryyyyyyyyyyyyyyyyyyyy");
  let titleInventory = document.getElementById("titleInventory");
  let overStock = document.getElementById("overStock");
  let underStock = document.getElementById("underStock");
  let totalInventory = document.getElementById("totalInventory");
  let capitalBlock = document.getElementById("capitalBlock");
  let purchaseOrder = document.getElementById("purchaseOrder");
  let workOrder = document.getElementById("workOrder");
  let valueConsumable = document.getElementById("valueConsumable");
  let valueSpares = document.getElementById("valueSpares");
  // if (globalType == "daily") {
  //   titleInventory.innerHTML =
  //     "Inventory  for " + convertDateFormat(globalDateFirst);
  // } else {
  //   titleInventory.innerHTML =
  //     "Inventory for " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  // }

  // ----------------------------------------------

  let xhr_object1 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object1.open(
      "GET",
      gettotalInventory + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(gettotalInventory + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object1.open(
      "GET",
      gettotalInventory +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      gettotalInventory +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object1.onload = function () {
    resfuntotalInventory = JSON.parse(this.responseText);
    console.log("Total Value of Inventory - ");
    console.log(resfuntotalInventory);

    totalInventory.innerHTML =
      resfuntotalInventory.total_inventory_response;

    capitalBlock.innerHTML =
      resfuntotalInventory.capital_block;


  };
  xhr_object1.send();

  //---------------------------------------------------------

  let xhr_object2 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object2.open(
      "GET",
      getOverUnderStock + idLink +   "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(getOverUnderStock + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object2.open(
      "GET",
      getOverUnderStock +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getOverUnderStock +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object2.onload = function () {
    console.log("stockkkkkkkkkkkkkkkkkkk");
    // resfunOverUnderStock = JSON.parse(this.responseText);
    resfunOverUnderStock = JSON.parse(this.responseText);
    console.log("Over Under Stock - ");
    console.log(resfunOverUnderStock);
    overStock.innerHTML =
      resfunOverUnderStock.over_stock_response;

    underStock.innerHTML =
      resfunOverUnderStock.under_stock_response;

  };
  xhr_object2.send();


  let xhr_object3 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object3.open(
      "GET",
      getPurchaseOrder + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(getPurchaseOrder + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object3.open(
      "GET",
      getPurchaseOrder +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getPurchaseOrder +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object3.onload = function () {
    resfunpurchaseOrder = JSON.parse(this.responseText);
    console.log("Purchase Order - ");
    console.log(resfunpurchaseOrder);
    purchaseOrder.innerHTML = resfunpurchaseOrder.puchase_order_response;

    workOrder.innerHTML = resfunpurchaseOrder.work_order_response;

  };
  xhr_object3.send();


  // --------------------------------------------------------------

  let xhr_object4 = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object4.open(
      "GET",
      getTotalValues + idLink +  "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateFirst,
      true
    );
    console.log(getTotalValues + idLink + "&date=" + globalDateFirst);
  } else {
    xhr_object4.open(
      "GET",
      getTotalValues +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
    console.log(
      getTotalValues +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond
    );
  }
  xhr_object4.onload = function () {
    resfuntotalValue = JSON.parse(this.responseText);
    console.log("Total Values - ");
    console.log(resfuntotalValue);
    valueConsumable.innerHTML = resfuntotalValue.consumable_response;

    valueSpares.innerHTML = resfuntotalValue.spare_response;

  };
  xhr_object4.send();


  // -----------------------------------------------------------------

}


function Refresh_OverStock() {
  let overStock = document.getElementById("overStock");
  let loader = document.getElementById("loader_OverStock");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    overStock.innerHTML = "";

    let xhr_object = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object.open(
        "GET",
        getOverUnderStock + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(getOverUnderStock + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object.open(
        "GET",
        getOverUnderStock +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getOverUnderStock +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object.onload = function () {
      resfunOverUnderStock = JSON.parse(this.responseText);
      console.log("Over Under Stock - ");
      console.log(resfunOverUnderStock);
      // Check if response exists and if it's greater than 0 hours
      if (resfunOverUnderStock && parseFloat(resfunOverUnderStock.over_stock_response) > 0) {
        overStock.innerHTML = resfunOverUnderStock.over_stock_response + "";
      } else {
        overStock.innerHTML = "No data available";
        overStock.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object.send();

  }

  fetchData();

}


function Refresh_UnderStock() {
  let underStock = document.getElementById("underStock");
  let loader = document.getElementById("loader_UnderStock");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    underStock.innerHTML = "";

    let xhr_object2 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object2.open(
        "GET",
        getOverUnderStock + idLink +  "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(getOverUnderStock + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object2.open(
        "GET",
        getOverUnderStock +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getOverUnderStock +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object2.onload = function () {
      resfunOverUnderStock = JSON.parse(this.responseText);
      console.log("Over Under Stock - ");
      console.log(resfunOverUnderStock);
      // Check if response exists and if it's greater than 0 hours
      if (resfunOverUnderStock && parseFloat(resfunOverUnderStock.under_stock_response) > 0) {
        underStock.innerHTML =
          resfunOverUnderStock.under_stock_response;
      } else {
        underStock.innerHTML = "No data available";
        underStock.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object2.send();

  }

  fetchData();

}



function Refresh_WorkOrder() {
  let workOrder = document.getElementById("workOrder");
  let loader = document.getElementById("loader_WorkOrder");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    workOrder.innerHTML = "";

    let xhr_object3 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object3.open(
        "GET",
        getPurchaseOrder + idLink +  "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(getPurchaseOrder + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object3.open(
        "GET",
        getPurchaseOrder +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getPurchaseOrder +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object3.onload = function () {
      resfunpurchaseOrder = JSON.parse(this.responseText);
      console.log("Purchase Order - ");
      console.log(resfunpurchaseOrder);
      // Check if response exists and if it's greater than 0 hours
      if (resfunpurchaseOrder && parseFloat(resfunpurchaseOrder.work_order_response) > 0) {
        workOrder.innerHTML = resfunpurchaseOrder.work_order_response;
      } else {
        workOrder.innerHTML = "No data available";
        workOrder.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object3.send();

  }

  fetchData();

}



function Refresh_purchaseOrder() {
  let purchaseOrder = document.getElementById("purchaseOrder");
  let loader = document.getElementById("loader_purchaseOrder");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    purchaseOrder.innerHTML = "";

    let xhr_object3 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object3.open(
        "GET",
        getPurchaseOrder + idLink +  "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(getPurchaseOrder + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object3.open(
        "GET",
        getPurchaseOrder +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getPurchaseOrder +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object3.onload = function () {
      resfunpurchaseOrder = JSON.parse(this.responseText);
      console.log("Purchase Order - ");
      console.log(resfunpurchaseOrder);
      // Check if response exists and if it's greater than 0 hours
      if (resfunpurchaseOrder && parseFloat(resfunpurchaseOrder.puchase_order_response) > 0) {
        purchaseOrder.innerHTML = resfunpurchaseOrder.puchase_order_response;
      } else {
        purchaseOrder.innerHTML = "No data available";
        purchaseOrder.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object3.send();

  }

  fetchData();

}


function Refresh_TotalValue() {
  let totalInventory = document.getElementById("totalInventory");
  let loader = document.getElementById("loader_TotalValue");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    totalInventory.innerHTML = "";

    let xhr_object1 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object1.open(
        "GET",
        gettotalInventory + idLink +  "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(gettotalInventory + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object1.open(
        "GET",
        gettotalInventory +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        gettotalInventory +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object1.onload = function () {
      resfuntotalInventory = JSON.parse(this.responseText);
      console.log("Total Value of Inventory - ");
      console.log(resfuntotalInventory);
      // Check if response exists and if it's greater than 0 hours
      if (resfuntotalInventory && parseFloat(resfuntotalInventory.total_inventory_response) > 0) {
        totalInventory.innerHTML =
          resfuntotalInventory.total_inventory_response;

      } else {
        totalInventory.innerHTML = "No data available";
        totalInventory.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object1.send();

  }

  fetchData();

}

function Refresh_capitalBlock() {
  let capitalBlock = document.getElementById("capitalBlock");
  let loader = document.getElementById("loader_capitalBlock");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    capitalBlock.innerHTML = "";

    let xhr_object1 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object1.open(
        "GET",
        gettotalInventory + idLink +  "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(gettotalInventory + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object1.open(
        "GET",
        gettotalInventory +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        gettotalInventory +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object1.onload = function () {
      resfuntotalInventory = JSON.parse(this.responseText);
      console.log("Total Value of Inventory - ");
      console.log(resfuntotalInventory);
      // Check if response exists and if it's greater than 0 hours
      if (resfuntotalInventory && parseFloat(resfuntotalInventory.capital_block) > 0) {
        capitalBlock.innerHTML =
          resfuntotalInventory.capital_block;

      } else {
        capitalBlock.innerHTML = "No data available";
        capitalBlock.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object1.send();

  }

  fetchData();

}




function Refresh_valueConsumable() {
  let valueConsumable = document.getElementById("valueConsumable");
  let loader = document.getElementById("loader_valueConsumable");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    valueConsumable.innerHTML = "";

    let xhr_object4 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object4.open(
        "GET",
        getTotalValues + idLink + "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(getTotalValues + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object4.open(
        "GET",
        getTotalValues +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getTotalValues +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object4.onload = function () {
      resfuntotalValue = JSON.parse(this.responseText);
      console.log("Total Values - ");
      console.log(resfuntotalValue);
      // Check if response exists and if it's greater than 0 hours
      if (resfuntotalValue && parseFloat(resfuntotalValue.consumable_response) > 0) {
        valueConsumable.innerHTML = resfuntotalValue.consumable_response;

      } else {
        valueConsumable.innerHTML = "No data available";
        valueConsumable.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object4.send();

  }

  fetchData();

}


function Refresh_valueSpares() {
  let valueSpares = document.getElementById("valueSpares");
  let loader = document.getElementById("loader_valueSpares");

  function fetchData() {
    loader.style.display = "block"; // Show loader
    valueSpares.innerHTML = "";

    let xhr_object4 = new XMLHttpRequest();
    if (globalType == "daily") {
      xhr_object4.open(
        "GET",
        getTotalValues + idLink +  "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateFirst,
        true
      );
      console.log(getTotalValues + idLink + "&date=" + globalDateFirst);
    } else {
      xhr_object4.open(
        "GET",
        getTotalValues +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond,
        true
      );
      console.log(
        getTotalValues +
        idLink +
        "&from_date=" +
        globalDateFirst +
        "&to_date=" +
        globalDateSecond
      );
    }

    xhr_object4.onload = function () {
      resfuntotalValue = JSON.parse(this.responseText);
      console.log("Total Values - ");
      console.log(resfuntotalValue);
      // Check if response exists and if it's greater than 0 hours
      if (resfuntotalValue && parseFloat(resfuntotalValue.spare_response) > 0) {
        valueSpares.innerHTML = resfuntotalValue.spare_response;

      } else {
        valueSpares.innerHTML = "No data available";
        valueSpares.style.fontSize = "10px";
      }

      loader.style.display = "none"; // Hide loader
    };
    xhr_object4.send();

  }

  fetchData();

}

function funTotalAmount() {
  let totalAmount = document.getElementById("totalAmount");
  let totalReceived = document.getElementById("totalReceived");
  let totalOutstanding = document.getElementById("totalOutstanding");

  let xhr_object = new XMLHttpRequest();

  if (globalType == "daily") {
    xhr_object.open("GET", getTotalAmount + idLink + "&date=" + globalDateFirst, true);
  } else {
    xhr_object.open("GET", getTotalAmount + idLink + "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond, true);
  }

  xhr_object.onload = function () {
    resfungetTotalAmount = JSON.parse(this.responseText);
    console.log("Total Amount - ");
    console.log(resfungetTotalAmount);
    totalAmount.innerHTML = resfungetTotalAmount.total_amount_response;
    totalReceived.innerHTML = resfungetTotalAmount.received_amount_response;
    totalOutstanding.innerHTML = resfungetTotalAmount.total_outstanding;
  };
  xhr_object.send();


  // function formatIndianRupee(value) {
  //   const countValue = parseInt(value);
  //   const formattedCount = new Intl.NumberFormat( {
  //     style: 'currency',
  //     currency: 'INR',
  //     minimumFractionDigits: 0,
  //     maximumFractionDigits: 0,
  //     useGrouping: true,
  //   }).format(countValue);

  //   return formattedCount;
  // }


}

function funIncidentSummary() {  // tblIncidentSummaryinfo,tablebodyIncidentSummary,loaderIncidentSummary,IncidentSummaryNoData
  let IncidentSummaryNoData = document.getElementById("IncidentSummaryNoData");
  let tblIncidentSummaryinfo = document.getElementById("tblIncidentSummaryinfo");
  let tablebodyIncidentSummary = document.getElementById("tablebodyIncidentSummary");
  let loaderIncidentSummary = document.getElementById("loaderIncidentSummary");

  // tblRCAinfo.style.display = "none";
  // loaderRCA.style.display = "block";
  // RCANoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getIncidentsSummary + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getIncidentsSummary +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }
  // console.log("RCA -1 ");
  // console.log(resfunRCA.response);
  xhr_object.onload = function () {
    resfunIncidentSummary = JSON.parse(this.responseText);
    console.log("Incident Summary-------------");
    console.log(resfunIncidentSummary);

    // console.log(getIncidentsRCATable + idLink);

    let resfunIncidentSummaryArray = resfunIncidentSummary.response;
    allDetails = ``;
    var index = 0;

    for (let x in resfunIncidentSummaryArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][0] +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][1] +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][2] +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][3] +
        `</td>`;

      if (resfunIncidentSummaryArray[x][4] < 0 || resfunIncidentSummaryArray[x][4] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][4] + `</td>`;
      }
      // `<td>` +
      // resfunRCAArray[x][5] +
      // `</td>`
      if (resfunIncidentSummaryArray[x][5] < 0 || resfunIncidentSummaryArray[x][5] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][5] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][6] < 0 || resfunIncidentSummaryArray[x][6] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][6] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][7] < 0 || resfunIncidentSummaryArray[x][7] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][7] + `</td>`;
      }

      if (resfunIncidentSummaryArray[x][13] < 0 || resfunIncidentSummaryArray[x][13] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][13] + `</td>`;
      }

      if (resfunIncidentSummaryArray[x][8] < 0 || resfunIncidentSummaryArray[x][8] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][8] + `</td>`;
      }

      if (resfunIncidentSummaryArray[x][9] < 0 || resfunIncidentSummaryArray[x][9] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][9] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][10] < 0 || resfunIncidentSummaryArray[x][10] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][10] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][11] < 0 || resfunIncidentSummaryArray[x][11] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][11] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][12] < 0 || resfunIncidentSummaryArray[x][12] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][12] + `</td>`;
      }

      allDetails = allDetails + `</tr>`;
    }
    tablebodyIncidentSummary.innerHTML = allDetails;

    loaderIncidentSummary.style.display = "none";
    if (resfunIncidentSummaryArray.length == 0) {
      IncidentSummaryNoData.style.display = "block";
      tblIncidentSummaryinfo.style.display = "none";
    } else {
      IncidentSummaryNoData.style.display = "none";
      tblIncidentSummaryinfo.style.display = "block";
    }
  };
  xhr_object.send();
}


function funOutstanding() {
  let OutstandingNoData = document.getElementById("OutstandingNoData");
  let tblOutstandinginfo = document.getElementById("tblOutstandinginfo");
  let tablebodyOutstanding = document.getElementById("tablebodyOutstanding");
  let loaderOutstanding = document.getElementById("loaderOutstanding");

  // tblOutstandinginfo.style.display = "none";
  // loaderOutstanding.style.display = "block";
  // OutstandingNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  if (globalType == "daily") {
    xhr_object.open(
      "GET",
      getOutstandingTable + idLink + "&date=" + globalDateFirst,
      true
    );
  } else {
    xhr_object.open(
      "GET",
      getOutstandingTable +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      true
    );
  }

  xhr_object.onload = function () {
    resfunOutstanding = JSON.parse(this.responseText);
    console.log("OutStanding Amount TABLE------");
    console.log(resfunOutstanding);

    console.log(getIncidentsRCATable + idLink);

    let resfunOutstandingArray = resfunOutstanding.client_outstanding;
    let allDetails = "";

    for (let x in resfunOutstandingArray) {
      allDetails +=
        `<tr>` +
        `<td style="text-align: left;">` + resfunOutstandingArray[x].site_name + `</td>` +
        `<td>` + resfunOutstandingArray[x].outstanding_amount + `</td>` +
        `<td>` + resfunOutstandingArray[x].percentage + `%</td>` +
        `</tr>`;
    }

    tablebodyOutstanding.innerHTML = allDetails;

    loaderOutstanding.style.display = "none";
    if (resfunOutstandingArray.length == 0) {
      OutstandingNoData.style.display = "block";
      tblOutstandinginfo.style.display = "none";
    } else {
      OutstandingNoData.style.display = "none";
      tblOutstandinginfo.style.display = "inline-table";
    }
  }

  xhr_object.send();
}

function funCardParking() {
  let cardTotalParking = document.getElementById("cardTotalParking");


  let xhr_object = new XMLHttpRequest();
  xhr_object.open("GET", getParking + idLink + "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond, true);

  xhr_object.onload = function () {
    let resfunCardParking = JSON.parse(this.responseText);
    console.log("Parking----------- - ");
    console.log(resfunCardParking);

    // Update HTML elements with values from the response
    cardTotalParking.innerHTML = resfunCardParking.total_parking + "";

  };

  xhr_object.send();


  // -------------------------------------------------------------------

  let cardFreeParking = document.getElementById("cardFreeParking");
  let cardPaidParking = document.getElementById("cardPaidParking");

  let xhr_object2 = new XMLHttpRequest();
  xhr_object2.open("GET", getPaidFreeParking + idLink + "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond, true);

  xhr_object2.onload = function () {
    let resfunCardParkingPaidFree = JSON.parse(this.responseText);
    console.log("Paid Free Parking----------- - ");
    console.log(resfunCardParkingPaidFree);

    // Update HTML elements with values from the response
    cardPaidParking.innerHTML = resfunCardParkingPaidFree.response.paid_parking + "";
    cardFreeParking.innerHTML = resfunCardParkingPaidFree.response.free_parking + "";

  };

  xhr_object2.send();

  // -------------------------------------------------------------

  let CardOccupiedParking = document.getElementById("CardOccupiedParking");
  let occupiedFour = document.getElementById("occupiedFour");
  let occupiedTwo = document.getElementById("occupiedTwo");

  let xhr_object3 = new XMLHttpRequest();
  xhr_object3.open("GET", getOccupiedParking + idLink + "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond, true);

  xhr_object3.onload = function () {
    let resfunCardParkingOccpied = JSON.parse(this.responseText);
    console.log("Occupied Parking----------- - ");
    console.log(resfunCardParkingOccpied);

    // Update HTML elements with values from the response
    CardOccupiedParking.innerHTML = resfunCardParkingOccpied.response.occupied_parking + "";
    occupiedFour.innerHTML = resfunCardParkingOccpied.response["4_wheeler_parking"] + "";
    occupiedTwo.innerHTML = resfunCardParkingOccpied.response["2_wheeler_parking"] + "";

  };

  xhr_object3.send();

  // ------------------------------------------------------------

  let cardVacantParking = document.getElementById("cardVacantParking");
  let fourVacant = document.getElementById("fourVacant");
  let twoVacant = document.getElementById("twoVacant");


  let xhr_object4 = new XMLHttpRequest();
  xhr_object4.open("GET", getVacantParking + idLink + "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond, true);

  xhr_object4.onload = function () {
    let resfunCardParkingVacant = JSON.parse(this.responseText);
    console.log("Vacant Parking----------- - ");
    console.log(resfunCardParkingVacant);

    // Update HTML elements with values from the response
    cardVacantParking.innerHTML = resfunCardParkingVacant.response + "";
    fourVacant.innerHTML = resfunCardParkingVacant.four_wheeler_count + "";
    twoVacant.innerHTML = resfunCardParkingVacant.two_wheeler_count + "";

  };

  xhr_object4.send();



}
// -------STEPATHON------------------------------------
function funCommLeaderboard() {
  let commulativeLeaderboardNoData = document.getElementById(
    "commulativeLeaderboardNoData"
  );
  let tablebodyCommulativeLeaderboard = document.getElementById(
    "tablebodyCommulativeLeaderboard"
  );
  let tblCommulativeLeaderboardinfo = document.getElementById(
    "tblCommulativeLeaderboardinfo"
  );
  let loaderCommulativeLeaderboard = document.getElementById(
    "loaderCommulativeLeaderboard"
  );

  // tblCommulativeLeaderboardinfo.style.display = "none";
  // loaderCommulativeLeaderboard.style.display = "block";
  // commulativeLeaderboardNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getCommLeaderboard +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );
  console.log("(WE@#TREJGFDGDJGDFGDIFGD(((((((((((((")
  console.log(getCommLeaderboard +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond)

  xhr_object.onload = function () {
    resfunCommLeaderboard = JSON.parse(this.responseText);
    console.log("Leaderboard Male------------ - ");
    console.log(resfunCommLeaderboard);

    let resfunCommLeaderboardArray = resfunCommLeaderboard.response1;
    allDetails = ``;
    var index = 0;

    for (let x in resfunCommLeaderboardArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardArray[x][0] +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardArray[x][1] +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardArray[x][2] +
        `</td>` +
        `</tr>`;
    }
    tablebodyCommulativeLeaderboard.innerHTML = allDetails;

    loaderCommulativeLeaderboard.style.display = "none";
    if (resfunCommLeaderboardArray.length == 0) {
      commulativeLeaderboardNoData.style.display = "block";
      tblCommulativeLeaderboardinfo.style.display = "none";
    } else {
      commulativeLeaderboardNoData.style.display = "none";
      tblCommulativeLeaderboardinfo.style.display = "inline-table";
    }
  };
  xhr_object.send();

}

function funDepartmentStats() {
  let DepartmentStatsNoData = document.getElementById(
    "DepartmentStatsNoData"
  );
  let tablebodyFunctionEmployeeParticiption = document.getElementById(
    "tablebodyFunctionEmployeeParticiption"
  );
  let tblFunctionEmployeeParticiptioninfo = document.getElementById(
    "tblFunctionEmployeeParticiptioninfo"
  );
  let loaderDepartmentStats = document.getElementById(
    "loaderDepartmentStats"
  );

  // tblFunctionEmployeeParticiptioninfo.style.display = "none";
  // loaderDepartmentStats.style.display = "block";
  // DepartmentStatsNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getFunctionEmployeeParticipation +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunFunctionEmployeeParticiption = JSON.parse(this.responseText);
    console.log("Function Employee------------- - ");
    console.log(resfunFunctionEmployeeParticiption);

    let resfunFunctionEmployeeParticiptionArray = resfunFunctionEmployeeParticiption.response1;
    allDetails = ``;
    var index = 0;

    for (let x in resfunFunctionEmployeeParticiptionArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunFunctionEmployeeParticiptionArray[x][0] +
        `</td>` +
        `<td>` +
        resfunFunctionEmployeeParticiptionArray[x][1] +
        `</td>` +
        `<td>` +
        resfunFunctionEmployeeParticiptionArray[x][2] +
        `</td>` +
        `</tr>`;
    }
    tablebodyFunctionEmployeeParticiption.innerHTML = allDetails;

    loaderDepartmentStats.style.display = "none";
    if (resfunFunctionEmployeeParticiptionArray.length == 0) {
      DepartmentStatsNoData.style.display = "block";
      tblFunctionEmployeeParticiptioninfo.style.display = "none";
    } else {
      DepartmentStatsNoData.style.display = "none";
      tblFunctionEmployeeParticiptioninfo.style.display = "inline-table";
    }
  };
  xhr_object.send();
}

function funDailyStepCount() {
  let cardDailyStep = document.getElementById("cardDailyStep");

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getDailyStepCount +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    true
  );

  xhr_object.onload = function () {
    resfunDailyStepCount = JSON.parse(this.responseText);
    console.log("Daily Step Count - ");
    console.log(resfunDailyStepCount);
    var dailyStepCount = resfunDailyStepCount.response !== null ? resfunDailyStepCount.response : 0;

    cardDailyStep.innerHTML = dailyStepCount;
  };

  xhr_object.send();

}

function funCommLeaderboardFemale() {
  let commulativeLeaderboardNoDataFemale = document.getElementById(
    "commulativeLeaderboardNoDataFemale"
  );
  let tablebodyCommulativeLeaderboardFemale = document.getElementById(
    "tablebodyCommulativeLeaderboardFemale"
  );
  let tblCommulativeLeaderboardinfoFemale = document.getElementById(
    "tblCommulativeLeaderboardinfoFemale"
  );
  let loaderCommulativeLeaderboardFemale = document.getElementById(
    "loaderCommulativeLeaderboardFemale"
  );

  // tblCommulativeLeaderboardinfoFemale.style.display = "none";
  // loaderCommulativeLeaderboardFemale.style.display = "block";
  // commulativeLeaderboardNoDataFemale.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getCommLeaderboardFemale +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunCommLeaderboardFemale = JSON.parse(this.responseText);
    console.log("Leaderboard Female------------ - ");
    console.log(resfunCommLeaderboardFemale);

    let resfunCommLeaderboardFemaleArray = resfunCommLeaderboardFemale.response1;
    allDetails = ``;
    var index = 0;

    for (let x in resfunCommLeaderboardFemaleArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardFemaleArray[x][0] +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardFemaleArray[x][1] +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardFemaleArray[x][2] +
        `</td>` +
        `</tr>`;
    }
    tablebodyCommulativeLeaderboardFemale.innerHTML = allDetails;

    loaderCommulativeLeaderboardFemale.style.display = "none";
    if (resfunCommLeaderboardFemaleArray.length == 0) {
      commulativeLeaderboardNoDataFemale.style.display = "block";
      tblCommulativeLeaderboardinfoFemale.style.display = "none";
    } else {
      commulativeLeaderboardNoDataFemale.style.display = "none";
      tblCommulativeLeaderboardinfoFemale.style.display = "inline-table";
    }
  };
  xhr_object.send();

}

function funClusterEmployeeParticiption() {
  let ClusterEmployeeParticiptionNoData = document.getElementById(
    "ClusterEmployeeParticiptionNoData"
  );
  let tablebodyClusterEmployeeParticiption = document.getElementById(
    "tablebodyClusterEmployeeParticiption"
  );
  let tblClusterEmployeeParticiptioninfo = document.getElementById(
    "tblClusterEmployeeParticiptioninfo"
  );
  let loaderClusterEmployeeParticiption = document.getElementById(
    "loaderClusterEmployeeParticiption"
  );

  // tblClusterEmployeeParticiptioninfo.style.display = "none";
  // loaderClusterEmployeeParticiption.style.display = "block";
  // ClusterEmployeeParticiptionNoData.style.display = "none";

  let xhr_object = new XMLHttpRequest();
  xhr_object.open(
    "GET",
    getClusterEmployeeParticipation +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    true
  );

  xhr_object.onload = function () {
    resfunClusterEmployeeParticiption = JSON.parse(this.responseText);
    console.log("Leaderboard Female------------ - ");
    console.log(resfunClusterEmployeeParticiption);

    let resfunClusterEmployeeParticiptionArray = resfunClusterEmployeeParticiption.response1;
    allDetails = ``;
    var index = 0;

    for (let x in resfunClusterEmployeeParticiptionArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunClusterEmployeeParticiptionArray[x][0] +
        `</td>` +
        `<td>` +
        resfunClusterEmployeeParticiptionArray[x][1] +
        `</td>` +
        `<td>` +
        resfunClusterEmployeeParticiptionArray[x][2] +
        `</td>` +
        `</tr>`;
    }
    tablebodyClusterEmployeeParticiption.innerHTML = allDetails;

    loaderClusterEmployeeParticiption.style.display = "none";
    if (resfunClusterEmployeeParticiptionArray.length == 0) {
      ClusterEmployeeParticiptionNoData.style.display = "block";
      tblClusterEmployeeParticiptioninfo.style.display = "none";
    } else {
      ClusterEmployeeParticiptionNoData.style.display = "none";
      tblClusterEmployeeParticiptioninfo.style.display = "inline-table";
    }
  };
  xhr_object.send();

}
// -------------------------------------------------------------------------------------------------------------------------------
// Refresh Widgets
// -------------------------------------------------------------------------------------------------------------------------------
function showRefreshWidgets() {
  grid.load(items);

  //  grid.load(savedLayout);

  if (activeTotalAssetsAvailable == 1 && resfunCardTotalAsset != null) {
    let cardTotalAsset = document.getElementById("cardTotalAsset");
    cardTotalAsset.innerHTML = resfunCardTotalAsset.response + "";
  }

  if (activeAssetsInUse == 1 && resfunCardTotalAssetInUseAndBreakDown != null) {
    let cardUseAsset = document.getElementById("cardUseAsset");
    cardUseAsset.innerHTML =
      resfunCardTotalAssetInUseAndBreakDown.response.InUse + "";
  }

  if (
    activeAssetInBreakdown == 1 &&
    resfunCardTotalAssetInUseAndBreakDown != null
  ) {
    let cardBreakdownAsset = document.getElementById("cardBreakdownAsset");
    cardBreakdownAsset.innerHTML =
      resfunCardTotalAssetInUseAndBreakDown.response.InBreakdown + "";
  }

  if (
    activeCriticalAssetsInBreakdown == 1 &&
    resfunCardTotalCriticalAssetInBreakdown != null
  ) {
    let cardCriticalAsset = document.getElementById("cardCriticalAsset");
    cardCriticalAsset.innerHTML =
      resfunCardTotalCriticalAssetInBreakdown.response + "";
  }

  if (activePPMConductedAssets == 1) {
    // No Data
  }

  if (activeLTIR == 1 && resfunGetLTIR != null) {
    let cardLTIR = document.getElementById("cardLTIR");
    cardLTIR.innerHTML = resfunGetLTIR.response + "";
  }

  if (activeZeroIncidentDays == 1 && resfunGetZeroIncidentDays != null) {
    let cardZeroIncidentDays = document.getElementById("cardZeroIncidentDays");
    cardZeroIncidentDays.innerHTML = resfunGetZeroIncidentDays.response + "";
  }

  if (activeIncidentPerSqFt == 1 && resfunGetIncidentPerSqFt != null) {
    let cardIncidentPerSqFt = document.getElementById("cardIncidentPerSqFt");
    cardIncidentPerSqFt.innerHTML = resfunGetIncidentPerSqFt.response + "";
  }

  // if (activeTotalFlats == 1 && resfunGetTotalFlats != null) {
  //   let cardTotalFlats = document.getElementById("cardTotalFlats");
  //   cardTotalFlats.innerHTML = resfunGetTotalFlats.response + "";
  // }

  if (
    activeIncidentNearMissGoodCatch == 1 &&
    resfunGetIncidentNearMissGoodCatch != null
  ) {
    let cardIncidentNearMissGoodCatch = document.getElementById(
      "cardIncidentNearMissGoodCatch"
    );
    cardIncidentNearMissGoodCatch.innerHTML =
      resfunGetIncidentNearMissGoodCatch.response + "";
  }

  if (activeTickets == 1 && resfunChartTicket != null) {
    let dt1NoData = document.getElementById("dt1NoData");
    let ticket_b1 = document.getElementById("ticket-b1");
    let loaderTicketB1Chart = document.getElementById("loaderTicketB1Chart");
    let dt1 = document.getElementById("dt1");

    loaderTicketB1Chart.style.display = "block";
    dt1NoData.style.display = "none";

    // if (globalType == "daily") {
    //   dt1.innerHTML = "Tickets for " + convertDateFormat(globalDateFirst);
    // } else {

    //   dt1.innerHTML =
    //     "Tickets for " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    // Added Now

    let total = resfunChartTicket.response.open + resfunChartTicket.response.closed;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }

    // Added Now
    // const originalChartConfigTicket= 
    new Chart(ticket_b1, {
      type: "doughnut",
      data: {
        labels: ["Open", "Closed"],
        datasets: [
          {
            label: "Tickets",
            backgroundColor: ["#e2445b", "#01c875"],
            data: [
              // resfunChartTicket.response.total,
              resfunChartTicket.response.open,
              resfunChartTicket.response.closed,
            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffff",
            // anchor: "end",
            // align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });
    // let myChart = new Chart(ticket_b1, originalChartConfigTicket);

    loaderTicketB1Chart.style.display = "none";

    if (resfunChartTicket.response.total == 0) {
      dt1NoData.style.display = "block";
      ticket_b1.style.display = "none";
    } else {
      dt1NoData.style.display = "none";
      ticket_b1.style.display = "block";
    }
  }



  if (activeBodyInjuryChart == 1 && resBodyInjuryChart != null) {
    let bodyInjuryChart = document.getElementById("bodyInjuryChart");
    let loaderBodyInjuryChart = document.getElementById("loaderBodyInjuryChart");
    let bodyInjuryChartNoData = document.getElementById("bodyInjuryChartNoData");

    // root_Cause_pie.style.display = "none";
    loaderBodyInjuryChart.style.display = "block";
    bodyInjuryChartNoData.style.display = "none";
    bodyInjuryChart.src = resBodyInjuryChart.response;
    console.log("------hey");
    console.log(bodyInjuryChart);
    console.log(bodyInjuryChart.src);

    loaderBodyInjuryChart.style.display = "none";
    bodyInjuryChartNoData.style.display = "none";
    bodyInjuryChart.style.display = "block";

  }


  if (activeExecutiveEscalation == 1 && resfunExecutiveEscalation != null) {
    let executiveEscalationNoData = document.getElementById("executiveEscalationNoData");
    let tblExecutiveEscalationinfo = document.getElementById(
      "tblExecutiveEscalationinfo"
    );
    let tablebodyExecutiveEscalation = document.getElementById(
      "tablebodyExecutiveEscalation"
    );
    let loaderExecutiveEscalation = document.getElementById("loaderExecutiveEscalation");

    tblExecutiveEscalationinfo.style.display = "none";
    loaderExecutiveEscalation.style.display = "block";
    executiveEscalationNoData.style.display = "none";

    let resfunExecutiveEscalationArray = resfunExecutiveEscalation.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunExecutiveEscalationArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        // `<td>` +
        // index +
        // `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][0] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][1] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][2] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][3] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][4] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][5] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][6] +
        `</td>` +
        `<td>` +
        resfunExecutiveEscalationArray[x][8] +
        `</td>`;

      allDetails = allDetails + `</tr>`;
    }
    tablebodyExecutiveEscalation.innerHTML = allDetails;

    loaderExecutiveEscalation.style.display = "none";
    if (resfunExecutiveEscalationArray.length == 0) {
      executiveEscalationNoData.style.display = "block";
      tblExecutiveEscalationinfo.style.display = "none";
    } else {
      executiveEscalationNoData.style.display = "none";
      tblExecutiveEscalationinfo.style.display = "block";
    }
  }




  if (activeOccupancy == 1 && resfunOccupancy != null) {
    let occupancyNoData = document.getElementById("occupancyNoData");
    let Occupancy_sum = document.getElementById("Occupancy_sum");
    let loaderOccupancy = document.getElementById("loaderOccupancy");
    let occupancy = document.getElementById("occupancy");

    loaderOccupancy.style.display = "block";
    occupancyNoData.style.display = "none";

    new Chart(Occupancy_sum, {
      type: "bar",
      data: {
        labels: resfunOccupancy.response.Keys,
        datasets: [
          {
            label: "Occupied",
            backgroundColor: ["#01c875"],
            data: resfunOccupancy.response.yes,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Unoccupied",
            backgroundColor: ["#e2445b"],
            data: resfunOccupancy.response.no,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });



    loaderOccupancy.style.display = "none";

    if (resfunOccupancy.response.total == 0) {
      occupancyNoData.style.display = "block";
      Occupancy_sum.style.display = "none";
    } else {
      occupancyNoData.style.display = "none";
      Occupancy_sum.style.display = "block";
    }



  }


  if (activeFitoutOccupancy == 1 && resFunoccupency1 != null) {
    let fitoutUnoccupied = document.getElementById("fitoutUnoccupiedFlats");
    let fitoutOccupied = document.getElementById("fitoutOccupiedFlats");

    let ftFitoutFlats = document.getElementById("ftFitoutFlats");

    if (resFunoccupency1.response == null) {
      fitoutUnoccupied.innerHTML = "0";
      fitoutOccupied.innerHTML = "0";
    } else {
      fitoutUnoccupied.innerHTML =
        resFunoccupency1.response.unoccupied_count;
      fitoutOccupied.innerHTML = resFunoccupency1.response.occupied_count;

    }

    if (resfunFtFitout2.response == null) {
      ftFitoutFlats.innerHTML = "0";
    } else {
      ftFitoutFlats.innerHTML =
        resfunFtFitout2.response + "";
    }
  }


  if (activeActivityFeed == 1) {
    // No Data
  }

  if (activeCategoryWiseTickets == 1 && resfunCategoryTicket != null) {
    let categoryTicketNoData = document.getElementById("categoryTicketNoData");
    let catagory_ticket = document.getElementById("catagory-ticket");
    let loaderCategoryTicketChart = document.getElementById(
      "loaderCategoryTicketChart"
    );
    let dt2 = document.getElementById("dt2");

    // if (globalType == "daily") {
    //   dt2.innerHTML = "Unit Category-wise Tickets for " + convertDateFormat(globalDateFirst);
    // } else {
    //   dt2.innerHTML =
    //     "Unit Category-wise Tickets for " +
    //     convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    loaderCategoryTicketChart.style.display = "block";
    categoryTicketNoData.style.display = "none";

    // Added now
    new Chart(catagory_ticket, {
      type: "bar",
      data: {
        labels: resfunCategoryTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCategoryTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCategoryTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderCategoryTicketChart.style.display = "none";

    if (String(resfunCategoryTicket.response.total_tickets).length == 0) {
      categoryTicketNoData.style.display = "block";
      catagory_ticket.style.display = "none";
    } else {
      categoryTicketNoData.style.display = "none";
      catagory_ticket.style.display = "block";
    }
  }

  if (
    activeCategoryWiseProactiveTickets == 1 &&
    resfunCategoryProactiveTicket != null
  ) {
    let categoryProactiveTicketNoData = document.getElementById(
      "categoryProactiveTicketNoData"
    );
    let catagory_proactive_ticket = document.getElementById("proactive-ticket");
    let loaderCategoryProactiveTicketChart = document.getElementById(
      "loaderCategoryProactiveTicketChart"
    );
    let dt3 = document.getElementById("dt3");

    // if (globalType == "daily") {
    //   dt3.innerHTML =
    //     "Unit Category-wise Proactive Tickets for " + convertDateFormat(globalDateFirst);
    // } else {
    //   dt3.innerHTML =
    //     "Unit Category-wise Proactive Tickets for " +
    //     convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    loaderCategoryProactiveTicketChart.style.display = "block";
    categoryProactiveTicketNoData.style.display = "none";

    // Added now
    new Chart(catagory_proactive_ticket, {
      type: "bar",
      data: {
        labels: resfunCategoryProactiveTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCategoryProactiveTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCategoryProactiveTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderCategoryProactiveTicketChart.style.display = "none";
    if (
      String(resfunCategoryProactiveTicket.response.total_tickets).length == 0
    ) {
      categoryProactiveTicketNoData.style.display = "block";
      catagory_proactive_ticket.style.display = "none";
    } else {
      categoryProactiveTicketNoData.style.display = "none";
      catagory_proactive_ticket.style.display = "block";
    }
  }

  if (activeCACategoryWiseTickets == 1 && resfunCACategoryTicket != null) {
    let categoryCATicketNoData = document.getElementById(
      "categoryCATicketNoData"
    );
    let catagory_ticket_ca = document.getElementById("catagory-ticket-ca");
    let loaderCACategoryTicketChart = document.getElementById(
      "loaderCACategoryTicketChart"
    );
    let dt2_ca = document.getElementById("dt2_ca");

    // if (globalType == "daily") {
    //   dt2_ca.innerHTML =
    //     "Common Area Category-wise Tickets for " + convertDateFormat(globalDateFirst);
    // } else {
    //   dt2_ca.innerHTML =
    //     "Common Area Category-wise Tickets for " +
    //     convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    loaderCACategoryTicketChart.style.display = "block";
    categoryCATicketNoData.style.display = "none";

    // Added now
    new Chart(catagory_ticket_ca, {
      type: "bar",
      data: {
        labels: resfunCACategoryTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCACategoryTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCACategoryTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderCACategoryTicketChart.style.display = "none";

    if (String(resfunCACategoryTicket.response.total_tickets).length == 0) {
      categoryCATicketNoData.style.display = "block";
      catagory_ticket_ca.style.display = "none";
    } else {
      categoryCATicketNoData.style.display = "none";
      catagory_ticket_ca.style.display = "block";
    }
  }


  if (activeCustomerSentiments == 1 && resfunChartCustomerSentiments != null) {
    let CustomerSentimentsNoData = document.getElementById("CustomerSentimentsNoData");
    let customerSentiment = document.getElementById("customerSentiment");
    let loaderCustomerSentiments = document.getElementById("loaderCustomerSentiments");
    let sentiments = document.getElementById("sentiments");

    loaderCustomerSentiments.style.display = "block";
    customerSentiment.style.display = "none";
    // CustomerSentimentsNoData.style.display = "none";

    // if (globalType == "daily") {
    //   sentiments.innerHTML = "Customer Sentiments for " + globalDateFirst;
    // } else {
    //   sentiments.innerHTML =
    //     "Customer Sentiments for " + globalDateFirst + " to " + globalDateSecond;
    // }
    let total = resfunChartCustomerSentiments.response.Great + resfunChartCustomerSentiments.response.Good + resfunChartCustomerSentiments.response.Okay + resfunChartCustomerSentiments.response.Bad + resfunChartCustomerSentiments.response.Unacceptable;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }
    new Chart(customerSentiment, {
      type: "doughnut",
      data: {
        labels: ["Great", "Good", "Okay", "Bad", "Unacceptable"],
        datasets: [
          {
            label: "Customer",
            backgroundColor: ["#01c875", "#A1CD7A", "#F2C06C", "#F69380", "#D44B52",],
            data: [
              // resfunChartTicket.response.total,
              resfunChartCustomerSentiments.response.Great,
              resfunChartCustomerSentiments.response.Good,
              resfunChartCustomerSentiments.response.Okay,
              resfunChartCustomerSentiments.response.Bad,
              resfunChartCustomerSentiments.response.Unacceptable,

            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,

        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });
    // CustomerSentimentsNoData.style.display = "block";
    // if (total == 0) {
    //   loaderCustomerSentiments.style.display = "none";
    //   customerSentiment.style.display = "none";
    //   CustomerSentimentsNoData.style.display = "block";

    // } else {
    //   loaderCustomerSentiments.style.display = "none";
    //   customerSentiment.style.display = "block";
    //   // CustomerSentimentsNoData.style.display = "none";
    // }
  }


  if (activeFootfall == 1 && resfunFootfall != null && resFootFallDrill != null) {
    let footfallNoData = document.getElementById("footfallNoData");
    // let footfall_bar = document.getElementById("footfall_bar ");
    // let loaderFootfall = document.getElementById("loaderFootfall");

    // loaderFootfall.style.display = "block";
    footfallNoData.style.display = "none";
    // footfall_bar.style.display = "block";

    // let eff1 = document.getElementById("eff1");
    // eff1.innerHTML = " Events Footfall Analysis ";

    // new Chart(footfall_bar, {
    //   type: "bar",
    //   data: {
    //     labels: Object.keys(resfunFootfall.response),
    //     datasets: [
    //       {
    //         label: "Footfall",
    //         backgroundColor: [
    //           "#77216F",
    //           "#01C875",
    //           "#E2445B",
    //           "#E95420",
    //           "#A1CD7A",
    //         ],
    //         data: Object.values(resfunFootfall.response),
    //         borderWidth: 1,
    //       },
    //     ],
    //   },
    //   options: {
    //     responsive: true,
    //     interaction: {
    //       intersect: false,
    //     },
    //     scales: {
    //       x: {
    //         stacked: true,
    //       },
    //       y: {
    //         stacked: true,
    //       },
    //     },
    //     maintainAspectRatio: false,
    //     scales: {
    //       x: {
    //         ticks: {
    //           callback: function (value) {
    //             return this.getLabelForValue(value).substr(0, 15);
    //           },
    //         },
    //       },
    //     },
    //     plugins: {
    //       datalabels: {
    //         color: "#000000",
    //         anchor: "end",
    //         align: "end",
    //         offset: -6,
    //         font: {
    //           size: "10",
    //           weight: "bold",
    //         },
    //         formatter: function (value, context) {
    //           // Hide label if value is zero
    //           return value === 0 ? '' : value;
    //         }
    //       },
    //       legend: {
    //         display: false,
    //         position: "no",
    //       },
    //     },
    //   },
    //   plugins: [ChartDataLabels],
    // });

    // -------------
    originalChartConfigFootfall = {
      type: "bar",
      data: {
        labels: Object.keys(resfunFootfall.response),
        datasets: [
          {
            label: "Footfall",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: Object.values(resfunFootfall.response),
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: false,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }

    let myChart = new Chart(footfall_bar, originalChartConfigFootfall)

    // -------------
    if (Object.keys(resfunFootfall.response).length == 0) {
      footfallNoData.style.display = "block";
      footfall_bar.style.display = "none";
    } else {
      footfallNoData.style.display = "none";
      footfall_bar.style.display = "block";
    }

    //  --

    let labelname;
    let selectedOption;
    let firstPoint;
    let selectedlabelValue;
    let backgroundColors;

    footfall_bar.onclick = function (event) {

      if (clickedFootfall == true) {

        const points = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);

        if (points.length) {
          firstPoint = points[0];
          const label = myChart.data.labels[firstPoint.index];
          const value = myChart.data.datasets[firstPoint.datasetIndex].data[firstPoint.index];
          backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];

          console.log(`Clicked on ${label} with value ${value}`);
          selectedlabelValue = label;
          document.getElementById("listItemLabelFootFall").textContent = `Ticket: ${label}`;
          console.log(backgroundColors);
          // document.getElementById("listItemValue").textContent = `Value: ${value}`;

          // const dropdown = new bootstrap.Dropdown(document.getElementById("dataDropdown"));
          // dropdown.show();

          const dropdown = (document.getElementById("dataDropdown_footfall"));
          dropdown.style.display = "block";


        }


        dataDropdown_footfall.addEventListener("click", function (event) {
          if (FootfalldrillDownLevel === 1) {
            selectedOption = event.target.id;
            firstPoint = points[0];
            label = myChart.data.labels[firstPoint.index];
            labelname = label;
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            console.log(selectedOption);

            let xhr_object = new XMLHttpRequest();
            let apiURL;

            apiURL =
              getFootFallDrillSecond +
              idLink +
              "&first_drilldown_by=" +
              selectedOption +
              "&date=" +
              labelname +
              "&sec_drill_down_on=" +
              "" +
              "&sec_drilldown_by=" +
              "" +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond;

            xhr_object.open("GET", apiURL, true);

            // downloadEventsFootfallAnalysisLink = ip + "fm-excel-download/get-drill-down-for-footfall-analysis/" + idLink +
            // "&first_drilldown_by=" +
            // selectedOption +
            // "&date=" +
            // labelname +
            // "&sec_drilldown_by=" +
            // "" +
            // "&sec_drill_down_on=" +
            // "" +
            // "&from_date=" +
            // globalDateFirst +
            // "&to_date=" +
            // globalDateSecond;

            xhr_object.onload = function () {
              resFootFallDrill = JSON.parse(this.responseText);
              console.log("Ticket Category Drill Down - ");
              console.log(resFootFallDrill);

              const labels = resFootFallDrill.response.map(item => item[0]);
              const dataValues = resFootFallDrill.response.map(item => item[1]);

              myChart.destroy();
              myChart = new Chart(footfall_bar, {
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: 'Data Values',
                    data: dataValues,
                    backgroundColor: [
                      "#77216F",
                      "#01C875",
                      "#E2445B",
                      "#E95420",
                      "#A1CD7A",
                    ],
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                  }]
                },
                options: {
                  responsive: true,
                  interaction: {
                    intersect: false,
                  },
                  scales: {
                    x: {
                      stacked: true,
                    },
                    y: {
                      stacked: true,
                    },
                  },
                  maintainAspectRatio: false,
                  plugins: {
                    datalabels: {
                      color: "#000000",
                      anchor: "end",
                      align: "end",
                      offset: -6,
                      font: {
                        size: "10",
                        weight: "bold",
                      },
                      formatter: function (value, context) {
                        // Hide label if value is zero
                        return value === 0 ? '' : value;
                      }
                    },
                    legend: {
                      display: true,
                      position: "no",
                    },
                  },
                },
                plugins: [ChartDataLabels],
              });
            }
            xhr_object.send();
          }


          else if (FootfalldrillDownLevel === 2) {
            // alert(selectedOption);
            // alert(labelname);
            // alert(selectedlabelValue);
            const firstPoint = points[0];
            // alert(firstPoint.index);
            const selectedSecondOption = event.target.id;
            const labelSecond = myChart.data.labels[firstPoint.index];
            const labelnameSecond = labelSecond;
            backgroundColors = myChart.data.datasets[0].backgroundColor[firstPoint.index];
            console.log(selectedSecondOption);
            console.log(selectedlabelValue);
            // console.log(backgroundColors);

            // apiURL =
            //   getFootFallDrillSecond +
            //   idLink +
            //   "&first_drilldown_by=" +
            //   selectedOption +
            //   "&date=" +
            //   labelname +
            //   "&sec_drilldown_by=" +
            //   selectedSecondOption +
            //   "&sec_drill_down_on=" +
            //   selectedlabelValue +
            //   "&from_date=" +
            //   globalDateFirst +
            //   "&to_date=" +
            //   globalDateSecond;
            // // // alert("second drill down api");
            // console.log(apiURL);

            // xhr_object.open("GET", apiURL, true);

            downloadEventsFootfallAnalysisLink = ip + "fm-excel-download/get-drill-down-for-footfall-analysis/" + idLink +
              "&first_drilldown_by=" +
              selectedOption +
              "&date=" +
              labelname +
              "&sec_drilldown_by=" +
              selectedSecondOption +
              "&sec_drill_down_on=" +
              selectedlabelValue +
              "&from_date=" +
              globalDateFirst +
              "&to_date=" +
              globalDateSecond;

            // xhr_object.onload = function () {
            //   resFootFallDrill = JSON.parse(this.responseText);
            //   console.log("Ticket Category Drill Down - ");
            //   console.log(resFootFallDrill);

            const labels = resFootFallDrill.response.map(item => item[0]);
            const dataValues = resFootFallDrill.response.map(item => item[1]);

            myChart.destroy();
            myChart = new Chart(footfall_bar, {
              type: "bar",
              data: {
                labels: labels,
                datasets: [{
                  label: 'Data Values',
                  data: dataValues,
                  backgroundColor: [
                    "#77216F",
                    "#01C875",
                    "#E2445B",
                    "#E95420",
                    "#A1CD7A",
                  ],
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
                }]
              },
              options: {
                responsive: true,
                interaction: {
                  intersect: false,
                },
                scales: {
                  x: {
                    stacked: true,
                  },
                  y: {
                    stacked: true,
                  },
                },
                maintainAspectRatio: false,
                plugins: {
                  datalabels: {
                    color: "#000000",
                    anchor: "end",
                    align: "end",
                    offset: -6,
                    font: {
                      size: "10",
                      weight: "bold",
                    },
                    formatter: function (value, context) {
                      // Hide label if value is zero
                      return value === 0 ? '' : value;
                    }
                  },
                  legend: {
                    display: true,
                    position: "no",
                  },
                },
              },
              plugins: [ChartDataLabels],
            });
            // }
            // xhr_object.send();
          }

          // if (selectedOption === "Tower" || "Flat" || "Status" || "Facility_Name" && currentChartType === "bar") {

          FootfalldrillDownLevel += 1

          dataDropdown_footfall.style.display = "none";

          currentChartType = "bar";
          // }

        });
      }


    };


    function restoreOriginalChart() {
      if (originalChartConfigFootfall) {
        myChart.destroy(); // Destroy the current chart
        myChart = new Chart(footfall_bar, originalChartConfigFootfall);
        clickedFootfall = true;
      }
    }

    refreshIconElement_footfall.addEventListener("click", restoreOriginalChart);

    // --


  }

  if (
    activeCACategoryWiseProactiveTickets == 1 &&
    resfunCACategoryProactiveTicket != null
  ) {
    let categoryCAProactiveTicketNoData = document.getElementById(
      "categoryCAProactiveTicketNoData"
    );
    let catagory_proactive_ticket_ca = document.getElementById(
      "proactive-ticket-ca"
    );
    let loaderCACategoryProactiveTicketChart = document.getElementById(
      "loaderCACategoryProactiveTicketChart"
    );
    let dt3_ca = document.getElementById("dt3_ca");

    // if (globalType == "daily") {
    //   dt3_ca.innerHTML =
    //     "Common Area Category-wise Proactive Tickets for " + convertDateFormat(globalDateFirst);
    //   tickets_category
    // } else {
    //   dt3_ca.innerHTML =
    //     "Common Area Category-wise Proactive Tickets for " +
    //     convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    loaderCACategoryProactiveTicketChart.style.display = "block";
    categoryCAProactiveTicketNoData.style.display = "none";

    // Added now
    new Chart(catagory_proactive_ticket_ca, {
      type: "bar",
      data: {
        labels: resfunCACategoryProactiveTicket.response.tickets_category,
        datasets: [
          {
            label: "Open Tickets",
            backgroundColor: ["#e2445b"],
            data: resfunCACategoryProactiveTicket.response.open_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Closed Tickets",
            backgroundColor: ["#01c875"],
            data: resfunCACategoryProactiveTicket.response.closed_tickets,
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderCACategoryProactiveTicketChart.style.display = "none";
    if (
      String(resfunCACategoryProactiveTicket.response.total_tickets).length == 0
    ) {
      categoryCAProactiveTicketNoData.style.display = "block";
      catagory_proactive_ticket_ca.style.display = "none";
    } else {
      categoryCAProactiveTicketNoData.style.display = "none";
      catagory_proactive_ticket_ca.style.display = "block";
    }
  }

  if (activeTicketsAgeingMatrix == 1 && resfunAgeingMatrix != null) {
    let ageingMatrixNoData = document.getElementById("ageingMatrixNoData");
    let tbl1info = document.getElementById("tbl1info");
    let loaderAgeingMatrix = document.getElementById("loaderAgeingMatrix");

    loaderAgeingMatrix.style.display = "block";
    ageingMatrixNoData.style.display = "none";

    let myAgeingArray = resfunAgeingMatrix.response;

    allAgeingDetails =
      `<tr>` +
      `<td>` +
      "P1" +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P1.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P2" +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P2.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P3" +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P3.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P4" +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P4.T5 +
      `</td>` +
      `</tr>` +
      `<tr>` +
      `<td>` +
      "P5" +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T1 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T2 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T3 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T4 +
      `</td>` +
      `<td>` +
      myAgeingArray.P5.T5 +
      `</td>` +
      `</tr>`;

    tablebodyTicketAgeing.innerHTML = allAgeingDetails;

    console.log("Ageing - ");
    console.log(myAgeingArray);

    daysTicketAgeing.innerHTML = resfunAgeingMatrix.average_days;

    loaderAgeingMatrix.style.display = "none";
    if (resfunAgeingMatrix.response.total_tickets == 0) {
      ageingMatrixNoData.style.display = "block";
      tbl1info.style.display = "none";
    } else {
      ageingMatrixNoData.style.display = "none";
      tbl1info.style.display = "block";
    }
  }

  if (activeResolutionTAT == 1 && resfunTATResolution != null) {
    let tatResolutionNoData = document.getElementById("tatResolutionNoData");
    let tat_resolution_chart = document.getElementById("resolution-b1");
    let loaderTATResolution = document.getElementById("loaderTATResolution");

    let tatResolutionAchieved = document.getElementById(
      "tatResolutionAchieved"
    );
    let tatResolutionBreached = document.getElementById(
      "tatResolutionBreached"
    );

    loaderTATResolution.style.display = "block";
    tatResolutionNoData.style.display = "none";
    tat_resolution_chart.style.visibility = "hidden";

    tatResolutionAchieved.innerHTML =
      resfunTATResolution.response.resolution.achieved + "";
    tatResolutionBreached.innerHTML =
      resfunTATResolution.response.resolution.breached + "";

    new Chart(tat_resolution_chart, {
      type: "bar",
      data: {
        labels: ["Achived", "Breached"],
        datasets: [
          {
            label: "Resolution TAT Status",
            backgroundColor: ["#01C875", "#FDAB3D"],
            data: [
              resfunTATResolution.response.resolution.achieved,
              resfunTATResolution.response.resolution.breached,
            ],
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 8);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderTATResolution.style.display = "none";
    if (
      resfunTATResolution.response.resolution.achieved == 0 &&
      resfunTATResolution.response.resolution.breached == 0
    ) {
      tatResolutionNoData.style.display = "block";
      tat_resolution_chart.style.visibility = "hidden";
    } else {
      tatResolutionNoData.style.display = "none";
      tat_resolution_chart.style.visibility = "visible";
    }
  }

  if (activeResponseTAT == 1 && resfunTATResponse != null) {
    let tatResponseNoData = document.getElementById("tatResponseNoData");
    let tat_response_chart = document.getElementById("response-b1");
    let loaderTATResponse = document.getElementById("loaderTATResponse");

    let tatResponseAchieved = document.getElementById("tatResponseAchieved");
    let tatResponseBreached = document.getElementById("tatResponseBreached");

    loaderTATResponse.style.display = "block";
    tatResponseNoData.style.display = "none";
    tat_response_chart.style.visibility = "hidden";

    tatResponseAchieved.innerHTML =
      resfunTATResponse.response.response.achieved + "";
    tatResponseBreached.innerHTML =
      resfunTATResponse.response.response.breached + "";

    new Chart(tat_response_chart, {
      type: "bar",
      data: {
        labels: ["Achived", "Breached"],
        datasets: [
          {
            label: "Response TAT Status",
            backgroundColor: ["#01C875", "#FDAB3D"],
            data: [
              resfunTATResponse.response.response.achieved,
              resfunTATResponse.response.response.breached,
            ],
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 8);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderTATResponse.style.display = "none";
    if (
      resfunTATResponse.response.response.achieved == 0 &&
      resfunTATResponse.response.response.breached == 0
    ) {
      tatResponseNoData.style.display = "block";
      tat_response_chart.style.visibility = "hidden";
    } else {
      tatResponseNoData.style.display = "none";
      tat_response_chart.style.visibility = "visible";
    }
  }

  if (activeVisitors == 1 && resfunVisitors != null) {
    let visTotalVehicles = document.getElementById("visTotalVehicles");
    let visTotalVisitors = document.getElementById("visTotalVisitors");
    let visExpectedVisitors = document.getElementById("visExpectedVisitors");
    let visUnExpectedVisitors = document.getElementById("visUnExpectedVisitors");
    let visTotalGatePass = document.getElementById("visTotalGatePass");
    let visReturnGatePass = document.getElementById("visReturnGatePass ");
    let visNonReturnGatePass = document.getElementById("visNonReturnGatePass");



    visTotalVehicles.innerHTML = resfunVisitors.response.totalVehicle + "";
    visTotalVisitors.innerHTML = resfunVisitors.response.totalVisitors + "";
    visExpectedVisitors.innerHTML =
      resfunVisitors.response.expectedVisitors + "";
    visUnExpectedVisitors = resfunVisitors.response.unexpectedVisitors + "";
    visTotalGatePass.innerHTML = resfunVisitors.response.totalGatePass + "";
    visReturnGatePass = resfunVisitors.response.ReturnGatePass + "";
    visNonReturnGatePass.innerHTML = resfunVisitors.response.NonReturnGatePass + "";

  }

  if (activeTotalVisitors == 1 && resfunVisitors != null) {
    let visTotalVisitors = document.getElementById("visTotalVisitors");
    visTotalVisitors.innerHTML = resfunVisitors.response.totalVisitors + "";
  }


  if (activeExpectedVisitors == 1 && resfunVisitors != null) {
    let visExpectedVisitors = document.getElementById("visExpectedVisitors");
    visExpectedVisitors.innerHTML = resfunVisitors.response.expectedVisitors + "";
  }


  if (activeTotalStaff == 1 && resfunStaff != null) {
    let visTotalStaffCard = document.getElementById("visTotalStaffCard");
    visTotalStaffCard.innerHTML = resfunStaff.response + "";
  }
  if (activeStaffIn == 1 && resfunStaffIn != null) {
    let visStaffInCard = document.getElementById("visStaffInCard");
    visStaffInCard.innerHTML = resfunStaffIn.response + "";
  }
  if (activeStaffOut == 1 && resfunStaffOut != null) {
    let visStaffOutCard = document.getElementById("visStaffOutCard");
    visStaffOutCard.innerHTML = resfunStaffOut.response + "";
  }

  if (activeUnExpectedVisitors == 1 && resfunVisitors != null) {
    let visUnExpectedVisitors = document.getElementById("visUnExpectedVisitors");
    visUnExpectedVisitors.innerHTML = resfunVisitors.response.unexpectedVisitors + "";
  }


  if (activeTotalVisitorsII == 1 && resfunTotalVisitorsII != null) {
    let totalVisitorsNoDataII = document.getElementById("totalVisitorsNoDataII");
    let total_visitors_II = document.getElementById("total-visitors-II");
    let loaderTotalVisitorsII = document.getElementById("loaderTotalVisitorsII");
    let dt2_tv = document.getElementById("dt2_tv");
    loaderTotalVisitorsII.style.display = "block";
    totalVisitorsNoDataII.style.display = "none";
    new Chart(total_visitors_II, {
      type: "bar",
      data: {
        labels: Object.keys(resfunTotalVisitorsII.response),
        datasets: [
          {
            label: "Visitors",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: Object.values(resfunTotalVisitorsII.response),
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });
    loaderTotalVisitorsII.style.display = "none";

    let sum = 0;
    let resValues = Object.values(resfunTotalVisitorsII.response);

    for (let i = 0; i < resValues.length; i += 1) {
      sum = resValues[i] + sum;
    }

    // if (sum == 0) {
    //   totalVisitorsNoDataII.style.display = "block";
    //   total_visitors_II.style.display = "none";
    // } else {
    totalVisitorsNoDataII.style.display = "none";
    total_visitors_II.style.display = "block";
  }



  if (activeGoodsInwards == 1 && resfunGoodsInwards != null) {
    let visGoodsInwards = document.getElementById("visGoodsInwards");
    visGoodsInwards.innerHTML = resfunGoodsInwards.response + "";

  }

  if (activeGoodsOutwards == 1 && resfunOutwards != null) {
    let visOutwards = document.getElementById("visOutwards");
    visOutwards.innerHTML = resfunOutwards.response + "";

  }

  if (activeGoodsIn == 1 && resfunGoodsIn != null) {
    let goods_in = document.getElementById("goods_in");
    let loaderGoodsIn = document.getElementById("loaderGoodsIn");
    // let dt2_gi = document.getElementById("dt2_gi");

    // loaderGoodsIn.style.display = "block";

    // let valueGoodsInName = Object.keys(resfunGoodsIn.response);
    // let valueGoodsInY = Object.values(resfunGoodsIn.response);


    new Chart(goods_in, {
      type: "bar",
      data: {
        labels: Object.keys(resfunGoodsIn.response),
        datasets: [
          {
            // label:"Incident",
            // `data: Object.values(resfunGoodsIn.response),`
            // axis: "y",
            // fill: true,
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: Object.values(resfunGoodsIn.response),
            borderWidth: 1,
          },
        ],
      },
      options: {
        // indexAxis: "y",
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#ffffff",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderGoodsIn.style.display = "none";

    let sum = 0;
    let resValue = Object.values(resfunGoodsIn.response);

    for (let i = 0; i < resValue.length; i += 1) {
      sum = resValue[i] + sum;
    }
    if (sum == 0) {
      // goodsInNoData.style.display = "block";
      goods_in.style.display = "none";
    } else {
      // goodsInNoData.style.display = "none";
      goods_in.style.display = "block";
    }
  }

  if (activeGoodsOut == 1 && resfunGoodsOut != null) {
    let goodsOutNoData = document.getElementById("goodsOutNoData");
    let goods_out = document.getElementById("goods_out");
    let loaderGoodsOut = document.getElementById("loaderGoodsOut");
    let dt2_go = document.getElementById("dt2_go");

    loaderGoodsOut.style.display = "none";
    goods_out.style.display = "block";

    new Chart(goods_out, {
      type: "bar",
      data: {
        labels: Object.keys(resfunGoodsOut.response),
        datasets: [
          {
            // label:"Incident",
            data: Object.values(resfunGoodsOut.response),
            axis: "y",
            fill: true,
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],

            borderWidth: 1,
          },
        ],
      },
      options: {
        // indexAxis: "y",
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#ffffff",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderGoodsOut.style.display = "none";

    let sum = 0;
    let resValueOut = Object.values(resfunGoodsOut.response);
    for (let i = 0; i < resValueOut.length; i += 1) {
      sum = resValueOut[i] + sum;
    }
    if (sum == 0) {
      goodsOutNoData.style.display = "block";
      goods_out.style.display = "none";
    } else {
      goodsOutNoData.style.display = "none";
      goods_out.style.display = "block";
    }
  }

  if (activeTotalGatePass == 1 && resfunVisitors != null) {
    let visTotalGatePass = document.getElementById("visTotalGatePass");
    visTotalGatePass.innerHTML = resfunVisitors.response.totalGatePass + "";

  }

  if (activeNonReturnablePass == 1 && resfunVisitors != null) {
    let visNonReturnGatePass = document.getElementById("visNonReturnGatePass");
    visNonReturnGatePass.innerHTML = resfunVisitors.response.non_returnable_gatePass + "";

  }

  if (activeReturnablePass == 1 && resfunVisitors != null) {
    let visReturnGatePass = document.getElementById("visReturnGatePass");
    visReturnGatePass.innerHTML = resfunVisitors.response.returnable_gatePass + "";
  }

  if (activeTotalAmount == 1 && resfungetTotalAmount != null) {
    let totalAmount = document.getElementById("totalAmount");
    totalAmount.innerHTML = resfungetTotalAmount.total_amount_response;
  }

  if (activeTotalReceived == 1 && resfungetTotalAmount != null) {
    let totalReceived = document.getElementById("totalReceived");
    totalReceived.innerHTML = resfungetTotalAmount.received_amount_response;
  }

  if (activeTotalOutStanding == 1 && resfungetTotalAmount != null) {
    let totalOutstanding = document.getElementById("totalOutstanding");
    totalOutstanding.innerHTML = resfungetTotalAmount.total_outstanding;
  }

  if (activeTotalOutStandingAmount == 1 && resfunOutstanding != null) {
    let OutstandingNoData = document.getElementById("OutstandingNoData");
    let tblOutstandinginfo = document.getElementById("tblOutstandinginfo");
    let tablebodyOutstanding = document.getElementById("tablebodyOutstanding");
    let loaderOutstanding = document.getElementById("loaderOutstanding");

    tblOutstandinginfo.style.display = "none";
    loaderOutstanding.style.display = "block";
    OutstandingNoData.style.display = "none";

    let resfunOutstandingArray = resfunOutstanding.client_outstanding;
    let allDetails = "";

    for (let x in resfunOutstandingArray) {
      allDetails +=
        `<tr>` +
        `<td style="text-align: left;">` + resfunOutstandingArray[x].site_name + `</td>` +
        `<td>` + resfunOutstandingArray[x].outstanding_amount + `</td>` +
        `<td>` + resfunOutstandingArray[x].percentage + `%</td>` +
        `</tr>`;
    }

    tablebodyOutstanding.innerHTML = allDetails;

    loaderOutstanding.style.display = "none";
    if (resfunOutstandingArray.length == 0) {
      OutstandingNoData.style.display = "block";
      tblOutstandinginfo.style.display = "none";
    } else {
      OutstandingNoData.style.display = "none";
      tblOutstandinginfo.style.display = "inline-table";
    }
  }

  if (activePermits == 1 && resfunPermitStatus != null) {
    let PermitStatusNoData = document.getElementById("PermitStatusNoData");
    let permitStatus = document.getElementById("permitStatus");
    let loaderPermitStatus = document.getElementById(
      "loaderPermitStatus"
    );
    loaderPermitStatus.style.display = "block";
    PermitStatusNoData.style.display = "none";
    let total = resfunPermitStatus.response.Total;
    const centerText = {
      id: 'centerText',
      afterDatasetsDraw(chart, args, options) {
        const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
        ctx.save();

        ctx.font = 'bolder 18px Arial';
        ctx.fillStyle = 'rgba(0, 0, 0, 1)';
        ctx.textAlign = 'center';
        ctx.fillText('Total: ' + total, width / 2, height / 2);
      }
    }

    // Specify colors for each segment
    // var backgroundColors = ["#5ae717", "yellow", "red"];

    // Create a new Chart
    myChart = new Chart(permitStatus, {
      type: "doughnut",
      data: {
        labels: ["Closed", "Extended", "Open"],
        datasets: [
          {
            label: "Permit Status",
            backgroundColor: ["#5ae717", "yellow", "red"],
            data: [
              resfunPermitStatus.response.Closed,
              resfunPermitStatus.response.Extended,
              resfunPermitStatus.response.Open,

            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffff",
            // anchor: "end",
            // align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderPermitStatus.style.display = "none";

    if (labels.length === 0) {
      PermitStatusNoData.style.display = "block";
      permitStatus.style.display = "none";
    } else {
      PermitStatusNoData.style.display = "none";
      permitStatus.style.display = "block";
    }

    // Manually draw total in the center
    var ctx = myChart.ctx;
    var centerX = myChart.width / 2;
    var centerY = myChart.height / 2;

    ctx.font = "16px Arial";
    ctx.fillStyle = "#000000";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText("Total: " + total, centerX, centerY);
  }



  if (activePermitSite == 1 && resfunSitePermit != null) {
    let SitePermitNoData = document.getElementById("SitePermitNoData");
    let sitePermit = document.getElementById("sitePermit");
    let loaderSitePermit = document.getElementById(
      "loaderSitePermit"
    );
    loaderSitePermit.style.display = "block";
    SitePermitNoData.style.display = "none";


    const locations = Object.keys(resfunSitePermit.response);
    const categories = Array.from(
      new Set(
        locations.flatMap(
          (location) => resfunSitePermit.response[location].map((item) => item[1])
        )
      )
    );

    const data = locations.map((location) =>
      categories.map((category) => {
        const foundItem = resfunSitePermit.response[location].find(
          (item) => item[1] === category
        );
        return foundItem ? foundItem[0] : 0;
      })
    );

    // Your existing code to generate random color
    function getRandomColor() {
      const letters = "0123456789ABCDEF";
      let color = "#";
      for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

    // Create a new Chart
    new Chart(sitePermit, {
      type: "bar",
      data: {
        labels: locations,
        datasets: categories.map((category, index) => ({
          label: category,
          data: data.map((locationData) => locationData[index]),
          backgroundColor: getRandomColor(),
          stack: "Stack 0",
        })),
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            beginAtZero: true,
            title: {
              display: true,
              text: "Sites",
              padding: {
                top: 20,
              },
            },
          },
          y: {
            stacked: true, // Stack bars on the y-axis
            beginAtZero: true,
            title: {
              display: true,
              text: "Type of Permits created",
            },
          },
        },
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            labels: {
              usePointStyle: true,
            },
            display: true,
            position: "top",
            align: "end",
          },
        },
      },
    });

    loaderSitePermit.style.display = "none";

    // if (labels.length === 0) {
    //   SitePermitNoData.style.display = "block";
    //   sitePermit.style.display = "none";
    // } else {
    SitePermitNoData.style.display = "none";
    sitePermit.style.display = "block";
  }

  if (activePowerConsumption == 1) {
    let titlePowerConsumation = document.getElementById(
      "titlePowerConsumation"
    );

    let pcTotalHtMeter = document.getElementById("pcTotalHtMeter");
    let pcTotalTransformer = document.getElementById("pcTotalTransformer");
    let pcTotalDg = document.getElementById("pcTotalDg");
    let pcTotalDieselConsumed = document.getElementById(
      "pcTotalDieselConsumed"
    );
    let pcTotalDieselConsumedPie = document.getElementById(
      "pcTotalDieselConsumedPie"
    );

    let loaderPowerConsumPie = document.getElementById("loaderPowerConsumPie");
    let powerConsumPieNoData = document.getElementById("powerConsumPieNoData");
    let power_consume_pie = document.getElementById("power-consume-pie");
    let psPie1 = document.getElementById("psPie1");
    let psPie2 = document.getElementById("psPie2");
    let psPie3 = document.getElementById("psPie3");
    let psPie4 = document.getElementById("psPie4");
    let psPie5 = document.getElementById("psPie5");

    let loaderPowerConsum = document.getElementById("loaderPowerConsum");
    let powerConsumNoData = document.getElementById("powerConsumNoData");
    let power_consumption = document.getElementById("power-consumption");
    let power_consumption_month = document.getElementById("power_consumption_month");
    let loaderPowerConsumMonth = document.getElementById("loaderPowerConsumMonth");



    // ----------------------------------------------

    if (resfunPowerConsumptionObject1 != null) {
      if (resfunPowerConsumptionObject1.response == null) {
        pcTotalHtMeter.innerHTML = "0 kwh";
      } else {
        pcTotalHtMeter.innerHTML =
          resfunPowerConsumptionObject1.response + " kwh";
      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject2 != null) {
      if (resfunPowerConsumptionObject2.response == null) {
        pcTotalTransformer.innerHTML = "0 kwh";
      } else {
        pcTotalTransformer.innerHTML =
          resfunPowerConsumptionObject2.response + " kwh";
      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject3 != null) {
      if (resfunPowerConsumptionObject3.response == null) {
        pcTotalDg.innerHTML = "0 kwh";
      } else {
        pcTotalDg.innerHTML = resfunPowerConsumptionObject3.response + " kwh";
      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject4 != null) {
      if (resfunPowerConsumptionObject4.response == null) {
        pcTotalDieselConsumed.innerHTML = "0 liters";
      } else {
        pcTotalDieselConsumed.innerHTML =
          resfunPowerConsumptionObject4.response + " liters";

      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject5 != null) {
      loaderPowerConsumPie.style.display = "block";
      powerConsumPieNoData.style.display = "none";

      let valueChartName = Object.keys(resfunPowerConsumptionObject5.pie);
      let valueChartY = Object.values(resfunPowerConsumptionObject5.pie);

      console.log("Power Consum Pie Chart - " + valueChartName);

      if (valueChartName[0] != null) {
        psPie1.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#F2C06C;"></i> ' +
          valueChartName[0] +
          "<br/>";
      }

      if (valueChartName[1] != null) {
        psPie2.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#F8EA94;"></i> ' +
          valueChartName[1] +
          "<br/>";
      }

      if (valueChartName[2] != null) {
        psPie3.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#A1CD7A;"></i> ' +
          valueChartName[2] +
          "<br/>";
      }

      if (valueChartName[3] != null) {
        psPie4.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#D44B52;"></i> ' +
          valueChartName[3] +
          "<br/>";
      }

      if (valueChartName[4] != null) {
        psPie5.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#F69380;"></i> ' +
          valueChartName[4] +
          "<br/>";
      }

      // Added Now
      new Chart(power_consume_pie, {
        type: "pie",
        data: {
          labels: valueChartName,
          datasets: [
            {
              label: "Power",
              data: valueChartY,
              backgroundColor: [
                "#F2C06C",
                "#F8EA94",
                "#A1CD7A",
                "#D44B52",
                "#F69380",
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            datalabels: {
              color: "#ffffff",
              font: {
                size: "14",
                weight: "bold",
              },
              formatter: (value, context) => {
                const dataset = context.chart.data.datasets[context.datasetIndex];
                const total = dataset.data.reduce((sum, value) => sum + value, 0);
                const percentage = ((value / total) * 100).toFixed(1);
                return `${percentage}%`;
              },
            },
            legend: {
              display: false,
              position: "bottom",
            },
          },
        },
        plugins: [ChartDataLabels],
      });



      if (resfunPowerConsumptionObject5.total_consumption == null) {
        pcTotalDieselConsumedPie.innerHTML = "0 KWH";
      } else {
        pcTotalDieselConsumedPie.innerHTML =
          resfunPowerConsumptionObject5.total_consumption + " KWH";
      }

      let sum = 0;

      for (let i = 0; i < valueChartY.length; i += 1) {
        if (valueChartY[i] == null) {
          let a = 0;
          sum += a;
        } else {
          sum += valueChartY[i];
        }
      }

      loaderPowerConsumPie.style.display = "none";
      if (sum == 0) {
        powerConsumPieNoData.style.display = "block";
        power_consume_pie.style.display = "none";
      } else {
        powerConsumPieNoData.style.display = "none";
        power_consume_pie.style.display = "block";
      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject6 != null) {
      power_consumption.style.display = "none";
      loaderPowerConsum.style.display = "block";
      powerConsumNoData.style.display = "none";


      let arrAllObjects = Object.values(resfunPowerConsumptionObject6.response);
      let arrSolar = [];
      let arrDG = [];
      let arrHtMeter = [];
      let arrTotal = [];
      let arrAverage = [];

      for (let i = 0; i < arrAllObjects.length; i++) {
        arrSolar.push(arrAllObjects[i].Solar);
        arrDG.push(arrAllObjects[i].dg);
        arrHtMeter.push(arrAllObjects[i].htMeter);
        arrAverage.push(arrAllObjects[i].average);
      }
      // Added now
      new Chart(power_consumption, {
        type: "bar",
        data: {
          labels: Object.keys(resfunPowerConsumptionObject6.response),
          datasets: [
            {
              label: "HT Meter",
              backgroundColor: ["#E95420"],
              data: arrHtMeter,
              borderWidth: 1,
              stack: "Stack 0",
            },
            {
              label: "Solar",
              backgroundColor: ["#77216f"],
              data: arrSolar,
              borderWidth: 1,
              stack: "Stack 0",
            },
            {
              label: "DG",
              backgroundColor: ["#f2ad6c"],
              data: arrDG,
              borderWidth: 1,
              stack: "Stack 0",
            },
            {
              type: "line",
              tension: 1,
              label: "Average",
              backgroundColor: ["#16a60c"],
              data: arrAverage,
              borderWidth: 0.4,
              stack: "Stack 0",
            },
          ],
        },
        options: {
          responsive: true,
          interaction: {
            intersect: false,
          },
          scales: {
            x: {
              stacked: true,
            },
            y: {
              stacked: true,
            },
          },
          maintainAspectRatio: false,
          scales: {
            x: {
              ticks: {
                callback: function (value) {
                  return this.getLabelForValue(value).substr(0, 15);
                },
              },
            },
          },
          plugins: {
            datalabels: {
              color: "#000000",
              anchor: "end",
              align: "end",
              offset: -6,
              font: {
                size: "10",
                weight: "bold",
              },
            },
            legend: {
              display: true,
              position: "no",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderPowerConsum.style.display = "none";
      powerConsumNoData.style.display = "none";
      power_consumption.style.display = "block";
    }

    // ----------------------------------------------



  }

  if (activePowerConsumptionTop == 1) {
    let titlePowerConsumation = document.getElementById("titlePowerConsumation");

    let pcTotalHtMeterTop = document.getElementById("pcTotalHtMeterTop");
    let pcTotalTransformerTop = document.getElementById("pcTotalTransformerTop");
    let pcTotalDgTop = document.getElementById("pcTotalDgTop");
    let pcTotalDieselConsumed = document.getElementById("pcTotalDieselConsumed");
    let pcTotalDieselConsumedPie = document.getElementById(
      "pcTotalDieselConsumedPie"
    );

    let loaderPowerConsumPieTop = document.getElementById("loaderPowerConsumPieTop");
    let powerConsumPieNoDataTop = document.getElementById("powerConsumPieNoDataTop");
    let power_consume_pieTop = document.getElementById("power_consume_pieTop");
    let psPie1 = document.getElementById("psPie1");
    let psPie2 = document.getElementById("psPie2");
    let psPie3 = document.getElementById("psPie3");
    let psPie4 = document.getElementById("psPie4");
    let psPie5 = document.getElementById("psPie5");

    let loaderMonthPower = document.getElementById("loaderMonthPower");
    let powerConsumMonthNoData = document.getElementById("powerConsumMonthNoData");
    let power_consumption_month = document.getElementById("power_consumption_month");



    let loaderSitePower = document.getElementById("loaderSitePower");
    let SitePowerNoData = document.getElementById("SitePowerNoData");
    let SitePowerConsumption = document.getElementById("SitePowerConsumption");

    let timeSeriesPowerConsumptionAssetwise = document.getElementById(
      "power-consumption-assetwise"
    );


    // ----------------------------------------------

    if (resfunPowerConsumptionObject1 != null) {
      if (resfunPowerConsumptionObject1.response == null) {
        pcTotalHtMeter.innerHTML = "0 kwh";
      } else {
        pcTotalHtMeter.innerHTML =
          resfunPowerConsumptionObject1.response + " kwh";
      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject2 != null) {
      if (resfunPowerConsumptionObject2.response == null) {
        pcTotalTransformer.innerHTML = "0 kwh";
      } else {
        pcTotalTransformer.innerHTML =
          resfunPowerConsumptionObject2.response + " kwh";
      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject3 != null) {
      if (resfunPowerConsumptionObject3.response == null) {
        pcTotalDg.innerHTML = "0 kwh";
      } else {
        pcTotalDg.innerHTML = resfunPowerConsumptionObject3.response + " kwh";
      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject4 != null) {
      if (resfunPowerConsumptionObject4.response == null) {
        pcTotalDieselConsumed.innerHTML = "0 liters";
      } else {
        pcTotalDieselConsumed.innerHTML =
          resfunPowerConsumptionObject4.response + " liters";

      }
    }

    // ----------------------------------------------

    if (resfunPowerConsumptionObject5 != null) {
      loaderPowerConsumPieTop.style.display = "block";
      powerConsumPieNoDataTop.style.display = "none";

      let valueChartName = Object.keys(resfunPowerConsumptionObject5.pie);
      let valueChartY = Object.values(resfunPowerConsumptionObject5.pie);

      console.log("Power Consum Pie Chart - " + valueChartName);

      if (valueChartName[0] != null) {
        psPie1.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#F2C06C;"></i> ' +
          valueChartName[0] +
          "<br/>";
      }

      if (valueChartName[1] != null) {
        psPie2.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#F8EA94;"></i> ' +
          valueChartName[1] +
          "<br/>";
      }

      if (valueChartName[2] != null) {
        psPie3.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#A1CD7A;"></i> ' +
          valueChartName[2] +
          "<br/>";
      }

      if (valueChartName[3] != null) {
        psPie4.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#D44B52;"></i> ' +
          valueChartName[3] +
          "<br/>";
      }

      if (valueChartName[4] != null) {
        psPie5.innerHTML =
          '<i class="bi  bi-square-fill " style="color:#F69380;"></i> ' +
          valueChartName[4] +
          "<br/>";
      }

      // Added Now
      new Chart(power_consume_pieTop, {
        type: "pie",
        data: {
          labels: valueChartName,
          datasets: [
            {
              label: "Power",
              data: valueChartY,
              backgroundColor: [
                "#F2C06C",
                "#F8EA94",
                "#A1CD7A",
                "#D44B52",
                "#F69380",
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            datalabels: {
              color: "#ffffff",
              font: {
                size: "14",
                weight: "bold",
              },
              formatter: (value, context) => {
                const dataset = context.chart.data.datasets[context.datasetIndex];
                const total = dataset.data.reduce((sum, value) => sum + value, 0);
                const percentage = ((value / total) * 100).toFixed(1);
                return `${percentage}%`;
              },
            },
            legend: {
              display: false,
              position: "bottom",
            },
          },
        },
        plugins: [ChartDataLabels],
      });



      if (resfunPowerConsumptionObject5.total_consumption == null) {
        pcTotalDieselConsumedPie.innerHTML = "0 KWH";
      } else {
        pcTotalDieselConsumedPie.innerHTML =
          resfunPowerConsumptionObject5.total_consumption + " KWH";
      }

      let sum = 0;

      for (let i = 0; i < valueChartY.length; i += 1) {
        if (valueChartY[i] == null) {
          let a = 0;
          sum += a;
        } else {
          sum += valueChartY[i];
        }
      }

      loaderPowerConsumPieTop.style.display = "none";
      if (sum == 0) {
        powerConsumPieNoDataTop.style.display = "block";
        power_consume_pieTop.style.display = "none";
      } else {
        powerConsumPieNoDataTop.style.display = "none";
        power_consume_pieTop.style.display = "block";
      }
    }

    // ----------------------------------------------





    if (resfunPowerConsumptionObject7 != null) {
      // power_consumption_month.style.display = "none";
      // loaderPowerConsumMonth.style.display = "block";
      // powerConsumNoDataMonth.style.display = "none";

      let arrAllObjects = Object.values(resfunPowerConsumptionObject7.response);
      let arrSolar = [];
      let arrDG = [];
      let arrMains = [];
      let arrSolar_avg = [];
      let arrDg_avg = [];
      let arrMains_avg = [];
      let arrDGpercent = [];
      let arrSolar_avg_precent = [];
      let arrMains_avg_precent = [];
      let arrconsum = [];

      for (let i = 0; i < arrAllObjects.length; i++) {
        arrSolar.push(arrAllObjects[i].Solar);
        arrDG.push(arrAllObjects[i].dg);
        arrDGpercent.push(arrAllObjects[i].dg_percentage);
        arrMains.push(arrAllObjects[i].mains);
        arrSolar_avg.push(arrAllObjects[i].solar_area_avg);
        arrSolar_avg_precent.push(arrAllObjects[i].solar_percentage);
        arrDg_avg.push(arrAllObjects[i].dg_area_avg);
        arrMains_avg.push(arrAllObjects[i].mains_area_avg);
        arrMains_avg_precent.push(arrAllObjects[i].mains_percentage);
        arrconsum.push(arrAllObjects[i].consumption_per_sq_feet)
      }

      // Added now
      new Chart(power_consumption_month, {
        type: "bar",
        // data: {
        //   labels: Object.keys(resfunMonthWiseDG.response),
        //   datasets: [
        //     {
        //       label: "DG",
        //       backgroundColor: ["#E95420"],
        //       data: arrdg,
        //       borderWidth: 1,
        //       borderColor: "#E95420",
        //       stack: "Stack 0",
        //       order:2,
        //     },
        //     {
        //       type: "line",
        //       tension: 0,
        //       label: "Cost/sq.ft",
        //       backgroundColor: ["#77216F"],
        //       data: arrdgsqft,
        //       borderWidth: 1,
        //       borderColor:"#77216F",
        //       stack: "Stack 1",
        //       order:1,
        //       yAxisID:'percentage',
        //     },
        //   ],
        // },

        data: {
          labels: Object.keys(resfunPowerConsumptionObject7.response),
          datasets: [
            {
              label: "DG",
              backgroundColor: "#E95420",
              data: arrDG,
              borderWidth: 1,
              borderColor: "#E95420",
              stack: "Stack 0",
              order: 2,
            }
          ]
        },
        options: {
          responsive: true,
          interaction: {
            intersect: false,
          },
          scales: {
            x: {
              stacked: true,
            },
            y: {
              stacked: true,
            },
          },
          maintainAspectRatio: false,
          scales: {
            x: {
              // ticks: {
              //   callback: function (value) {
              //     return this.getLabelForValue(value).substr(0, 15);
              //   },
              // },
              beginAtZero: true,
              title: {
                display: true,
                text: 'Sites',
                padding: {
                  top: 20,
                }
              }
            },
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'kVAh/liter'
              },
            },
            percentage: {
              beginAtZero: true,
              position: 'right',
              title: {
                display: true,
                text: 'Per Sq.ft Rs'
              },
            },
          },
          plugins: {
            datalabels: {
              display: false,
            },
            legend: {
              labels: {
                usePointStyle: true
              },
              display: true,
              position: "top",
              align: "center"
            },
            layout: {
              padding: {
                right: 50  // Increase right padding for the chart area
              }
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      // loaderMonthPower.style.display = "none";
      powerConsumMonthNoData.style.display = "none";
      power_consumption_month.style.display = "block";


    }

    if (resfunPowerConsumptionObject8 != null) {
      SitePowerConsumption.style.display = "none";
      loaderSitePower.style.display = "block";
      SitePowerNoData.style.display = "none";

      let arrAllObjects = Object.values(resfunPowerConsumptionObject8.response);
      let arrSolar = [];
      let arrSolaravg = [];
      let arrDG = [];
      let arrDGavg = [];
      let arrMains = [];
      let arrMainsavg = [];
      // let arrTotal = [];
      // let arrAverage = [];
      let arrSolarpercent = [];
      let arrDGpercent = [];
      let arrMainspercent = [];
      let arrconsum = [];

      for (let i = 0; i < arrAllObjects.length; i++) {
        arrSolar.push(arrAllObjects[i].Solar);
        arrSolaravg.push(arrAllObjects[i].solar_area_avg);
        arrDG.push(arrAllObjects[i].dg);
        arrDGavg.push(arrAllObjects[i].dg_area_avg);
        arrMains.push(arrAllObjects[i].main);
        arrMainsavg.push(arrAllObjects[i].mains_area_avg);
        // arrTotal.push(arrAllObjects[i].total);
        // arrAverage.push(arrAllObjects[i].average);
        arrSolarpercent.push(arrAllObjects[i].solar_percentage);
        arrDGpercent.push(arrAllObjects[i].dg_percentage);
        arrMainspercent.push(arrAllObjects[i].main_percentage);
        arrconsum.push(arrAllObjects[i].consumption_per_sq_feet)
      }
      console.log("++++++++++++++++++++++++++++++++++++++++++++++++Satcked Bar+++++++++++++++++++++++++++++++++++++++++++++++++++++++++")
      console.log(arrSolar);
      console.log(arrDG);
      // console.log(arrHtMeter);
      // console.log(arrAverage);


      // Added now
      new Chart(SitePowerConsumption, {
        type: "bar",
        data: {
          labels: Object.keys(resfunPowerConsumptionObject7.response),
          datasets: [


            {
              label: "DG",
              backgroundColor: ["#77216F"],
              data: arrDG,
              borderWidth: 1,
              borderColor: "#77216F",
              stack: "Stack 0",
              order: 2,
              datalabels: {
                display: true,
                formatter: function (value, context) {
                  const percentValue = arrDGpercent[context.dataIndex];
                  return !isNaN(percentValue) ? percentValue.toFixed(2) + '%' : ' ';
                },
                color: "#000", // Set the desired font color (white)
                anchor: "center",
                align: "center",
                offset: 0,
                font: {
                  size: "10",
                  weight: "bold",
                }, // Make sure datalabels are enabled
              },
            },

            {
              label: "Renewable",
              backgroundColor: ["#FDAB3D"],
              data: arrSolar,
              borderWidth: 1,
              borderColor: "#FDAB3D",
              stack: "Stack 0",
              order: 2,
              datalabels: {
                formatter: function (value, context) {
                  const percentValue = arrSolarpercent[context.dataIndex];
                  return !isNaN(percentValue) ? percentValue.toFixed(2) + '%' : ' ';
                },
                color: "#000", // Set the desired font color (white)
                anchor: "center",
                align: "center",
                offset: 0,
                font: {
                  size: "10",
                  weight: "bold",
                },
                display: true, // Make sure datalabels are enabled
              },
            },

            {
              label: "Mains",
              backgroundColor: ["#E95420"],
              data: arrMains,
              borderWidth: 1,
              borderColor: "#E95420",
              stack: "Stack 0",
              order: 2,
              datalabels: {
                formatter: function (value, context) {
                  const percentValue = arrMainspercent[context.dataIndex];
                  return !isNaN(percentValue) ? percentValue.toFixed(2) + '%' : ' ';
                },
                color: "#000", // Set the desired font color (white)
                anchor: "center",
                align: "center",
                offset: 0,
                font: {
                  size: "10",
                  weight: "bold",
                },
                display: true, // Make sure datalabels are enabled
              },
            },


            // {
            //   label: "Total",
            //   backgroundColor: ["#f2ad6c"],
            //   data: arrTotal,
            //   borderWidth: 1,
            //   borderColor: "#f2ad6c",
            //   stack: "Stack 0",
            //   order:2,
            // },
            // {
            //   type: "line",
            //   tension: 0,
            //   label: "Main",
            //   backgroundColor: ["#730000"],
            //   data: arrMainsavg,
            //   borderWidth: 0.4,
            //   borderColor: "#730000",
            //   stack: "Stack 1",
            //   order: 1,
            //   yAxisID: 'percentage',
            // },
            {
              type: "line",
              tension: 0,
              label: "Consumption per sq.ft",
              backgroundColor: ["#730000"],
              data: arrconsum,
              borderWidth: 0.4,
              borderColor: "#730000",
              stack: "Stack 1",
              order: 1,
              yAxisID: 'percentage',
            },
            // {
            //   type: "line",
            //   tension: 0,
            //   label: "Cost per sq.ft",
            //   backgroundColor: ["#7be382"],
            //   data: arrSolaravg,
            //   borderWidth: 0.4,
            //   borderColor: "#7be382",
            //   stack: "Stack 1",
            //   order: 1,
            //   // yAxisID:'percentage',
            // },
            // {
            //   type: "line",
            //   tension: 0,
            //   label: "DG",
            //   backgroundColor: ["#98c1d9"],
            //   data: arrDGavg,
            //   borderWidth: 0.4,
            //   borderColor:"#98c1d9",
            //   stack: "Stack 1",
            //   order:1,
            //   // yAxisID:'percentage',
            // },
            // {
            //   type: "line",
            //   tension: 0,
            //   label: "Total",
            //   backgroundColor: ["#f2ad6c"],
            //   data: arrAverage,
            //   borderWidth: 0.4,
            //   borderColor:"#f2ad6c",
            //   stack: "Stack 1",
            //   order:1,
            //   // yAxisID:'percentage',
            // },
          ],
        },
        options: {
          responsive: true,
          interaction: {
            intersect: false,
          },
          scales: {
            x: {
              stacked: true,
            },
            y: {
              stacked: true,
            },
          },
          maintainAspectRatio: false,
          scales: {
            x: {
              ticks: {
                callback: function (value) {
                  return this.getLabelForValue(value).substr(0, 15);
                },
              },
              beginAtZero: true,
              title: {
                display: true,
                text: 'Sites',
                padding: {
                  top: 20,
                }
              }
            },
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Consumption kVAh'
              },
            },
            percentage: {
              beginAtZero: true,
              position: 'right',
              title: {
                display: true,
                text: 'Per Sq.ft Rs'
              },
            },
          },
          plugins: {
            datalabels: {
              display: true,
            },
            legend: {
              labels: {
                usePointStyle: true  // Enable point style icons
              },
              display: true,
              position: "top",
              align: "center",


            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderSitePower.style.display = "none";
      SitePowerNoData.style.display = "none";
      SitePowerConsumption.style.display = "block";
    }

  }

  if (activeWaterConsumption == 1) {
    let titleWaterConsumption = document.getElementById(
      "titleWaterConsumption"
    );

    let wcTotalConsumption = document.getElementById("wcTotalConsumption");
    let wcTotalDomestic = document.getElementById("wcTotalDomestic");
    let wcFlushingTotal = document.getElementById("wcFlushingTotal");
    let wcTotalIrrigation = document.getElementById("wcTotalIrrigation");

    let loaderWaterConsumPie = document.getElementById("loaderWaterConsumPie");
    let waterConsumPieNoData = document.getElementById("waterConsumPieNoData");
    let water_consume_pie = document.getElementById("water-consume-pie");
    let wsPie1 = document.getElementById("wsPie1");

    let loaderWaterConsum = document.getElementById("loaderWaterConsum");
    let waterConsumNoData = document.getElementById("waterConsumNoData");
    let water_consumption = document.getElementById("water-consumption");

    let loaderWaterConsumLPCD = document.getElementById("loaderWaterConsumLPCD");
    let waterConsumLPCDNoData = document.getElementById("waterConsumLPCDNoData");
    let water_consume_lpcd = document.getElementById("water-consume-lpcd");
    let wsLPCD = document.getElementById("wsLPCD");

    // if (globalType == "daily") {
    //   titleWaterConsumption.innerHTML =
    //     "Water Consumption for " + convertDateFormat(globalDateFirst);
    // } else {
    //   titleWaterConsumption.innerHTML =
    //     "Water Consumption for " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    // ----------------------------------------------

    if (resfunWaterConsumptionObject1 != null) {
      if (resfunWaterConsumptionObject1.response == null) {
        wcTotalConsumption.innerHTML = "0 KL";
      } else {
        wcTotalConsumption.innerHTML =
          resfunWaterConsumptionObject1.response + " KL";
      }
    }

    // ----------------------------------------------

    if (resfunWaterConsumptionObject2 != null) {
      if (resfunWaterConsumptionObject2.response["Domestic KL"] == null) {
        wcTotalDomestic.innerHTML = "0 KL";
      } else {
        wcTotalDomestic.innerHTML =
          resfunWaterConsumptionObject2.response["Domestic KL"] + " KL";
      }

      if (resfunWaterConsumptionObject2.response["Flushing KL"] == null) {
        wcFlushingTotal.innerHTML = "0 KL";
      } else {
        wcFlushingTotal.innerHTML =
          resfunWaterConsumptionObject2.response["Flushing KL"] + " KL";
      }

      if (resfunWaterConsumptionObject2.response["Irrigation KL"] == null) {
        wcTotalIrrigation.innerHTML = "0 KL";
      } else {
        wcTotalIrrigation.innerHTML =
          resfunWaterConsumptionObject2.response["Irrigation KL"] + " KL";
      }
    }

    // ----------------------------------------------

    if (resfunWaterConsumptionObject5 != null) {
      loaderWaterConsumPie.style.display = "block";
      waterConsumPieNoData.style.display = "none";

      let valueChartName = Object.keys(resfunWaterConsumptionObject5.response);
      let valueChartY = Object.values(resfunWaterConsumptionObject5.response);

      console.log(valueChartY);

      let waterPieChartColors = [
        "#F2C06C",
        "#F8EA94",
        "#A1CD7A",
        "#D44B52",
        "#F69380",
        "#FF933C",
        "#FFBD3C",
        "#B4FF3C",
        "#4BFF3C",
        "#F69380",
        "#3CFF93",
        "#3CDEFF",
        "#3C4BFF",
        "#BD3CFF",
        "#FF3CFC",
        "#5F8900",
        "#008913",
        "#007C89",
        "#280089",
        "#890069",
      ];

      // let legendList = "<b>Water Sources</b><br/>";
      // for (let i = 0; i < valueChartName.length; i++) {
      //   if (valueChartName[i] != null) {
      //     legendList +=
      //       '<i class="bi  bi-circle-fill " style="color:' +
      //       waterPieChartColors[i] +
      //       ';"></i> ' +
      //       valueChartName[i] +
      //       "<br/>";
      //   }
      // }
      // wsPie1.innerHTML = legendList;

      // Added Now
      new Chart(water_consume_pie, {
        type: "bar",
        data: {
          labels: valueChartName,
          datasets: [
            {
              label: "Water Resource",
              data: valueChartY,
              backgroundColor: waterPieChartColors,
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          height: 400,

          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Consumption in %'
              }
            },
            x: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Water Resources'
              }
            }

          },

          plugins: {

            title: {
              fullSize: true,
              display: true,
              text: 'Water Resources',
              color: 'black',
              align: 'center',
              font: {
                weight: 'bold'
              },
              font: {
                size: 14
              },
              padding: {
                top: 1,
                bottom: 30
              }
            },

            datalabels: {
              color: "#ffffff",
              font: {
                size: "14",
                weight: "bold",
              },
            },
            legend: {
              display: false,
              position: "bottom",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      let sum = 0;

      for (let i = 0; i < valueChartY.length; i += 1) {
        if (valueChartY[i] == null) {
          let a = 0;
          sum += a;
        } else {
          sum += valueChartY[i];
        }
      }

      loaderWaterConsumPie.style.display = "none";
      if (sum == 0) {
        waterConsumPieNoData.style.display = "block";
        water_consume_pie.style.display = "none";
      } else {
        waterConsumPieNoData.style.display = "none";
        water_consume_pie.style.display = "block";
      }
    }

    // ----------------------------------------------------------

    if (resfunWaterConsumptionObjectLPCD != null) {
      let valueChartName = Object.keys(resfunWaterConsumptionObjectLPCD.response);
      let valueChartY = Object.values(resfunWaterConsumptionObjectLPCD.response);

      console.log(valueChartY);

      let waterPieChartColors = [
        "#F2C06C",
        "#F8EA94",
        "#A1CD7A",
        "#D44B52",
        "#F69380",
        "#FF933C",
        "#FFBD3C",
        "#B4FF3C",
        "#4BFF3C",
        "#F69380",
        "#3CFF93",
        "#3CDEFF",
        "#3C4BFF",
        "#BD3CFF",
        "#FF3CFC",
        "#5F8900",
        "#008913",
        "#007C89",
        "#280089",
        "#890069",
      ];




      new Chart(water_consume_lpcd, {
        type: "bar",
        data: {
          labels: valueChartName,
          datasets: [
            {
              label: "Water Consumption",
              data: valueChartY,
              backgroundColor: waterPieChartColors,
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) {
                  return value
                }
              },
              title: {
                display: true,
                text: '',
              }
            },
            x: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Towers',
                padding: {
                  top: 40,
                }
              }
            }

          },
          plugins: {


            title: {
              fullSize: true,
              display: true,
              text: '',
              color: 'black',
              align: 'center',
              font: {
                weight: 'bold'
              },
              font: {
                size: 14
              },
              padding: {
                top: 1,
                bottom: 30
              }
            },

            datalabels: {
              color: "#000000",
              font: {
                size: "14",
                weight: "bold",
              },
              ticks: {
                callback: function (value) {
                  return value + "%"
                }
              },
            },
            legend: {
              display: false,
              position: "bottom",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      let sum = 0;

      for (let i = 0; i < valueChartY.length; i += 1) {
        if (valueChartY[i] == null) {
          let a = 0;
          sum += a;
        } else {
          sum += valueChartY[i];
        }
      }

      loaderWaterConsumLPCD.style.display = "none";
      if (sum == 0) {
        waterConsumLPCDNoData.style.display = "block";
        water_consume_lpcd.style.display = "none";
      } else {
        waterConsumLPCDNoData.style.display = "none";
        water_consume_lpcd.style.display = "block";
      }
    }

    // ----------------------------------------------

    if (resfunWaterConsumptionObject6 != null) {
      water_consumption.style.display = "none";
      loaderWaterConsum.style.display = "block";
      waterConsumNoData.style.display = "none";

      let arrAllObjects = Object.values(resfunWaterConsumptionObject6.response);
      let arrdomestic_KL = [];
      let arrflushing_KL = [];
      let arrirrigation_KL = [];
      let arrTotal = [];
      let arrAverage = [];

      for (let i = 0; i < arrAllObjects.length; i++) {
        arrdomestic_KL.push(arrAllObjects[i].domestic_KL);
        arrflushing_KL.push(arrAllObjects[i].flushing_KL);
        arrirrigation_KL.push(arrAllObjects[i].irrigation_KL);
        arrTotal.push(arrAllObjects[i].total);
        arrAverage.push(arrAllObjects[i].average);
      }

      // Added now
      new Chart(water_consumption, {
        type: "bar",
        data: {
          labels: Object.keys(resfunWaterConsumptionObject6.response),
          datasets: [
            {
              label: "Domestic KL",
              backgroundColor: ["#E95420"],
              data: arrdomestic_KL,
              borderWidth: 1,
              stack: "Stack 0",
            },
            {
              label: "Flushing KL",
              backgroundColor: ["#77216f"],
              data: arrflushing_KL,
              borderWidth: 1,
              stack: "Stack 0",
            },
            {
              label: "Irrigation KL",
              backgroundColor: ["#f2ad6c"],
              data: arrirrigation_KL,
              borderWidth: 1,
              stack: "Stack 0",
            },
            {
              type: "line",
              tension: 1,
              label: "Average",
              backgroundColor: ["#16a60c"],
              data: arrAverage,
              borderWidth: 0.4,
              stack: "Stack 0",
            },
          ],
        },
        options: {
          responsive: true,
          interaction: {
            intersect: false,
          },
          scales: {
            x: {
              stacked: true,
            },
            y: {
              stacked: true,
            },

          },
          maintainAspectRatio: false,
          scales: {
            x: {
              ticks: {
                callback: function (value) {
                  return this.getLabelForValue(value).substr(0, 15);
                },
              },
            },

            x: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Dates'
              }
            }


          },
          plugins: {
            datalabels: {
              color: "#000000",
              anchor: "end",
              align: "end",
              offset: -6,
              font: {
                size: "10",
                weight: "bold",
              },
            },
            legend: {
              display: true,
              position: "no",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderWaterConsum.style.display = "none";
      waterConsumNoData.style.display = "none";
      water_consumption.style.display = "block";
    }
  }

  if (activeWaterConsumptionTop == 1) {

  }
  // if (activeWaterConsumptionTop == 1) {
  //   let titleWaterConsumption = document.getElementById(
  //     "titleWaterConsumption"
  //   );


  //   let wcTotalConsumptionTop = document.getElementById("wcTotalConsumptionTop");
  //   let wcTotalDomesticTop = document.getElementById("wcTotalDomesticTop");
  //   let wcFlushingTotalTop = document.getElementById("wcFlushingTotalTop");
  //   let wcTotalIrrigationTop = document.getElementById("wcTotalIrrigationTop");
  //   let wcTotalSTPTop = document.getElementById("wcTotalSTPTop");

  //   let loaderWaterConsumPie = document.getElementById("loaderWaterConsumPie");
  //   let waterConsumPieNoData = document.getElementById("waterConsumPieNoData");
  //   let water_consume_pieTop = document.getElementById("water_consume_pieTop");
  //   let wsPie1 = document.getElementById("wsPie1");

  //   let loaderWaterConsum = document.getElementById("loaderWaterConsum");
  //   let waterConsumNoData = document.getElementById("waterConsumNoData");
  //   let water_consumption_top = document.getElementById("water_consumption_top");

  //   let loaderWaterDomesticMonth = document.getElementById("loaderWaterDomesticMonth");
  //   let WaterDomesticMonthNoData = document.getElementById("WaterDomesticMonthNoData");
  //   let WaterDomesticMonth = document.getElementById("WaterDomesticMonth");

  //   let loaderSiteWiseWater = document.getElementById("loaderSiteWiseWater");
  //   let SiteWiseWaterNoData = document.getElementById("SiteWiseWaterNoData");
  //   let SiteWiseWater = document.getElementById("SiteWiseWater");



  //   // if (globalType == "daily") {
  //   //   titleWaterConsumption.innerHTML =
  //   //     "Water Consumption for " + convertDateFormat(globalDateFirst);
  //   // } else {
  //   //   titleWaterConsumption.innerHTML =
  //   //     "Water Consumption for " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  //   // }

  //   // ----------------------------------------------

  //   if (resfunWaterConsumptionObject1 != null) {
  //     if (resfunWaterConsumptionObject1.response == null) {
  //       wcTotalConsumption.innerHTML = "0 KL";
  //     } else {
  //       wcTotalConsumption.innerHTML =
  //         resfunWaterConsumptionObject1.response + " KL";
  //     }
  //   }

  //   // ----------------------------------------------

  //   if (resfunWaterConsumptionObject2 != null) {
  //     if (resfunWaterConsumptionObject2.response["Domestic KL"] == null) {
  //       wcTotalDomestic.innerHTML = "0 KL";
  //     } else {
  //       wcTotalDomestic.innerHTML =
  //         resfunWaterConsumptionObject2.response["Domestic KL"] + " KL";
  //     }

  //     if (resfunWaterConsumptionObject2.response["Flushing KL"] == null) {
  //       wcFlushingTotal.innerHTML = "0 KL";
  //     } else {
  //       wcFlushingTotal.innerHTML =
  //         resfunWaterConsumptionObject2.response["Flushing KL"] + " KL";
  //     }

  //     if (resfunWaterConsumptionObject2.response["Irrigation KL"] == null) {
  //       wcTotalIrrigation.innerHTML = "0 KL";
  //     } else {
  //       wcTotalIrrigation.innerHTML =
  //         resfunWaterConsumptionObject2.response["Irrigation KL"] + " KL";
  //     }
  //   }


  //   // ----------------------------------------------

  //   if(resfunWaterDomesticMonth !=null){

  //     new Chart(WaterDomesticMonth, {
  //       type: "bar",
  //       data: {
  //         labels: Object.keys(resfunWaterDomesticMonth.response),
  //         datasets: [
  //           {
  //             label: "Domestic KL",
  //             backgroundColor: ["#FDAB3D"],
  //             data: arrdomestic_KL,
  //             borderWidth: 1,
  //             borderColor: "#FDAB3D",
  //             stack: "Stack 0",
  //             order: "2",

  //           },
  //           {
  //             type: "line",
  //             tension: 0,
  //             label: "Cosumption/sq.ft",
  //             backgroundColor: ["#E95420"],
  //             data: domestic_KL_avg_area,
  //             borderWidth: 1,
  //             borderColor: "#E95420",
  //             stack: "Stack 1",
  //             order: "1",
  //             yAxisID: 'percentage',


  //           },
  //         ],
  //       },
  //       options: {
  //         responsive: true,
  //         maintainAspectRatio: false,
  //         // interaction: {
  //         //   intersect: false,
  //         // },

  //         scales: {
  //           x: {
  //             ticks: {
  //               callback: function (value) {
  //                 return this.getLabelForValue(value).substr(0, 15);
  //               },
  //             },
  //             beginAtZero: true,
  //             title: {
  //               display: true,
  //               text: 'Month',
  //               padding: {
  //                 top: 20,
  //               }
  //             }

  //           },
  //           y: {
  //             beginAtZero: true,
  //             title: {
  //               display: true,
  //               text: 'Consumption (KL)'
  //             },
  //           },
  //           percentage: {
  //             beginAtZero: true,
  //             position: 'right',
  //             title: {
  //               display: true,
  //               text: 'Consumption per Sq.ft'
  //             },
  //           },
  //         },
  //         plugins: {
  //           datalabels: {
  //             //  color: "#000000",
  //             //  anchor: "end",
  //             //  align: "end",
  //             //  offset: -6,
  //             //  font: {
  //             //    size: "10",
  //             //    weight: "bold",
  //             //  },
  //             //  ticks: {
  //             //    callback: function (value) {
  //             //      return value
  //             //    }
  //             //  },
  //             display: false,
  //           },
  //           legend: {
  //             labels: {
  //               usePointStyle: true  // Enable point style icons
  //             },
  //             display: true,
  //             position: "top",
  //             align: "end"
  //           },
  //         },
  //       },
  //       plugins: [ChartDataLabels],
  //     });



  //     loaderWaterDomesticMonth.style.display = "none";
  //     WaterDomesticMonthNoData.style.display = "none";
  //     WaterDomesticMonth.style.display = "block";
  //   }
  //   // ----------------------------------------------------------

  //   if(resfunWaterConsumptionObject5 !=null){
  //     let valueChartName = Object.keys(resfunWaterConsumptionObject5.response);
  //     let valueChartY = Object.values(resfunWaterConsumptionObject5.response);

  //     console.log(valueChartY);

  //     let waterPieChartColors = [
  //       "#F2C06C",
  //       "#F8EA94",
  //       "#A1CD7A",
  //       "#D44B52",
  //       "#F69380",
  //       "#FF933C",
  //       "#FFBD3C",
  //       "#B4FF3C",
  //       "#4BFF3C",
  //       "#F69380",
  //       "#3CFF93",
  //       "#3CDEFF",
  //       "#3C4BFF",
  //       "#BD3CFF",
  //       "#FF3CFC",
  //       "#5F8900",
  //       "#008913",
  //       "#007C89",
  //       "#280089",
  //       "#890069",
  //     ];




  //     new Chart(water_consume_pieTop, {
  //       type: "bar",
  //       data: {
  //         labels: valueChartName,
  //         datasets: [
  //           {
  //             label: "Water Resource",
  //             data: valueChartY,
  //             backgroundColor: waterPieChartColors,
  //             borderWidth: 1,
  //           },
  //         ],
  //       },
  //       options: {
  //         responsive: true,
  //         maintainAspectRatio: false,
  //         scales: {
  //           y: {
  //             beginAtZero: true,
  //             ticks: {
  //               callback: function (value) {
  //                 return value + "%"
  //               }
  //             },
  //             title: {
  //               display: true,
  //               text: 'Consumption in %',
  //             }
  //           },
  //           x: {
  //             beginAtZero: true,
  //             title: {
  //               display: true,
  //               text: 'Water Resources',
  //               padding: {
  //                 top: 40,
  //               }
  //             }
  //           }

  //         },
  //         plugins: {


  //           title: {
  //             fullSize: true,
  //             display: true,
  //             text: '',
  //             color: 'black',
  //             align: 'center',
  //             font: {
  //               weight: 'bold'
  //             },
  //             font: {
  //               size: 14
  //             },
  //             padding: {
  //               top: 1,
  //               bottom: 30
  //             }
  //           },

  //           datalabels: {
  //             // color: "#000000",
  //             // font: {
  //             //   size: "14",
  //             //   weight: "bold",
  //             // },
  //             display: false,
  //             ticks: {
  //               callback: function (value) {
  //                 return value + "%"
  //               }
  //             },
  //           },
  //           legend: {
  //             display: false,
  //             position: "bottom",
  //           },
  //         },
  //       },
  //       plugins: [ChartDataLabels],
  //     });

  //     let sum = 0;

  //     for (let i = 0; i < valueChartY.length; i += 1) {
  //       if (valueChartY[i] == null) {
  //         let a = 0;
  //         sum += a;
  //       } else {
  //         sum += valueChartY[i];
  //       }
  //     }

  //     loaderWaterConsumPie.style.display = "none";
  //     if (sum == 0) {
  //       waterConsumPieNoData.style.display = "block";
  //       water_consume_pieTop.style.display = "none";
  //     } else {
  //       waterConsumPieNoData.style.display = "none";
  //       water_consume_pieTop.style.display = "block";
  //     }
  //   }

  //   if(resfunWaterConsumptionObject6){
  //     let arrAllObjects = Object.values(resfunWaterConsumptionObject6.response);
  //   let arrflushing_KL = [];
  //   // let arrflushing_KL_avg = [];
  //   let arrirrigation_KL = [];
  //   // let arrirrigation_KL_avg = [];
  //   let arrtanker = [];
  //   // let arrtanker_avg = [];
  //   let arrstp = [];
  //   // let arrstp_avg = [];
  //   let arrTMC = [];
  //   // let arrTMC_avg = [];
  //   let arrOthers = [];
  //   // let arrOthers_avg = [];

  //   for (let i = 0; i < arrAllObjects.length; i++) {
  //     arrflushing_KL.push(arrAllObjects[i].Flushing_KL);
  //     // arrflushing_KL_avg.push(arrAllObjects[i].Flushing_KL_avg_area);
  //     arrirrigation_KL.push(arrAllObjects[i].Irrigation_KL);
  //     // arrirrigation_KL_avg.push(arrAllObjects[i].Irrigation_KL_avg_area);
  //     arrtanker.push(arrAllObjects[i].SOURCE___Tanker___Raw___Multiplication_Factor);
  //     // arrtanker_avg.push(arrAllObjects[i].SOURCE___Tanker___Raw___Multiplication_Factor_avg_area);
  //     arrstp.push(arrAllObjects[i].SOURCE__STP_Out_Put___Multiplication_Factor);
  //     // arrstp_avg.push(arrAllObjects[i].SOURCE__STP_Out_Put___Multiplication_Factor_avg_area);
  //     arrTMC.push(arrAllObjects[i].Water_Meter_TMC_Reading_In_KL);
  //     // arrTMC_avg.push(arrAllObjects[i].Water_Meter_TMC_Reading_In_KL_avg_area);
  //     arrOthers.push(arrAllObjects[i].others);
  //     // arrOthers_avg.push(arrAllObjects[i].others_avg_area);
  //   }

  //   // Added now
  //   new Chart(water_consumption_top, {
  //     type: "bar",
  //     data: {
  //       labels: Object.keys(resfunWaterConsumptionObject6.response),
  //       datasets: [
  //         {
  //           label: "Flushing KL",
  //           backgroundColor: ["#77216f"],
  //           data: arrflushing_KL,
  //           borderWidth: 1,
  //           borderColor: "#77216f",
  //           stack: "Stack 0",
  //           order: 2,
  //         },
  //         {
  //           label: "Irrigation KL",
  //           backgroundColor: ["#f2ad6c"],
  //           data: arrirrigation_KL,
  //           borderWidth: 1,
  //           borderColor: "#f2ad6c",
  //           stack: "Stack 0",
  //           order: 2,
  //         },
  //         {
  //           label: "Tanker",
  //           backgroundColor: ["#3d5a80"],
  //           data: arrtanker,
  //           borderWidth: 1,
  //           borderColor: "#3d5a80",
  //           stack: "Stack 0",
  //           order: 2,
  //         },
  //         {
  //           label: "STP",
  //           backgroundColor: ["grey"],
  //           data: arrstp,
  //           borderWidth: 1,
  //           borderColor: "grey",
  //           stack: "Stack 0",
  //           order: 2,
  //         },
  //         {
  //           label: "TMC",
  //           backgroundColor: ["#98c1d9"],
  //           data: arrTMC,
  //           borderWidth: 1,
  //           borderColor: "#98c1d9",
  //           stack: "Stack 0",
  //           order: 2,
  //         },
  //         {
  //           label: "Others",
  //           backgroundColor: ["	#dddddd"],
  //           data: arrOthers,
  //           borderWidth: 1,
  //           borderColor: "	#dddddd",
  //           stack: "Stack 0",
  //           order: 2,
  //         },
  //         // {
  //         //   type: "line",
  //         //   tension: 0,
  //         //   label: "Flushing",
  //         //   backgroundColor: ["#77216f"],
  //         //   data: arrflushing_KL_avg,
  //         //   borderWidth: 1,
  //         //   borderColor:"#77216f",
  //         //   stack: "Stack 0",
  //         //   order:1,
  //         // },
  //         // {
  //         //   type: "line",
  //         //   tension: 0,
  //         //   label: "Irrigation",
  //         //   backgroundColor: ["#f2ad6c"],
  //         //   data: arrirrigation_KL_avg,
  //         //   borderWidth: 1,
  //         //   borderColor:"#f2ad6c",
  //         //   stack: "Stack 0",
  //         //   order:1,
  //         // },
  //         // {
  //         //   type: "line",
  //         //   tension: 0,
  //         //   label: "Tanker",
  //         //   backgroundColor: ["#3d5a80"],
  //         //   data: arrtanker_avg,
  //         //   borderWidth: 1,
  //         //   borderColor:"#3d5a80",
  //         //   stack: "Stack 0",
  //         //   order:1,
  //         // },
  //         // {
  //         //   type: "line",
  //         //   tension: 0,
  //         //   label: "STP",
  //         //   backgroundColor: ["grey"],
  //         //   data: arrstp_avg,
  //         //   borderWidth: 1,
  //         //   borderColor:"grey",
  //         //   stack: "Stack 0",
  //         //   order:1,
  //         // },
  //         // {
  //         //   type: "line",
  //         //   tension: 0,
  //         //   label: "TMC",
  //         //   backgroundColor: ["#98c1d9"],
  //         //   data: arrTMC_avg,
  //         //   borderWidth: 1,
  //         //   borderColor:"#98c1d9",
  //         //   stack: "Stack 0",
  //         //   order:1,
  //         // },
  //         // {
  //         //   type: "line",
  //         //   tension: 0,
  //         //   label: "Others",
  //         //   backgroundColor: ["	#dddddd"],
  //         //   data: arrOthers_avg,
  //         //   borderWidth: 1,
  //         //   borderColor:"	#dddddd",
  //         //   stack: "Stack 0",
  //         //   order:1,
  //         // },
  //       ],
  //     },
  //     options: {
  //       responsive: true,
  //       maintainAspectRatio: false,
  //       // interaction: {
  //       //   intersect: false,
  //       // },

  //       scales: {
  //         x: {
  //           ticks: {
  //             callback: function (value) {
  //               return this.getLabelForValue(value).substr(0, 15);
  //             },
  //           },
  //           beginAtZero: true,
  //           title: {
  //             display: true,
  //             text: 'Months',
  //             padding: {
  //               top: 20,
  //             }
  //           }

  //         },
  //         y: {
  //           beginAtZero: true,
  //           // ticks: {
  //           //   callback: function (value) {
  //           //     return value + "%"
  //           //   }
  //           // },
  //           title: {
  //             display: true,
  //             text: 'Consumption (KL)'
  //           }
  //         }
  //       },
  //       plugins: {
  //         datalabels: {
  //           // color: "#000000",
  //           // anchor: "end",
  //           // align: "end",
  //           // offset: -6,
  //           // font: {
  //           //   size: "10",
  //           //   weight: "bold",
  //           // },

  //           display: false,
  //           ticks: {
  //             callback: function (value) {
  //               return value + "%"
  //             }
  //           },
  //         },
  //         legend: {
  //           labels: {
  //             usePointStyle: true  // Enable point style icons
  //           },
  //           display: true,
  //           position: "top",
  //           align: "center"
  //         },
  //       },
  //     },
  //     plugins: [ChartDataLabels],
  //   });

  //   loaderWaterConsum.style.display = "none";
  //   waterConsumNoData.style.display = "none";
  //   water_consumption_top.style.display = "block";

  //   }

  //   if(resfunMonthWiseSTP !=null){

  //     for (let i = 0; i < arrAllObjects.length; i++) {
  //       arrstp.push(arrAllObjects[i].stp);
  //       // arrflushing_KL.push(arrAllObjects[i].flushing_KL);
  //       // arrirrigation_KL.push(arrAllObjects[i].irrigation_KL);
  //       // arrTotal.push(arrAllObjects[i].total);
  //       // arrAverage.push(arrAllObjects[i].average);
  //     }

  //     // Added now
  //     new Chart(MonthWiseSTP, {
  //       type: "bar",
  //       data: {
  //         labels: Object.keys(resfunMonthWiseSTP.response),
  //         datasets: [
  //           {
  //             label: "Stp Efficiency",
  //             backgroundColor: ["#E95420"],
  //             data: arrstp,
  //             borderWidth: 1,
  //             borderColor: "#E95420",
  //             stack: "Stack 0",
  //           },
  //           // {
  //           //   label: "Flushing KL",
  //           //   backgroundColor: ["#77216f"],
  //           //   data: arrflushing_KL,
  //           //   borderWidth: 1,
  //           //   borderColor:"grey",
  //           //   stack: "Stack 0",
  //           // },
  //           // {
  //           //   label: "Irrigation KL",
  //           //   backgroundColor: ["#f2ad6c"],
  //           //   data: arrirrigation_KL,
  //           //   borderWidth: 1,
  //           //   borderColor:"grey",
  //           //   stack: "Stack 0",
  //           // },
  //           // {
  //           //   type: "line",
  //           //   tension: 1,
  //           //   label: "Average",
  //           //   backgroundColor: ["#16a60c"],
  //           //   data: arrAverage,
  //           //   borderWidth: 1,
  //           //   borderColor:"grey",
  //           //   stack: "Stack 0",
  //           // },
  //         ],
  //       },
  //       options: {
  //         responsive: true,
  //         maintainAspectRatio: false,
  //         // interaction: {
  //         //   intersect: false,
  //         // },

  //         scales: {
  //           x: {
  //             ticks: {
  //               callback: function (value) {
  //                 return this.getLabelForValue(value).substr(0, 15);
  //               },
  //             },
  //             beginAtZero: true,
  //             title: {
  //               display: true,
  //               text: 'Sites',
  //               padding: {
  //                 top: 20,
  //               }
  //             }

  //           },
  //           y: {
  //             beginAtZero: true,
  //             // ticks: {
  //             //   callback: function (value) {
  //             //     return value + "%"
  //             //   }
  //             // },
  //             title: {
  //               display: true,
  //               text: 'Consumption (KL)'
  //             }
  //           }
  //         },
  //         plugins: {
  //           datalabels: {
  //             // color: "#000000",
  //             // anchor: "end",
  //             // align: "end",
  //             // offset: -6,
  //             // font: {
  //             //   size: "10",
  //             //   weight: "bold",
  //             // },
  //             display: false,
  //             ticks: {
  //               callback: function (value) {
  //                 return value + "%"
  //               }
  //             },
  //           },
  //           legend: {
  //             labels: {
  //               usePointStyle: true  // Enable point style icons
  //             },
  //             display: true,
  //             position: "top",
  //             align: "center"
  //           },
  //         },
  //       },
  //       plugins: [ChartDataLabels],
  //     });

  //     loaderMonthWiseSTP.style.display = "none";
  //     MonthWiseSTPNoData.style.display = "none";
  //     MonthWiseSTP.style.display = "block";
  //   }

  //   if(resfunSiteWiseWater != null){
  //     let arrAllObjects = Object.values(resfunSiteWiseWater.response);
  //     let arrdomestic_KL = [];
  //     let arrflushing_KL = [];
  //     let arrirrigation_KL = [];
  //     let arrTotal = [];
  //     let arrAverage = [];

  //     for (let i = 0; i < arrAllObjects.length; i++) {
  //       arrdomestic_KL.push(arrAllObjects[i].domestic_KL);
  //       arrflushing_KL.push(arrAllObjects[i].flushing_KL);
  //       arrirrigation_KL.push(arrAllObjects[i].irrigation_KL);
  //       arrTotal.push(arrAllObjects[i].total);
  //       arrAverage.push(arrAllObjects[i].average);
  //     }

  //     // Added now
  //     new Chart(SiteWiseWater, {
  //       type: "bar",
  //       data: {
  //         labels: Object.keys(resfunSiteWiseWater.response),
  //         datasets: [
  //           {
  //             label: "Domestic",
  //             backgroundColor: ["#77216f"],
  //             data: arrdomestic_KL,
  //             borderWidth: 1,
  //             borderColor: "#77216f",
  //             stack: "Stack 0",
  //             order: 2,
  //           },
  //           {
  //             label: "Flushing ",
  //             backgroundColor: ["#FDAB3D"],
  //             data: arrflushing_KL,
  //             borderWidth: 1,
  //             borderColor: "#FDAB3D",
  //             stack: "Stack 0",
  //             order: 2,
  //           },
  //           {
  //             label: "Irrigation",
  //             backgroundColor: ["#E95420"],
  //             data: arrirrigation_KL,
  //             borderWidth: 1,
  //             borderColor: "#E95420",
  //             stack: "Stack 0",
  //             order: 2,
  //           },
  //           {
  //             type: "line",
  //             tension: 0,
  //             label: "Per sq ft",
  //             backgroundColor: ["#16a60c"],
  //             data: arrAverage,
  //             borderWidth: 1,
  //             borderColor: "#16a60c",
  //             stack: "Stack 0",
  //             order: 1,
  //             yAxisID: 'percentage',
  //           },
  //           {
  //             type: "line",
  //             tension: 0,
  //             label: "Consumption per sq ft",
  //             backgroundColor: ["#730000"],
  //             data: arrAverage,
  //             borderWidth: 1,
  //             borderColor: "#730000",
  //             stack: "Stack 0",
  //             order: 1,
  //             yAxisID: 'percentage',
  //           },
  //         ],
  //       },
  //       options: {
  //         responsive: true,
  //         maintainAspectRatio: false,
  //         // interaction: {
  //         //   intersect: false,
  //         // },

  //         scales: {
  //           x: {
  //             // ticks: {
  //             //   callback: function (value) {
  //             //     return this.getLabelForValue(value).substr(0, 15);
  //             //   },
  //             // },
  //             beginAtZero: true,
  //             title: {
  //               display: true,
  //               text: 'Sites',
  //               padding: {
  //                 top: 20,
  //               }
  //             }

  //           },
  //           y: {
  //             beginAtZero: true,
  //             title: {
  //               display: true,
  //               text: 'Consumption kl'
  //             },
  //           },
  //           percentage: {
  //             beginAtZero: true,
  //             position: 'right',
  //             title: {
  //               display: true,
  //               text: 'Per Sq.ft kl'
  //             },
  //           },
  //         },
  //         plugins: {
  //           datalabels: {
  //             // color: "#000000",
  //             // anchor: "end",
  //             // align: "end",
  //             // offset: -6,
  //             // font: {
  //             //   size: "10",
  //             //   weight: "bold",
  //             // },
  //             display: false,
  //             ticks: {
  //               callback: function (value) {
  //                 return value + "%"
  //               }
  //             },
  //           },
  //           legend: {
  //             labels: {
  //               usePointStyle: true  // Enable point style icons
  //             },
  //             display: true,
  //             position: "top",
  //             align: "end"
  //           },
  //         },
  //       },
  //       plugins: [ChartDataLabels],
  //     });

  //     loaderSiteWiseWater.style.display = "none";
  //     SiteWiseWaterNoData.style.display = "none";
  //     SiteWiseWater.style.display = "block";
  //   }

  // }

  if (activeCarbonEmission == 1 && resfunCarbonEmissionScope1 != null) {
    let cEScope1 = document.getElementById("cEScope1");
    cEScope1.innerHTML = resfunCarbonEmissionScope1.response + " kg CO2";

    let cEScope2 = document.getElementById("cEScope2");
    cEScope2.innerHTML = resfunCarbonEmissionScope2.response + " kg CO2";
  }

  if (activeFuelConsumption == 1 && resfunFuelConsumption != null) {
    let fuelConsmVal = document.getElementById("fuelConsmVal");
    fuelConsmVal.innerHTML = resfunFuelConsumption.response + " liters";
  }

  if (activeFitoutRequest == 1 && resfunFitOutRequest != null) {
    let fitOutVal = document.getElementById("fitOutVal");
    fitOutVal.innerHTML = resfunFitOutRequest.response + "";
  }

  if (activeEnergyIntensity == 1 && resgetEnergyIntensity != null) {
    let energyIntensity = document.getElementById("energyIntensity"); let fitOutVal = document.getElementById("fitOutVal");
    energyIntensity.innerHTML = resgetEnergyIntensity.response;
  }



  if (activeConductedAssets == 1 && resfunPpmConducted != null) {
    let cardConductedAssets = document.getElementById("cardConductedAssets");
    cardConductedAssets.innerHTML = resfunPpmConducted.response + "";
  }



  if (activeCustomerAverage == 1 && resfunCardCustomerAverage != null) {
    let cardCustomerAvg = document.getElementById("cardCustomerAvg");
    cardCustomerAvg.innerHTML = resfunCardCustomerAverage.response + "";
  }


  if (activeOpenEscalation == 1 && resfunCardOpenCloseEscalation != null) {
    let cardOpenEscalation = document.getElementById("cardOpenEscalation");
    cardOpenEscalation.innerHTML = resfunCardOpenCloseEscalation.response.Open + "";
  }


  if (activeCloseEscalation == 1 && resfunCardOpenCloseEscalation != null) {
    let cardCloseEscalation = document.getElementById("cardCloseEscalation");
    cardCloseEscalation.innerHTML = resfunCardOpenCloseEscalation.response.Closed + "";
  }

  if (activeAvgEscalation == 1 && resfunCardAvgEscalation != null) {
    let cardAvgEscalation = document.getElementById("cardAvgEscalation");
    cardAvgEscalation.innerHTML = resfunCardAvgEscalation.response + "";
  }

  if (activeIncidents == 1 && resfunIncidents != null) {
    let incidentsOpen = document.getElementById("fitOutVal");
    let incidentsInProgress = document.getElementById("fitOutVal");
    let incidentsPending = document.getElementById("fitOutVal");
    let incidentsClosed = document.getElementById("fitOutVal");

    let loaderIncident = document.getElementById("loaderIncident");
    let incidentNoData = document.getElementById("incidentNoData");
    let incident_dount = document.getElementById("incident-dount");

    loaderIncident.style.display = "block";
    incidentNoData.style.display = "none";

    // incidentsOpen.innerHTML = resfunIncidents.response["Open"];
    // incidentsInProgress.innerHTML = resfunIncidents.response["In Progress"];
    // incidentsPending.innerHTML = resfunIncidents.response["Pending"];
    // incidentsClosed.innerHTML = resfunIncidents.response["Closed"];

    let sum =
      resfunIncidents.response["Open"] +
      resfunIncidents.response["In Progress"] +
      resfunIncidents.response["Pending"] +
      resfunIncidents.response["Closed"];

    new Chart(incident_dount, {
      type: "doughnut",
      data: {
        labels: ["Open", "Work In Progress", "Pending", "Closed"],
        datasets: [
          {
            label: "Delivered Amount",
            data: [
              resfunIncidents.response["Open"],
              resfunIncidents.response["In Progress"],
              resfunIncidents.response["Pending"],
              resfunIncidents.response["Closed"],
            ],
            backgroundColor: ["#77216f", "#f2c06c", "#e2445b", "#a1cd7a"],
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderIncident.style.display = "none";
    if (sum == 0) {
      incidentNoData.style.display = "block";
      incident_dount.style.display = "none";
    } else {
      incidentNoData.style.display = "none";
      incident_dount.style.display = "block";
    }
  }

  if (activeCategoryWiseIncidents == 1 && resfunIncidentsCategory != null) {
    let incidentsCatMechanical = document.getElementById(
      "incidentsCatMechanical"
    );
    let incidentsCatEngineering = document.getElementById(
      "incidentsCatEngineering"
    );
    let incidentsCatHealthSafety = document.getElementById(
      "incidentsCatHealthSafety"
    );
    let incidentsCatOther = document.getElementById("incidentsCatOther");

    let loaderIncidentCategory = document.getElementById(
      "loaderIncidentCategory"
    );
    let incidentCategoryNoData = document.getElementById(
      "incidentCategoryNoData"
    );
    let incident_category_pie = document.getElementById(
      "incident-category-pie"
    );

    loaderIncidentCategory.style.display = "block";
    incidentCategoryNoData.style.display = "none";

    // incidentsCatMechanical.innerHTML =
    //   resfunIncidentsCategory.response["Mechanical System"];
    // incidentsCatEngineering.innerHTML =
    //   resfunIncidentsCategory.response["Engineering"];
    // incidentsCatHealthSafety.innerHTML =
    //   resfunIncidentsCategory.response["Health and Safety"];
    // incidentsCatOther.innerHTML = resfunIncidentsCategory.response["Others"];

    //   new Chart(incident_category_pie, {
    //     type: "pie",
    //     data: {
    //       labels: ["Mechanical", "Engineering", "Health & Safety", "other"],
    //       datasets: [
    //         {
    //           label: "Share",
    //           data: [
    //             resfunIncidentsCategory.response["Mechanical System"],
    //             resfunIncidentsCategory.response["Engineering"],
    //             resfunIncidentsCategory.response["Health and Safety"],
    //             resfunIncidentsCategory.response["Others"],
    //           ],
    //           backgroundColor: ["#f8ea94", "#a1cd7a", "#e2445b", "#f2c06c"],
    //           borderWidth: 1,
    //         },
    //       ],
    //     },
    //     options: {
    //       responsive: true,
    //       maintainAspectRatio: false,
    //       plugins: {
    //         datalabels: {
    //           color: "#ffffff",
    //           font: {
    //             size: "14",
    //             weight: "bold",
    //           },
    //         },
    //         legend: {
    //           display: true,
    //           position: "bottom",
    //         },
    //       },
    //     },
    //     plugins: [ChartDataLabels],
    //   });

    //   let sum =
    //     resfunIncidentsCategory.response["Health and Safety"] +
    //     resfunIncidentsCategory.response["Others"] +
    //     resfunIncidentsCategory.response["Mechanical System"] +
    //     resfunIncidentsCategory.response["Engineering"];

    //   loaderIncidentCategory.style.display = "none";
    //   if (sum == 0) {
    //     incidentCategoryNoData.style.display = "block";
    //     incident_category_pie.style.display = "none";
    //   } else {
    //     incidentCategoryNoData.style.display = "none";
    //     incident_category_pie.style.display = "block";
    //   }
    // }
    // let xhr_object = new XMLHttpRequest();

    // if (globalType == "daily") {
    //   xhr_object.open(
    //     "GET",
    //     getIncidentsCategory + idLink + "&date=" + globalDateFirst,
    //     true
    //   );
    //   console.log(getIncidentsCategory + idLink + "&date=" + globalDateFirst);
    // } else {
    //   xhr_object.open(
    //     "GET",
    //     getIncidentsCategory +
    //     idLink +
    //     "&from_date=" +
    //     globalDateFirst +
    //     "&to_date=" +
    //     globalDateSecond,
    //     true
    //   );
    //   console.log(
    //     getIncidentsCategory +
    //     idLink +
    //     "&from_date=" +
    //     globalDateFirst +
    //     "&to_date=" +
    //     globalDateSecond
    //   );
    // }

    // xhr_object.onload = function () {
    //   resfunIncidentsCategory = JSON.parse(this.responseText);

    //   console.log("Incident Category - ");
    //   console.log(resfunIncidentsCategory.response);

    let xValues = [], yValues = [];

    xValues = Object.keys(resfunIncidentsCategory.response);
    yValues = Object.values(resfunIncidentsCategory.response);

    let incidentCategoryPieColors = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];

    new Chart(incident_category_pie, {
      type: "pie",
      data: {
        labels: xValues,
        datasets: [
          {
            label: "Share",
            data: yValues,
            backgroundColor: incidentCategoryPieColors,
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderIncidentCategory.style.display = "none";
    incidentCategoryNoData.style.display = "none";
    incident_category_pie.style.display = "block";
  }

  if (activeManPowerAttendance == 1 && resfunManPower != null) {
    let ManPowerNoData = document.getElementById("ManPowerNoData");
    let loaderManPower = document.getElementById("loaderManPower");
    let tblManPowerinfo = document.getElementById("tblManPowerinfo");
    let tablebodyManPower = document.getElementById("tablebodyManPower");
    let mP = document.getElementById("mP");

    tblManPowerinfo.style.display = "none";
    loaderManPower.style.display = "block";
    ManPowerNoData.style.display = "none";

    // getIncidentManPower
    // if (globalType == "daily") {
    //   mP.innerHTML = " Man Power -  " + convertDateFormat(globalDateFirst);
    // } else {
    //   mP.innerHTML = " Man Power -  " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    let resfunManPowerArray = resfunManPower.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunManPowerArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        // `<td>` +
        // index +
        // `</td>` +
        `<td>` +
        resfunManPowerArray[x][0] +
        `</td>` +
        `<td>` +
        resfunManPowerArray[x][1] +
        `</td>`;
      // `<td>` +
      // resfunManPowerArray[x][2] +
      // `</td>` +
      // `<td>` +
      // resfunManPowerArray[x][3] +
      // `</td>`;
      allDetails = allDetails + `</tr>`;
    }
    tablebodyManPower.innerHTML = allDetails;

    loaderManPower.style.display = "none";
    if (resfunManPower.length == 0) {
      ManPowerNoData.style.display = "block";
      tblManPowerinfo.style.display = "none";
    } else {
      ManPowerNoData.style.display = "none";
      tblManPowerinfo.style.display = "inline-table";
    }
  }

  if (activeEventsFootfallAnalysis == 1) {
    // No Data
  }


  if (activeFitout == 1 && resfunRCA != null) {
    let FitoutNoData = document.getElementById("FitoutNoData");
    let tblFitout = document.getElementById("tblFitout");
    let tablebodyFitout = document.getElementById("tablebodyFitout");
    let loaderFitout = document.getElementById("loaderFitout");
    let ft = document.getElementById("ft");

    tblFitout.style.display = "none";
    loaderFitout.style.display = "block";
    FitoutNoData.style.display = "none";

    // if (globalType == "daily") {
    //   ft.innerHTML = " Fitout -  " + convertDateFormat(globalDateFirst);
    // } else {
    //   ft.innerHTML = " Fitout -  " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }
    let resfunFitoutArray = resfunFitout.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunFitoutArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        // `<td>` +
        // index +
        // `</td>` +
        `<td>` +
        resfunFitoutArray[x][0] +
        `</td>` +
        `<td>` +
        resfunFitoutArray[x][1] +
        `</td>` +
        `<td>` +
        resfunFitoutArray[x][2] +
        `</td>` +

        `<td>` +
        resfunFitoutArray[x][4] +
        `</td>` +
        `<td>` +
        resfunFitoutArray[x][5] +
        `</td>` +
        `<td>` +
        resfunFitoutArray[x][6] +
        `</td>`;
      allDetails = allDetails + `</tr>`;
    }
    tablebodyFitout.innerHTML = allDetails;

    loaderFitout.style.display = "none";
    if (resfunFitout.length == 0) {
      FitoutNoData.style.display = "block";
      tblFitout.style.display = "none";
    } else {
      FitoutNoData.style.display = "none";
      tblFitout.style.display = "block";
    }
  }



  if (activeRAC == 1 && resfunRCA != null) {
    let RCANoData = document.getElementById("RCANoData");
    let tblRCAinfo = document.getElementById("tblRCAinfo");
    let tablebodyRCA = document.getElementById("tablebodyRCA");
    let loaderRCA = document.getElementById("loaderRCA");
    let rca = document.getElementById("rca");

    tblRCAinfo.style.display = "none";
    loaderRCA.style.display = "block";
    RCANoData.style.display = "none";

    // if (globalType == "daily") {
    //   rca.innerHTML = " RCA -  " + convertDateFormat(globalDateFirst);
    // } else {
    //   rca.innerHTML = " RCA -  " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }
    let resfunRCAArray = resfunRCA.response;
    allDetails = ``;
    var index = 0;

    for (let x in resfunRCAArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][0] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][1] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][2] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][3] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][4] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][5] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][6] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][7] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][8] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][9] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][10] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][11] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][12] +
        `</td>` +
        `<td>` +
        resfunRCAArray[x][13] +
        `</td>` +
        `</tr>`;
    }
    tablebodyRCA.innerHTML = allDetails;

    loaderRCA.style.display = "none";
    if (resfunRCAArray.length == 0) {
      RCANoData.style.display = "block";
      tblRCAinfo.style.display = "none";
    } else {
      RCANoData.style.display = "none";
      tblRCAinfo.style.display = "block";
    }
  }

  if (activeAssetsBreakdown == 1 && resfunAssetsBreakdown != null) {
    let assetsBreakdownNoData = document.getElementById(
      "assetsBreakdownNoData"
    );
    let tblAssetsBreakdowninfo = document.getElementById(
      "tblAssetsBreakdowninfo"
    );
    let tablebodyAssetsBreakdown = document.getElementById(
      "tablebodyAssetsBreakdown"
    );
    let loaderAssetsBreakdown = document.getElementById(
      "loaderAssetsBreakdown"
    );
    let asset = document.getElementById("asset");

    tblAssetsBreakdowninfo.style.display = "none";
    loaderAssetsBreakdown.style.display = "block";
    assetsBreakdownNoData.style.display = "none";

    // if (globalType == "daily") {
    //   asset.innerHTML = " Assets Breakdown " + convertDateFormat(globalDateFirst);
    // } else {
    //   asset.innerHTML =
    //     " Assets Breakdown " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }
    let resfunAssetsBreakdownArray = resfunAssetsBreakdown.response.values;
    allDetails = ``;
    var index = 0;

    for (let x in resfunAssetsBreakdownArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][0] +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][1] +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][2] +
        `</td>` +
        `<td>` +
        resfunAssetsBreakdownArray[x][3] +
        `</td>`;

      if (
        resfunAssetsBreakdownArray[x][4] < 0 ||
        resfunAssetsBreakdownArray[x][4] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails + `<td>` + resfunAssetsBreakdownArray[x][4] + `</td>`;
      }

      if (
        resfunAssetsBreakdownArray[x][5] < 0 ||
        resfunAssetsBreakdownArray[x][5] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails + `<td>` + resfunAssetsBreakdownArray[x][5] + `</td>`;
      }
      allDetails = allDetails + `</tr>`;
    }
    tablebodyAssetsBreakdown.innerHTML = allDetails;

    loaderAssetsBreakdown.style.display = "none";
    if (resfunAssetsBreakdownArray.length == 0) {
      assetsBreakdownNoData.style.display = "block";
      tblAssetsBreakdowninfo.style.display = "none";
    } else {
      assetsBreakdownNoData.style.display = "none";
      tblAssetsBreakdowninfo.style.display = "block";
    }
  }

  if (activeAssetsBreakdownGraph == 1 && resfunAssetBreakDown != null) {
    let AssetBreakDownNoData = document.getElementById("AssetBreakDownNoData");
    let AssetBreakDown = document.getElementById("AssetBreakDown");
    let loaderAssetBreakDown = document.getElementById(
      "loaderAssetBreakDown"
    );

    let arrAllObjects = Object.values(resfunAssetBreakDown.response);
    let arrCriticalBreak = [];
    let arrCriticalOperational = [];
    let arrNonCriticalBreak = [];
    let arrNonCriticalOperational = [];

    for (let i = 0; i < arrAllObjects.length; i++) {
      arrCriticalBreak.push(arrAllObjects[i].critical_breakdown_count);
      // arrCriticalOperational.push(arrAllObjects[i].Critical_Operational);
      arrNonCriticalBreak.push(arrAllObjects[i].non_critical_breakdown_count);
      // arrNonCriticalOperational.push(arrAllObjects[i].Non_Critical_Operational);

    }

    // Added now
    new Chart(AssetBreakDown, {
      type: "bar",
      data: {
        labels: Object.keys(resfunAssetBreakDown.response),
        datasets: [
          {
            label: "Critical Breakdown",
            backgroundColor: "rgba(255, 159, 64)",
            data: arrCriticalBreak,
            borderWidth: 1,
            stack: "Stack 0",
          },
          // {
          //   label: "Critical Operational",
          //   backgroundColor: ["#3d5a80"],
          //   data: arrCriticalOperational,
          //   borderWidth: 1,
          //   stack: "Stack 0",
          // },
          {
            label: "Non-Critical Breakdown",
            backgroundColor: ["#555555"],
            data: arrNonCriticalBreak,
            borderWidth: 1,
            stack: "Stack 1",
          },
          // {
          //   label: "Non-Critical Operational",
          //   backgroundColor: ["#98c1d9"],
          //   data: arrNonCriticalOperational,
          //   borderWidth: 1,
          //   stack: "Stack 1",
          // },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            // ticks: {
            //   callback: function (value) {
            //     return this.getLabelForValue(value).substr(0, 15);
            //   },
            // },
            beginAtZero: true,
            title: {
              display: true,
              text: 'Sites',
              padding: {
                top: 20,
              }
            }
          },
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Total Breakdown'
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            labels: {
              usePointStyle: true  // Enable point style icons
            },
            display: true,
            position: "top",
            align: "end"
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderAssetBreakDown.style.display = "none";

    if (resfunAssetBreakDown.response.length == 0) {
      AssetBreakDownNoData.style.display = "block";
      AssetBreakDown.style.display = "none";
    } else {
      AssetBreakDownNoData.style.display = "none";
      AssetBreakDown.style.display = "block";
    }
  }


  if (activeSafeManHours == 1 && resfunGetSafeManHours != null) {
    let cardSafeManHours = document.getElementById("cardSafeManHours");
    cardSafeManHours.innerHTML = resfunGetSafeManHours.response + "";
  }

  if (activeWaste == 1) {
  }

  if (activePyramid == 1 && resfunPyramid != null) {
    let chartPyramidNoData = document.getElementById("chartPyramidNoData");
    let chartPyramid = document.getElementById("chartPyramid");
    let loaderPyramid = document.getElementById("loaderPyramid");
    let pyr = document.getElementById("pyr");

    chartPyramid.style.display = "none";
    loaderPyramid.style.display = "block";
    chartPyramidNoData.style.display = "none";
    console.log(resfunPyramid);

    // if (globalType == "daily") {
    //   pyr.innerHTML = " Incident Wise Level " + convertDateFormat(globalDateFirst);
    // } else {
    //   pyr.innerHTML =
    //     " Incident Wise Level " + convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
    // }

    let valueChartName = Object.keys(resfunPyramid.response);
    let valueChartY = Object.values(resfunPyramid.response);

    myChart = new Chart(chartPyramid, {
      type: "bar",
      data: {
        labels: valueChartName,
        datasets: [
          {
            // label:"Incident",
            data: valueChartY,
            axis: "y",
            fill: true,
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],

            borderWidth: 1,
          },
        ],
      },
      options: {
        indexAxis: "y",
        responsive: true,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: false,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    // if (myChart !=null){
    //     myChart.destory();
    // }
    loaderPyramid.style.display = "none";
    if (resfunPyramid.response == 0) {
      chartPyramidNoData.style.display = "block";
      chartPyramid.style.display = "none";
    } else {
      chartPyramidNoData.style.display = "none";
      chartPyramid.style.display = "block";
    }
  }

  // if (activeIncidentII == 1 && resfunIncidentII != null) {
  //   let incidentSpan = document.getElementById("incidentSpan");
  //   let loaderIncidentII = document.getElementById("loaderIncidentII");
  //   let incidentIINoData = document.getElementById("incidentIINoData");
  //   let incident_II_pie = document.getElementById("incident_II_pie");
  //   let incidentii = document.getElementById("incidentii");

  //   // incident_II_pie.style.display = "none";
  //   loaderIncidentII.style.display = "block";
  //   incidentIINoData.style.display = "none";

  //   if (globalType == "daily") {
  //     incidentii.innerHTML = " Incident Injury Illness" + convertDateFormat(globalDateFirst);
  //   } else {
  //     incidentii.innerHTML =
  //       " Incident Injury Illness " +
  //       convertDateFormat(globalDateFirst) + " to " + convertDateFormat(globalDateSecond);
  //   }
  //   resfunIncidentII = JSON.parse(this.responseText);
  //   let sum = 0;

  //   let valueName = [];
  //   let valueY = [];

  //   let arrayPie = [];

  //   for (let i = 0; i < resfunIncidentII.response.length; i++) {
  //     valueName[i] = resfunIncidentII.response[i].name;
  //     valueY[i] = resfunIncidentII.response[i].y;
  //   }

  //   for (let i = 0; i < valueName.length; i++) {
  //     if (valueY[i] == null) {
  //       arrayPie.push({ name: valueName[i], y: 0 });
  //     } else {
  //       arrayPie.push({
  //         name: valueName[i],
  //         y: valueY[i],
  //       });
  //     }
  //   }

  //   let incidentChartColors = [
  //     "#F8EA94",
  //     "#A1CD7A",
  //     "#F2C06C",
  //     "#D44B52",
  //     "#F69380",
  //     "#FF933C",
  //     "#FFBD3C",
  //     "#B4FF3C",
  //     "#4BFF3C",
  //     "#F69380",
  //     "#3CFF93",
  //     "#3CDEFF",
  //     "#3C4BFF",
  //     "#BD3CFF",
  //     "#FF3CFC",
  //     "#5F8900",
  //     "#008913",
  //     "#007C89",
  //     "#280089",
  //     "#890069",
  //   ];


  //   let total = valueName + valueY;
  //   const centerT = {
  //     id: "centerT",
  //     afterDatasetsDraw(chart, args, options) {
  //       const {
  //         ctx,
  //         chartArea: { left, right, top, bottom, width, height },
  //       } = chart;
  //       ctx.save();

  //       ctx.font = "bolder 18px Arial";
  //       ctx.fillStyle = "rgba(0, 0, 0, 1)";
  //       ctx.textAlign = "center";
  //       ctx.fillText("Total: " + total, width, height);
  //     },
  //   };
  //   new Chart(incident_II_pie, {
  //     type: "pie",
  //     data: {
  //       labels: valueName,
  //       datasets: [
  //         {
  //           label: "Incident Pyramid",
  //           data: valueY,
  //           backgroundColor: incidentChartColors,
  //           radius: "80%",
  //           borderWidth: 1,
  //         },
  //       ],
  //     },
  //     options: {
  //       indexAxis: "y",
  //       responsive: true,
  //       maintainAspectRatio: false,
  //       plugins: {
  //         datalabels: {
  //           color: "#ffffff",
  //           font: {
  //             size: "14",
  //             weight: "bold",
  //           },
  //         },
  //         legend: {
  //           display: true,
  //           position: "bottom",
  //         },
  //       },
  //     },
  //     plugins: [ChartDataLabels],
  //   });

  //   for (let i = 0; i < valueY.length; i += 1) {
  //     if (valueY[i] == null) {
  //       let a = 0;
  //       sum += a;
  //     } else {
  //       sum += valueY[i];
  //     }
  //   }

  //   loaderIncidentII.style.display = "none";
  //   if (sum == 0) {
  //     incidentIINoData.style.display = "block";
  //     incident_II_pie.style.display = "none";
  //   } else {
  //     incidentIINoData.style.display = "none";
  //     incident_II_pie.style.display = "block";
  //   }
  // }

  if (activeRootCause == 1 && resfunRootCause != null) {
    let incidentRoot = document.getElementById("incidentRoot");
    let loaderRootCause = document.getElementById("loaderRootCause");
    let rootCauseNoData = document.getElementById("rootCauseNoData");
    let root_Cause_pie = document.getElementById("root_Cause_pie");

    // root_Cause_pie.style.display = "none";
    loaderRootCause.style.display = "block";
    rootCauseNoData.style.display = "none";



    let sum = 0;

    let valueN = [];
    let valueYa = [];

    let arrayP = [];

    for (let i = 0; i < resfunRootCause.response.length; i++) {
      valueN[i] = resfunRootCause.response[i].name;
      valueYa[i] = resfunRootCause.response[i].y;
    }

    for (let i = 0; i < valueN.length; i++) {
      if (valueYa[i] == null) {
        arrayP.push({ name: valueN[i], y: 0 });
      } else {
        arrayP.push({
          name: valueN[i],
          y: valueYa[i],
        });
      }
    }

    let incidentRootColors = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];

    // let legendList = "";
    // for (let i = 0; i < valueN.length; i++) {
    //   if (valueN[i] != null) {
    //     legendList +=
    //       '<i class="bi  bi-circle-fill " style="color:' +
    //       incidentRootColors[i] +
    //       ';"></i> ' +
    //       valueN[i] +
    //       "-" +
    //       valueYa[i];
    //     "<br/>" + "<br/>";
    //   }
    // }
    // incidentRoot.innerHTML = legendList;

    let total = valueN + valueYa;
    const centerTexts = {
      id: "centerTexts",
      afterDatasetsDraw(chart, args, options) {
        const {
          ctx,
          chartArea: { left, right, top, bottom, width, height },
        } = chart;
        ctx.save();

        ctx.font = "bolder 18px Arial";
        ctx.fillStyle = "rgba(0, 0, 0, 1)";
        ctx.textAlign = "center";
        ctx.fillText("Total: " + total, width, height);
      },
    };
    new Chart(root_Cause_pie, {
      type: "pie",

      data: {
        labels: valueN,
        datasets: [
          {
            label: "Incident Root Cause",
            data: valueYa,
            backgroundColor: incidentRootColors,
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        indexAxis: "y",
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });
    // console.log("arraypie");
    // console.log(arrayP);

    for (let i = 0; i < valueYa.length; i += 1) {
      if (valueYa[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueYa[i];
      }
    }

    loaderRootCause.style.display = "none";
    if (sum == 0) {
      rootCauseNoData.style.display = "block";
      root_Cause_pie.style.display = "none";
    } else {
      rootCauseNoData.style.display = "none";
      root_Cause_pie.style.display = "block";
    }
  };

  if (activeReactiveProactiveTickets == 1 && resfunReactiveTicket != null) {
    let ReactiveTicketNoData = document.getElementById("ReactiveTicketNoData");
    let reactiveTicket = document.getElementById("reactiveTicket");
    let loaderReactiveTicket = document.getElementById("loaderReactiveTicket");


    loaderReactiveTicket.style.display = "block";
    ReactiveTicketNoData.style.display = "none";

    new Chart(reactiveTicket, {
      type: "doughnut",
      data: {
        labels: ["Proactive", "Reactive"],
        datasets: [
          {
            label: "Tickets",
            backgroundColor: ["#01c875", "#e2445b"],
            data: [
              // resfunChartTicket.response.total,
              resfunReactiveTicket.response.proactive_tickets,
              resfunReactiveTicket.response.reactive_tickets,
            ],
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffff",
            // anchor: "end",
            // align: "end",
            offset: -6,
            font: {
              size: "14",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

  }

  // if (activeSiteWiseEscalation == 1 && resfunSiteWiseEscalation != null) {
  //   let SiteWiseEscalationNoData = document.getElementById("SiteWiseEscalationNoData");
  //   let SiteWiseEscalation = document.getElementById("SiteWiseEscalation");
  //   let loaderSiteWiseEscalation = document.getElementById("loaderSiteWiseEscalation");
  //   // let occupancy = document.getElementById("occupancy");

  //   // loaderSiteWiseEscalation.style.display = "block";
  //   // SiteWiseEscalationNoData.style.display = "none";

  //   let xLabelsArray = Object.keys(resfunSiteWiseEscalation.response);

  //   for (let i = 0; i < xLabelsArray.length; i += 1) {
  //     xLabelsArray[i] = xLabelsArray[i].split(" ");
  //   }
  //   // Added now
  //   new Chart(SiteWiseEscalation, {
  //     type: "bar",
  //     data: {
  //       labels: xLabelsArray,
  //       datasets: [
  //         {
  //           label: "Site Wise",
  //           backgroundColor: [
  //             "#77216F",
  //             "#01C875",
  //             "#E2445B",
  //             "#E95420",
  //             "#A1CD7A",
  //           ],
  //           data: Object.values(resfunSiteWiseEscalation.response),
  //           borderWidth: 1,

  //         },
  //       ],
  //     },
  //     options: {
  //       responsive: true,
  //       maintainAspectRatio: false,

  //       plugins: {
  //         datalabels: {
  //           color: "#000000",
  //           anchor: "end",
  //           align: "end",
  //           offset: -6,
  //           font: {
  //             size: "10",
  //             weight: "bold",
  //           },
  //         },
  //         legend: {
  //           display: true,
  //           position: "no",
  //         },
  //       },
  //     },
  //     plugins: [ChartDataLabels],
  //   });

  //   loaderSiteWiseEscalation.style.display = "none";

  //   if (Object.keys(resfunSiteWiseEscalation.response).length == 0) {
  //     SiteWiseEscalationNoData.style.display = "block";
  //     SiteWiseEscalation.style.display = "none";
  //   } else {
  //     SiteWiseEscalationNoData.style.display = "none";
  //     SiteWiseEscalation.style.display = "block";
  //   }

  // }

  // if (activeOpenCloseEscalation == 1 && resfunOpenCloseEscalation != null) {
  //   let OpenCloseEscalationNoData = document.getElementById("OpenCloseEscalationNoData");
  //   let OpenCloseEscalation = document.getElementById("OpenCloseEscalation");
  //   let loaderOpenCloseEscalation = document.getElementById("loaderOpenCloseEscalation");
  //   // let dt1 = document.getElementById("dt1");

  //   // loaderOpenCloseEscalation.style.display = "block";
  //   // OpenCloseEscalationNoData.style.display = "none";

  //   let total = resfunOpenCloseEscalation.response.Open + resfunOpenCloseEscalation.response.Closed;
  //   const centerText = {
  //     id: 'centerText',
  //     afterDatasetsDraw(chart, args, options) {
  //       const { ctx, chartArea: { left, right, top, bottom, width, height } } = chart;
  //       ctx.save();

  //       ctx.font = 'bolder 18px Arial';
  //       ctx.fillStyle = 'rgba(0, 0, 0, 1)';
  //       ctx.textAlign = 'center';
  //       ctx.fillText('Total: ' + total, width / 2, height / 2);
  //     }
  //   }

  //   // let xValues = [], yValues = [];

  //   // xValues = Object.keys(resfunChartTicket.response.open);
  //   // yValues = Object.values(resfunChartTicket.response);

  //   // Added Now
  //   new Chart(OpenCloseEscalation, {
  //     type: "doughnut",
  //     data: {
  //       labels: ["Open", "Closed"],
  //       datasets: [
  //         {
  //           label: "Escalation",
  //           backgroundColor: ["#e2445b", "#01c875"],
  //           data: [
  //             // resfunChartTicket.response.total,
  //             resfunOpenCloseEscalation.response.Open,
  //             resfunOpenCloseEscalation.response.Closed
  //           ],
  //           borderWidth: 1,
  //           radius: "80%",
  //         },
  //       ],
  //     },
  //     options: {
  //       responsive: true,
  //       maintainAspectRatio: false,

  //       plugins: {
  //         datalabels: {
  //           color: "#ffffff",
  //           font: {
  //             size: "14",
  //             weight: "bold",
  //           },
  //         },
  //         legend: {
  //           display: true,
  //           position: "bottom",
  //         },
  //       },
  //     },
  //     plugins: [ChartDataLabels],
  //   });

  //   loaderOpenCloseEscalation.style.display = "none";

  //   if (resfunOpenCloseEscalation.response.length == 0) {
  //     OpenCloseEscalationNoData.style.display = "block";
  //     OpenCloseEscalation.style.display = "none";
  //   } else {
  //     OpenCloseEscalationNoData.style.display = "none";
  //     OpenCloseEscalation.style.display = "block";
  //   }



  // }

  if (activeCategoryWiseEscalation == 1 && resfunCategoryWiseEscalation != null) {
    let NoDataCategoryEscalation = document.getElementById("NoDataCategoryEscalation");
    let CategoryEscalation = document.getElementById("CategoryEscalation");
    let loaderCategoryEscalation = document.getElementById("loaderCategoryEscalation");
    // let dt1 = document.getElementById("dt1");

    loaderCategoryEscalation.style.display = "block";
    NoDataCategoryEscalation.style.display = "none";

    let xValues = [], yValues = [];

    xValues = Object.keys(resfunCategoryWiseEscalation.response);
    yValues = Object.values(resfunCategoryWiseEscalation.response);

    let CategoryEscalationPieColors = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];


    // Added Now
    new Chart(CategoryEscalation, {
      type: "pie",
      data: {
        labels: xValues,
        datasets: [
          {
            label: "Category",
            backgroundColor: CategoryEscalationPieColors,
            data: yValues,
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,

        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderCategoryEscalation.style.display = "none";
    NoDataCategoryEscalation.style.display = "none";
    CategoryEscalation.style.display = "block";
  }

  if (activeTotalDownloads == 1) {

  }
  if (activeRegisterdUser == 1) {

  }

  if (activeZoneWiseEscalation == 1 && resfunSiteWiseEscalation != null) {
    let SiteWiseEscalationNoData = document.getElementById("SiteWiseEscalationNoData");
    let SiteWiseEscalation = document.getElementById("SiteWiseEscalation");
    let loaderSiteWiseEscalation = document.getElementById("loaderSiteWiseEscalation");
    // let occupancy = document.getElementById("occupancy");

    loaderSiteWiseEscalation.style.display = "block";
    SiteWiseEscalationNoData.style.display = "none";



    resfunSiteWiseEscalation = JSON.parse(this.responseText);
    console.log("Site Wise Escalation - ");
    console.log(resfunSiteWiseEscalation);

    let xLabelsArray = Object.keys(resfunSiteWiseEscalation.response);

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      xLabelsArray[i] = xLabelsArray[i].split(" ");
    }
    // Added now
    new Chart(SiteWiseEscalation, {
      type: "bar",
      data: {
        labels: xLabelsArray,
        datasets: [
          {
            label: "Site Wise",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: Object.values(resfunSiteWiseEscalation.response),
            borderWidth: 1,

          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,

        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderSiteWiseEscalation.style.display = "none";

    SiteWiseEscalationNoData.style.display = "none";
    SiteWiseEscalation.style.display = "block";



  }

  if (activeServicePartnerEvaluation == 1 && resfunAuditScore != null) {
    let AuditScoreNoData = document.getElementById("AuditScoreNoData");
    let tblAuditScoreinfo = document.getElementById(
      "tblAuditScoreinfo"
    );
    let tablebodyAuditScore = document.getElementById(
      "tablebodyAuditScore"
    );
    let loaderAuditScore = document.getElementById("loaderAuditScore");


    // Assuming your API response is in the correct format
    let resfunAuditScore = JSON.parse(this.responseText);

    console.log("Audit Score - ");
    console.log(resfunAuditScore);

    let resfunAuditScoreArray = resfunAuditScore.response;
    allDetails = ``;

    for (let i = 0; i < resfunAuditScoreArray.length; i++) {
      let rowData = resfunAuditScoreArray[i];
      allDetails +=
        `<tr>` +
        `<td>` + (i + 1) + `</td>` +
        `<td>` + rowData[0] + `</td>` +
        `<td>` + (rowData[1] ? rowData[1] : '-') + `</td>` +
        `<td>` + (rowData[2] ? new Date(rowData[2]).toLocaleDateString() : '-') + `</td>` +
        `<td>` + (rowData[3] ? rowData[3] : '-') + `</td>` +
        `<td>` + (rowData[4] ? rowData[4] : '-') + `</td>` +
        `</tr>`;
    }
    tablebodyAuditScore.innerHTML = allDetails;


    loaderAuditScore.style.display = "none";
    AuditScoreNoData.style.display = "none";
    tblAuditScoreinfo.style.display = "inline-table";

  }

  if (activeGenderParticipation == 1 && resfungenderParticipation != null) {
    let genderNoData = document.getElementById("genderNoData");
    let genderParticipation = document.getElementById("genderParticipation");
    let loaderGender = document.getElementById("loaderGender");

    loaderGender.style.display = "block";
    genderNoData.style.display = "none";
    genderParticipation.style.display = "none";

    xhr_object.onload = function () {
      resfungenderParticipation = JSON.parse(this.responseText);
      console.log("Gender Participation");
      console.log(resfungenderParticipation);

      // Get the counts of male and female participants
      let femaleCount = parseInt(resfungenderParticipation.response1.female);
      let maleCount = parseInt(resfungenderParticipation.response1.male);

      // Update the pie chart data
      new Chart(genderParticipation, {
        type: "pie",
        data: {
          labels: ["Female", "Male"],
          datasets: [
            {
              label: "Gender",
              backgroundColor: ["#e2445b", "#01c875"],
              data: [femaleCount, maleCount], // Use the raw counts here
              borderWidth: 1,
              radius: "100%",
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            datalabels: {
              color: "#ffff",
              offset: -6,
              font: {
                size: "14",
                weight: "bold",
              },
              formatter: function (value, context) {
                return value === 0 ? "" : value; // Display the raw count value
              },
            },
            legend: {
              display: true,
              position: "bottom",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderGender.style.display = "none";

      if (femaleCount + maleCount === 0) {
        genderNoData.style.display = "block";
        genderParticipation.style.display = "none";
      } else {
        genderNoData.style.display = "none";
        genderParticipation.style.display = "block";
      }

    };

    xhr_object.send();

  }

  if (activeClusterStats == 1 && resfunClusterStats != null) {
    let loaderClusterStats = document.getElementById("loaderClusterStats");
    let barChartClusterStats = document.getElementById("cluster-stats");
    let clusterStatsNoData = document.getElementById("clusterStatsNoData");

    barChartClusterStats.style.display = "none";
    loaderClusterStats.style.display = "block";
    clusterStatsNoData.style.display = "none";

    xhr_object.onload = function () {
      resfunClusterStats = JSON.parse(this.responseText);
      console.log("Cluster Stats - ");
      console.log(resfunClusterStats);


      let responseValues = [];
      let responseLabels = [];

      // Extracting data from the response
      resfunClusterStats.response1.forEach(item => {
        // Check if the first element is not null
        if (item[0] !== null) {
          responseLabels.push(item[0]);
          responseValues.push(item[1]);
        }
      });

      new Chart(barChartClusterStats, {
        type: "bar",
        data: {
          labels: responseLabels,
          datasets: [
            {
              label: "Cluster",
              backgroundColor: ["#E95420"],
              data: responseValues,
              borderWidth: 1,
              borderColor: "#E95420",
              stack: "Stack 0",
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              title: {
                display: true,
                text: "Cluster",
              },
            },
            y: {
              title: {
                display: true,
                text: "Total steps taken",
              },
            },
          },
          plugins: {
            datalabels: {
              color: "#000000",
              anchor: "end",
              align: "end",
              offset: -6,
              font: {
                size: "10",
                weight: "bold",
              },
            },
            legend: {
              display: true,
              position: "no",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderClusterStats.style.display = "none";
      if (resfunClusterStats.length == 0) {
        clusterStatsNoData.style.display = "block";
        barChartClusterStats.style.display = "none";
      } else {
        clusterStatsNoData.style.display = "none";
        barChartClusterStats.style.display = "block";
      }

    };
    xhr_object.send();
  }

  if (activeDailyStepStats == 1 && resfunDailyStepStats != null) {
    let loaderDailyStep = document.getElementById("loaderDailyStep");
    let barChartDailyStep = document.getElementById("barChartDailyStep");
    let dailyStepNoData = document.getElementById("dailyStepNoData");

    // barChartDailyStep.style.display = "none";
    // loaderDailyStep.style.display = "block";
    // dailyStepNoData.style.display = "none";


    let responseValues = [];
    let responseLabels = [];

    // Extracting data from the response
    resfunDailyStepStats.response1.forEach(item => {
      // Check if the first element is not null
      if (item[0] !== null) {
        responseLabels.push(item[0]);
        responseValues.push(item[1]);
      }
    });
    new Chart(barChartDailyStep, {
      type: "bar",
      data: {
        labels: responseLabels,
        datasets: [
          {
            label: "Function",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: responseValues,
            borderRadius: 15,
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          yAxes: [
            {
              ticks: {
                beginAtZero: true,
              },
            },
          ],
          y: {
            title: {
              display: true,
              text: "Cumulative steps taken",
            },
          },
          x: {
            title: {
              display: true,
              text: "Date",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderDailyStep.style.display = "none";
    if (resfunDailyStepStats.length == 0) {
      dailyStepNoData.style.display = "block";
      barChartDailyStep.style.display = "none";
    } else {
      dailyStepNoData.style.display = "none";
      barChartDailyStep.style.display = "block";
    }

  }


  if (activeTrendsOverMonthSites == 1) {
    let loaderTrendsMonths = document.getElementById("loaderTrendsMonths");
    let TrendsMonthsNoData = document.getElementById("TrendsMonthsNoData");
    let trendsOverMonths = document.getElementById("trendsOverMonths");
    let loaderTrendsSites = document.getElementById("loaderTrendsSites");
    let TrendsSitesNoData = document.getElementById("TrendsSitesNoData");
    let trendsOverSites = document.getElementById("trendsOverSites");


    if (resfuntrendsOverMonths != null) {


      trendsOverMonths.style.display = "block";
      loaderTrendsMonths.style.display = "block";
      TrendsMonthsNoData.style.display = "none";

      let months = Object.keys(resfuntrendsOverMonths.response);
      let consumptionData = Object.values(resfuntrendsOverMonths.response).map(
        (item) => item.trend_over_month
      );
      // Added now
      new Chart(trendsOverMonths, {
        type: "bar",
        data: {
          labels: months,
          datasets: [
            {
              label: "Inventory Consumption",
              backgroundColor: ["#77216f"],
              data: consumptionData,
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          // interaction: {
          //   intersect: false,
          // },

          scales: {
            x: {
              ticks: {
                callback: function (value) {
                  return this.getLabelForValue(value).substr(0, 15);
                },
              },
              beginAtZero: true,
              title: {
                display: true,
                text: 'Months',
                padding: {
                  top: 20,
                }
              }

            },
            y: {
              beginAtZero: true,
              // ticks: {
              //   callback: function (value) {
              //     return value + "%"
              //   }
              // },
              title: {
                display: true,
                text: 'Total Cost'
              }
            }
          },
          plugins: {
            datalabels: {
              color: "#000000",
              anchor: "end",
              align: "end",
              offset: -6,
              font: {
                size: "10",
                weight: "bold",
              },
              ticks: {
                callback: function (value) {
                  return value
                }
              },
            },
            legend: {
              display: true,
              position: "no",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderTrendsMonths.style.display = "none";
      TrendsMonthsNoData.style.display = "none";
      trendsOverMonths.style.display = "block";
    }
    // --------------------------------------------------------------
    if (resfuntrendsOverSites != null) {
      trendsOverSites.style.display = "block";
      loaderTrendsSites.style.display = "block";
      TrendsSitesNoData.style.display = "none";

      // let responseValues = [resfuntrendsOverSites.response[0]];
      // let responseLabels = [resfuntrendsOverSites.response[1]];

      let responseLabels = Object.keys(resfuntrendsOverSites.response); // Get the first key in response object
      let responseValues = Object.values(resfuntrendsOverSites.response);
    
      // Added now
      new Chart(trendsOverSites, {
        type: "bar",
        data: {
          labels: responseLabels,
          datasets: [
            {
              label: "Trends over Months",
              backgroundColor: ["#E95420"],
              data: responseValues,
              borderWidth: 1,
              borderColor: "#E95420",
              stack: "Stack 0",
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          // interaction: {
          //   intersect: false,
          // },

          scales: {
            x: {
              // ticks: {
              //   callback: function (value) {
              //     return this.getLabelForValue(value).substr(0, 15);
              //   },
              // },
              beginAtZero: true,
              title: {
                display: true,
                text: 'Sites',
                padding: {
                  top: 20,
                }
              }

            },
            y: {
              beginAtZero: true,
              // ticks: {
              //   callback: function (value) {
              //     return value + "%"
              //   }
              // },
              title: {
                display: true,
                text: 'Total Cost'
              }
            }
          },
          plugins: {
            datalabels: {
              color: "#000000",
              anchor: "end",
              align: "end",
              offset: -6,
              font: {
                size: "10",
                weight: "bold",
              },
              ticks: {
                callback: function (value) {
                  return value
                }
              },
            },
            legend: {
              display: true,
              position: "no",
            },
          },
        },
        plugins: [ChartDataLabels],
      });

      loaderTrendsSites.style.display = "none";
      TrendsSitesNoData.style.display = "none";
      trendsOverSites.style.display = "block";

    }
  }


  if (activeIncident == 1 && resfunIncidentSummary != null) {
    let IncidentSummaryNoData = document.getElementById("IncidentSummaryNoData");
    let tblIncidentSummaryinfo = document.getElementById("tblIncidentSummaryinfo");
    let tablebodyIncidentSummary = document.getElementById("tablebodyIncidentSummary");
    let loaderIncidentSummary = document.getElementById("loaderIncidentSummary");

    let resfunIncidentSummaryArray = resfunIncidentSummary.response;
    allDetails = ``;
    var index = 0;

    for (let x in resfunIncidentSummaryArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][0] +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][1] +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][2] +
        `</td>` +
        `<td>` +
        resfunIncidentSummaryArray[x][3] +
        `</td>`;

      if (resfunIncidentSummaryArray[x][4] < 0 || resfunIncidentSummaryArray[x][4] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][4] + `</td>`;
      }
      // `<td>` +
      // resfunRCAArray[x][5] +
      // `</td>`
      if (resfunIncidentSummaryArray[x][5] < 0 || resfunIncidentSummaryArray[x][5] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][5] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][6] < 0 || resfunIncidentSummaryArray[x][6] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunRCAArray[x][6] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][7] < 0 || resfunIncidentSummaryArray[x][7] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][7] + `</td>`;
      }

      if (resfunIncidentSummaryArray[x][13] < 0 || resfunIncidentSummaryArray[x][13] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][13] + `</td>`;
      }

      if (resfunIncidentSummaryArray[x][8] < 0 || resfunIncidentSummaryArray[x][8] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][8] + `</td>`;
      }

      if (resfunIncidentSummaryArray[x][9] < 0 || resfunIncidentSummaryArray[x][9] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][9] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][10] < 0 || resfunIncidentSummaryArray[x][10] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][10] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][11] < 0 || resfunIncidentSummaryArray[x][11] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][11] + `</td>`;
      }
      if (resfunIncidentSummaryArray[x][12] < 0 || resfunIncidentSummaryArray[x][12] == null) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails = allDetails + `<td>` + resfunIncidentSummaryArray[x][12] + `</td>`;
      }

      allDetails = allDetails + `</tr>`;
    }
    tablebodyIncidentSummary.innerHTML = allDetails;

    loaderIncidentSummary.style.display = "none";
    if (resfunIncidentSummaryArray.length == 0) {
      IncidentSummaryNoData.style.display = "block";
      tblIncidentSummaryinfo.style.display = "none";
    } else {
      IncidentSummaryNoData.style.display = "none";
      tblIncidentSummaryinfo.style.display = "block";
    }
  }

  if (activeLTIR == 1 && resfungetTotalAmount != null) {
    let totalAmount = document.getElementById("totalAmount");
    totalAmount.innerHTML = resfungetTotalAmount.total_amount_response + "";
  }

  if (activeZeroIncidentDays == 1 && resfungetTotalAmount != null) {
    let totalReceived = document.getElementById("totalReceived");
    totalReceived.innerHTML = resfungetTotalAmount.received_amount_response + "";
  }

  if (activeIncidentPerSqFt == 1 && resfungetTotalAmount != null) {
    let totalOutstanding = document.getElementById("totalOutstanding");
    totalOutstanding.innerHTML = resfungetTotalAmount.total_outstanding + "";
  }

  if (activeInventory == 1) {
    let titleInventory = document.getElementById("titleInventory");
    let overStock = document.getElementById("overStock");
    let underStock = document.getElementById("underStock");
    let totalInventory = document.getElementById("totalInventory");
    let capitalBlock = document.getElementById("capitalBlock");
    let purchaseOrder = document.getElementById("purchaseOrder");
    let workOrder = document.getElementById("workOrder");
    let valueConsumable = document.getElementById("valueConsumable");
    let valueSpares = document.getElementById("valueSpares");

    if (resfuntotalInventory != null) {
      totalInventory.innerHTML =
        resfuntotalInventory.total_inventory_response;

      capitalBlock.innerHTML =
        resfuntotalInventory.capital_block;

    }

    if (resfunOverUnderStock != null) {
      overStock.innerHTML =
        resfunOverUnderStock.over_stock_response;

      underStock.innerHTML =
        resfunOverUnderStock.under_stock_response;
    }

    if (resfunpurchaseOrder != null) {
      purchaseOrder.innerHTML = resfunpurchaseOrder.puchase_order_response;

      workOrder.innerHTML = resfunpurchaseOrder.work_order_response;

    }
    if (resfuntotalValue != null) {
      valueConsumable.innerHTML = resfuntotalValue.consumable_response;

      valueSpares.innerHTML = resfuntotalValue.spare_response;
    }
  }
  // -----------
  // activeDailyStepStats = 1,

  // -----------
  if (activeDailyStepCount == 1 && resfunDailyStepCount != null) {
    let cardDailyStep = document.getElementById("cardDailyStep");
    cardDailyStep.innerHTML = resfunDailyStepCount.daily_step_count + " Steps";
  }

  if (activeEmpParticipationStats == 1 && resfunEmpParticipationStats != null) {
    let loaderEmployeeParticipationStats = document.getElementById(
      "loaderEmployeeParticipationStats"
    );
    let barChartEmployeeStats = document.getElementById("employee-stats");
    let employeeNoData = document.getElementById("employeeNoData");

    barChartEmployeeStats.style.display = "none";
    loaderEmployeeParticipationStats.style.display = "block";
    employeeNoData.style.display = "none";

    let xLabelsArray = resfunEmpParticipationStats.leaderboard;

    let xLabelsArrayDate = [],
      xLabelsArrayCount = [];

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      console.log(xLabelsArray[i].date);
      console.log(xLabelsArray[i].count);
      xLabelsArrayDate[i] = xLabelsArray[i].date;
      xLabelsArrayCount[i] = xLabelsArray[i].count;
    }

    new Chart(barChartEmployeeStats, {
      type: "bar",
      data: {
        labels: xLabelsArrayDate,
        datasets: [
          {
            label: "Days",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: xLabelsArrayCount,

            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            title: {
              display: true,
              text: "Days",
            },
          },
          y: {
            title: {
              display: true,
              text: "No. of steps taken",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderEmployeeParticipationStats.style.display = "none";
    if (xLabelsArray.length == 0) {
      employeeNoData.style.display = "block";
      barChartEmployeeStats.style.display = "none";
    } else {
      employeeNoData.style.display = "none";
      barChartEmployeeStats.style.display = "block";
    }
  }

  if (activeDeliveryVisitors == 1 && resfunDeliveryVisitor != null) {
    let DeliveryNoData = document.getElementById("DeliveryNoData");
    let deliveryVisitor = document.getElementById("deliveryVisitor");
    let loaderDelivery = document.getElementById("loaderDelivery");
    loaderDelivery.style.display = "block";
    DeliveryNoData.style.display = "none";

    originalChartConfigVisitors = {
      type: "bar",
      data: {
        labels: Object.keys(resfunDeliveryVisitor.response),
        datasets: [
          {
            // label: Object.keys(resfunDeliveryVisitor.response),
            backgroundColor: ["#01c875"],
            data: Object.values(resfunDeliveryVisitor.response),
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        interaction: {
          intersect: false,
        },
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
          },
        },
        maintainAspectRatio: false,
        scales: {
          x: {
            ticks: {
              callback: function (value) {
                return this.getLabelForValue(value).substr(0, 15);
              },
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
            formatter: function (value, context) {
              // Hide label if value is zero
              return value === 0 ? '' : value;
            }
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    }

    let myChart = new Chart(deliveryVisitor, originalChartConfigVisitors)


    loaderDelivery.style.display = "none";

    if (resfunDeliveryVisitor.response == 0) {
      DeliveryNoData.style.display = "block";
      deliveryVisitor.style.display = "none";
    } else {
      DeliveryNoData.style.display = "none";
      deliveryVisitor.style.display = "block";
    }

  }

  if (activeCheckList == 1 && resfunChecklist != null) {
    let ChecklistNoData = document.getElementById("ChecklistNoData");
    let Checklist = document.getElementById("Checklist");
    let loaderChecklist = document.getElementById("loaderChecklist");
    let responseCLosed = [], responseOpen = [], responseWIP = []; responseOverdue = [];

    let valuesResponses = Object.values(resfunChecklist.response);

    for (let i = 0; i < valuesResponses.length; i += 1) {
      responseCLosed[i] = valuesResponses[i].closed;
      responseOpen[i] = valuesResponses[i].open;
      responseWIP[i] = valuesResponses[i].work_in_progress;
      responseOverdue[i] = valuesResponses[i].overdue;
    }

    let xLabelsArray = Object.keys(resfunChecklist.response);

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      xLabelsArray[i] = xLabelsArray[i].split(" ");
    }

    new Chart(Checklist, {
      type: "bar",
      data: {
        labels: xLabelsArray,
        datasets: [
          {
            label: "Closed",
            backgroundColor: "#67c801",
            data: responseCLosed,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Open",
            backgroundColor: "#FDAB3D",
            data: responseOpen,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Work In Progress",
            backgroundColor: "#01C875",
            data: responseWIP,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Overdue",
            backgroundColor: "#FF5F1F",
            data: responseOverdue,
            barThickness: 70,
            borderWidth: 1,
          },
        ],
      },
      options: {
        tooltips: {
          displayColors: true,
          callbacks: {
            mode: 'x',
          },
        },
        scales: {
          xAxes: {
            stacked: true,
            gridLines: {
              display: false,
            }
          },
          yAxes: {
            stacked: true,
            ticks: {
              beginAtZero: true,
            },
            type: 'linear',
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderChecklist.style.display = "none";

    // if (resfunChartTicket.response == 0) {
    //   ChecklistNoData.style.display = "block";
    //   Checklist.style.display = "none";
    // } else {
    // ChecklistNoData.style.display = "none";
    Checklist.style.display = "block";
    // }
  }

  if (activeFacilityInfo == 1 && resfunFacilityInfo != null) {
    let facilityinfoNoData = document.getElementById("facilityinfoNoData");
    let tblfacilityinfo = document.getElementById("tblfacilityinfo");
    let tablebodyfacilityinfo = document.getElementById("tablebodyfacilityinfo");
    let loaderfacilityinfo = document.getElementById("loaderfacilityinfo");

    tblfacilityinfo.style.display = "none";
    loaderfacilityinfo.style.display = "block";
    facilityinfoNoData.style.display = "none";

    let resfunFacilityInfoArray = resfunFacilityInfo.facilities_info;
    let allDetails = '';

    for (let index = 0; index < resfunFacilityInfoArray.length; index++) {
      let facilityName = resfunFacilityInfoArray[index].facility_name;
      let bookingCount = resfunFacilityInfoArray[index].booking_count;
      let bookingBy = resfunFacilityInfoArray[index].booked_by;
      let bookingStatus = resfunFacilityInfoArray[index].booking_status;
      let tower = resfunFacilityInfoArray[index].tower;
      let flat = resfunFacilityInfoArray[index].flat;
      let scheduleDate = resfunFacilityInfoArray[index].schedule_date;
      let scheduleslot = resfunFacilityInfoArray[index].schedule_slot;

      allDetails +=
        `<tr>` +
        `<td>` + (index + 1) + `</td>` +
        `<td>` + facilityName + `</td>` +
        `<td>` + bookingCount + `</td>` +
        `<td>` + bookingBy + `</td>` +
        `<td>` + bookingStatus + `</td>` +
        `<td>` + tower + `</td>` +
        `<td>` + flat + `</td>` +
        `<td>` + scheduleDate + `</td>` +
        `<td>` + scheduleslot + `</td>` +
        `</tr>`;
    }
    tablebodyfacilityinfo.innerHTML = allDetails;

    loaderfacilityinfo.style.display = "none";
    if (resfunFacilityInfoArray.length == 0) {
      facilityinfoNoData.style.display = "block";
      tblfacilityinfo.style.display = "none";
    } else {
      facilityinfoNoData.style.display = "none";
      tblfacilityinfo.style.display = "table"; // Use "table" instead of "inline-table"
    }
  }




  if (activeCommLeaderboard == 1 && resfunCommLeaderboard != null) {
    let commulativeLeaderboardNoData = document.getElementById(
      "commulativeLeaderboardNoData"
    );
    let tablebodyCommulativeLeaderboard = document.getElementById(
      "tablebodyCommulativeLeaderboard"
    );
    let tblCommulativeLeaderboardinfo = document.getElementById(
      "tblCommulativeLeaderboardinfo"
    );
    let loaderCommulativeLeaderboard = document.getElementById(
      "loaderCommulativeLeaderboard"
    );

    tblCommulativeLeaderboardinfo.style.display = "none";
    loaderCommulativeLeaderboard.style.display = "block";
    commulativeLeaderboardNoData.style.display = "none";

    let resfunCommLeaderboardArray = resfunCommLeaderboard.leaderboard;
    allDetails = ``;
    var index = 0;

    for (let x in resfunCommLeaderboardArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        resfunCommLeaderboardArray[x].rank +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardArray[x].firstname +
        " " +
        resfunCommLeaderboardArray[x].lastname +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardArray[x].department_name +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardArray[x].highScore +
        `</td>` +
        `</tr>`;
    }
    tablebodyCommulativeLeaderboard.innerHTML = allDetails;

    loaderCommulativeLeaderboard.style.display = "none";
    if (resfunCommLeaderboardArray.length == 0) {
      commulativeLeaderboardNoData.style.display = "block";
      tblCommulativeLeaderboardinfo.style.display = "none";
    } else {
      commulativeLeaderboardNoData.style.display = "none";
      tblCommulativeLeaderboardinfo.style.display = "block";
    }
  }

  // checkDailyStepStats c17
  // if (activeDailyStepStats == 1 && ){

  // }

  // resfunClusterEmployeeParticiption

  if (activeCommLeaderboardFemale == 1 && resfunCommLeaderboardFemale != null) {
    let commulativeLeaderboardNoDataFemale = document.getElementById(
      "commulativeLeaderboardNoDataFemale"
    );
    let tablebodyCommulativeLeaderboardFemale = document.getElementById(
      "tablebodyCommulativeLeaderboardFemale"
    );
    let tblCommulativeLeaderboardinfoFemale = document.getElementById(
      "tblCommulativeLeaderboardinfoFemale"
    );
    let loaderCommulativeLeaderboardFemale = document.getElementById(
      "loaderCommulativeLeaderboardFemale"
    );

    tblCommulativeLeaderboardinfoFemale.style.display = "none";
    loaderCommulativeLeaderboardFemale.style.display = "block";
    commulativeLeaderboardNoDataFemale.style.display = "none";

    let resfunCommLeaderboardFemaleArray = resfunCommLeaderboardFemale.response1;
    allDetails = ``;
    var index = 0;

    for (let x in resfunCommLeaderboardFemaleArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardFemaleArray[x][0] +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardFemaleArray[x][1] +
        `</td>` +
        `<td>` +
        resfunCommLeaderboardFemaleArray[x][2] +
        `</td>` +
        `</tr>`;
    }
    tablebodyCommulativeLeaderboardFemale.innerHTML = allDetails;

    loaderCommulativeLeaderboardFemale.style.display = "none";
    if (resfunCommLeaderboardFemaleArray.length == 0) {
      commulativeLeaderboardNoDataFemale.style.display = "block";
      tblCommulativeLeaderboardinfoFemale.style.display = "none";
    } else {
      commulativeLeaderboardNoDataFemale.style.display = "none";
      tblCommulativeLeaderboardinfoFemale.style.display = "inline-table";
    }
  }

  if (activeTechnicalChecklist == 1 && resfunTechnicalChecklist != null) {
    let TechnicalChecklistNoData = document.getElementById("TechnicalChecklistNoData");
    let TechnicalChecklist = document.getElementById("TechnicalChecklist");
    let loaderTechnicalChecklist = document.getElementById("loaderTechnicalChecklist");

    let responseCLosed = [], responseOpen = [], responseWIP = []; responseOverdue = [];

    let valuesResponses = Object.values(resfunTechnicalChecklist.response);

    for (let i = 0; i < valuesResponses.length; i += 1) {
      responseCLosed[i] = valuesResponses[i].closed;
      responseOpen[i] = valuesResponses[i].open;
      responseWIP[i] = valuesResponses[i].work_in_progress;
      responseOverdue[i] = valuesResponses[i].overdue;
    }

    let xLabelsArray = Object.keys(resfunTechnicalChecklist.response);

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      xLabelsArray[i] = xLabelsArray[i].split(" ");
    }
    // Added now
    new Chart(TechnicalChecklist, {
      type: "bar",
      data: {
        labels: xLabelsArray,
        datasets: [
          {
            label: "Closed",
            backgroundColor: "#67c801",
            data: responseCLosed,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Open",
            backgroundColor: "#FDAB3D",
            data: responseOpen,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Work In Progress",
            backgroundColor: "#01C875",
            data: responseWIP,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Overdue",
            backgroundColor: "#FF5F1F",
            data: responseOverdue,
            barThickness: 70,
            borderWidth: 1,
          },
        ],
      },
      options: {
        tooltips: {
          displayColors: true,
          callbacks: {
            mode: 'x',
          },
        },
        scales: {
          xAxes: {
            stacked: true,
            gridLines: {
              display: false,
            }
          },
          yAxes: {
            stacked: true,
            ticks: {
              beginAtZero: true,
            },
            type: 'linear',
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderTechnicalChecklist.style.display = "none";

    if (resfunTechnicalChecklist.response.total == 0) {
      TechnicalChecklistNoData.style.display = "block";
      TechnicalChecklist.style.display = "none";
    } else {
      TechnicalChecklistNoData.style.display = "none";
      TechnicalChecklist.style.display = "block";
    }
  }

  if (activeNonTechnicalChecklist == 1 && resfunNonTechnicalChecklist != null) {
    let NonTechnicalChecklistNoData = document.getElementById("NonTechnicalChecklistNoData");
    let NonTechnicalChecklist = document.getElementById("NonTechnicalChecklist");
    let loaderNonTechnicalChecklist = document.getElementById("loaderNonTechnicalChecklist");

    let responseCLosed = [], responseOpen = [], responseWIP = []; responseOverdue = [];

    let valuesResponses = Object.values(resfunNonTechnicalChecklist.response);

    for (let i = 0; i < valuesResponses.length; i += 1) {
      responseCLosed[i] = valuesResponses[i].closed;
      responseOpen[i] = valuesResponses[i].open;
      responseWIP[i] = valuesResponses[i].work_in_progress;
      responseOverdue[i] = valuesResponses[i].overdue;
    }

    let xLabelsArray = Object.keys(resfunNonTechnicalChecklist.response);

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      xLabelsArray[i] = xLabelsArray[i].split(" ");
    }

    // Added now
    new Chart(NonTechnicalChecklist, {
      type: "bar",
      data: {
        labels: xLabelsArray,
        datasets: [
          {
            label: "Closed",
            backgroundColor: "#67c801",
            data: responseCLosed,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Open",
            backgroundColor: "#FDAB3D",
            data: responseOpen,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Work In Progress",
            backgroundColor: "#01C875",
            data: responseWIP,
            barThickness: 70,
            borderWidth: 1,
          },
          {
            label: "Overdue",
            backgroundColor: "#FF5F1F",
            data: responseOverdue,
            barThickness: 70,
            borderWidth: 1,
          },
        ],
      },
      options: {
        tooltips: {
          displayColors: true,
          callbacks: {
            mode: 'x',
          },
        },
        scales: {
          xAxes: {
            stacked: true,
            gridLines: {
              display: false,
            }
          },
          yAxes: {
            stacked: true,
            ticks: {
              beginAtZero: true,
            },
            type: 'linear',
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: 'bold'
            }
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderNonTechnicalChecklist.style.display = "none";

    if (resfunNonTechnicalChecklist.response.total == 0) {
      NonTechnicalChecklistNoData.style.display = "block";
      NonTechnicalChecklist.style.display = "none";
    } else {
      NonTechnicalChecklistNoData.style.display = "none";
      NonTechnicalChecklist.style.display = "block";
    }
  }

  
  if (activeInventoryConsumption == 1 && resfunInventoryConsumption != null) {
    let inventoryConsumptionNoData = document.getElementById(
      "inventoryConsumptionNoData"
    );
    let tablebodyInventoryConsumption = document.getElementById(
      "tablebodyInventoryConsumption"
    );
    let tblInventoryConsumptioninfo = document.getElementById(
      "tblInventoryConsumptioninfo"
    );
    let loaderInventoryConsumption = document.getElementById(
      "loaderInventoryConsumption"
    );

    tblInventoryConsumptioninfo.style.display = "none";
    loaderInventoryConsumption.style.display = "block";
    inventoryConsumptionNoData.style.display = "none";

    // resfunInventoryConsumption = JSON.parse(this.responseText);
    console.log("Leaderboard - ");
    console.log(resfunInventoryConsumption);

    let resfunInventoryConsumptionArray = resfunInventoryConsumption.response;
    allDetails = ``;
    var index = 0;

    for (let x in resfunInventoryConsumptionArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][0] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][1] +
        `<td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][2] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][3] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][4] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][5] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][6] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][7] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][8] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionArray[x][9] +
        `</td>` +
        `</tr>`;
    }
    tablebodyInventoryConsumption.innerHTML = allDetails;

    loaderInventoryConsumption.style.display = "none";
    if (resfunCommLeaderboardArray.length == 0) {
      inventoryConsumptionNoData.style.display = "block";
      tblInventoryConsumptioninfo.style.display = "none";
    } else {
      inventoryConsumptionNoData.style.display = "none";
      tblInventoryConsumptioninfo.style.display = "block";
    }
  }

  if (activeInventoryReport == 1 && resfunInventoryReport != null) {
    let loaderInventoryReport = document.getElementById(
      "loaderInventoryReport"
    );
    let inventoryReportNoData = document.getElementById(
      "inventoryReportNoData"
    );
    let inventory_report = document.getElementById("inventory-report");

    loaderInventoryReport.style.display = "block";
    inventoryReportNoData.style.display = "none";

    console.log("Inventory Report - ");
    console.log(resfunInventoryReport);

    new Chart(inventory - report, {
      type: "pie",
      data: {
        labels: ["abc", "abcd",],
        datasets: [
          {
            label: "Share",
            data: [
              resfunInventoryReport.response,
              // resfunInventoryReport.response["Engineering"],
              ,
            ],
            backgroundColor: ["#f8ea94", "#a1cd7a", "#e2445b", "#f2c06c"],
            borderWidth: 1,
            radius: "80%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderInventoryReport.style.display = "none";
    if (resfunInventoryReport.response == 0) {
      inventoryReportNoData.style.display = "block";
      inventory_report.style.display = "none";
    } else {
      inventoryReportNoData.style.display = "none";
      inventory_report.style.display = "block";
    }

  }

  if (activeCurrentStock == 1 && resfunCurrentStock != null) {
    let loaderCurrentStock = document.getElementById("loaderCurrentStock");
    let barChartCurrentStock = document.getElementById("current-Stock");
    let CurrentStockNoData = document.getElementById("clusterStatsNoData");

    barChartCurrentStock.style.display = "none";
    loaderCurrentStock.style.display = "block";
    CurrentStockNoData.style.display = "none";

    resfunCurrentStock = JSON.parse(this.responseText);
    console.log("Current Stock - ");
    console.log(resfunCurrentStock);

    let xLabelsArray = resfunCurrentStock.leaderboard;

    let xLabelsArrayDate = [],
      xLabelsArrayCount = [];

    for (let i = 0; i < xLabelsArray.length; i += 1) {
      console.log(xLabelsArray[i].date);
      console.log(xLabelsArray[i].count);
      xLabelsArrayDate[i] = xLabelsArray[i].site_name;
      xLabelsArrayCount[i] = xLabelsArray[i].count;
    }

    new Chart(barChartCurrentStock, {
      type: "bar",
      data: {
        labels: xLabelsArrayDate,
        datasets: [
          {
            label: "Days",
            backgroundColor: [
              "#77216F",
              "#01C875",
              "#E2445B",
              "#E95420",
              "#A1CD7A",
            ],
            data: xLabelsArrayCount,
            borderRadius: 15,
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            title: {
              display: true,
              text: "Total steps taken",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "no",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderCurrentStock.style.display = "none";
    if (xLabelsArray.length == 0) {
      CurrentStockNoData.style.display = "block";
      barChartCurrentStock.style.display = "none";
    } else {
      CurrentStockNoData.style.display = "none";
      barChartCurrentStock.style.display = "block";
    }

  }

  if (activeInventoryConsumptionGreen == 1 && resfunInventoryConsumptionGreen != null) {
    let inventoryConsumptionGreenNoData = document.getElementById(
      "inventoryConsumptionGreenNoData"
    );
    let tablebodyInventoryConsumptionGreen = document.getElementById(
      "tablebodyInventoryConsumptionGreen"
    );
    let tblInventoryConsumptionGreeninfo = document.getElementById(
      "tblInventoryConsumptionGreeninfo"
    );
    let loaderInventoryConsumptionGreen = document.getElementById(
      "loaderInventoryConsumptionGreen"
    );

    tblInventoryConsumptionGreeninfo.style.display = "none";
    loaderInventoryConsumptionGreen.style.display = "block";
    inventoryConsumptionGreenNoData.style.display = "none";

    let resfunInventoryConsumptionGreenArray =
      resfunInventoryConsumptionGreen.response;
    allDetails = ``;
    // var index = 0;

    for (let x in resfunInventoryConsumptionGreenArray) {
      // index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][0] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][1] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][2] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][3] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][4] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][5] +
        `</td>` +
        `<td>` +
        resfunInventoryConsumptionGreenArray[x][6] +
        `</td>`;
      // `<td>` +
      // resfunInventoryConsumptionGreenArray[x][7] +
      // `</td>` +
      // `<td>` +
      // resfunInventoryConsumptionGreenArray[x][8] +
      // `</td>` +
      if (
        resfunInventoryConsumptionGreenArray[x][7] < 0 ||
        resfunInventoryConsumptionGreenArray[x][7] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails +
          `<td>` +
          resfunInventoryConsumptionGreenArray[x][7] +
          `</td>`;
      }
      if (
        resfunInventoryConsumptionGreenArray[x][8] < 0 ||
        resfunInventoryConsumptionGreenArray[x][8] == null
      ) {
        allDetails = allDetails + `<td></td>`;
      } else {
        allDetails =
          allDetails +
          `<td>` +
          resfunInventoryConsumptionGreenArray[x][8] +
          `</td>`;
      }
      +`</tr>`;
    }
    tablebodyInventoryConsumptionGreen.innerHTML = allDetails;

    loaderInventoryConsumptionGreen.style.display = "none";
    if (resfunInventoryConsumptionGreenArray.length == 0) {
      inventoryConsumptionGreenNoData.style.display = "block";
      tblInventoryConsumptionGreeninfo.style.display = "none";
    } else {
      inventoryConsumptionGreenNoData.style.display = "none";
      tblInventoryConsumptionGreeninfo.style.display = "block";
    }
  }

  if (activeInventoryConsumptionReportGreen == 1 && resfunInventoryReportGreen != null) {
    let loaderInventoryReportGreen = document.getElementById(
      "loaderInventoryReportGreen"
    );
    let inventoryReportGreenNoData = document.getElementById(
      "inventoryReportGreenNoData"
    );
    let inventory_report_green = document.getElementById(
      "inventory_report_green"
    );
    let inventoryReportGreen = document.getElementById("inventoryReportGreen");

    // inventory_report.style.display = "none";
    loaderInventoryReportGreen.style.display = "block";
    inventoryReportGreenNoData.style.display = "none";


    let sum = 0;

    let valueName = [];
    let valueY = [];


    valueName = Object.keys(resfunInventoryReportGreen.response);
    valueY = Object.values(resfunInventoryReportGreen.response);
    console.log(valueName);
    console.log(valueY);

    let inventoryReportColor = [
      "#F8EA94",
      "#A1CD7A",
      "#F2C06C",
      "#D44B52",
      "#F69380",
      "#FF933C",
      "#FFBD3C",
      "#B4FF3C",
      "#4BFF3C",
      "#F69380",
      "#3CFF93",
      "#3CDEFF",
      "#3C4BFF",
      "#BD3CFF",
      "#FF3CFC",
      "#5F8900",
      "#008913",
      "#007C89",
      "#280089",
      "#890069",
    ];



    new Chart(inventory_report_green, {
      type: "pie",
      data: {
        labels: valueName,
        datasets: [
          {
            label: "Inventory Report Green",
            data: valueY,
            backgroundColor: inventoryReportColor,
            borderWidth: 1,
            radius: "100%",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          datalabels: {
            color: "#ffffff",
            font: {
              size: "14",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    for (let i = 0; i < valueY.length; i += 1) {
      if (valueY[i] == null) {
        let a = 0;
        sum += a;
      } else {
        sum += valueY[i];
      }
    }

    loaderInventoryReportGreen.style.display = "none";
    if (sum == 0) {
      inventoryReportGreenNoData.style.display = "block";
      inventory_report_green.style.display = "none";
    } else {
      inventoryReportGreenNoData.style.display = "none";
      inventory_report_green.style.display = "block";
    }
  }

  if (activeCurrentStockGreen == 1 && resfunCurrentStockGreen != null) {
    let loaderCurrentStockGreen = document.getElementById("loaderCurrentStock");
    let barChartCurrentStockGreen = document.getElementById(
      "current-Stock-Green"
    );
    let CurrentStockGreenNoData = document.getElementById(
      "clusterStatsGreenNoData"
    );

    barChartCurrentStockGreen.style.display = "none";
    loaderCurrentStockGreen.style.display = "block";

    let xLabelsArrays = [];
    xLabelsArrays = Object.keys(resfunCurrentStockGreen.response);
    // let xLabelsArray = resfunCurrentStock.leaderboard;

    let xLabelsArrayCs = [];
    let xLabelsArrayMs = [];
    // object.value
    let xLabelArrayV = [];
    xLabelArrayV = Object.values(resfunCurrentStockGreen.response);

    for (let i = 0; i < xLabelArrayV.length; i += 1) {
      console.log(xLabelsArrays[i].Current_Stock);
      console.log(xLabelsArrays[i].Minimum_Stock);
      xLabelsArrayCs[i] = xLabelArrayV[i].Current_Stock;
      xLabelsArrayMs[i] = xLabelArrayV[i].Minimum_Stock;
    }

    new Chart(barChartCurrentStockGreen, {
      type: "line",
      data: {
        labels: xLabelsArrays,
        // labels: ["", "", ""],
        datasets: [
          {
            label: "Minimum Stock",
            backgroundColor: ["#e2445b"],
            data: xLabelsArrayMs,
            tension: 0.4,
            borderColor: ["#e2445b"],
            borderWidth: 1,
            stack: "Stack 0",
          },
          {
            label: "Current Stock",
            backgroundColor: ["#01c875"],
            data: xLabelsArrayCs,
            tension: 0.4,
            borderColor: ["#01c875"],
            borderWidth: 1,
            stack: "Stack 0",
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            stacked: true,
          },
          y: {
            stacked: true,
            title: {
              display: true,
              text: "Total steps taken",
            },
          },
        },
        plugins: {
          datalabels: {
            color: "#000000",
            anchor: "end",
            align: "end",
            offset: -6,
            font: {
              size: "10",
              weight: "bold",
            },
          },
          legend: {
            display: true,
            position: "bottom",
          },
        },
      },
      plugins: [ChartDataLabels],
    });

    loaderCurrentStockGreen.style.display = "none";
    if (xLabelsArrays.length == 0) {
      // CurrentStockGreenNoData.style.display = "block";
      barChartCurrentStockGreen.style.display = "none";
    } else {
      // CurrentStockGreenNoData.style.display = "none";
      barChartCurrentStockGreen.style.display = "block";
    }
  }

  // checkDepartmentStats
  if (activeDepartmentStats == 1 && resfunFunctionEmployeeParticiption != null) {

    let DepartmentStatsNoData = document.getElementById(
      "DepartmentStatsNoData"
    );
    let tablebodyFunctionEmployeeParticiption = document.getElementById(
      "tablebodyFunctionEmployeeParticiption"
    );
    let tblFunctionEmployeeParticiptioninfo = document.getElementById(
      "tblFunctionEmployeeParticiptioninfo"
    );
    let loaderDepartmentStats = document.getElementById(
      "loaderDepartmentStats"
    );

    tblFunctionEmployeeParticiptioninfo.style.display = "none";
    loaderDepartmentStats.style.display = "block";
    DepartmentStatsNoData.style.display = "none";

    let resfunFunctionEmployeeParticiptionArray = resfunFunctionEmployeeParticiption.response1;
    allDetails = ``;
    var index = 0;

    for (let x in resfunFunctionEmployeeParticiptionArray) {
      index += 1;
      allDetails +=
        `<tr>` +
        `<td>` +
        index +
        `</td>` +
        `<td>` +
        resfunFunctionEmployeeParticiptionArray[x][0] +
        `</td>` +
        `<td>` +
        resfunFunctionEmployeeParticiptionArray[x][1] +
        `</td>` +
        `<td>` +
        resfunFunctionEmployeeParticiptionArray[x][2] +
        `</td>` +
        `</tr>`;
    }
    tablebodyFunctionEmployeeParticiption.innerHTML = allDetails;

    loaderDepartmentStats.style.display = "none";
    if (resfunFunctionEmployeeParticiptionArray.length == 0) {
      DepartmentStatsNoData.style.display = "block";
      tblFunctionEmployeeParticiptioninfo.style.display = "none";
    } else {
      DepartmentStatsNoData.style.display = "none";
      tblFunctionEmployeeParticiptioninfo.style.display = "inline-table";
    }
  }



}




// -------------------------------------------------------------------------------------------------------------------------------
// Show & Hide Widgets
// -------------------------------------------------------------------------------------------------------------------------------

// changes
// function toggleAllParking() {
//   var checkboxes = document.querySelectorAll('#Parking-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllParking');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// // changes
// function toggleAllAssets() {
//   var checkboxes = document.querySelectorAll('#Assets-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllAssets');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// // changes
// function toggleAllPermit() {
//   var checkboxes = document.querySelectorAll('#Permit-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllPermit');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllAmount() {
//   var checkboxes = document.querySelectorAll('#Amount-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllAmount');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllUtilityConsumption() {
//   var checkboxes = document.querySelectorAll('#UtilityConsumption-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllUtilityConsumption');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllQUICKGATE() {
//   var checkboxes = document.querySelectorAll('#QUICKGATE-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllQUICKGATE');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllEscalation() {
//   var checkboxes = document.querySelectorAll('#Escalation-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllEscalation');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllStepathon() {
//   var checkboxes = document.querySelectorAll('#Stepathon-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllStepathon');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllIncidents() {
//   var checkboxes = document.querySelectorAll('#Incidents-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllIncidents');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// // function toggleAllChecklist() {
// //   var checkboxes = document.querySelectorAll('#Checklist-nav input[type="checkbox"]');
// //   var selectAllCheckbox = document.getElementById('selectAllChecklist');
// //   checkboxes.forEach(function(checkbox) {  
// //       checkbox.checked = selectAllCheckbox.checked;
// //   });
// // }

// function toggleAllChecklist() {
//   var checkboxes = document.querySelectorAll('#Checklist-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllChecklist');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllOccupancySummary() {
//   var checkboxes = document.querySelectorAll('#OccupancySummary-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllOccupancySummary');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// function toggleAllTickets() {
//   var checkboxes = document.querySelectorAll('#Tickets-nav input[type="checkbox"]');
//   var selectAllCheckbox = document.getElementById('selectAllTickets');
//   checkboxes.forEach(function(checkbox) {
//       checkbox.checked = selectAllCheckbox.checked;
//   });
// }

// changes till above for select all //


function showTotalAssetsAvailable() {
  if (checkTotalAssetsAvailable.checked) {
    activeTotalAssetsAvailable = 1;

    // checkTotalAssetsAvailable.style.color = "blue";

    items.push(a11);
    showRefreshWidgets();
  } else {
    activeTotalAssetsAvailable = 0;

    // checkTotalAssetsAvailable.style.color = "black";

    const index = items.indexOf(a11);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }

}

function showAssetsInUse() {
  if (checkAssetsInUse.checked) {
    activeAssetsInUse = 1;
    // checkAssetsInUse.style.color = "blue";

    items.push(a12);
    showRefreshWidgets();
  } else {
    activeAssetsInUse = 0;
    // checkAssetsInUse.style.color = "black";

    const index = items.indexOf(a12);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showAssetInBreakdown() {
  if (checkAssetInBreakdown.checked) {
    activeAssetInBreakdown = 1;
    // checkAssetInBreakdown.style.color = "blue";

    items.push(a13);
    showRefreshWidgets();
  } else {
    activeAssetInBreakdown = 0;
    // checkAssetInBreakdown.style.color = "black";

    const index = items.indexOf(a13);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showLTIR() {

  if (checkLTIR.checked) {
    activeLTIR = 1;
    // checkLTIR.style.color = "blue";

    items.push(a34);
    showRefreshWidgets();
  } else {
    activeLTIR = 0;
    // checkLTIR.style.color = "black";

    const index = items.indexOf(a34);
    if (index > -1) {
      items.splice(index, 1);
    }
    console.log(index);
    showRefreshWidgets();
  }
}

function showZeroIncidentDays() {
  if (checkZeroIncidentDays.checked) {
    activeZeroIncidentDays = 1;
    // checkZeroIncidentDays.style.color = "blue";

    items.push(a35);
    showRefreshWidgets();
  } else {
    activeZeroIncidentDays = 0;
    // checkZeroIncidentDays.style.color = "black";

    const index = items.indexOf(a35);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}



function showZeroIncidentDaysTop() {
  if (checkZeroIncidentDaysTop.checked) {
    activeZeroIncidentDaysTop = 1;
    // checkZeroIncidentDaysTop.style.color = "blue";

    items.push(a122);
    showRefreshWidgets();
  } else {
    activeZeroIncidentDaysTop = 0;
    // checkZeroIncidentDaysTop.style.color = "black";

    const index = items.indexOf(a122);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showFitout() {
  if (checkFitout.checked) {
    activeFitout = 1;
    // checkFitout.style.color = "blue";

    items.push(a61);
    showRefreshWidgets();
  } else {
    activeFitout = 0;
    // checkFitout.style.color = "black";

    const index = items.indexOf(a61);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showIncidentPerSqFt() {
  if (checkIncidentPerSqFt.checked) {
    activeIncidentPerSqFt = 1;
    // checkIncidentPerSqFt.style.color = "blue";

    items.push(a36);
    showRefreshWidgets();
  } else {
    activeIncidentPerSqFt = 0;
    // checkIncidentPerSqFt.style.color = "black";

    const index = items.indexOf(a36);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showIncidentPerSqFtTop() {
  if (checkIncidentPerSqFtTop.checked) {
    activeIncidentPerSqFtTop = 1;
    // checkIncidentPerSqFtTop.style.color = "blue";

    items.push(a123);
    showRefreshWidgets();
  } else {
    activeIncidentPerSqFtTop = 0;
    // checkIncidentPerSqFtTop.style.color = "black";

    const index = items.indexOf(a123);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showIncidentNearMissGoodCatch() {
  if (checkIncidentNearMissGoodCatch.checked) {
    activeIncidentNearMissGoodCatch = 1;
    // checkIncidentNearMissGoodCatch.style.color = "blue";

    items.push(a37);
    showRefreshWidgets();
  } else {
    activeIncidentNearMissGoodCatch = 0;
    // checkIncidentNearMissGoodCatch.style.color = "black";

    const index = items.indexOf(a37);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showIncidentNearMissGoodCatchTop() {
  if (checkIncidentNearMissGoodCatchTop.checked) {
    activeIncidentNearMissGoodCatchTop = 1;
    // checkIncidentNearMissGoodCatchTop.style.color = "blue";

    items.push(a124);
    showRefreshWidgets();
  } else {
    activeIncidentNearMissGoodCatchTop = 0;
    // checkIncidentNearMissGoodCatchTop.style.color = "black";

    const index = items.indexOf(a124);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCriticalAssetsInBreakdown() {
  if (checkCriticalAssetsInBreakdown.checked) {
    activeCriticalAssetsInBreakdown = 1;
    // checkCriticalAssetsInBreakdown.style.color = "blue";

    items.push(a14);
    showRefreshWidgets();
  } else {
    activeCriticalAssetsInBreakdown = 0;
    // checkCriticalAssetsInBreakdown.style.color = "black";

    const index = items.indexOf(a14);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showPPMConductedAssets() {
  if (checkPPMConductedAssets.checked) {
    activePPMConductedAssets = 1;
    // checkPPMConductedAssets.style.color = "blue";

    items.push(a15);
    showRefreshWidgets();
  } else {
    activePPMConductedAssets = 0;
    // checkPPMConductedAssets.style.color = "black";

    const index = items.indexOf(a15);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showExecutiveEscalation() {
  if (checkExecutiveEscalation.checked) {
    activeExecutiveEscalation = 1;
    // checkExecutiveEscalation.style.color = "blue";

    items.push(a68);
    showRefreshWidgets();
  } else {
    activeExecutiveEscalation = 0;
    // checkExecutiveEscalation.style.color = "black";

    const index = items.indexOf(a68);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showTickets() {
  if (checkTickets.checked) {
    activeTickets = 1;
    // checkTickets.style.color = "blue";

    items.push(a16);
    showRefreshWidgets();
  } else {
    activeTickets = 0;
    // checkTickets.style.color = "black";

    const index = items.indexOf(a16);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}



function showActivityFeed() {
  if (activeActivityFeed == 0) {
    activeActivityFeed = 1;
    checkActivityFeed.style.color = "blue";

    items.push(a17);
    showRefreshWidgets();
  } else {
    activeActivityFeed = 0;
    checkActivityFeed.style.color = "black";

    const index = items.indexOf(a17);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCategoryWiseTickets() {
  if (checkCategoryWiseTickets.checked) {
    activeCategoryWiseTickets = 1;
    // checkCategoryWiseTickets.style.color = "blue";

    items.push(a18);
    showRefreshWidgets();
  } else {
    activeCategoryWiseTickets = 0;
    // checkCategoryWiseTickets.style.color = "black";

    const index = items.indexOf(a18);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCategoryWiseProactiveTickets() {
  if (checkCategoryWiseProactiveTickets.checked ) {
    activeCategoryWiseProactiveTickets = 1;
    // checkCategoryWiseProactiveTickets.style.color = "blue";

    items.push(a19);
    showRefreshWidgets();
  } else {
    activeCategoryWiseProactiveTickets = 0;
    // checkCategoryWiseProactiveTickets.style.color = "black";

    const index = items.indexOf(a19);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showCustomerSentiments() {
  if (checkCustomerSentiments.checked) {
    activeCustomerSentiments = 1;
    // checkCustomerSentiments.style.color = "blue";

    items.push(a69);
    showRefreshWidgets();
  } else {
    activeCustomerSentiments = 0;
    // checkCustomerSentiments.style.color = "black";

    const index = items.indexOf(a69);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCACategoryWiseTickets() {
  if (checkCACategoryWiseTickets.checked) {
    activeCACategoryWiseTickets = 1;
    // checkCACategoryWiseTickets.style.color = "blue";

    items.push(a39);
    showRefreshWidgets();
  } else {
    activeCACategoryWiseTickets = 0;
    // checkCACategoryWiseTickets.style.color = "black";

    const index = items.indexOf(a39);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCACategoryWiseProactiveTickets() {
  if (checkCACategoryWiseProactiveTickets.checked) {
    activeCACategoryWiseProactiveTickets = 1;
    // checkCACategoryWiseProactiveTickets.style.color = "blue";

    items.push(a40);
    showRefreshWidgets();
  } else {
    activeCACategoryWiseProactiveTickets = 0;
    // checkCACategoryWiseProactiveTickets.style.color = "black";

    const index = items.indexOf(a40);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTicketsAgeingMatrix() {
  if (checkTicketsAgeingMatrix.checked) {
    activeTicketsAgeingMatrix = 1;
    // checkTicketsAgeingMatrix.style.color = "blue";

    items.push(a20);
    showRefreshWidgets();
  } else {
    activeTicketsAgeingMatrix = 0;
    // checkTicketsAgeingMatrix.style.color = "black";

    const index = items.indexOf(a20);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showResolutionTAT() {
  if (checkResolutionTAT.checked) {
    activeResolutionTAT = 1;
    // checkResolutionTAT.style.color = "blue";

    items.push(a21);
    showRefreshWidgets();
  } else {
    activeResolutionTAT = 0;
    // checkResolutionTAT.style.color = "black";

    const index = items.indexOf(a21);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showResponseTAT() {
  if (checkResponseTAT.checked) {
    activeResponseTAT = 1;
    // checkResponseTAT.style.color = "blue";

    items.push(a22);
    console.log("Added");
    showRefreshWidgets();
  } else {
    activeResponseTAT = 0;
    // checkResponseTAT.style.color = "black";

    const index = items.indexOf(a22);
    if (index > -1) {
      items.splice(index, 1);
    }
    console.log("Removed");
    showRefreshWidgets();
  }
}

function showVisitors() {
  if (checkVisitors.checked) {
    activeVisitors = 1;
    // checkVisitors.style.color = "blue";

    items.push(a23);
    showRefreshWidgets();
  } else {
    activeVisitors = 0;
    // checkVisitors.style.color = "black";

    const index = items.indexOf(a23);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showPermits() {
  if (checkPermits.checked) {
    activePermits = 1;
    // checkPermits.style.color = "blue";

    items.push(b77);
    showRefreshWidgets();
  } else {
    activePermits = 0;
    // checkPermits.style.color = "black";

    const index = items.indexOf(b77);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showPermitSite() {
  if (checkPermitSite.checked) {
    activePermitSite = 1;
    // checkPermitSite.style.color = "blue";

    items.push(b76);
    showRefreshWidgets();
  } else {
    activePermitSite = 0;
    // checkPermitSite.style.color = "black";

    const index = items.indexOf(b76);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showPowerConsumption() {
  if (checkPowerConsumption.checked) {
    activePowerConsumption = 1;
    // checkPowerConsumption.style.color = "blue";

    items.push(a25);
    showRefreshWidgets();
  } else {
    activePowerConsumption = 0;
    // checkPowerConsumption.style.color = "black";

    const index = items.indexOf(a25);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showPowerConsumptionTop() {
  if (checkPowerConsumptionTop.checked) {
    activePowerConsumptionTop = 1;
    // checkPowerConsumptionTop.style.color = "blue";

    items.push(a118);
    showRefreshWidgets();
  } else {
    activePowerConsumptionTop = 0;
    // checkPowerConsumptionTop.style.color = "black";

    const index = items.indexOf(a118);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showWaterConsumption() {
  if (checkWaterConsumption.checked) {
    activeWaterConsumption = 1;
    // checkWaterConsumption.style.color = "blue";

    items.push(a26);
    showRefreshWidgets();
  } else {
    activeWaterConsumption = 0;
    // checkWaterConsumption.style.color = "black";

    const index = items.indexOf(a26);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showWaterConsumptionTop() {
  if (checkWaterConsumptionTop.checked) {
    activeWaterConsumptionTop = 1;
    // checkWaterConsumptionTop.style.color = "blue";

    items.push(a119);
    showRefreshWidgets();
  } else {
    activeWaterConsumptionTop = 0;
    // checkWaterConsumptionTop.style.color = "black";

    const index = items.indexOf(a119);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTopChecklist() {
  if (checkTopChecklist.checked) {
    activeTopChecklist = 1;
    // checkTopChecklist.style.color = "blue";

    items.push(a120);
    showRefreshWidgets();
  } else {
    activeTopChecklist = 0;
    // checkTopChecklist.style.color = "black";

    const index = items.indexOf(a120);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showLTIRTop() {

  if (activeLTIRTop == 0) {
    activeLTIRTop = 1;
    checkLTIRTop.style.color = "blue";

    items.push(a121);
    showRefreshWidgets();
  } else {
    activeLTIRTop = 0;
    checkLTIRTop.style.color = "black";

    const index = items.indexOf(a121);
    if (index > -1) {
      items.splice(index, 1);
    }
    console.log(index);
    showRefreshWidgets();
  }
}
function showInventoryConsumption() {
  if (checkInventoryConsumption.checked) {
    activeInventoryConsumption = 1;
    // checkInventoryConsumption.style.color = "blue";

    items.push(d11);
    showRefreshWidgets();
  } else {
    activeInventoryConsumption = 0;
    // checkInventoryConsumption.style.color = "black";

    const index = items.indexOf(d11);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showInventoryConsumptionReport() {
  if (checkInventoryReport.checked) {
    activeInventoryReport = 1;
    // checkInventoryReport.style.color = "blue";

    items.push(d12);
    showRefreshWidgets();
  } else {
    activeInventoryReport = 0;
    // checkInventoryReport.style.color = "black";

    const index = items.indexOf(d12);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCurrentStock() {
  if (checkCurrentStock.checked) {
    activeCurrentStock = 1;
    // checkCurrentStock.style.color = "blue";

    items.push(d13);
    showRefreshWidgets();
  } else {
    activeCurrentStock = 0;
    // checkCurrentStock.style.color = "black";

    const index = items.indexOf(d13);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}



function showInventoryConsumptionGreen() {
  if (checkInventoryConsumptionGreen.checked) {
    activeInventoryConsumptionGreen = 1;
    // checkInventoryConsumptionGreen.style.color = "blue";

    items.push(d14);
    showRefreshWidgets();
  } else {
    activeInventoryConsumptionGreen = 0;
    // checkInventoryConsumptionGreen.style.color = "black";

    const index = items.indexOf(d14);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showInventoryConsumptionReportGreen() {
  if (checkInventoryConsumptionReportGreen.checked) {
    activeInventoryConsumptionReportGreen = 1;
    // checkInventoryConsumptionReportGreen.style.color = "blue";

    items.push(d15);
    showRefreshWidgets();
  } else {
    activeInventoryConsumptionReportGreen = 0;
    // checkInventoryConsumptionReportGreen.style.color = "black";

    const index = items.indexOf(d15);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCurrentStockGreen() {
  if (checkCurrentStockGreen.checked) {
    activeCurrentStockGreen = 1;
    // checkCurrentStockGreen.style.color = "blue";

    items.push(d16);
    showRefreshWidgets();
  } else {
    activeCurrentStockGreen = 0;
    // checkCurrentStockGreen.style.color = "black";

    const index = items.indexOf(d16);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCarbonEmission() {
  if (checkCarbonEmission.checked) {
    activeCarbonEmission = 1;
    // checkCarbonEmission.style.color = "blue";

    items.push(a27);
    showRefreshWidgets();
  } else {
    activeCarbonEmission = 0;
    // checkCarbonEmission.style.color = "black";

    const index = items.indexOf(a27);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showEnergyIntensity() {
  if (checkEnergyIntensity.checked) {
    activeEnergyIntensity = 1;
    // checkEnergyIntensity.style.color = "blue";

    items.push(a63);
    showRefreshWidgets();
  } else {
    activeEnergyIntensity = 0;
    // checkEnergyIntensity.style.color = "black";

    const index = items.indexOf(a63);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showFuelConsumption() {
  if (checkFuelConsumption.checked) {
    activeFuelConsumption = 1;
    // checkFuelConsumption.style.color = "blue";

    items.push(a28);
    showRefreshWidgets();
  } else {
    activeFuelConsumption = 0;
    // checkFuelConsumption.style.color = "black";

    const index = items.indexOf(a28);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showFitoutRequest() {
  if (checkFitoutRequest.checked) {
    activeFitoutRequest = 1;
    // checkFitoutRequest.style.color = "blue";

    items.push(a29);
    showRefreshWidgets();
  } else {
    activeFitoutRequest = 0;
    // checkFitoutRequest.style.color = "black";

    const index = items.indexOf(a29);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showFitout() {
  if (checkFitout.checked) {
    activeFitout = 1;
    // checkFitout.style.color = "blue";

    items.push(a61);
    showRefreshWidgets();
  } else {
    activeFitout = 0;
    // checkFitout.style.color = "black";

    const index = items.indexOf(a61);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showIncidents() {
  if (checkIncidents.checked) {
    activeIncidents = 1;
    // checkIncidents.style.color = "blue";

    items.push(a30);
    showRefreshWidgets();
  } else {
    activeIncidents = 0;
    // checkIncidents.style.color = "black";

    const index = items.indexOf(a30);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showIncidentsTop() {
  if (checkIncidentsTop.checked) {
    activeIncidentsTop = 1;
    // checkIncidentsTop.style.color = "blue";

    items.push(a125);
    showRefreshWidgets();
  } else {
    activeIncidentsTop = 0;
    // checkIncidentsTop.style.color = "black";

    const index = items.indexOf(a125);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showOpenEscalation() {
  if (checkOpenEscalation.checked) {
    activeOpenEscalation = 1;
    // checkOpenEscalation.style.color = "blue";

    items.push(a71);
    showRefreshWidgets();
  } else {
    activeOpenEscalation = 0;
    // checkOpenEscalation.style.color = "black";

    const index = items.indexOf(a71);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showCloseEscalation() {
  if (checkCloseEscalation.checked) {
    activeCloseEscalation = 1;
    // checkCloseEscalation.style.color = "blue";

    items.push(a72);
    showRefreshWidgets();
  } else {
    activeCloseEscalation = 0;
    // checkCloseEscalation.style.color = "black";

    const index = items.indexOf(a72);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}



function showAvgEscalation() {
  if (checkAvgEscalation.checked) {
    activeAvgEscalation = 1;
    // checkAvgEscalation.style.color = "blue";

    items.push(a73);
    showRefreshWidgets();
  } else {
    activeAvgEscalation = 0;
    // checkAvgEscalation.style.color = "black";

    const index = items.indexOf(a73);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCategoryWiseIncidents() {
  if (checkCategoryWiseIncidents.checked) {
    activeCategoryWiseIncidents = 1;
    // checkCategoryWiseIncidents.style.color = "blue";

    items.push(a31);
    showRefreshWidgets();
  } else {
    activeCategoryWiseIncidents = 0;
    // checkCategoryWiseIncidents.style.color = "black";

    const index = items.indexOf(a31);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCategoryWiseIncidentsTop() {
  if (checkCategoryWiseIncidentsTop.checked) {
    activeCategoryWiseIncidentsTop = 1;
    // checkCategoryWiseIncidentsTop.style.color = "blue";

    items.push(a128);
    showRefreshWidgets();
  } else {
    activeCategoryWiseIncidentsTop = 0;
    // checkCategoryWiseIncidentsTop.style.color = "black";

    const index = items.indexOf(a128);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showManPowerAttendance() {
  if (checkManPowerAttendance.checked) {
    activeManPowerAttendance = 1;
    // checkManPowerAttendance.style.color = "blue";

    items.push(a32);
    showRefreshWidgets();
  } else {
    activeManPowerAttendance = 0;
    // checkManPowerAttendance.style.color = "black";

    const index = items.indexOf(a32);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showEventsFootfallAnalysis() {
  if (checkEventsFootfallAnalysis.checked) {
    activeEventsFootfallAnalysis = 1;
    // checkEventsFootfallAnalysis.style.color = "blue";

    items.push(a33);
    showRefreshWidgets();
  } else {
    activeEventsFootfallAnalysis = 0;
    // checkEventsFootfallAnalysis.style.color = "black";

    const index = items.indexOf(a33);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showRAC() {
  if (activeRAC == 0) {
    activeRAC = 1;
    checkRAC.style.color = "blue";

    items.push(a38);
    showRefreshWidgets();
  } else {
    activeRAC = 0;
    checkRAC.style.color = "black";

    const index = items.indexOf(a38);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showRACTop() {
  if (checkRACTop.checked) {
    activeRACTop = 1;
    // checkRACTop.style.color = "blue";

    items.push(a127);
    showRefreshWidgets();
  } else {
    activeRACTop = 0;
    // checkRACTop.style.color = "black";

    const index = items.indexOf(a127);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showSafeManHours() {
  if (checkSafeManHours.checked) {
    activeSafeManHours = 1;
    // checkSafeManHours.style.color = "blue";

    items.push(a41);
    showRefreshWidgets();
  } else {
    activeSafeManHours = 0;
    // checkSafeManHours.style.color = "black";

    const index = items.indexOf(a41);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showAssetsBreakdown() {
  if (checkAssetsBreakdown.checked) {
    activeAssetsBreakdown = 1;
    // checkAssetsBreakdown.style.color = "blue";

    items.push(a42);
    showRefreshWidgets();
  } else {
    activeAssetsBreakdown = 0;
    // checkAssetsBreakdown.style.color = "black";

    const index = items.indexOf(a42);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showAssetsBreakdownGraph() {
  if (activeAssetsBreakdownGraph == 0) {
    activeAssetsBreakdownGraph = 1;
    checkAssetsBreakdownGraph.style.color = "blue";

    items.push(a116);
    showRefreshWidgets();
  } else {
    activeAssetsBreakdownGraph = 0;
    checkAssetsBreakdownGraph.style.color = "black";

    const index = items.indexOf(a116);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}



function showWaste() {
  if (checkWaste.checked) {
    activeWaste = 1;
    // checkWaste.style.color = "blue";

    items.push(a117);
    showRefreshWidgets();
  } else {
    activeWaste = 0;
    // checkWaste.style.color = "black";

    const index = items.indexOf(a117);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showPyramid() {
  if (checkPyramid.checked) {
    activePyramid = 1;
    // checkPyramid.style.color = "blue";

    items.push(a44);
    showRefreshWidgets();
  } else {
    activePyramid = 0;
    // checkPyramid.style.color = "black";

    const index = items.indexOf(a44);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showPyramidTop() {
  if (checkPyramidTop.checked) {
    activePyramidTop = 1;
    // checkPyramidTop.style.color = "blue";

    items.push(a126);
    showRefreshWidgets();
  } else {
    activePyramidTop = 0;
    // checkPyramidTop.style.color = "black";

    const index = items.indexOf(a126);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showRootCause() {
  if (checkRootCause.checked) {
    activeRootCause = 1;
    // checkRootCause.style.color = "blue";

    items.push(a46);
    showRefreshWidgets();
  } else {
    activeRootCause = 0;
    // checkRootCause.style.color = "black";

    const index = items.indexOf(a46);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showReactiveProactiveTickets() {
  if (checkReactiveProactiveTickets.checked) {
    activeReactiveProactiveTickets = 1;
    // checkReactiveProactiveTickets.style.color = "blue";

    items.push(a79);
    showRefreshWidgets();
  } else {
    activeReactiveProactiveTickets = 0;
    // checkReactiveProactiveTickets.style.color = "black";

    const index = items.indexOf(a79);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showBodyInjuryChart() {
  if (checkBodyInjuryChart.checked) {
    activeBodyInjuryChart = 1;
    // checkBodyInjuryChart.style.color = "blue";

    items.push(a64);
    showRefreshWidgets();
  } else {
    activeBodyInjuryChart = 0;
    // checkBodyInjuryChart.style.color = "black";

    const index = items.indexOf(a64);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showOccupancy() {
  if (checkOccupancy.checked) {
    activeOccupancy = 1;
    // checkOccupancy.style.color = "blue";

    items.push(a67);
    showRefreshWidgets();
  } else {
    activeOccupancy = 0;
    // checkOccupancy.style.color = "black";

    const index = items.indexOf(a67);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalVisitors() {
  if (checkTotalVisitors.checked) {
    activeTotalVisitors = 1;
    // checkTotalVisitors.style.color = "blue";

    items.push(a105);
    showRefreshWidgets();
  } else {
    activeTotalVisitors = 0;
    // checkTotalVisitors.style.color = "black";

    const index = items.indexOf(a105);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalStaff() {
  if (checkTotalStaff.checked) {
    activeTotalStaff = 1;
    // checkTotalStaff.style.color = "blue";

    items.push(a111);
    showRefreshWidgets();
  } else {
    activeTotalStaff = 0;
    // checkTotalStaff.style.color = "black";

    const index = items.indexOf(a111);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showStaffIn() {
  if (checkStaffIn.checked) {
    activeStaffIn = 1;
    // checkStaffIn.style.color = "blue";

    items.push(a112);
    showRefreshWidgets();
  } else {
    activeStaffIn = 0;
    // checkStaffIn.style.color = "black";

    const index = items.indexOf(a112);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showStaffOut() {
  if (checkStaffOut.checked) {
    activeStaffOut = 1;
    // checkStaffOut.style.color = "blue";

    items.push(a113);
    showRefreshWidgets();
  } else {
    activeStaffOut = 0;
    // checkStaffOut.style.color = "black";

    const index = items.indexOf(a113);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showExpectedVisitors() {
  if (checkExpectedVisitors.checked) {
    activeExpectedVisitors = 1;
    // checkExpectedVisitors.style.color = "blue";

    items.push(a106);
    showRefreshWidgets();
  } else {
    activeExpectedVisitors = 0;
    // checkExpectedVisitors.style.color = "black";

    const index = items.indexOf(a106);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showUnExpectedVisitors() {
  if (checkUnExpectedVisitors.checked) {
    activeUnExpectedVisitors = 1;
    // checkUnExpectedVisitors.style.color = "blue";

    items.push(a107);
    showRefreshWidgets();
  } else {
    activeUnExpectedVisitors = 0;
    // checkUnExpectedVisitors.style.color = "black";

    const index = items.indexOf(a107);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showGoodsIn() {
  if (checkGoodsIn.checked) {
    activeGoodsIn = 1;
    // checkGoodsIn.style.color = "blue";

    items.push(a48);
    showRefreshWidgets();
  } else {
    activeGoodsIn = 0;
    // checkGoodsIn.style.color = "black";

    const index = items.indexOf(a48);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showGoodsOut() {
  if (checkGoodsOut.checked) {
    activeGoodsOut = 1;
    // checkGoodsOut.style.color = "blue";

    items.push(a49);
    showRefreshWidgets();
  } else {
    activeGoodsOut = 0;
    // checkGoodsOut.style.color = "black";

    const index = items.indexOf(a49);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showGoodsInwards() {
  if (checkGoodsInwards.checked) {
    activeGoodsInwards = 1;
    // checkGoodsInwards.style.color = "blue";

    items.push(a59);
    showRefreshWidgets();
  } else {
    activeGoodsInwards = 0;
    // checkGoodsInwards.style.color = "black";

    const index = items.indexOf(a59);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showGoodsOutwards() {
  if (checkGoodsOutwards.checked) {
    activeGoodsOutwards = 1;
    // checkGoodsOutwards.style.color = "blue";

    items.push(a60);
    showRefreshWidgets();
  } else {
    activeGoodsOutwards = 0;
    // checkGoodsOutwards.style.color = "black";

    const index = items.indexOf(a60);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCustomAvg() {
  if (checkCustomAvg.checked) {
    activeCustomAvg = 1;
    // checkCustomAvg.style.color = "blue";

    items.push(a70);
    showRefreshWidgets();
  } else {
    activeCustomAvg = 0;
    // checkCustomAvg.style.color = "black";

    const index = items.indexOf(a70);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showRegisterdUser() {
  if (checkRegisterdUser.checked) {
    activeRegisterdUser = 1;
    // checkRegisterdUser.style.color = "blue";

    items.push(a80);
    showRefreshWidgets();
  } else {
    activeRegisterdUser = 0;
    // checkRegisterdUser.style.color = "black";

    const index = items.indexOf(a80);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showTotalDownloads() {
  if (checkTotalDownloads.checked) {
    activeTotalDownloads = 1;
    // checkTotalDownloads.style.color = "blue";

    items.push(a81);
    showRefreshWidgets();
  } else {
    activeTotalDownloads = 0;
    // checkTotalDownloads.style.color = "black";

    const index = items.indexOf(a81);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showOpenAndCloseEscalation() {
  if (checkOpenAndCloseEscalation.checked) {
    activeOpenAndCloseEscalation = 1;
    // checkOpenAndCloseEscalation.style.color = "blue";

    items.push(a83);
    showRefreshWidgets();
  } else {
    activeOpenAndCloseEscalation = 0;
    // checkOpenAndCloseEscalation.style.color = "black";

    const index = items.indexOf(a83);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showZoneWiseEscalation() {
  if (checkZoneWiseEscalation.checked) {
    activeZoneWiseEscalation = 1;
    // checkZoneWiseEscalation.style.color = "blue";

    items.push(a82);
    showRefreshWidgets();
  } else {
    activeZoneWiseEscalation = 0;
    // checkZoneWiseEscalation.style.color = "black";

    const index = items.indexOf(a82);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showCategoryWiseEscalation() {
  if (checkCategoryWiseEscalation.checked) {
    activeCategoryWiseEscalation = 1;
    // checkCategoryWiseEscalation.style.color = "blue";

    items.push(a84);
    showRefreshWidgets();
  } else {
    activeCategoryWiseEscalation = 0;
    // checkCategoryWiseEscalation.style.color = "black";

    const index = items.indexOf(a84);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showServicePartnerEvaluation() {
  if (checkServicePartnerEvaluation.checked) {
    activeServicePartnerEvaluation = 1;
    // checkServicePartnerEvaluation.style.color = "blue";

    items.push(a85);
    showRefreshWidgets();
  } else {
    activeServicePartnerEvaluation = 0;
    // checkServicePartnerEvaluation.style.color = "black";

    const index = items.indexOf(a85);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showFunctionWise() {
  if (checkFunctionWise.checked) {
    activeFunctionWise = 1;
    // checkFunctionWise.style.color = "blue";

    items.push(a101);
    showRefreshWidgets();
  } else {
    activeFunctionWise = 0;
    // checkFunctionWise.style.color = "black";

    const index = items.indexOf(a101);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showClusterWise() {
  if (checkClusterStats.checked) {
    activeClusterStats = 1;
    // checkClusterStats.style.color = "blue";

    items.push(a100);
    showRefreshWidgets();
  } else {
    activeClusterStats = 0;
    // checkClusterStats.style.color = "black";

    const index = items.indexOf(a100);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTrendsOverMonthSites() {
  if (checkTrendsOverMonthSites.checked) {
    activeTrendsOverMonthSites = 1;
    // checkTrendsOverMonthSites.style.color = "blue";

    items.push(a103);
    showRefreshWidgets();
  } else {
    activeTrendsOverMonthSites = 0;
    // checkTrendsOverMonthSites.style.color = "black";

    const index = items.indexOf(a103);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showGenderParticipation() {
  if (checkGenderParticipation.checked) {
    activeGenderParticipation = 1;
    // checkGenderParticipation.style.color = "blue";

    items.push(a102);
    showRefreshWidgets();
  } else {
    activeGenderParticipation = 0;
    // checkGenderParticipation.style.color = "black";

    const index = items.indexOf(a102);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalVisitors2() {
  if (checkTotalVisitorsII.checked) {
    activeTotalVisitorsII = 1;
    // checkTotalVisitorsII.style.color = "blue";

    items.push(a104);
    showRefreshWidgets();
  } else {
    activeTotalVisitorsII = 0;
    // checkTotalVisitorsII.style.color = "black";

    const index = items.indexOf(a104);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}



function showGoodsOut() {
  if (activeGoodsOut == 0) {
    activeGoodsOut = 1;
    checkGoodsOut.style.color = "blue";

    items.push(a49);
    showRefreshWidgets();
  } else {
    activeGoodsOut = 0;
    checkGoodsOut.style.color = "black";

    const index = items.indexOf(a49);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalParking() {
  if (checkTotalParking.checked) {
    activeTotalParking = 1;
    // checkTotalParking.style.color = "blue";

    items.push(b70);
    showRefreshWidgets();
  } else {
    activeTotalParking = 0;
    // checkTotalParking.style.color = "black";

    const index = items.indexOf(b70);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showFreeParking() {
  if (checkFreeParking.checked) {
    activeFreeParking = 1;
    // checkFreeParking.style.color = "blue";

    items.push(b71);
    showRefreshWidgets();
  } else {
    activeFreeParking = 0;
    // checkFreeParking.style.color = "black";

    const index = items.indexOf(b71);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showPaidParking() {
  if (checkPaidParking.checked) {
    activePaidParking = 1;
    // checkPaidParking.style.color = "blue";

    items.push(b72);
    showRefreshWidgets();
  } else {
    activePaidParking = 0;
    // checkPaidParking.style.color = "black";

    const index = items.indexOf(b72);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}
function showOccupiedParking() {
  if (activeOccupiedParking.checked) {
    activeOccupiedParking = 1;
    // checkOccupiedParking.style.color = "blue";

    items.push(b73);
    showRefreshWidgets();
  } else {
    activeOccupiedParking = 0;
    // checkOccupiedParking.style.color = "black";

    const index = items.indexOf(b73);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showVacantParking() {
  if (activeVacantParking.checked) {
    activeVacantParking = 1;
    // checkVacantParking.style.color = "blue";

    items.push(b74);
    showRefreshWidgets();
  } else {
    activeVacantParking = 0;
    // checkVacantParking.style.color = "black";

    const index = items.indexOf(b74);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showTotalGatePass() {
  if (checkTotalGatePass.checked) {
    activeTotalGatePass = 1;
    // checkTotalGatePass.style.color = "blue";

    items.push(a108);
    showRefreshWidgets();
  } else {
    activeTotalGatePass = 0;
    // checkTotalGatePass.style.color = "black";

    const index = items.indexOf(a108);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showReturnablePass() {
  if (checkReturnablePass.checked) {
    activeReturnablePass = 1;
    // checkReturnablePass.style.color = "blue";

    items.push(a109);
    showRefreshWidgets();
  } else {
    activeReturnablePass = 0;
    // checkReturnablePass.style.color = "black";

    const index = items.indexOf(a109);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showNonReturnablePass() {
  if (checkNonReturnablePass.checked) {
    activeNonReturnablePass = 1;
    // checkNonReturnablePass.style.color = "blue";

    items.push(a110);
    showRefreshWidgets();
  } else {
    activeNonReturnablePass = 0;
    // checkNonReturnablePass.style.color = "black";

    const index = items.indexOf(a110);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalAmount() {
  if (checkTotalAmount.checked) {
    activeTotalAmount = 1;
    // checkTotalAmount.style.color = "blue";

    items.push(b34);
    showRefreshWidgets();
  } else {
    activeTotalAmount = 0;
    // checkTotalAmount.style.color = "black";

    const index = items.indexOf(b34);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalReceived() {
  if (checkTotalReceived.checked) {
    activeTotalReceived = 1;
    // checkTotalReceived.style.color = "blue";

    items.push(b35);
    showRefreshWidgets();
  } else {
    activeTotalReceived = 0;
    // checkTotalReceived.style.color = "black";

    const index = items.indexOf(b35);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showTotalOutstanding() {
  if (checkTotalOutstanding.checked) {
    activeTotalOutStanding = 1;
    // checkTotalOutstanding.style.color = "blue";

    items.push(b36);
    showRefreshWidgets();
  } else {
    activeTotalOutStanding = 0;
    // checkTotalOutstanding.style.color = "black";

    const index = items.indexOf(b36);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalOutstandingAmount() {
  if (checkTotalOutstandingAmount.checked) {
    activeTotalOutStandingAmount = 1;
    // checkTotalOutstandingAmount.style.color = "blue";

    items.push(b78);
    showRefreshWidgets();
  } else {
    activeTotalOutStandingAmount = 0;
    // checkTotalOutstandingAmount.style.color = "black";

    const index = items.indexOf(b78);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTotalInventory() {
  if (checkInventory.checked) {
    activeInventory = 1;
    // checkInventory.style.color = "blue";

    items.push(b61);
    showRefreshWidgets();
  } else {
    activeInventory = 0;
    // checkInventory.style.color = "black";

    const index = items.indexOf(b61);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showEmpParticipationStats() {
  if (checkEmpParticipationStats.checked) {
    activeEmpParticipationStats = 1;
    // checkEmpParticipationStats.style.color = "blue";

    items.push(c15);
    showRefreshWidgets();
  } else {
    activeEmpParticipationStats = 0;
    // checkEmpParticipationStats.style.color = "black";

    const index = items.indexOf(c15);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showDeliveryVisitors() {
  if (checkDeliveryVisitors.checked) {
    activeDeliveryVisitors = 1;
    // checkDeliveryVisitors.style.color = "blue";

    items.push(a78);
    showRefreshWidgets();
  } else {
    activeDeliveryVisitors = 0;
    // checkDeliveryVisitors.style.color = "black";

    const index = items.indexOf(a78);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showCheckList() {
  if (checkCheckList.checked) {
    activeCheckList = 1;
    // checkCheckList.style.color = "blue";

    items.push(a75);
    showRefreshWidgets();
  } else {
    activeCheckList = 0;
    // checkCheckList.style.color = "black";

    const index = items.indexOf(a75);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}


function showFacilityInfo() {
  if (checkFacilityInfo.checked) {
    activeFacilityInfo = 1;
    // checkFacilityInfo.style.color = "blue";

    items.push(a74);
    showRefreshWidgets();
  } else {
    activeFacilityInfo = 0;
    // checkFacilityInfo.style.color = "black";

    const index = items.indexOf(a74);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCommLeaderboard() {
  if (checkCommLeaderboard.checked) {
    activeCommLeaderboard = 1;
    // checkCommLeaderboard.style.color = "blue";

    items.push(c19);
    showRefreshWidgets();
  } else {
    activeCommLeaderboard = 0;
    // checkCommLeaderboard.style.color = "black";

    const index = items.indexOf(c19);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showDepartmentStats() {
  if (checkDepartmentStats.checked) {
    activeDepartmentStats = 1;
    // checkDepartmentStats.style.color = "blue";

    items.push(c14);
    showRefreshWidgets();
  } else {
    activeDepartmentStats = 0;
    // checkDepartmentStats.style.color = "black";

    const index = items.indexOf(c14);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showDailyStepCount() {
  if (checkDailyStepCount.checked) {
    activeDailyStepCount = 1;
    // checkDailyStepCount.style.color = "blue";

    items.push(c11);
    showRefreshWidgets();
  } else {
    activeDailyStepCount = 0;
    // checkDailyStepCount.style.color = "black";

    const index = items.indexOf(c11);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showCommLeaderboardFemale() {
  if (checkCommLeaderboardFemale.checked) {
    activeCommLeaderboardFemale = 1;
    // checkCommLeaderboardFemale.style.color = "blue";

    items.push(c21);
    showRefreshWidgets();
  } else {
    activeCommLeaderboardFemale = 0;
    // checkCommLeaderboardFemale.style.color = "black";

    const index = items.indexOf(c21);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showTechnicalChecklist() {
  if (checkTechnicalChecklist.checked) {
    activeTechnicalChecklist = 1;
    // checkTechnicalChecklist.style.color = "blue";

    items.push(a114);
    showRefreshWidgets();
  } else {
    activeTechnicalChecklist = 0;
    // checkTechnicalChecklist.style.color = "black";

    const index = items.indexOf(a114);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }
}

function showNonTechnicalChecklist() {
  if (checkNonTechnicalChecklist.checked) {
    activeNonTechnicalChecklist = 1;
    // checkNonTechnicalChecklist.style.color = "blue";

    items.push(a115);
    showRefreshWidgets();
  } else {
    activeNonTechnicalChecklist = 0;
    // checkNonTechnicalChecklist.style.color = "black";

    const index = items.indexOf(a115);
    if (index > -1) {
      items.splice(index, 1);
    }
    showRefreshWidgets();
  }

}

/// Download Reports-------------------------------------------------------------------------------

// globalSiteId
// globalSocietyId
function downloadVisitors() {
  // if ((globalType = "daily")) {
  //   window.open(
  //     ip +
  //       "charts-daily/get-total-visitors-download/" +
  //       idLink +
  //       "&date=" +
  //       globalDateFirst +
  //       "&building_id=" +
  //       globalVisitorBuildingId,
  //     "_blank"
  //   );
  // } else {
  window.open(
    ip +
    "fm-excel-download/get-visitors-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond +
    // "&building_id=" +
    // globalVisitorBuildingId,
    "_blank"
  );
}
// }

function downloadGoodsInwards() {

  window.open(downloadGoodInLink
    ,
    "_blank"
  );

}

function downloadOutwards() {

  window.open(downloadGoodOutLink
    ,
    "_blank"
  );

}

function downloadTotalVisitors() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "fm-excel-download/get-visitors-excel-data/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "fm-excel-download/get-visitors-excel-data/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}
function downloadExpectedVisitors() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-expected-visitors-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-expected-visitors-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadUnExpectedVisitors() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-unexpected-visitors-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-unexpected-visitors-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadTotalGatePass() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-total-visitors-gatepass-download/" +
      idLink +
      "&date=" +
      globalDateFirst, "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-total-visitors-gatepass-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadReturnGatePass() {
  window.open(ip + "//" + idLink + "&date=" + globalDateFirst, "_blank");
}

function downloadNonReturnGatePass() {
  window.open(ip + "//" + idLink + "&date=" + globalDateFirst, "_blank");
}

function downloadTotalVehicles() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-visitors-behicle-in-out-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-visitors-behicle-in-out-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadTotalStaff() {
  window.open(ip + "quick-gate-daily/get-total-staff-download/" + idLink + "&date=" +
    globalDateFirst, "_blank");
}




function downloadStaffIn() {
  window.open(ip + "quick-gate-daily/get-total-staff-in-download/" + idLink + "&date=" +
    globalDateFirst, "_blank");
}

function downloadStaffOut() {
  window.open(ip + "quick-gate-daily/get-total-staff-out-download/" + idLink + "&date=" +
    globalDateFirst, "_blank");
}

function downloadGoodsInwards() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-goods-inward-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-goods-inward-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadOutwards() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-goods-outward-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-goods-outward-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}
// ---------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------
function downloadAsset() {
  window.open(
    ip +
    "fm-excel-download/get-total-assets-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"

  );
}
function downloadAssetInUse() {
  window.open(
    ip +
    "fm-excel-download/get-assets-in-use-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadAssetIB() {
  window.open(
    ip +


    "fm-excel-download/get-assets-in-breakdown-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadCAIB() {
  window.open(
    ip +
    "fm-excel-download/get-critical-assets-inbreakdown-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadAssetPPM() {
  window.open(
    ip +
    "fm-excel-download/get-ppm-conducted-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTickets() {
  console.log(downloadTicketsLink);
  window.open(downloadTicketsLink, "_blank");
}

function downloadActivityFeed() {
  window.open(
    ip +
    "" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadCategoryWiseTickets() {
  console.log(downloadCategoryTicketsLink);
  window.open(
    downloadCategoryTicketsLink, "_blank"
  );
}
function downloadCategoryWiseProactiveTickets() {
  window.open(
    downloadCategoryWiseProactiveTicketsLink,
    "_blank"
  );
}
function downloadCACategoryWiseTickets() {
  window.open(downloadCACategoryWiseTicketsLink, "_blank"
  );
}
function downloadCACategoryWiseProactiveTickets() {
  window.open(downloadCACategoryWiseProactiveTicketsLink, "_blank"
  );
}
function downloadTicketsAgeingMatrix() {

  window.open(
    ip +
    "fm-excel-download/get-commonArea-category-wise-proactiveticket-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}




/// Download Reports-------------------------------------------------------------------------------

// globalSiteId
// globalSocietyId
function downloadVisitors() {
  // if ((globalType = "daily")) {
  //   window.open(
  //     ip +
  //       "charts-daily/get-total-visitors-download/" +
  //       idLink +
  //       "&date=" +
  //       globalDateFirst +
  //       "&building_id=" +
  //       globalVisitorBuildingId,
  //     "_blank"
  //   );
  // } else {
  window.open(
    ip +
    "fm-excel-download/get-visitors-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond +
    // "&building_id=" +
    // globalVisitorBuildingId,
    "_blank"
  );
}
// }

function downloadGoodsInwards() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-day-wise-goods-inward-download/" +
      idLink +
      "&date=" +
      globalDateFirst +
      "&building_id=" +
      globalGoodsIn,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-day-wise-goods-inward-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond +
      "&building_id=" +
      globalVisitorBuildingId,
      "_blank"
    );
  }
}

function downloadOutwards() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-day-wise-goods-outward-download/" +
      idLink +
      "&date=" +
      globalDateFirst +
      "&building_id=" +
      globalGoodsOut,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-day-wise-goods-outward-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond +
      "&building_id=" +
      globalVisitorBuildingId,
      "_blank"
    );
  }
}

function downloadTotalVisitors() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "fm-excel-download/get-visitors-excel-data/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "fm-excel-download/get-visitors-excel-data/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}
function downloadExpectedVisitors() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-expected-visitors-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-expected-visitors-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadUnExpectedVisitors() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-unexpected-visitors-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-unexpected-visitors-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadTotalGatePass() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-total-visitors-gatepass-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-total-visitors-gatepass-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadReturnGatePass() {
  window.open(ip + "//" + idLink + "&date=" + globalDateFirst, "_blank");
}

function downloadNonReturnGatePass() {
  window.open(ip + "//" + idLink + "&date=" + globalDateFirst, "_blank");
}

function downloadTotalVehicles() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-visitors-behicle-in-out-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-visitors-behicle-in-out-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

// function downloadTotalStaff() {
//   window.open(ip + "//" + idLink + "&date=" + globalDateFirst, "_blank");
// }

// function downloadStaffIn() {
//   window.open(ip + "//" + idLink + "&date=" + globalDateFirst, "_blank");
// }

// function downloadStaffOut() {
//   window.open(ip + "//" + idLink + "&date=" + globalDateFirst, "_blank");
// }

function downloadGoodsInwards() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-goods-inward-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-goods-inward-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}

function downloadOutwards() {
  if ((globalType = "daily")) {
    window.open(
      ip +
      "charts-daily/get-goods-outward-download/" +
      idLink +
      "&date=" +
      globalDateFirst,
      "_blank"
    );
  } else {
    window.open(
      ip +
      "charts-monthly/get-goods-outward-download/" +
      idLink +
      "&from_date=" +
      globalDateFirst +
      "&to_date=" +
      globalDateSecond,
      "_blank"
    );
  }
}
// ---------------------------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------------------------
function downloadAsset() {
  window.open(
    ip +
    "fm-excel-download/get-total-assets-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadAssetInUse() {
  window.open(
    ip +
    "fm-excel-download/get-assets-in-use-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadAssetIB() {
  window.open(
    ip +
    "fm-excel-download/get-assets-in-breakdown-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadCAIB() {
  window.open(
    ip +
    "fm-excel-download/get-critical-assets-inbreakdown-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadAssetPPM() {
  window.open(
    ip +
    "fm-excel-download/get-ppm-conducted-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

// function downloadTickets() {
//   window.open(
//     ip +
//     "fm-excel-download/get-tickets-excel-data/" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }



function downloadActivityFeed() {
  window.open(
    ip +
    "" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
// function downloadCategoryWiseTickets() {
//   window.open(
//     ip +
//     "fm-excel-download/get-category-wise-ticket-excel-data/" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }
// function downloadCategoryWiseProactiveTickets() {
//   window.open(
//     ip +
//     "fm-excel-download/get-category-wise-proactive-ticket-excel-data/" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }
// function downloadCACategoryWiseTickets() {
//   window.open(
//     ip +
//     "fm-excel-download/get-commonArea-category-wiseticket-excel-data/" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }
// function downloadCACategoryWiseProactiveTickets() {
//   window.open(
//     ip +
//     "fm-excel-download/get-commonArea-category-wise-proactiveticket-excel-data/" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }
function downloadTicketsAgeingMatrix() {
  window.open(
    ip +
    "fm-excel-download/get-ageing-matrix-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadResolutionTAT() {
  window.open(downloadResolutionTATLink, "_blank"
  );
}
function downloadResponseTAT() {
  window.open(
    downloadResponseTATLink,
    "_blank"
  );
}
function downloadDConsumPie() {
  window.open(
    ip +
    "fm-excel-download/get-cumulitive-power-consumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
// function downloadPowerConsumption(){
//    window.open(
//       ip +
//         "" +
//         idLink +
//         "&from_date=" +
//         globalDateFirst +
//         "&to_date=" +
//         globalDateSecond,
//       "_blank"
//     );
// }
function downloadWaterConsumption() {
  window.open(
    ip +
    "" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadIncidents() {
  window.open(
    downloadIncidentsLink, "_blank"
  );
}
function downloadCategoryWiseIncidents() {
  window.open(
    downloadCategoryWiseIncidentsLink, "_blank"
  );
}
// function downloadManPowerAttendance() {
//   window.open(
//     ip +
//       "" +
//       idLink +
//       "&from_date=" +
//       globalDateFirst +
//       "&to_date=" +
//       globalDateSecond,
//     "_blank"
//   );
// }

function downloadManPowerAttendance() {
  window.open(
    downloadEventsFootfallAnalysisLink, "_blank"
  );
}


function downloadEventsFootfallAnalysis() {
  window.open(
    ip +
    "fm-excel-download/get-footfall-analysis-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadLTIR() {
  window.open(
    ip +
    "fm-excel-download/get-incident-LTIR-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadZeroIncidentDays() {
  window.open(
    ip +
    "fm-excel-download/get-zero-incident-days-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadIncidentPerSqFt() {
  window.open(
    ip +
    "fm-excel-download/get-incident-per-square-feet-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadIncidentNearMissGoodCatch() {
  window.open(
    ip +
    "fm-excel-download/get-incident-near-miss-and-good-catch-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadSafeManHours() {
  window.open(
    ip +
    "fm-excel-download/get-safe-man-hours-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

// function downloadSafeManHours() {
//   window.open(
//     ip +
//       "" +
//       idLink +
//       "&from_date=" +
//       globalDateFirst +
//       "&to_date=" +
//       globalDateSecond,
//     "_blank"
//   );
// }
function downloadRAC() {
  window.open(
    ip +
    "fm-excel-download/get-incident-RCA-chart-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadAssetsBreakdown() {
  window.open(
    ip +
    "fm-excel-download/get-asset-break-downs-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadPyramid() {
  window.open(
    downloadPyramidLink, "_blank"
  );
}
// function downloadInjuryIllness() {
//   window.open(
//     ip +
//     "fm-excel-download/get-injuryor-illness-graph-excel-data/" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }
function downloadRootCause() {
  window.open(
    ip +
    "fm-excel-download/get-cause-wise-incidents-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadBodyInjuryChart() {
  window.open(
    ip +
    "fm-excel-download/get-incident-body-injury-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadTotalConsumption() {
  window.open(
    ip +
    "fm-excel-download/get-ht-main-meter-total-consumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTransformaerTotal() {
  window.open(
    ip +
    "fm-excel-download/get-transformer-total-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadFitoutTableData() {
  window.open(
    ip +
    "fm-excel-download/get-active-fitout-requests/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadfitoutUnoccupied() {
  window.open(
    ip +
    "fm-excel-download/get-occupancy-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadftFitoutFlats() {
  window.open(
    ip +
    "fm-excel-download/get-fitout-flat/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadDgtotal() {
  window.open(
    ip +
    "fm-excel-download/get-dg-total-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTotalDieselConsumed() {
  window.open(
    ip +
    "fm-excel-download/get-total-diesel-consumed-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadPowerConsum() {
  window.open(
    downloadPowerConsumLink, "_blank"
  );
}

// function downloadPowerConsumAssetWiseTimeSeries() {
//   window.open(
//     ip +
//     "fm-excel-download/get-power-consumption-time-series-excel-data/" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }

function downloadCarbonEmissionScope1() {
  window.open(
    ip +
    "fm-excel-download/get-carbon-emission-scope1-excel-data/"
    + idLink + "&from_date=" + globalDateFirst + "&to_date=" + globalDateSecond, "_blank"
  );
}
function downloadCarbonEmissionScope2() {
  window.open(
    ip +
    "fm-excel-download/get-carbon-emission-scope2-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadEnergyIntensity() {
  window.open(
    ip +
    "fm-excel-download/get-energy-intensity-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}


function downloadwcTotalConsumption() {
  window.open(
    ip +
    "fm-excel-download/get-totalWaterConsumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadwcTotalSTP() {
  window.open(
    ip +
    "fm-excel-download/get-total-stp-WaterConsumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadDomesticTotal() {
  window.open(
    ip +
    "fm-excel-download/get-card-domestic-waterConsumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadFlushingTotal() {
  window.open(
    ip +
    "fm-excel-download/get-card-flushing-waterConsumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadIrrigation() {
  window.open(
    ip +
    "fm-excel-download/get-card-irrigation-waterConsumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );

}




function downloadWaterConsumLPCD() {
  window.open(
    ip +
    "fm-excel-download/get-card-lpcd-waterConsumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadWaterConsumPie() {
  window.open(
    ip +
    "fm-excel-download/get-water-sourcePieChart-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadWaterConsumBar() {
  window.open(
    downloadWaterConsumBarLink, "_blank"
  );
}
function downloadFuelConsumption() {
  window.open(
    ip +
    "fm-excel-download/get-total-fuel-consumption-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadFitout() {
  window.open(
    ip +
    "fm-excel-download/get-fitout-chart-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
function downloadOccupancy() {
  window.open(
    downloadOccupancyLink, "_blank"
  );
}


function downloadExecutiveEscalation() {
  window.open(
    ip +
    "fm-excel-download/get-executive-escalation-table-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}


function downloadcustomerSentiment() {
  window.open(
    ip +
    "fm-excel-download/get-sentiments-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}





function downloadcardCustomerAvg() {
  window.open(
    ip +
    "fm-excel-download/get-sentiments-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadFacilityInfo() {
  window.open(
    ip +
    "fm-excel-download/get-club-facilities-monthly-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}





function downloadChecklist() {
  window.open(
    ip +
    "fm-excel-download/get-chart-checklist-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadDieselNot() {
  window.open(
    ip +
    "fm-excel-download/get-card-total-diesel-non-consumed-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadWaterNot() {
  window.open(
    ip +
    "fm-excel-download/get-card-total-tanker-non-consumption-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}




function downloadDeliveryVisitor() {
  window.open(
    downloadDeliveryVisitorLink, "_blank"
  );
}



// function downloadTotalflats() {
//   window.open(
//     ip +
//     "" +
//     idLink +
//     "&from_date=" +
//     globalDateFirst +
//     "&to_date=" +
//     globalDateSecond,
//     "_blank"
//   );
// }

function downloadRegisteredUsers() {
  window.open(
    ip +
    "fm-excel-download/get-total-users-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadDownloads() {
  window.open(
    ip +
    "fm-excel-download/get-total-downloads-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}



function downloadCategoryEscalation() {
  window.open(
    ip +
    "fm-excel-download/get-executive-escalation-table-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadGenderParticipation() {
  window.open(
    downloadGenderParticipationLink,
    "_blank"
  );
}

function downloadClusterWiseTotal() {
  window.open(downloadClusterWiseTotalLink,
    "_blank"
  );
}


function downloadFunctionWiseTotal() {
  window.open(
    downloadFunctionWiseTotalLink,
    "_blank"
  );
}



function downloadTrendsMonths() {
  window.open(downloadTrendsMonthsLink,
    "_blank"
  );
}





function downloadTrendsSites() {
  window.open(downloadTrendsSitesLink,
    "_blank"
  );
}



function downloadTotalVisitorsChartII() {

  window.open(
    downloadTotalVisitorIILink,
    "_blank"
  );

}



function downloadPermitSite() {
  window.open(
    ip +
    "supervisor-monthly/get-site-wise-permits-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadPermitStatus() {
  window.open(
    ip +
    "supervisor-monthly/get-permits-status-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadOverStock() {
  window.open(
    ip +
    "supervisor-monthly/get-Over-Stock-Items-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadUnderStock() {
  window.open(
    ip +
    "supervisor-monthly/get-Under-Stock-Items-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadWorkOrder() {
  window.open(
    ip +
    "supervisor-monthly/get-card-work-order-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadPurchaseOrder() {
  window.open(
    ip +
    "supervisor-monthly/get-card-purchase-order-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTotalValue() {
  window.open(
    ip +
    "supervisor-monthly/get-Total-value-of-Inventory-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadInventory() {
  window.open(
    ip +
    "supervisor-monthly/get-card-total-inventory-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTotalConsumables() {
  window.open(
    ip +
    "supervisor-monthly/get-Total-Value-Of-Consumables-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTotalSpares() {
  window.open(
    ip +
    "supervisor-monthly/get-Total-Value-Of-Spares-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}


function downloadIncidentSummary() {
  window.open(
    ip +
    "fm-excel-download/get-incident-RCA-chart-excel-data/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTotalParking() {
  window.open(
    ip +
    "supervisor-monthly/get-total-parking-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadFreeParking() {
  window.open(
    ip +
    "supervisor-monthly/get-free-parking-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadPaidParking() {
  window.open(
    ip +
    "supervisor-monthly/get-paid-parking-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadOccupiedParking() {
  window.open(
    ip +
    "supervisor-monthly/get-occupied-parking-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadVacantParking() {
  window.open(
    ip +
    "supervisor-monthly/get-vacant-parking-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}
// -----------


function downloadClusterEmployeeParticiption() {
  window.open(
    ip +
    "stepathon/get-cluster-employee-participation-download/" +
    "?from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadCumulativeLeaderboardFemale() {
  window.open(
    ip +
    "stepathon/get-cumulative-leaderboard-female-download/" +
    "?from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}


function downloadDailyStepCount() {
  window.open(
    ip +
    "stepathon/get-organisation-daily-step-count-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadFunctionEmployee() {
  window.open(
    ip +
    "stepathon/get-function-employee-participation-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadCumulativeLeaderboardMale() {
  window.open(
    ip +
    "stepathon/get-cumulative-leaderboard-male-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadTechnicalChecklist() {
  window.open(
    ip +
    "fm-excel-download/get-chart-technical-checklist-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadNonTechnicalChecklist() {
  window.open(
    ip +
    "fm-excel-download/get-chart-non-technical-checklist-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateSecond,
    "_blank"
  );
}

function downloadOpenEscalation() {

  window.open(
    ip +
    "fm-excel-download/get-open-escalation-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}



function downloadCloseEscalation() {

  window.open(
    ip +
    "fm-excel-download/get-closed-escalation-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}




function downloadAvgEscalation() {

  window.open(
    ip +
    "fm-excel-download/get-average-escalation-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadSiteWise() {
  window.open(
    ip +
    "supervisor-monthly/get-site-wise-power-consumption-excel-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadAssetBreakdown() {
  window.open(
    ip +
    "supervisor-monthly/get-assets-breakdown-excel-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadChecklistTop() {
  window.open(
    ip +
    "fm-excel-download/get-top-ten-checklist-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadAuditScore() {
  window.open(
    ip +
    "fm-excel-download/get-auditscore-table-excel-download/" +
    idLink +
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}


function downloadInventoryConsumption() {
  window.open(
    ip +
    "inventory/get-inventory-consumption-non-green-excel-data/" +
    idLink+
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadInventoryConsumptionReport() {
  window.open(
    ip +
    "inventory/get-inventory-consumption-report-non-green-excel-data/" +
    idLink+
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadCurrentStock() {
  window.open(
    ip +
    "inventory/get-inventory-current-stock-non-green-excel-data/" +
    idLink+
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadInventoryConsumptionGreen() {
  window.open(
    ip +
    "inventory/get-inventory-consumption-green-excel-data/" +
    idLink+
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadInventoryConsumptionReportGreen() {
  window.open(
    ip +
    "inventory/get-inventory-consumption-report-green-excel-data/" +
    idLink+
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

function downloadCurrentStockGreen() {
  window.open(
    ip +
    "inventory/get-inventory-current-and-minimum-stock-green-excel-data/" +
    idLink+
    "&from_date=" +
    globalDateFirst +
    "&to_date=" +
    globalDateFirst,
    "_blank"
  );
}

